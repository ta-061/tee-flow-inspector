{
  "id": "optee-core-cve-2022-46152",
  "display_name": "OP-TEE OS Core - cleanup_shm_refs UAF (CVE-2022-46152)",
  "description": "OP-TEE OS (optee_os) before commit 728616b has a use-after-free in cleanup_shm_refs() in core/tee/entry_std.c. When processing REE-provided shared memory references, a failure in tee_mmu_map_param() can leave partially-mapped shm entries. cleanup_shm_refs() then iterates and unmaps them, but the loop bounds are incorrect, leading to UAF or double-unmap of shm objects. NOTE: This is an OS-core level vulnerability (not a TA), running in the OP-TEE kernel. It is outside tee-flow-inspector's TA analysis scope but included for reference as a confirmed OP-TEE CVE.",
  "cve_ids": [
    "CVE-2022-46152"
  ],
  "advisory_ids": [],
  "cwe_ids": [
    "CWE-416"
  ],
  "vulnerability_category": "weak_input_validation",
  "repo_url": "https://github.com/OP-TEE/optee_os",
  "repo_branch": null,
  "repo_commit": "03e07432b68f9d78dbad4b9a8af50705948e7893",
  "fix_commit": "728616b28df659cf0bdde6e58a471f6ef25d023c",
  "collected_at": "2026-02-18T08:30:47.070800+00:00",
  "source_files": [
    "entry_std.c",
    "fs_dirfile.c",
    "fs_htree.c",
    "socket.c",
    "tadb.c",
    "tee_cryp_concat_kdf.c",
    "tee_cryp_hkdf.c",
    "tee_cryp_pbkdf2.c",
    "tee_cryp_utl.c",
    "tee_fs_key_manager.c",
    "tee_fs_rpc.c",
    "tee_obj.c",
    "tee_pobj.c",
    "tee_ree_fs.c",
    "tee_rpmb_fs.c",
    "tee_supp_plugin_rpc.c",
    "tee_svc.c",
    "tee_svc_cryp.c",
    "tee_svc_storage.c",
    "tee_ta_enc_manager.c",
    "tee_time_generic.c",
    "uuid.c"
  ],
  "tee_flow_inspector_cmd": "python3 ./src/main.py -p benchmark/optee-core-cve-2022-46152",
  "ground_truth_note": "ground_truth.csv contains known vulnerable lines. Empty rows indicate manual annotation is required."
}