{
  "sinks": [
    {
      "kind": "function",
      "name": "TEE_CreatePersistentObject",
      "param_index": 5,
      "rule_id": "weak_input_validation",
      "reason": "Initial persistent object data written from this buffer",
      "confidence": "high",
      "role": "buf"
    },
    {
      "kind": "function",
      "name": "TEE_CreatePersistentObject",
      "param_index": 6,
      "rule_id": "weak_input_validation",
      "reason": "Controls amount of initial data written persistently",
      "confidence": "high",
      "role": "len"
    },
    {
      "kind": "function",
      "name": "TEE_GenerateRandom",
      "param_index": 0,
      "rule_id": "weak_input_validation",
      "reason": "Filled with bytes that may be attacker-influenced or exposed",
      "confidence": "high",
      "role": "dest"
    },
    {
      "kind": "function",
      "name": "TEE_GenerateRandom",
      "param_index": 1,
      "rule_id": "weak_input_validation",
      "reason": "Length controls how many bytes are written into dest",
      "confidence": "high",
      "role": "len"
    },
    {
      "kind": "function",
      "name": "TEE_GetObjectBufferAttribute",
      "param_index": 2,
      "rule_id": "weak_input_validation",
      "reason": "Copies attribute bytes into caller-provided buffer",
      "confidence": "high",
      "role": "dest"
    },
    {
      "kind": "function",
      "name": "TEE_GetObjectBufferAttribute",
      "param_index": 3,
      "rule_id": "weak_input_validation",
      "reason": "Controls/reflects number of bytes written into buffer",
      "confidence": "high",
      "role": "len"
    },
    {
      "kind": "function",
      "name": "TEE_GetOperationInfo",
      "param_index": 1,
      "rule_id": "weak_input_validation",
      "reason": "API fills caller-provided info struct with data from operation handle",
      "confidence": "high",
      "role": "dest"
    },
    {
      "kind": "function",
      "name": "TEE_GetPropertyAsUUID",
      "param_index": 2,
      "rule_id": "weak_input_validation",
      "reason": "Writes property UUID into caller-provided buffer without explicit size",
      "confidence": "high",
      "role": "dest"
    },
    {
      "kind": "function",
      "name": "TEE_MemFill",
      "param_index": 0,
      "rule_id": "weak_input_validation",
      "reason": "memset-like fill into caller-provided buffer",
      "confidence": "high",
      "role": "dest"
    },
    {
      "kind": "function",
      "name": "TEE_MemFill",
      "param_index": 2,
      "rule_id": "weak_input_validation",
      "reason": "controls number of bytes written into destination buffer",
      "confidence": "high",
      "role": "len"
    },
    {
      "kind": "function",
      "name": "TEE_MemMove",
      "param_index": 0,
      "rule_id": "weak_input_validation",
      "reason": "memcpy-like destination buffer; attacker-controlled length may overflow",
      "confidence": "high",
      "role": "dest"
    },
    {
      "kind": "function",
      "name": "TEE_MemMove",
      "param_index": 2,
      "rule_id": "weak_input_validation",
      "reason": "controls number of bytes written into destination buffer",
      "confidence": "high",
      "role": "len"
    },
    {
      "kind": "function",
      "name": "TEE_ReadObjectData",
      "param_index": 1,
      "rule_id": "weak_input_validation",
      "reason": "Reads object bytes into caller buffer; size may be attacker-controlled.",
      "confidence": "high",
      "role": "dest"
    },
    {
      "kind": "function",
      "name": "TEE_ReadObjectData",
      "param_index": 2,
      "rule_id": "weak_input_validation",
      "reason": "Read length controls how many bytes are written into buffer.",
      "confidence": "high",
      "role": "len"
    },
    {
      "kind": "function",
      "name": "TEE_WriteObjectData",
      "param_index": 1,
      "rule_id": "weak_input_validation",
      "reason": "Buffer whose contents are written into persistent object storage",
      "confidence": "high",
      "role": "buf"
    },
    {
      "kind": "function",
      "name": "TEE_WriteObjectData",
      "param_index": 2,
      "rule_id": "weak_input_validation",
      "reason": "Length controls how many bytes are written from attacker-influenced buffer",
      "confidence": "high",
      "role": "len"
    },
    {
      "kind": "function",
      "name": "mbedtls_asn1_write_octet_string",
      "param_index": 0,
      "rule_id": "weak_input_validation",
      "reason": "Writes ASN.1 encoded octet string bytes into caller-provided buffer",
      "confidence": "high",
      "role": "dest"
    },
    {
      "kind": "function",
      "name": "mbedtls_asn1_write_octet_string",
      "param_index": 3,
      "rule_id": "weak_input_validation",
      "reason": "Controls how many bytes from source are written into buffer",
      "confidence": "high",
      "role": "len"
    },
    {
      "kind": "function",
      "name": "mbedtls_ecp_point_write_binary",
      "param_index": 4,
      "rule_id": "weak_input_validation",
      "reason": "Writes serialized EC point bytes into caller-provided buffer",
      "confidence": "high",
      "role": "dest"
    },
    {
      "kind": "function",
      "name": "mbedtls_ecp_point_write_binary",
      "param_index": 5,
      "rule_id": "weak_input_validation",
      "reason": "Buffer length controls maximum write extent into destination",
      "confidence": "high",
      "role": "len"
    },
    {
      "kind": "function",
      "name": "mbedtls_mpi_write_binary",
      "param_index": 1,
      "rule_id": "weak_input_validation",
      "reason": "Writes MPI bytes into caller-provided buffer",
      "confidence": "high",
      "role": "dest"
    },
    {
      "kind": "function",
      "name": "mbedtls_mpi_write_binary",
      "param_index": 2,
      "rule_id": "weak_input_validation",
      "reason": "Length controls how many bytes are written to buffer",
      "confidence": "high",
      "role": "len"
    },
    {
      "kind": "function",
      "name": "mbedtls_pk_write_key_der",
      "param_index": 0,
      "rule_id": "weak_input_validation",
      "reason": "Writes key material into caller-provided buffer.",
      "confidence": "high",
      "role": "dest"
    },
    {
      "kind": "function",
      "name": "mbedtls_pk_write_key_der",
      "param_index": 1,
      "rule_id": "weak_input_validation",
      "reason": "Controls how many bytes may be written into buffer.",
      "confidence": "high",
      "role": "len"
    },
    {
      "kind": "function",
      "name": "memset",
      "param_index": 0,
      "rule_id": "weak_input_validation",
      "reason": "Writes attacker-controlled pattern into destination buffer",
      "confidence": "high",
      "role": "dest"
    },
    {
      "kind": "function",
      "name": "memset",
      "param_index": 2,
      "rule_id": "weak_input_validation",
      "reason": "Length controls extent of memory write to dest",
      "confidence": "high",
      "role": "len"
    },
    {
      "kind": "function",
      "name": "snprintf",
      "param_index": 0,
      "rule_id": "weak_input_validation",
      "reason": "Formatted output buffer; attacker-controlled content or size may overflow",
      "confidence": "high",
      "role": "dest"
    },
    {
      "kind": "function",
      "name": "snprintf",
      "param_index": 1,
      "rule_id": "weak_input_validation",
      "reason": "Maximum bytes to write; attacker control may truncate or probe",
      "confidence": "high",
      "role": "len"
    },
    {
      "kind": "function",
      "name": "snprintk",
      "param_index": 0,
      "rule_id": "weak_input_validation",
      "reason": "printf-like formatted write into destination buffer",
      "confidence": "high",
      "role": "dest"
    },
    {
      "kind": "function",
      "name": "snprintk",
      "param_index": 1,
      "rule_id": "weak_input_validation",
      "reason": "bounds for formatted write; may be attacker-influenced",
      "confidence": "high",
      "role": "len"
    }
  ],
  "analysis_time": {
    "total_seconds": 337.864853143692,
    "total_formatted": "5.63分",
    "llm_analysis_seconds": 337.65158438682556,
    "llm_analysis_formatted": "5.63分",
    "functions_analyzed": 102,
    "per_function": {
      "TEE_GetOperationInfo": {
        "seconds": 13.847020387649536,
        "formatted": "13.85秒"
      },
      "TEE_GetPropertyAsUUID": {
        "seconds": 12.13626503944397,
        "formatted": "12.14秒"
      },
      "TEE_TruncateObjectData": {
        "seconds": 9.296992301940918,
        "formatted": "9.30秒"
      },
      "mbedtls_ecp_point_write_binary": {
        "seconds": 6.441009283065796,
        "formatted": "6.44秒"
      },
      "TEE_WriteObjectData": {
        "seconds": 6.361167907714844,
        "formatted": "6.36秒"
      },
      "mbedtls_asn1_write_octet_string": {
        "seconds": 6.228769540786743,
        "formatted": "6.23秒"
      },
      "TEE_ReadObjectData": {
        "seconds": 6.130177736282349,
        "formatted": "6.13秒"
      },
      "TEE_GetObjectBufferAttribute": {
        "seconds": 5.713924407958984,
        "formatted": "5.71秒"
      },
      "TEE_CreatePersistentObject": {
        "seconds": 5.6460959911346436,
        "formatted": "5.65秒"
      },
      "TEE_GenerateRandom": {
        "seconds": 5.511093854904175,
        "formatted": "5.51秒"
      },
      "mbedtls_mpi_free": {
        "seconds": 5.07932448387146,
        "formatted": "5.08秒"
      },
      "TEE_GetObjectInfo1": {
        "seconds": 4.792985677719116,
        "formatted": "4.79秒"
      },
      "TEE_MemFill": {
        "seconds": 4.695872068405151,
        "formatted": "4.70秒"
      },
      "mbedtls_ecp_group_free": {
        "seconds": 4.663712501525879,
        "formatted": "4.66秒"
      },
      "memset": {
        "seconds": 4.402608394622803,
        "formatted": "4.40秒"
      },
      "mbedtls_mpi_write_binary": {
        "seconds": 4.298692941665649,
        "formatted": "4.30秒"
      },
      "snprintk": {
        "seconds": 4.138676643371582,
        "formatted": "4.14秒"
      },
      "bit_set": {
        "seconds": 4.0931901931762695,
        "formatted": "4.09秒"
      },
      "LIST_FOREACH": {
        "seconds": 4.042226076126099,
        "formatted": "4.04秒"
      },
      "mbedtls_pk_write_key_der": {
        "seconds": 3.9586188793182373,
        "formatted": "3.96秒"
      },
      "TEE_AsymmetricEncrypt": {
        "seconds": 3.681278705596924,
        "formatted": "3.68秒"
      },
      "TEE_MemMove": {
        "seconds": 3.678831100463867,
        "formatted": "3.68秒"
      },
      "LIST_INSERT_HEAD": {
        "seconds": 3.6695656776428223,
        "formatted": "3.67秒"
      },
      "TEE_CloseAndDeletePersistentObject1": {
        "seconds": 3.604043483734131,
        "formatted": "3.60秒"
      },
      "snprintf": {
        "seconds": 3.4655697345733643,
        "formatted": "3.47秒"
      },
      "MSG_RAW": {
        "seconds": 3.409400463104248,
        "formatted": "3.41秒"
      },
      "IMSG": {
        "seconds": 3.3988804817199707,
        "formatted": "3.40秒"
      },
      "TEE_Malloc": {
        "seconds": 3.3507683277130127,
        "formatted": "3.35秒"
      },
      "TEE_GenerateKey": {
        "seconds": 3.3378844261169434,
        "formatted": "3.34秒"
      },
      "ARRAY_SIZE": {
        "seconds": 3.313788652420044,
        "formatted": "3.31秒"
      },
      "TAILQ_INSERT_HEAD": {
        "seconds": 3.2754361629486084,
        "formatted": "3.28秒"
      },
      "TEE_AsymmetricVerifyDigest": {
        "seconds": 3.2556281089782715,
        "formatted": "3.26秒"
      },
      "LIST_EMPTY": {
        "seconds": 3.254213809967041,
        "formatted": "3.25秒"
      },
      "mbedtls_pk_parse_key": {
        "seconds": 3.159313917160034,
        "formatted": "3.16秒"
      },
      "TEE_Panic": {
        "seconds": 3.0931525230407715,
        "formatted": "3.09秒"
      },
      "TEE_PopulateTransientObject": {
        "seconds": 3.0690619945526123,
        "formatted": "3.07秒"
      },
      "DMSG_RAW": {
        "seconds": 3.0193512439727783,
        "formatted": "3.02秒"
      },
      "ROUNDUP": {
        "seconds": 3.01507306098938,
        "formatted": "3.02秒"
      },
      "TEE_OpenPersistentObject": {
        "seconds": 2.962574005126953,
        "formatted": "2.96秒"
      },
      "TAILQ_FOREACH": {
        "seconds": 2.9359500408172607,
        "formatted": "2.94秒"
      },
      "bit_decl": {
        "seconds": 2.8551223278045654,
        "formatted": "2.86秒"
      },
      "TEE_CloseTASession": {
        "seconds": 2.846850633621216,
        "formatted": "2.85秒"
      },
      "TEE_MACComputeFinal": {
        "seconds": 2.8429319858551025,
        "formatted": "2.84秒"
      },
      "mbedtls_ecp_point_free": {
        "seconds": 2.8400871753692627,
        "formatted": "2.84秒"
      },
      "TEE_MemCompare": {
        "seconds": 2.8276984691619873,
        "formatted": "2.83秒"
      },
      "TEE_CipherInit": {
        "seconds": 2.800394296646118,
        "formatted": "2.80秒"
      },
      "TEE_DigestUpdate": {
        "seconds": 2.7983477115631104,
        "formatted": "2.80秒"
      },
      "TEE_InitValueAttribute": {
        "seconds": 2.7913804054260254,
        "formatted": "2.79秒"
      },
      "TEE_AsymmetricSignDigest": {
        "seconds": 2.791177988052368,
        "formatted": "2.79秒"
      },
      "TEE_DigestDoFinal": {
        "seconds": 2.778834104537964,
        "formatted": "2.78秒"
      },
      "TEE_FreeTransientObject": {
        "seconds": 2.7715365886688232,
        "formatted": "2.77秒"
      },
      "TEE_OpenTASession": {
        "seconds": 2.7369801998138428,
        "formatted": "2.74秒"
      },
      "TEE_DeriveKey": {
        "seconds": 2.6991117000579834,
        "formatted": "2.70秒"
      },
      "TAILQ_REMOVE": {
        "seconds": 2.6987452507019043,
        "formatted": "2.70秒"
      },
      "TEE_InitRefAttribute": {
        "seconds": 2.6928696632385254,
        "formatted": "2.69秒"
      },
      "bit_test": {
        "seconds": 2.6726622581481934,
        "formatted": "2.67秒"
      },
      "mbedtls_ecp_group_init": {
        "seconds": 2.663780450820923,
        "formatted": "2.66秒"
      },
      "mbedtls_ecp_check_privkey": {
        "seconds": 2.6011104583740234,
        "formatted": "2.60秒"
      },
      "TAILQ_INIT": {
        "seconds": 2.596703290939331,
        "formatted": "2.60秒"
      },
      "ADD_OVERFLOW": {
        "seconds": 2.5913124084472656,
        "formatted": "2.59秒"
      },
      "TAILQ_FOREACH_SAFE": {
        "seconds": 2.5438625812530518,
        "formatted": "2.54秒"
      },
      "mbedtls_mpi_init": {
        "seconds": 2.5433499813079834,
        "formatted": "2.54秒"
      },
      "LIST_FIRST": {
        "seconds": 2.5370678901672363,
        "formatted": "2.54秒"
      },
      "EMSG": {
        "seconds": 2.514439344406128,
        "formatted": "2.51秒"
      },
      "mbedtls_ecp_mul": {
        "seconds": 2.5136044025421143,
        "formatted": "2.51秒"
      },
      "TEE_RestrictObjectUsage1": {
        "seconds": 2.500871181488037,
        "formatted": "2.50秒"
      },
      "TEE_SeekObjectData": {
        "seconds": 2.4981372356414795,
        "formatted": "2.50秒"
      },
      "assert": {
        "seconds": 2.4887659549713135,
        "formatted": "2.49秒"
      },
      "TEE_CipherUpdate": {
        "seconds": 2.485257625579834,
        "formatted": "2.49秒"
      },
      "TEE_MACCompareFinal": {
        "seconds": 2.4564054012298584,
        "formatted": "2.46秒"
      },
      "mbedtls_pk_init": {
        "seconds": 2.4474306106567383,
        "formatted": "2.45秒"
      },
      "mbedtls_pk_free": {
        "seconds": 2.4221715927124023,
        "formatted": "2.42秒"
      },
      "TEE_Realloc": {
        "seconds": 2.4005913734436035,
        "formatted": "2.40秒"
      },
      "buf_compare_ct": {
        "seconds": 2.3999502658843994,
        "formatted": "2.40秒"
      },
      "mbedtls_rsa_check_privkey": {
        "seconds": 2.397371530532837,
        "formatted": "2.40秒"
      },
      "TEE_Free": {
        "seconds": 2.396367311477661,
        "formatted": "2.40秒"
      },
      "TEE_InvokeTACommand": {
        "seconds": 2.394965171813965,
        "formatted": "2.39秒"
      },
      "mbedtls_pk_setup": {
        "seconds": 2.38692569732666,
        "formatted": "2.39秒"
      },
      "mbedtls_ecp_point_init": {
        "seconds": 2.3828649520874023,
        "formatted": "2.38秒"
      },
      "TEE_PARAM_TYPES": {
        "seconds": 2.3610079288482666,
        "formatted": "2.36秒"
      },
      "mbedtls_mpi_bitlen": {
        "seconds": 2.360880136489868,
        "formatted": "2.36秒"
      },
      "TEE_PARAM_TYPE_GET": {
        "seconds": 2.3194382190704346,
        "formatted": "2.32秒"
      },
      "strlen": {
        "seconds": 2.3049516677856445,
        "formatted": "2.30秒"
      },
      "TEE_CloseObject": {
        "seconds": 2.296440362930298,
        "formatted": "2.30秒"
      },
      "mbedtls_ecp_keypair_free": {
        "seconds": 2.2860546112060547,
        "formatted": "2.29秒"
      },
      "TEE_AsymmetricDecrypt": {
        "seconds": 2.274090528488159,
        "formatted": "2.27秒"
      },
      "LIST_INIT": {
        "seconds": 2.2634737491607666,
        "formatted": "2.26秒"
      },
      "DMSG": {
        "seconds": 2.2521121501922607,
        "formatted": "2.25秒"
      },
      "mbedtls_ecp_keypair_init": {
        "seconds": 2.1831793785095215,
        "formatted": "2.18秒"
      },
      "LIST_REMOVE": {
        "seconds": 2.1522161960601807,
        "formatted": "2.15秒"
      },
      "TEE_AllocateTransientObject": {
        "seconds": 2.1509480476379395,
        "formatted": "2.15秒"
      },
      "mbedtls_pk_info_from_type": {
        "seconds": 2.144751787185669,
        "formatted": "2.14秒"
      },
      "TEE_SetOperationKey": {
        "seconds": 2.111912965774536,
        "formatted": "2.11秒"
      },
      "DMSG_BAD_BBOOL": {
        "seconds": 2.0804476737976074,
        "formatted": "2.08秒"
      },
      "TEE_AllocateOperation": {
        "seconds": 2.0779340267181396,
        "formatted": "2.08秒"
      },
      "TEE_FreeOperation": {
        "seconds": 2.054361343383789,
        "formatted": "2.05秒"
      },
      "TEE_CipherDoFinal": {
        "seconds": 2.005316972732544,
        "formatted": "2.01秒"
      },
      "MIN": {
        "seconds": 1.963413953781128,
        "formatted": "1.96秒"
      },
      "mbedtls_ecp_check_pubkey": {
        "seconds": 1.848137378692627,
        "formatted": "1.85秒"
      },
      "COMPILE_TIME_ASSERT": {
        "seconds": 1.8053040504455566,
        "formatted": "1.81秒"
      },
      "strnlen": {
        "seconds": 1.6652946472167969,
        "formatted": "1.67秒"
      },
      "TEE_MACUpdate": {
        "seconds": 1.653688907623291,
        "formatted": "1.65秒"
      }
    }
  },
  "analysis_mode": "llm_only"
}