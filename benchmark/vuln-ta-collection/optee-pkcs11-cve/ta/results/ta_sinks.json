{
  "sinks": [
    {
      "kind": "function",
      "name": "TEE_CreatePersistentObject",
      "param_index": 1,
      "rule_id": "weak_input_validation",
      "reason": "source bytes written to persistent object",
      "confidence": "high",
      "role": "buf"
    },
    {
      "kind": "function",
      "name": "TEE_CreatePersistentObject",
      "param_index": 2,
      "rule_id": "weak_input_validation",
      "reason": "size of data written to storage",
      "confidence": "high",
      "role": "len"
    },
    {
      "kind": "function",
      "name": "TEE_GenerateRandom",
      "param_index": 0,
      "rule_id": "weak_input_validation",
      "reason": "writes generated bytes into provided buffer",
      "confidence": "high",
      "role": "dest"
    },
    {
      "kind": "function",
      "name": "TEE_GenerateRandom",
      "param_index": 1,
      "rule_id": "weak_input_validation",
      "reason": "specifies number of bytes to write",
      "confidence": "high",
      "role": "len"
    },
    {
      "kind": "function",
      "name": "TEE_GetObjectBufferAttribute",
      "param_index": 0,
      "rule_id": "weak_input_validation",
      "reason": "copies object attribute bytes into caller buffer",
      "confidence": "high",
      "role": "dest"
    },
    {
      "kind": "function",
      "name": "TEE_GetObjectBufferAttribute",
      "param_index": 2,
      "rule_id": "weak_input_validation",
      "reason": "size/length of destination buffer",
      "confidence": "high",
      "role": "len"
    },
    {
      "kind": "function",
      "name": "TEE_GetObjectInfo1",
      "param_index": 1,
      "rule_id": "weak_input_validation",
      "reason": "writes TEE_ObjectInfo into caller buffer",
      "confidence": "high",
      "role": "dest"
    },
    {
      "kind": "function",
      "name": "TEE_GetPropertyAsUUID",
      "param_index": 2,
      "rule_id": "weak_input_validation",
      "reason": "writes UUID struct (16 bytes) into caller-supplied pointer",
      "confidence": "high",
      "role": "dest"
    },
    {
      "kind": "function",
      "name": "TEE_MemFill",
      "param_index": 0,
      "rule_id": "weak_input_validation",
      "reason": "destination buffer written with pattern",
      "confidence": "high",
      "role": "dest"
    },
    {
      "kind": "function",
      "name": "TEE_MemFill",
      "param_index": 2,
      "rule_id": "weak_input_validation",
      "reason": "number of bytes to write (write extent)",
      "confidence": "high",
      "role": "len"
    },
    {
      "kind": "function",
      "name": "TEE_MemMove",
      "param_index": 0,
      "rule_id": "weak_input_validation",
      "reason": "destination buffer receiving copied bytes",
      "confidence": "high",
      "role": "dest"
    },
    {
      "kind": "function",
      "name": "TEE_MemMove",
      "param_index": 2,
      "rule_id": "weak_input_validation",
      "reason": "number of bytes copied (controls write extent)",
      "confidence": "high",
      "role": "len"
    },
    {
      "kind": "function",
      "name": "TEE_ReadObjectData",
      "param_index": 1,
      "rule_id": "weak_input_validation",
      "reason": "writes object bytes into caller buffer",
      "confidence": "high",
      "role": "buf"
    },
    {
      "kind": "function",
      "name": "TEE_ReadObjectData",
      "param_index": 2,
      "rule_id": "weak_input_validation",
      "reason": "controls number of bytes written",
      "confidence": "high",
      "role": "len"
    },
    {
      "kind": "function",
      "name": "TEE_TruncateObjectData",
      "param_index": 1,
      "rule_id": "weak_input_validation",
      "reason": "Size parameter controls persisted object truncation length",
      "confidence": "high",
      "role": "len"
    },
    {
      "kind": "function",
      "name": "TEE_WriteObjectData",
      "param_index": 1,
      "rule_id": "weak_input_validation",
      "reason": "source buffer written to persistent object",
      "confidence": "high",
      "role": "buf"
    },
    {
      "kind": "function",
      "name": "TEE_WriteObjectData",
      "param_index": 2,
      "rule_id": "weak_input_validation",
      "reason": "length controls number of bytes written",
      "confidence": "high",
      "role": "len"
    },
    {
      "kind": "function",
      "name": "mbedtls_asn1_write_octet_string",
      "param_index": 0,
      "rule_id": "weak_input_validation",
      "reason": "writes ASN.1 octet bytes into provided output buffer",
      "confidence": "high",
      "role": "dest"
    },
    {
      "kind": "function",
      "name": "mbedtls_ecp_point_write_binary",
      "param_index": 4,
      "rule_id": "weak_input_validation",
      "reason": "writes point bytes into provided buffer",
      "confidence": "high",
      "role": "dest"
    },
    {
      "kind": "function",
      "name": "mbedtls_ecp_point_write_binary",
      "param_index": 5,
      "rule_id": "weak_input_validation",
      "reason": "buffer length bounds for the write",
      "confidence": "high",
      "role": "len"
    },
    {
      "kind": "function",
      "name": "mbedtls_mpi_write_binary",
      "param_index": 1,
      "rule_id": "weak_input_validation",
      "reason": "writes MPI bytes into provided buffer",
      "confidence": "high",
      "role": "dest"
    },
    {
      "kind": "function",
      "name": "mbedtls_mpi_write_binary",
      "param_index": 2,
      "rule_id": "weak_input_validation",
      "reason": "buffer length bounds the write",
      "confidence": "high",
      "role": "len"
    },
    {
      "kind": "function",
      "name": "mbedtls_pk_write_key_der",
      "param_index": 1,
      "rule_id": "weak_input_validation",
      "reason": "writes DER bytes into provided buffer",
      "confidence": "high",
      "role": "dest"
    },
    {
      "kind": "function",
      "name": "mbedtls_pk_write_key_der",
      "param_index": 2,
      "rule_id": "weak_input_validation",
      "reason": "buffer length limits written bytes",
      "confidence": "high",
      "role": "len"
    },
    {
      "kind": "function",
      "name": "memset",
      "param_index": 0,
      "rule_id": "weak_input_validation",
      "reason": "writes pattern into destination buffer",
      "confidence": "high",
      "role": "dest"
    },
    {
      "kind": "function",
      "name": "memset",
      "param_index": 2,
      "rule_id": "weak_input_validation",
      "reason": "controls number of bytes written",
      "confidence": "high",
      "role": "len"
    },
    {
      "kind": "function",
      "name": "snprintf",
      "param_index": 0,
      "rule_id": "weak_input_validation",
      "reason": "writes formatted output into provided destination buffer",
      "confidence": "high",
      "role": "dest"
    },
    {
      "kind": "function",
      "name": "snprintf",
      "param_index": 1,
      "rule_id": "weak_input_validation",
      "reason": "limits characters written; attacker-influenced format can control length usage",
      "confidence": "high",
      "role": "len"
    },
    {
      "kind": "function",
      "name": "snprintk",
      "param_index": 0,
      "rule_id": "weak_input_validation",
      "reason": "format output buffer (printf-like)",
      "confidence": "high",
      "role": "dest"
    },
    {
      "kind": "function",
      "name": "snprintk",
      "param_index": 1,
      "rule_id": "weak_input_validation",
      "reason": "buffer size limit for formatted write",
      "confidence": "high",
      "role": "len"
    }
  ],
  "analysis_time": {
    "total_seconds": 395.02250385284424,
    "total_formatted": "6.58分",
    "llm_analysis_seconds": 394.8125891685486,
    "llm_analysis_formatted": "6.58分",
    "functions_analyzed": 102,
    "per_function": {
      "TEE_GetObjectBufferAttribute": {
        "seconds": 12.001483678817749,
        "formatted": "12.00秒"
      },
      "LIST_REMOVE": {
        "seconds": 11.734586238861084,
        "formatted": "11.73秒"
      },
      "TEE_TruncateObjectData": {
        "seconds": 10.043441534042358,
        "formatted": "10.04秒"
      },
      "TEE_GetObjectInfo1": {
        "seconds": 7.042510747909546,
        "formatted": "7.04秒"
      },
      "mbedtls_pk_write_key_der": {
        "seconds": 6.817289113998413,
        "formatted": "6.82秒"
      },
      "TEE_MemFill": {
        "seconds": 6.724693298339844,
        "formatted": "6.72秒"
      },
      "mbedtls_asn1_write_octet_string": {
        "seconds": 6.678408622741699,
        "formatted": "6.68秒"
      },
      "TEE_ReadObjectData": {
        "seconds": 6.464895486831665,
        "formatted": "6.46秒"
      },
      "TEE_CloseAndDeletePersistentObject1": {
        "seconds": 5.824992418289185,
        "formatted": "5.82秒"
      },
      "TEE_SetOperationKey": {
        "seconds": 5.785962343215942,
        "formatted": "5.79秒"
      },
      "mbedtls_mpi_bitlen": {
        "seconds": 5.542407989501953,
        "formatted": "5.54秒"
      },
      "mbedtls_ecp_point_write_binary": {
        "seconds": 5.5150535106658936,
        "formatted": "5.52秒"
      },
      "TEE_WriteObjectData": {
        "seconds": 5.476997375488281,
        "formatted": "5.48秒"
      },
      "DMSG": {
        "seconds": 5.405880689620972,
        "formatted": "5.41秒"
      },
      "mbedtls_mpi_write_binary": {
        "seconds": 5.348754167556763,
        "formatted": "5.35秒"
      },
      "TEE_GetPropertyAsUUID": {
        "seconds": 5.331357479095459,
        "formatted": "5.33秒"
      },
      "memset": {
        "seconds": 5.308144569396973,
        "formatted": "5.31秒"
      },
      "TEE_GenerateRandom": {
        "seconds": 5.28122878074646,
        "formatted": "5.28秒"
      },
      "ADD_OVERFLOW": {
        "seconds": 5.263703346252441,
        "formatted": "5.26秒"
      },
      "TEE_AsymmetricVerifyDigest": {
        "seconds": 5.088366508483887,
        "formatted": "5.09秒"
      },
      "TEE_CloseTASession": {
        "seconds": 5.059682846069336,
        "formatted": "5.06秒"
      },
      "IMSG": {
        "seconds": 5.027110815048218,
        "formatted": "5.03秒"
      },
      "TEE_CreatePersistentObject": {
        "seconds": 4.8730244636535645,
        "formatted": "4.87秒"
      },
      "snprintk": {
        "seconds": 4.77419114112854,
        "formatted": "4.77秒"
      },
      "TEE_RestrictObjectUsage1": {
        "seconds": 4.471848964691162,
        "formatted": "4.47秒"
      },
      "TEE_PARAM_TYPES": {
        "seconds": 4.431676864624023,
        "formatted": "4.43秒"
      },
      "TEE_InvokeTACommand": {
        "seconds": 4.390084266662598,
        "formatted": "4.39秒"
      },
      "TEE_MemMove": {
        "seconds": 4.378554582595825,
        "formatted": "4.38秒"
      },
      "mbedtls_ecp_keypair_init": {
        "seconds": 4.240845441818237,
        "formatted": "4.24秒"
      },
      "TEE_DeriveKey": {
        "seconds": 4.240647554397583,
        "formatted": "4.24秒"
      },
      "mbedtls_ecp_group_init": {
        "seconds": 4.216858863830566,
        "formatted": "4.22秒"
      },
      "TEE_MACCompareFinal": {
        "seconds": 4.114545106887817,
        "formatted": "4.11秒"
      },
      "TEE_OpenTASession": {
        "seconds": 4.062755584716797,
        "formatted": "4.06秒"
      },
      "mbedtls_pk_parse_key": {
        "seconds": 4.051084756851196,
        "formatted": "4.05秒"
      },
      "TEE_GetOperationInfo": {
        "seconds": 3.9281115531921387,
        "formatted": "3.93秒"
      },
      "TAILQ_INSERT_HEAD": {
        "seconds": 3.86865496635437,
        "formatted": "3.87秒"
      },
      "TEE_DigestDoFinal": {
        "seconds": 3.7830147743225098,
        "formatted": "3.78秒"
      },
      "TEE_AsymmetricDecrypt": {
        "seconds": 3.7211110591888428,
        "formatted": "3.72秒"
      },
      "TEE_GenerateKey": {
        "seconds": 3.697209119796753,
        "formatted": "3.70秒"
      },
      "TEE_Malloc": {
        "seconds": 3.6758456230163574,
        "formatted": "3.68秒"
      },
      "MSG_RAW": {
        "seconds": 3.665780544281006,
        "formatted": "3.67秒"
      },
      "LIST_INSERT_HEAD": {
        "seconds": 3.600496530532837,
        "formatted": "3.60秒"
      },
      "LIST_FIRST": {
        "seconds": 3.4625155925750732,
        "formatted": "3.46秒"
      },
      "TEE_MemCompare": {
        "seconds": 3.3710741996765137,
        "formatted": "3.37秒"
      },
      "mbedtls_pk_free": {
        "seconds": 3.369260311126709,
        "formatted": "3.37秒"
      },
      "bit_set": {
        "seconds": 3.34836483001709,
        "formatted": "3.35秒"
      },
      "assert": {
        "seconds": 3.317366361618042,
        "formatted": "3.32秒"
      },
      "TEE_InitValueAttribute": {
        "seconds": 3.3024110794067383,
        "formatted": "3.30秒"
      },
      "mbedtls_rsa_check_privkey": {
        "seconds": 3.2647478580474854,
        "formatted": "3.26秒"
      },
      "TEE_MACComputeFinal": {
        "seconds": 3.256807804107666,
        "formatted": "3.26秒"
      },
      "TEE_CloseObject": {
        "seconds": 3.2529501914978027,
        "formatted": "3.25秒"
      },
      "TEE_InitRefAttribute": {
        "seconds": 3.252622365951538,
        "formatted": "3.25秒"
      },
      "snprintf": {
        "seconds": 3.226738214492798,
        "formatted": "3.23秒"
      },
      "TEE_PARAM_TYPE_GET": {
        "seconds": 3.178314685821533,
        "formatted": "3.18秒"
      },
      "mbedtls_ecp_point_init": {
        "seconds": 3.171680212020874,
        "formatted": "3.17秒"
      },
      "TEE_SeekObjectData": {
        "seconds": 3.168875217437744,
        "formatted": "3.17秒"
      },
      "mbedtls_mpi_free": {
        "seconds": 3.131025791168213,
        "formatted": "3.13秒"
      },
      "TEE_MACUpdate": {
        "seconds": 3.1262667179107666,
        "formatted": "3.13秒"
      },
      "TEE_Panic": {
        "seconds": 3.121664047241211,
        "formatted": "3.12秒"
      },
      "DMSG_BAD_BBOOL": {
        "seconds": 3.11582088470459,
        "formatted": "3.12秒"
      },
      "EMSG": {
        "seconds": 3.1152408123016357,
        "formatted": "3.12秒"
      },
      "TEE_AllocateTransientObject": {
        "seconds": 3.0960261821746826,
        "formatted": "3.10秒"
      },
      "bit_decl": {
        "seconds": 3.0883283615112305,
        "formatted": "3.09秒"
      },
      "TEE_FreeOperation": {
        "seconds": 3.0873117446899414,
        "formatted": "3.09秒"
      },
      "LIST_EMPTY": {
        "seconds": 3.0774600505828857,
        "formatted": "3.08秒"
      },
      "DMSG_RAW": {
        "seconds": 3.0691096782684326,
        "formatted": "3.07秒"
      },
      "TAILQ_INIT": {
        "seconds": 3.0450172424316406,
        "formatted": "3.05秒"
      },
      "LIST_FOREACH": {
        "seconds": 2.975372791290283,
        "formatted": "2.98秒"
      },
      "TEE_CipherDoFinal": {
        "seconds": 2.957312822341919,
        "formatted": "2.96秒"
      },
      "TEE_AsymmetricSignDigest": {
        "seconds": 2.9564247131347656,
        "formatted": "2.96秒"
      },
      "strlen": {
        "seconds": 2.9367947578430176,
        "formatted": "2.94秒"
      },
      "ARRAY_SIZE": {
        "seconds": 2.9316601753234863,
        "formatted": "2.93秒"
      },
      "mbedtls_ecp_check_pubkey": {
        "seconds": 2.904829263687134,
        "formatted": "2.90秒"
      },
      "mbedtls_ecp_point_free": {
        "seconds": 2.901301145553589,
        "formatted": "2.90秒"
      },
      "MIN": {
        "seconds": 2.8721814155578613,
        "formatted": "2.87秒"
      },
      "TEE_CipherInit": {
        "seconds": 2.8563289642333984,
        "formatted": "2.86秒"
      },
      "TEE_CipherUpdate": {
        "seconds": 2.838332414627075,
        "formatted": "2.84秒"
      },
      "bit_test": {
        "seconds": 2.838311195373535,
        "formatted": "2.84秒"
      },
      "TEE_FreeTransientObject": {
        "seconds": 2.7651803493499756,
        "formatted": "2.77秒"
      },
      "TEE_OpenPersistentObject": {
        "seconds": 2.6990857124328613,
        "formatted": "2.70秒"
      },
      "mbedtls_pk_init": {
        "seconds": 2.6869723796844482,
        "formatted": "2.69秒"
      },
      "TEE_DigestUpdate": {
        "seconds": 2.6726174354553223,
        "formatted": "2.67秒"
      },
      "mbedtls_pk_info_from_type": {
        "seconds": 2.6660852432250977,
        "formatted": "2.67秒"
      },
      "mbedtls_ecp_mul": {
        "seconds": 2.646174669265747,
        "formatted": "2.65秒"
      },
      "TEE_Realloc": {
        "seconds": 2.594573736190796,
        "formatted": "2.59秒"
      },
      "TAILQ_REMOVE": {
        "seconds": 2.589465618133545,
        "formatted": "2.59秒"
      },
      "mbedtls_pk_setup": {
        "seconds": 2.5305325984954834,
        "formatted": "2.53秒"
      },
      "buf_compare_ct": {
        "seconds": 2.502871513366699,
        "formatted": "2.50秒"
      },
      "TEE_PopulateTransientObject": {
        "seconds": 2.4442601203918457,
        "formatted": "2.44秒"
      },
      "mbedtls_ecp_keypair_free": {
        "seconds": 2.4352900981903076,
        "formatted": "2.44秒"
      },
      "TEE_AsymmetricEncrypt": {
        "seconds": 2.4266889095306396,
        "formatted": "2.43秒"
      },
      "ROUNDUP": {
        "seconds": 2.4120237827301025,
        "formatted": "2.41秒"
      },
      "strnlen": {
        "seconds": 2.3501944541931152,
        "formatted": "2.35秒"
      },
      "mbedtls_ecp_check_privkey": {
        "seconds": 2.3472938537597656,
        "formatted": "2.35秒"
      },
      "TAILQ_FOREACH": {
        "seconds": 2.319718837738037,
        "formatted": "2.32秒"
      },
      "mbedtls_mpi_init": {
        "seconds": 2.280463457107544,
        "formatted": "2.28秒"
      },
      "TEE_Free": {
        "seconds": 2.2397608757019043,
        "formatted": "2.24秒"
      },
      "TAILQ_FOREACH_SAFE": {
        "seconds": 2.1913399696350098,
        "formatted": "2.19秒"
      },
      "COMPILE_TIME_ASSERT": {
        "seconds": 2.1059279441833496,
        "formatted": "2.11秒"
      },
      "LIST_INIT": {
        "seconds": 2.008928060531616,
        "formatted": "2.01秒"
      },
      "mbedtls_ecp_group_free": {
        "seconds": 1.9952921867370605,
        "formatted": "2.00秒"
      },
      "TEE_AllocateOperation": {
        "seconds": 1.9627039432525635,
        "formatted": "1.96秒"
      }
    }
  },
  "analysis_mode": "llm_only"
}