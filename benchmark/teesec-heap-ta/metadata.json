{
  "id": "teesec-heap-ta",
  "display_name": "teesec-research: Heap TA - Double-Free & Unencrypted Secret Output",
  "description": "OP-TEE Trusted Application demonstrating (1) double-free via an intentionally broken aquirePasswordFromUsername() that returns a pointer offset +4 with a separate releasePassword() that subtracts 4 before freeingâ€”this pattern breaks in reuse scenarios; (2) sessId from REE used to index sessions[] before bounds-checking (CWE-125 out-of-bounds read); (3) SECRET directly memcpy'd to REE-controlled unencrypted output buffer without any encryption (CWE-200 unencrypted output). From the paper: Memory corruption attacks within Android TEEs (2020).",
  "cve_ids": [],
  "advisory_ids": [],
  "cwe_ids": [
    "CWE-20",
    "CWE-125",
    "CWE-200",
    "CWE-415"
  ],
  "vulnerability_category": "unencrypted_output",
  "repo_url": "https://github.com/teesec-research/optee_examples",
  "repo_branch": "vuln",
  "repo_commit": "32b357dbc65424c81d331ca4d80daefa088e67b3",
  "fix_commit": null,
  "collected_at": "2026-02-18T08:05:48.929295+00:00",
  "source_files": [
    "heap_ta.c"
  ],
  "tee_flow_inspector_cmd": "python3 ./src/main.py -p benchmark/teesec-heap-ta",
  "ground_truth_note": "ground_truth.csv contains known vulnerable lines. Empty rows indicate manual annotation is required."
}