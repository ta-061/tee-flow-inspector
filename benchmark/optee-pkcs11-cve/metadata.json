{
  "id": "optee-pkcs11-cve",
  "display_name": "OP-TEE PKCS#11 TA - PIN Counter Reset (GHSA-2f5m-q4w3-865p)",
  "description": "The PKCS#11 Trusted Application in OP-TEE OS before v4.1.0 pre-increments the PIN retry counter after a failed authentication but does not properly reset it on session close, allowing an attacker to reset the PIN counter via repeated session open/close. This is a weak input validation issue where session-state from REE is not properly sanitized.",
  "cve_ids": [],
  "advisory_ids": [
    "GHSA-2f5m-q4w3-865p"
  ],
  "cwe_ids": [
    "CWE-20",
    "CWE-284"
  ],
  "vulnerability_category": "weak_input_validation",
  "repo_url": "https://github.com/OP-TEE/optee_os",
  "repo_branch": null,
  "repo_commit": "2ae2cfb2599b52df383128f122ca184412a12090",
  "fix_commit": "d75c42ff2847b090d5b1f11c49067cd41fcc2734",
  "collected_at": "2026-02-18T08:16:29.359177+00:00",
  "source_files": [
    "attributes.c",
    "entry.c",
    "handle.c",
    "object.c",
    "persistent_token.c",
    "pkcs11_attributes.c",
    "pkcs11_helpers.c",
    "pkcs11_token.c",
    "processing.c",
    "processing_aes.c",
    "processing_asymm.c",
    "processing_digest.c",
    "processing_ec.c",
    "processing_rsa.c",
    "processing_symm.c",
    "sanitize_object.c",
    "serializer.c",
    "token_capabilities.c"
  ],
  "tee_flow_inspector_cmd": "python3 ./src/main.py -p benchmark/optee-pkcs11-cve",
  "ground_truth_note": "ground_truth.csv contains known vulnerable lines. Empty rows indicate manual annotation is required."
}