make -C host CROSS_COMPILE="arm-linux-gnueabihf-" --no-builtin-variables \
	TEEC_EXPORT=/workspace/benchmark/bad-partitioning/../../optee_client/out/export
make[1]: Entering directory '/workspace/benchmark/bad-partitioning/host'
arm-linux-gnueabihf-gcc -Wall -I../ta/include -I/workspace/benchmark/bad-partitioning/../../optee_client/out/export/include -I./include -c main.c -o main.o
main.c: In function ‘thread_function’:
main.c:98:18: warning: format ‘%s’ expects argument of type ‘char *’, but argument 2 has type ‘void *’ [-Wformat=]
   98 |         printf("%s\n", shared_mem->buffer);
      |                 ~^     ~~~~~~~~~~~~~~~~~~
      |                  |               |
      |                  char *          void *
      |                 %p
main.c: In function ‘main’:
main.c:238:26: warning: format ‘%s’ expects argument of type ‘char *’, but argument 2 has type ‘void *’ [-Wformat=]
  238 |                 printf("%s\n", shared_mem.shadow_buffer);
      |                         ~^     ~~~~~~~~~~~~~~~~~~~~~~~~
      |                          |               |
      |                          char *          void *
      |                         %p
arm-linux-gnueabihf-gcc -o optee_example_hello_world main.o -lteec -L/workspace/benchmark/bad-partitioning/../../optee_client/out/export/lib -lpthread
make[1]: Leaving directory '/workspace/benchmark/bad-partitioning/host'
make -C ta CROSS_COMPILE="arm-linux-gnueabihf-" LDFLAGS="" \
	TA_DEV_KIT_DIR=/workspace/benchmark/bad-partitioning/../../optee_os/out/arm/export-ta_arm32
make[1]: Entering directory '/workspace/benchmark/bad-partitioning/ta'
  CC      entry.o
entry.c:99:6: warning: no previous prototype for ‘enc’ [-Wmissing-prototypes]
   99 | void enc(char *str)
      |      ^~~
entry.c: In function ‘enc’:
entry.c:99:16: warning: unused parameter ‘str’ [-Wunused-parameter]
   99 | void enc(char *str)
      |          ~~~~~~^~~
entry.c: At top level:
entry.c:104:6: warning: no previous prototype for ‘dec’ [-Wmissing-prototypes]
  104 | void dec(char *str)
      |      ^~~
entry.c: In function ‘dec’:
entry.c:104:16: warning: unused parameter ‘str’ [-Wunused-parameter]
  104 | void dec(char *str)
      |          ~~~~~~^~~
entry.c: At top level:
entry.c:109:6: warning: no previous prototype for ‘produce_2’ [-Wmissing-prototypes]
  109 | void produce_2(TEE_Param params[4])
      |      ^~~~~~~~~
entry.c:129:6: warning: no previous prototype for ‘produce’ [-Wmissing-prototypes]
  129 | void produce(TEE_Param params[4])
      |      ^~~~~~~
entry.c:151:6: warning: no previous prototype for ‘produce_3’ [-Wmissing-prototypes]
  151 | void produce_3(char *buf, int size)
      |      ^~~~~~~~~
entry.c:196:6: warning: no previous prototype for ‘produce_i2’ [-Wmissing-prototypes]
  196 | void produce_i2(int a, int b, char *buf2, int size2, char *buf3, int size3, TEE_Param params[4])
      |      ^~~~~~~~~~
entry.c: In function ‘produce_i2’:
entry.c:210:14: warning: unused variable ‘c’ [-Wunused-variable]
  210 |         char c = str[params[0].value.a - 3]; //c7
      |              ^
entry.c:202:14: warning: unused variable ‘arr_ref’ [-Wunused-variable]
  202 |         int *arr_ref = TEE_Malloc(b, 0); //p2-2
      |              ^~~~~~~
entry.c:201:14: warning: unused variable ‘arr_a’ [-Wunused-variable]
  201 |         int *arr_a = TEE_Malloc(a, 0); //p2-1
      |              ^~~~~
entry.c:199:13: warning: variable ‘tmp_arr’ set but not used [-Wunused-but-set-variable]
  199 |         int tmp_arr[20];
      |             ^~~~~~~
entry.c:196:60: warning: unused parameter ‘buf3’ [-Wunused-parameter]
  196 | void produce_i2(int a, int b, char *buf2, int size2, char *buf3, int size3, TEE_Param params[4])
      |                                                      ~~~~~~^~~~
entry.c:196:70: warning: unused parameter ‘size3’ [-Wunused-parameter]
  196 | void produce_i2(int a, int b, char *buf2, int size2, char *buf3, int size3, TEE_Param params[4])
      |                                                                  ~~~~^~~~~
entry.c: At top level:
entry.c:215:6: warning: no previous prototype for ‘produce_i0’ [-Wmissing-prototypes]
  215 | void produce_i0(int a, int b, char *buf2, int size2, char *buf3, int size3, TEE_Param params[4])
      |      ^~~~~~~~~~
In file included from /workspace/optee_os/out/arm/export-ta_arm32/include/tee_api.h:12,
                 from /workspace/optee_os/out/arm/export-ta_arm32/include/tee_internal_api.h:10,
                 from entry.c:28:
entry.c: In function ‘produce_i0’:
/workspace/optee_os/out/arm/export-ta_arm32/include/tee_api_defines.h:29:43: warning: ‘return’ with a value, in function returning void [-Wreturn-type]
   29 | #define TEE_ERROR_BAD_PARAMETERS          0xFFFF0006
      |                                           ^~~~~~~~~~
entry.c:235:24: note: in expansion of macro ‘TEE_ERROR_BAD_PARAMETERS’
  235 |                 return TEE_ERROR_BAD_PARAMETERS;
      |                        ^~~~~~~~~~~~~~~~~~~~~~~~
entry.c:215:6: note: declared here
  215 | void produce_i0(int a, int b, char *buf2, int size2, char *buf3, int size3, TEE_Param params[4])
      |      ^~~~~~~~~~
In file included from /workspace/optee_os/out/arm/export-ta_arm32/include/tee_api.h:12,
                 from /workspace/optee_os/out/arm/export-ta_arm32/include/tee_internal_api.h:10,
                 from entry.c:28:
/workspace/optee_os/out/arm/export-ta_arm32/include/tee_api_defines.h:29:43: warning: ‘return’ with a value, in function returning void [-Wreturn-type]
   29 | #define TEE_ERROR_BAD_PARAMETERS          0xFFFF0006
      |                                           ^~~~~~~~~~
entry.c:243:24: note: in expansion of macro ‘TEE_ERROR_BAD_PARAMETERS’
  243 |                 return TEE_ERROR_BAD_PARAMETERS;
      |                        ^~~~~~~~~~~~~~~~~~~~~~~~
entry.c:215:6: note: declared here
  215 | void produce_i0(int a, int b, char *buf2, int size2, char *buf3, int size3, TEE_Param params[4])
      |      ^~~~~~~~~~
entry.c:231:14: warning: unused variable ‘c’ [-Wunused-variable]
  231 |         char c = str[a - 3]; //c1
      |              ^
entry.c:221:14: warning: unused variable ‘arr_ref’ [-Wunused-variable]
  221 |         int *arr_ref = TEE_Malloc(b, 0); //p1-2
      |              ^~~~~~~
entry.c:220:14: warning: unused variable ‘arr_a’ [-Wunused-variable]
  220 |         int *arr_a = TEE_Malloc(a, 0); //p1-1
      |              ^~~~~
entry.c:218:13: warning: variable ‘tmp_arr’ set but not used [-Wunused-but-set-variable]
  218 |         int tmp_arr[20];
      |             ^~~~~~~
entry.c: At top level:
entry.c:249:6: warning: no previous prototype for ‘produce_i3’ [-Wmissing-prototypes]
  249 | void produce_i3(int i)
      |      ^~~~~~~~~~
In file included from /workspace/optee_os/out/arm/export-ta_arm32/include/tee_api.h:12,
                 from /workspace/optee_os/out/arm/export-ta_arm32/include/tee_internal_api.h:10,
                 from entry.c:28:
entry.c: In function ‘produce_i3’:
/workspace/optee_os/out/arm/export-ta_arm32/include/tee_api_defines.h:29:43: warning: ‘return’ with a value, in function returning void [-Wreturn-type]
   29 | #define TEE_ERROR_BAD_PARAMETERS          0xFFFF0006
      |                                           ^~~~~~~~~~
entry.c:262:24: note: in expansion of macro ‘TEE_ERROR_BAD_PARAMETERS’
  262 |                 return TEE_ERROR_BAD_PARAMETERS;
      |                        ^~~~~~~~~~~~~~~~~~~~~~~~
entry.c:249:6: note: declared here
  249 | void produce_i3(int i)
      |      ^~~~~~~~~~
entry.c:258:14: warning: variable ‘c’ set but not used [-Wunused-but-set-variable]
  258 |         char c = str[i - 3]; //c5
      |              ^
entry.c:254:14: warning: unused variable ‘arr_a’ [-Wunused-variable]
  254 |         int *arr_a = TEE_Malloc(i, 0); //p1-6
      |              ^~~~~
entry.c:252:13: warning: variable ‘tmp_arr’ set but not used [-Wunused-but-set-variable]
  252 |         int tmp_arr[20];
      |             ^~~~~~~
entry.c: In function ‘input’:
entry.c:286:27: warning: comparison of integer expressions of different signedness: ‘int’ and ‘uint32_t’ {aka ‘unsigned int’} [-Wsign-compare]
  286 |         for (int i = 0; i < params[2].memref.size; i++) { //b4
      |                           ^
entry.c:303:14: warning: unused variable ‘arr_path’ [-Wunused-variable]
  303 |         int *arr_path = TEE_Malloc(params[1].memref.size, 0); //pa1 -1
      |              ^~~~~~~~
entry.c:293:14: warning: variable ‘c’ set but not used [-Wunused-but-set-variable]
  293 |         char c = ((char *)params[3].memref.buffer)[params[3].memref.size - 3]; //b7 -1
      |              ^
entry.c:284:14: warning: unused variable ‘arr_ref’ [-Wunused-variable]
  284 |         int *arr_ref = TEE_Malloc(params[1].memref.size, 0); //b2
      |              ^~~~~~~
entry.c:283:14: warning: unused variable ‘arr_a’ [-Wunused-variable]
  283 |         int *arr_a = TEE_Malloc(params[0].value.a, 0); //b1
      |              ^~~~~
entry.c:281:13: warning: variable ‘tmp_arr’ set but not used [-Wunused-but-set-variable]
  281 |         int tmp_arr[20];
      |             ^~~~~~~
entry.c: At top level:
entry.c:317:6: warning: no previous prototype for ‘produce_s2’ [-Wmissing-prototypes]
  317 | void produce_s2(char *buf, int size)
      |      ^~~~~~~~~~
entry.c:332:6: warning: no previous prototype for ‘produce_s’ [-Wmissing-prototypes]
  332 | void produce_s(char *buf, int size)
      |      ^~~~~~~~~
In file included from /workspace/optee_os/out/arm/export-ta_arm32/include/tee_api.h:12,
                 from /workspace/optee_os/out/arm/export-ta_arm32/include/tee_internal_api.h:10,
                 from entry.c:28:
entry.c: In function ‘produce_s’:
/workspace/optee_os/out/arm/export-ta_arm32/include/tee_api_defines.h:29:43: warning: ‘return’ with a value, in function returning void [-Wreturn-type]
   29 | #define TEE_ERROR_BAD_PARAMETERS          0xFFFF0006
      |                                           ^~~~~~~~~~
entry.c:347:24: note: in expansion of macro ‘TEE_ERROR_BAD_PARAMETERS’
  347 |                 return TEE_ERROR_BAD_PARAMETERS;
      |                        ^~~~~~~~~~~~~~~~~~~~~~~~
entry.c:332:6: note: declared here
  332 | void produce_s(char *buf, int size)
      |      ^~~~~~~~~
entry.c: At top level:
entry.c:355:6: warning: no previous prototype for ‘produce_s3’ [-Wmissing-prototypes]
  355 | void produce_s3(TEE_Param params[4])
      |      ^~~~~~~~~~
In file included from /workspace/optee_os/out/arm/export-ta_arm32/include/tee_api.h:12,
                 from /workspace/optee_os/out/arm/export-ta_arm32/include/tee_internal_api.h:10,
                 from entry.c:28:
entry.c: In function ‘produce_s3’:
/workspace/optee_os/out/arm/export-ta_arm32/include/tee_api_defines.h:29:43: warning: ‘return’ with a value, in function returning void [-Wreturn-type]
   29 | #define TEE_ERROR_BAD_PARAMETERS          0xFFFF0006
      |                                           ^~~~~~~~~~
entry.c:398:24: note: in expansion of macro ‘TEE_ERROR_BAD_PARAMETERS’
  398 |                 return TEE_ERROR_BAD_PARAMETERS;
      |                        ^~~~~~~~~~~~~~~~~~~~~~~~
entry.c:355:6: note: declared here
  355 | void produce_s3(TEE_Param params[4])
      |      ^~~~~~~~~~
In file included from /workspace/optee_os/out/arm/export-ta_arm32/include/tee_api.h:12,
                 from /workspace/optee_os/out/arm/export-ta_arm32/include/tee_internal_api.h:10,
                 from entry.c:28:
/workspace/optee_os/out/arm/export-ta_arm32/include/tee_api_defines.h:18:43: warning: ‘return’ with a value, in function returning void [-Wreturn-type]
   18 | #define TEE_SUCCESS                       0x00000000
      |                                           ^~~~~~~~~~
entry.c:408:16: note: in expansion of macro ‘TEE_SUCCESS’
  408 |         return TEE_SUCCESS;
      |                ^~~~~~~~~~~
entry.c:355:6: note: declared here
  355 | void produce_s3(TEE_Param params[4])
      |      ^~~~~~~~~~
  CC      user_ta_header.o
  CPP     ta.lds
  LD      8aaaf200-2450-11e4-abe2-0002a5d5c51b.elf
  OBJDUMP 8aaaf200-2450-11e4-abe2-0002a5d5c51b.dmp
  OBJCOPY 8aaaf200-2450-11e4-abe2-0002a5d5c51b.stripped.elf
  SIGN    8aaaf200-2450-11e4-abe2-0002a5d5c51b.ta
make[1]: Leaving directory '/workspace/benchmark/bad-partitioning/ta'
============================================================
TA Static Analysis Driver
============================================================
Analysis Configuration: Hybrid (DITING rules only) (excluding debug macros)
Token Tracking: Enabled
Debug Macros: Excluded
============================================================

=== Project: bad-partitioning / TA: ta ===
[INFO] Analysis mode: Hybrid (DITING rules only) (excluding debug macros)
[INFO] Token tracking is enabled
[INFO] Debug macros will be excluded from analysis
[INFO] Cleaning dependencies for bad-partitioning
  - Removed stale dependency: ta/.entry.o.d
  - Removed stale dependency: ta/.user_ta_header.o.d
  - Executed 'make clean' in .
  - Executed 'make clean' in ta
  - Executed 'make clean' in host
  ✓ Cleaned 5 files
[INFO] $ bear -- make  (cwd=/workspace/benchmark/bad-partitioning)
[INFO] TA DB saved: /workspace/benchmark/bad-partitioning/ta/compile_commands.json  entries=1
[DEBUG] Include paths:
  ✓ /workspace/benchmark/bad-partitioning/ta
  ✓ /workspace/benchmark/bad-partitioning/ta/include
  ✗ ./include
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/bad-partitioning/ta/entry.c
  Args: -I/workspace/benchmark/bad-partitioning/ta -I/workspace/benchmark/bad-partitioning/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=entry_c --target=armv7a-none-eabi
  [3] void function 'produce_i0' should not return a value
  [3] void function 'produce_i0' should not return a value
  [3] void function 'produce_i3' should not return a value
  [3] void function 'produce_s' should not return a value
  [3] void function 'produce_s3' should not return a value
  [3] void function 'produce_s3' should not return a value
[phase1-2] → /workspace/benchmark/bad-partitioning/ta/results/ta_phase12.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/identify_sinks.py -i /workspace/benchmark/bad-partitioning/ta/results/ta_phase12.json -o /workspace/benchmark/bad-partitioning/ta/results/ta_sinks.json --llm-only --no-rag  (cwd=/workspace/benchmark/bad-partitioning/ta)
[STDOUT] [WARN] TokenTrackingClient not available. Token tracking disabled.
[INFO] LLM retry handler initialized (max retries: 3)
[INFO] LLM logs will be saved to: /workspace/benchmark/bad-partitioning/ta/results/llm_logs
使用中のLLMプロバイダー: openai
呼び出し済み外部 API を抽出中...
外部 API 関数: 10 個
外部 API 関数をシンクとして解析中（LLMのみ）...
  Analyzing DMSG with LLM...
[DEBUG] LLM call attempt 1/3
  → Not a sink: DMSG (is_sink_candidate=False)
  Analyzing IMSG with LLM...
[DEBUG] LLM call attempt 1/3
  → Not a sink: IMSG (is_sink_candidate=False)
  Analyzing TEE_Malloc with LLM...
[DEBUG] LLM call attempt 1/3
  → Not a sink: TEE_Malloc (is_sink_candidate=False)
  Analyzing TEE_MemCompare with LLM...
[DEBUG] LLM call attempt 1/3
  → Not a sink: TEE_MemCompare (is_sink_candidate=False)
  Analyzing TEE_MemMove with LLM...
[DEBUG] LLM call attempt 1/3
  → Sink identified: TEE_MemMove with 1 dangerous params: [0]
  Analyzing TEE_PARAM_TYPES with LLM...
[DEBUG] LLM call attempt 1/3
  → Not a sink: TEE_PARAM_TYPES (is_sink_candidate=False)
  Analyzing TEE_Wait with LLM...
[DEBUG] LLM call attempt 1/3
  → Not a sink: TEE_Wait (is_sink_candidate=False)
  Analyzing snprintf with LLM...
[DEBUG] LLM call attempt 1/3
  → Sink identified: snprintf with 2 dangerous params: [0, 1]
  Analyzing strcmp with LLM...
[DEBUG] LLM call attempt 1/3
  → Not a sink: strcmp (is_sink_candidate=False)
  Analyzing strlen with LLM...
[DEBUG] LLM call attempt 1/3
  → Not a sink: strlen (is_sink_candidate=False)

抽出されたシンク候補: 3 個
全関数の解析時間: 27.75秒
  - LLM解析時間: 27.58秒
結果を /workspace/benchmark/bad-partitioning/ta/results/ta_sinks.json に保存しました

[phase3 ] → /workspace/benchmark/bad-partitioning/ta/results/ta_sinks.json

[phase4 ] Integrated candidate flow generation
          → generate_candidate_flows.py --compile-db compile_commands.json --sinks ta_sinks.json --phase12 ta_phase12.json --sources ... --output ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_flows/generate_candidate_flows.py --compile-db /workspace/benchmark/bad-partitioning/ta/compile_commands.json --sinks /workspace/benchmark/bad-partitioning/ta/results/ta_sinks.json --phase12 /workspace/benchmark/bad-partitioning/ta/results/ta_phase12.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/bad-partitioning/ta/results/ta_candidate_flows.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --verbose  (cwd=/workspace/benchmark/bad-partitioning/ta)
[STDOUT] [INFO] Loaded 3 sink functions
[INFO] Source functions: ['TA_InvokeCommandEntryPoint', 'TA_OpenSessionEntryPoint']
[ClangUtils] Loaded 1 compile entries
[SinkDetector] Tracking 2 sink functions
  Active sinks: {'TEE_MemMove', 'snprintf'}
  Identified 87 macros from phase12
[Phase 4] Starting integrated candidate flow generation...
[Step 1] Parsing source files...
  Parsing /workspace/benchmark/bad-partitioning/ta/entry.c...
  [WARN] 9 errors in /workspace/benchmark/bad-partitioning/ta/entry.c
[Step 2] Building call graph...
[CallGraphBuilder] Building call graph...
  Found 19 function definitions
  Found 122 unique call edges
[Step 3] Detecting sink calls...
  Scanning /workspace/benchmark/bad-partitioning/ta/entry.c...
    Entering function: TA_CreateEntryPoint
    Entering function: TA_DestroyEntryPoint
    Entering function: TA_OpenSessionEntryPoint
    Entering function: TA_CloseSessionEntryPoint
    Entering function: enc
    Entering function: dec
    Entering function: produce_2
      -> Detected sink: TEE_MemMove at line 116 in produce_2
      -> Detected sink: snprintf at line 117 in produce_2
      -> Detected sink: snprintf at line 121 in produce_2
      -> Detected sink: snprintf at line 122 in produce_2
      -> Detected sink: snprintf at line 125 in produce_2
      -> Detected sink: snprintf at line 126 in produce_2
    Entering function: produce
      -> Detected sink: TEE_MemMove at line 136 in produce
      -> Detected sink: snprintf at line 137 in produce
      -> Detected sink: snprintf at line 143 in produce
      -> Detected sink: snprintf at line 144 in produce
      -> Detected sink: snprintf at line 147 in produce
      -> Detected sink: snprintf at line 148 in produce
    Entering function: produce_3
      -> Detected sink: TEE_MemMove at line 154 in produce_3
      -> Detected sink: snprintf at line 155 in produce_3
    Entering function: output
      -> Detected sink: TEE_MemMove at line 175 in output
      -> Detected sink: snprintf at line 176 in output
      -> Detected sink: snprintf at line 184 in output
      -> Detected sink: snprintf at line 185 in output
      -> Detected sink: snprintf at line 189 in output
      -> Detected sink: snprintf at line 190 in output
      -> Detected sink: snprintf at line 191 in output
    Entering function: produce_i2
      -> Detected sink: TEE_MemMove at line 208 in produce_i2
      -> Detected sink: TEE_MemMove at line 212 in produce_i2
    Entering function: produce_i0
      -> Detected sink: TEE_MemMove at line 227 in produce_i0
      -> Detected sink: TEE_MemMove at line 238 in produce_i0
      -> Detected sink: TEE_MemMove at line 239 in produce_i0
      -> Detected sink: TEE_MemMove at line 246 in produce_i0
    Entering function: produce_i3
    Entering function: input
      -> Detected sink: TEE_MemMove at line 290 in input
      -> Detected sink: TEE_MemMove at line 291 in input
      -> Detected sink: TEE_MemMove at line 306 in input
      -> Detected sink: TEE_MemMove at line 307 in input
      -> Detected sink: TEE_MemMove at line 309 in input
    Entering function: produce_s2
    Entering function: produce_s
      -> Detected sink: TEE_MemMove at line 350 in produce_s
    Entering function: produce_s3
      -> Detected sink: TEE_MemMove at line 401 in produce_s3
    Entering function: shared_memory
      -> Detected sink: TEE_MemMove at line 485 in shared_memory
    Entering function: TA_InvokeCommandEntryPoint
    Found 52 sink calls
      - TEE_MemMove at line 116 in produce_2
      - snprintf at line 117 in produce_2
      - snprintf at line 117 in produce_2
      - snprintf at line 121 in produce_2
      - snprintf at line 121 in produce_2
      - snprintf at line 122 in produce_2
      - snprintf at line 122 in produce_2
      - snprintf at line 125 in produce_2
      - snprintf at line 125 in produce_2
      - snprintf at line 126 in produce_2
      - snprintf at line 126 in produce_2
      - TEE_MemMove at line 136 in produce
      - snprintf at line 137 in produce
      - snprintf at line 137 in produce
      - snprintf at line 143 in produce
      - snprintf at line 143 in produce
      - snprintf at line 144 in produce
      - snprintf at line 144 in produce
      - snprintf at line 147 in produce
      - snprintf at line 147 in produce
      - snprintf at line 148 in produce
      - snprintf at line 148 in produce
      - TEE_MemMove at line 154 in produce_3
      - snprintf at line 155 in produce_3
      - snprintf at line 155 in produce_3
      - TEE_MemMove at line 175 in output
      - snprintf at line 176 in output
      - snprintf at line 176 in output
      - snprintf at line 184 in output
      - snprintf at line 184 in output
      - snprintf at line 185 in output
      - snprintf at line 185 in output
      - snprintf at line 189 in output
      - snprintf at line 189 in output
      - snprintf at line 190 in output
      - snprintf at line 190 in output
      - snprintf at line 191 in output
      - snprintf at line 191 in output
      - TEE_MemMove at line 208 in produce_i2
      - TEE_MemMove at line 212 in produce_i2
      - TEE_MemMove at line 227 in produce_i0
      - TEE_MemMove at line 238 in produce_i0
      - TEE_MemMove at line 239 in produce_i0
      - TEE_MemMove at line 246 in produce_i0
      - TEE_MemMove at line 290 in input
      - TEE_MemMove at line 291 in input
      - TEE_MemMove at line 306 in input
      - TEE_MemMove at line 307 in input
      - TEE_MemMove at line 309 in input
      - TEE_MemMove at line 350 in produce_s
      - TEE_MemMove at line 401 in produce_s3
      - TEE_MemMove at line 485 in shared_memory
[SinkDetector] Found 52 unique sink calls
  Sink call breakdown:
    - TEE_MemMove (function): 18 calls
    - snprintf (function): 34 calls
  Total: 52 function calls, 0 macro calls

  Calls by containing function:
    produce_2: TEE_MemMove@116, snprintf@117, snprintf@117, snprintf@121, snprintf@121, snprintf@122, snprintf@122, snprintf@125, snprintf@125, snprintf@126, snprintf@126
    produce: TEE_MemMove@136, snprintf@137, snprintf@137, snprintf@143, snprintf@143, snprintf@144, snprintf@144, snprintf@147, snprintf@147, snprintf@148, snprintf@148
    produce_3: TEE_MemMove@154, snprintf@155, snprintf@155
    output: TEE_MemMove@175, snprintf@176, snprintf@176, snprintf@184, snprintf@184, snprintf@185, snprintf@185, snprintf@189, snprintf@189, snprintf@190, snprintf@190, snprintf@191, snprintf@191
    produce_i2: TEE_MemMove@208, TEE_MemMove@212
    produce_i0: TEE_MemMove@227, TEE_MemMove@238, TEE_MemMove@239, TEE_MemMove@246
    input: TEE_MemMove@290, TEE_MemMove@291, TEE_MemMove@306, TEE_MemMove@307, TEE_MemMove@309
    produce_s: TEE_MemMove@350
    produce_s3: TEE_MemMove@401
    shared_memory: TEE_MemMove@485
[Step 4] Tracing call chains...
[ChainTracer] Processing TEE_MemMove at line 116 in produce_2
    Path found: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2
  Found 1 paths
[ChainTracer] Processing snprintf at line 117 in produce_2
    Path found: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2
  Found 1 paths
[ChainTracer] Processing snprintf at line 117 in produce_2
    Path found: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2
  Found 1 paths
[ChainTracer] Processing snprintf at line 121 in produce_2
    Path found: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2
  Found 1 paths
[ChainTracer] Processing snprintf at line 121 in produce_2
    Path found: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2
  Found 1 paths
[ChainTracer] Processing snprintf at line 122 in produce_2
    Path found: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2
  Found 1 paths
[ChainTracer] Processing snprintf at line 122 in produce_2
    Path found: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2
  Found 1 paths
[ChainTracer] Processing snprintf at line 125 in produce_2
    Path found: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2
  Found 1 paths
[ChainTracer] Processing snprintf at line 125 in produce_2
    Path found: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2
  Found 1 paths
[ChainTracer] Processing snprintf at line 126 in produce_2
    Path found: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2
  Found 1 paths
[ChainTracer] Processing snprintf at line 126 in produce_2
    Path found: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2
  Found 1 paths
[ChainTracer] Processing TEE_MemMove at line 136 in produce
    Path found: TA_InvokeCommandEntryPoint -> output -> produce
  Found 1 paths
[ChainTracer] Processing snprintf at line 137 in produce
    Path found: TA_InvokeCommandEntryPoint -> output -> produce
  Found 1 paths
[ChainTracer] Processing snprintf at line 137 in produce
    Path found: TA_InvokeCommandEntryPoint -> output -> produce
  Found 1 paths
[ChainTracer] Processing snprintf at line 143 in produce
    Path found: TA_InvokeCommandEntryPoint -> output -> produce
  Found 1 paths
[ChainTracer] Processing snprintf at line 143 in produce
    Path found: TA_InvokeCommandEntryPoint -> output -> produce
  Found 1 paths
[ChainTracer] Processing snprintf at line 144 in produce
    Path found: TA_InvokeCommandEntryPoint -> output -> produce
  Found 1 paths
[ChainTracer] Processing snprintf at line 144 in produce
    Path found: TA_InvokeCommandEntryPoint -> output -> produce
  Found 1 paths
[ChainTracer] Processing snprintf at line 147 in produce
    Path found: TA_InvokeCommandEntryPoint -> output -> produce
  Found 1 paths
[ChainTracer] Processing snprintf at line 147 in produce
    Path found: TA_InvokeCommandEntryPoint -> output -> produce
  Found 1 paths
[ChainTracer] Processing snprintf at line 148 in produce
    Path found: TA_InvokeCommandEntryPoint -> output -> produce
  Found 1 paths
[ChainTracer] Processing snprintf at line 148 in produce
    Path found: TA_InvokeCommandEntryPoint -> output -> produce
  Found 1 paths
[ChainTracer] Processing TEE_MemMove at line 154 in produce_3
    Path found: TA_InvokeCommandEntryPoint -> output -> produce_3
  Found 1 paths
[ChainTracer] Processing snprintf at line 155 in produce_3
    Path found: TA_InvokeCommandEntryPoint -> output -> produce_3
  Found 1 paths
[ChainTracer] Processing snprintf at line 155 in produce_3
    Path found: TA_InvokeCommandEntryPoint -> output -> produce_3
  Found 1 paths
[ChainTracer] Processing TEE_MemMove at line 175 in output
    Path found: TA_InvokeCommandEntryPoint -> output
  Found 1 paths
[ChainTracer] Processing snprintf at line 176 in output
    Path found: TA_InvokeCommandEntryPoint -> output
  Found 1 paths
[ChainTracer] Processing snprintf at line 176 in output
    Path found: TA_InvokeCommandEntryPoint -> output
  Found 1 paths
[ChainTracer] Processing snprintf at line 184 in output
    Path found: TA_InvokeCommandEntryPoint -> output
  Found 1 paths
[ChainTracer] Processing snprintf at line 184 in output
    Path found: TA_InvokeCommandEntryPoint -> output
  Found 1 paths
[ChainTracer] Processing snprintf at line 185 in output
    Path found: TA_InvokeCommandEntryPoint -> output
  Found 1 paths
[ChainTracer] Processing snprintf at line 185 in output
    Path found: TA_InvokeCommandEntryPoint -> output
  Found 1 paths
[ChainTracer] Processing snprintf at line 189 in output
    Path found: TA_InvokeCommandEntryPoint -> output
  Found 1 paths
[ChainTracer] Processing snprintf at line 189 in output
    Path found: TA_InvokeCommandEntryPoint -> output
  Found 1 paths
[ChainTracer] Processing snprintf at line 190 in output
    Path found: TA_InvokeCommandEntryPoint -> output
  Found 1 paths
[ChainTracer] Processing snprintf at line 190 in output
    Path found: TA_InvokeCommandEntryPoint -> output
  Found 1 paths
[ChainTracer] Processing snprintf at line 191 in output
    Path found: TA_InvokeCommandEntryPoint -> output
  Found 1 paths
[ChainTracer] Processing snprintf at line 191 in output
    Path found: TA_InvokeCommandEntryPoint -> output
  Found 1 paths
[ChainTracer] Processing TEE_MemMove at line 208 in produce_i2
    Path found: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> produce_i2
  Found 1 paths
[ChainTracer] Processing TEE_MemMove at line 212 in produce_i2
    Path found: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> produce_i2
  Found 1 paths
[ChainTracer] Processing TEE_MemMove at line 227 in produce_i0
    Path found: TA_InvokeCommandEntryPoint -> input -> produce_i0
  Found 1 paths
[ChainTracer] Processing TEE_MemMove at line 238 in produce_i0
    Path found: TA_InvokeCommandEntryPoint -> input -> produce_i0
  Found 1 paths
[ChainTracer] Processing TEE_MemMove at line 239 in produce_i0
    Path found: TA_InvokeCommandEntryPoint -> input -> produce_i0
  Found 1 paths
[ChainTracer] Processing TEE_MemMove at line 246 in produce_i0
    Path found: TA_InvokeCommandEntryPoint -> input -> produce_i0
  Found 1 paths
[ChainTracer] Processing TEE_MemMove at line 290 in input
    Path found: TA_InvokeCommandEntryPoint -> input
  Found 1 paths
[ChainTracer] Processing TEE_MemMove at line 291 in input
    Path found: TA_InvokeCommandEntryPoint -> input
  Found 1 paths
[ChainTracer] Processing TEE_MemMove at line 306 in input
    Path found: TA_InvokeCommandEntryPoint -> input
  Found 1 paths
[ChainTracer] Processing TEE_MemMove at line 307 in input
    Path found: TA_InvokeCommandEntryPoint -> input
  Found 1 paths
[ChainTracer] Processing TEE_MemMove at line 309 in input
    Path found: TA_InvokeCommandEntryPoint -> input
  Found 1 paths
[ChainTracer] Processing TEE_MemMove at line 350 in produce_s
    Path found: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s
  Found 1 paths
[ChainTracer] Processing TEE_MemMove at line 401 in produce_s3
    Path found: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s3
  Found 1 paths
[ChainTracer] Processing TEE_MemMove at line 485 in shared_memory
    Path found: TA_InvokeCommandEntryPoint -> shared_memory
  Found 1 paths
[Step 5] Optimizing flows...
[FlowOptimizer] Optimizing 52 flows...
  Initial flows:
    - TEE_MemMove@116 chain: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> TEE_MemMove
    - snprintf@117 chain: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> snprintf
    - snprintf@117 chain: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> snprintf
    - snprintf@121 chain: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> snprintf
    - snprintf@121 chain: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> snprintf
    - snprintf@122 chain: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> snprintf
    - snprintf@122 chain: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> snprintf
    - snprintf@125 chain: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> snprintf
    - snprintf@125 chain: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> snprintf
    - snprintf@126 chain: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> snprintf
    - snprintf@126 chain: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> snprintf
    - TEE_MemMove@136 chain: TA_InvokeCommandEntryPoint -> output -> produce -> TEE_MemMove
    - snprintf@137 chain: TA_InvokeCommandEntryPoint -> output -> produce -> snprintf
    - snprintf@137 chain: TA_InvokeCommandEntryPoint -> output -> produce -> snprintf
    - snprintf@143 chain: TA_InvokeCommandEntryPoint -> output -> produce -> snprintf
    - snprintf@143 chain: TA_InvokeCommandEntryPoint -> output -> produce -> snprintf
    - snprintf@144 chain: TA_InvokeCommandEntryPoint -> output -> produce -> snprintf
    - snprintf@144 chain: TA_InvokeCommandEntryPoint -> output -> produce -> snprintf
    - snprintf@147 chain: TA_InvokeCommandEntryPoint -> output -> produce -> snprintf
    - snprintf@147 chain: TA_InvokeCommandEntryPoint -> output -> produce -> snprintf
    - snprintf@148 chain: TA_InvokeCommandEntryPoint -> output -> produce -> snprintf
    - snprintf@148 chain: TA_InvokeCommandEntryPoint -> output -> produce -> snprintf
    - TEE_MemMove@154 chain: TA_InvokeCommandEntryPoint -> output -> produce_3 -> TEE_MemMove
    - snprintf@155 chain: TA_InvokeCommandEntryPoint -> output -> produce_3 -> snprintf
    - snprintf@155 chain: TA_InvokeCommandEntryPoint -> output -> produce_3 -> snprintf
    - TEE_MemMove@175 chain: TA_InvokeCommandEntryPoint -> output -> TEE_MemMove
    - snprintf@176 chain: TA_InvokeCommandEntryPoint -> output -> snprintf
    - snprintf@176 chain: TA_InvokeCommandEntryPoint -> output -> snprintf
    - snprintf@184 chain: TA_InvokeCommandEntryPoint -> output -> snprintf
    - snprintf@184 chain: TA_InvokeCommandEntryPoint -> output -> snprintf
    - snprintf@185 chain: TA_InvokeCommandEntryPoint -> output -> snprintf
    - snprintf@185 chain: TA_InvokeCommandEntryPoint -> output -> snprintf
    - snprintf@189 chain: TA_InvokeCommandEntryPoint -> output -> snprintf
    - snprintf@189 chain: TA_InvokeCommandEntryPoint -> output -> snprintf
    - snprintf@190 chain: TA_InvokeCommandEntryPoint -> output -> snprintf
    - snprintf@190 chain: TA_InvokeCommandEntryPoint -> output -> snprintf
    - snprintf@191 chain: TA_InvokeCommandEntryPoint -> output -> snprintf
    - snprintf@191 chain: TA_InvokeCommandEntryPoint -> output -> snprintf
    - TEE_MemMove@208 chain: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> produce_i2 -> TEE_MemMove
    - TEE_MemMove@212 chain: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> produce_i2 -> TEE_MemMove
    - TEE_MemMove@227 chain: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> TEE_MemMove
    - TEE_MemMove@238 chain: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> TEE_MemMove
    - TEE_MemMove@239 chain: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> TEE_MemMove
    - TEE_MemMove@246 chain: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> TEE_MemMove
    - TEE_MemMove@290 chain: TA_InvokeCommandEntryPoint -> input -> TEE_MemMove
    - TEE_MemMove@291 chain: TA_InvokeCommandEntryPoint -> input -> TEE_MemMove
    - TEE_MemMove@306 chain: TA_InvokeCommandEntryPoint -> input -> TEE_MemMove
    - TEE_MemMove@307 chain: TA_InvokeCommandEntryPoint -> input -> TEE_MemMove
    - TEE_MemMove@309 chain: TA_InvokeCommandEntryPoint -> input -> TEE_MemMove
    - TEE_MemMove@350 chain: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s -> TEE_MemMove
    - TEE_MemMove@401 chain: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s3 -> TEE_MemMove
    - TEE_MemMove@485 chain: TA_InvokeCommandEntryPoint -> shared_memory -> TEE_MemMove
  Merged param_indices [0, 1] for snprintf at line 117
  Merged param_indices [0, 1] for snprintf at line 121
  Merged param_indices [0, 1] for snprintf at line 122
  Merged param_indices [0, 1] for snprintf at line 125
  Merged param_indices [0, 1] for snprintf at line 126
  Merged param_indices [0, 1] for snprintf at line 137
  Merged param_indices [0, 1] for snprintf at line 143
  Merged param_indices [0, 1] for snprintf at line 144
  Merged param_indices [0, 1] for snprintf at line 147
  Merged param_indices [0, 1] for snprintf at line 148
  Merged param_indices [0, 1] for snprintf at line 155
  Merged param_indices [0, 1] for snprintf at line 176
  Merged param_indices [0, 1] for snprintf at line 184
  Merged param_indices [0, 1] for snprintf at line 185
  Merged param_indices [0, 1] for snprintf at line 189
  Merged param_indices [0, 1] for snprintf at line 190
  Merged param_indices [0, 1] for snprintf at line 191
  Merging same function sinks...
    Grouping: TEE_MemMove@116 in produce_2 with chain TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> TEE_MemMove
    Grouping: snprintf@117 in produce_2 with chain TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> snprintf
    Grouping: snprintf@121 in produce_2 with chain TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> snprintf
    Grouping: snprintf@122 in produce_2 with chain TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> snprintf
    Grouping: snprintf@125 in produce_2 with chain TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> snprintf
    Grouping: snprintf@126 in produce_2 with chain TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> snprintf
    Grouping: TEE_MemMove@136 in produce with chain TA_InvokeCommandEntryPoint -> output -> produce -> TEE_MemMove
    Grouping: snprintf@137 in produce with chain TA_InvokeCommandEntryPoint -> output -> produce -> snprintf
    Grouping: snprintf@143 in produce with chain TA_InvokeCommandEntryPoint -> output -> produce -> snprintf
    Grouping: snprintf@144 in produce with chain TA_InvokeCommandEntryPoint -> output -> produce -> snprintf
    Grouping: snprintf@147 in produce with chain TA_InvokeCommandEntryPoint -> output -> produce -> snprintf
    Grouping: snprintf@148 in produce with chain TA_InvokeCommandEntryPoint -> output -> produce -> snprintf
    Grouping: TEE_MemMove@154 in produce_3 with chain TA_InvokeCommandEntryPoint -> output -> produce_3 -> TEE_MemMove
    Grouping: snprintf@155 in produce_3 with chain TA_InvokeCommandEntryPoint -> output -> produce_3 -> snprintf
    Grouping: TEE_MemMove@175 in output with chain TA_InvokeCommandEntryPoint -> output -> TEE_MemMove
    Grouping: snprintf@176 in output with chain TA_InvokeCommandEntryPoint -> output -> snprintf
    Grouping: snprintf@184 in output with chain TA_InvokeCommandEntryPoint -> output -> snprintf
    Grouping: snprintf@185 in output with chain TA_InvokeCommandEntryPoint -> output -> snprintf
    Grouping: snprintf@189 in output with chain TA_InvokeCommandEntryPoint -> output -> snprintf
    Grouping: snprintf@190 in output with chain TA_InvokeCommandEntryPoint -> output -> snprintf
    Grouping: snprintf@191 in output with chain TA_InvokeCommandEntryPoint -> output -> snprintf
    Grouping: TEE_MemMove@208 in produce_i2 with chain TA_InvokeCommandEntryPoint -> input -> produce_i0 -> produce_i2 -> TEE_MemMove
    Grouping: TEE_MemMove@212 in produce_i2 with chain TA_InvokeCommandEntryPoint -> input -> produce_i0 -> produce_i2 -> TEE_MemMove
    Grouping: TEE_MemMove@227 in produce_i0 with chain TA_InvokeCommandEntryPoint -> input -> produce_i0 -> TEE_MemMove
    Grouping: TEE_MemMove@238 in produce_i0 with chain TA_InvokeCommandEntryPoint -> input -> produce_i0 -> TEE_MemMove
    Grouping: TEE_MemMove@239 in produce_i0 with chain TA_InvokeCommandEntryPoint -> input -> produce_i0 -> TEE_MemMove
    Grouping: TEE_MemMove@246 in produce_i0 with chain TA_InvokeCommandEntryPoint -> input -> produce_i0 -> TEE_MemMove
    Grouping: TEE_MemMove@290 in input with chain TA_InvokeCommandEntryPoint -> input -> TEE_MemMove
    Grouping: TEE_MemMove@291 in input with chain TA_InvokeCommandEntryPoint -> input -> TEE_MemMove
    Grouping: TEE_MemMove@306 in input with chain TA_InvokeCommandEntryPoint -> input -> TEE_MemMove
    Grouping: TEE_MemMove@307 in input with chain TA_InvokeCommandEntryPoint -> input -> TEE_MemMove
    Grouping: TEE_MemMove@309 in input with chain TA_InvokeCommandEntryPoint -> input -> TEE_MemMove
    Grouping: TEE_MemMove@350 in produce_s with chain TA_InvokeCommandEntryPoint -> shared_memory -> produce_s -> TEE_MemMove
    Grouping: TEE_MemMove@401 in produce_s3 with chain TA_InvokeCommandEntryPoint -> shared_memory -> produce_s3 -> TEE_MemMove
    Grouping: TEE_MemMove@485 in shared_memory with chain TA_InvokeCommandEntryPoint -> shared_memory -> TEE_MemMove
    Merging 5 flows at lines [117, 121, 122, 125, 126] in produce_2 with chain: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> snprintf
    Merging 5 flows at lines [137, 143, 144, 147, 148] in produce with chain: TA_InvokeCommandEntryPoint -> output -> produce -> snprintf
    Merging 6 flows at lines [176, 184, 185, 189, 190, 191] in output with chain: TA_InvokeCommandEntryPoint -> output -> snprintf
    Merging 2 flows at lines [208, 212] in produce_i2 with chain: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> produce_i2 -> TEE_MemMove
    Merging 4 flows at lines [227, 238, 239, 246] in produce_i0 with chain: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> TEE_MemMove
    Merging 5 flows at lines [290, 291, 306, 307, 309] in input with chain: TA_InvokeCommandEntryPoint -> input -> TEE_MemMove
[FlowOptimizer] Optimized to 14 flows
  Final flows:
    - TEE_MemMove@116 chain: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> TEE_MemMove
    - snprintf@[117, 121, 122, 125, 126] chain: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> snprintf
    - TEE_MemMove@136 chain: TA_InvokeCommandEntryPoint -> output -> produce -> TEE_MemMove
    - snprintf@[137, 143, 144, 147, 148] chain: TA_InvokeCommandEntryPoint -> output -> produce -> snprintf
    - TEE_MemMove@154 chain: TA_InvokeCommandEntryPoint -> output -> produce_3 -> TEE_MemMove
    - snprintf@155 chain: TA_InvokeCommandEntryPoint -> output -> produce_3 -> snprintf
    - TEE_MemMove@175 chain: TA_InvokeCommandEntryPoint -> output -> TEE_MemMove
    - snprintf@[176, 184, 185, 189, 190, 191] chain: TA_InvokeCommandEntryPoint -> output -> snprintf
    - TEE_MemMove@[208, 212] chain: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> produce_i2 -> TEE_MemMove
    - TEE_MemMove@[227, 238, 239, 246] chain: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> TEE_MemMove
    - TEE_MemMove@[290, 291, 306, 307, 309] chain: TA_InvokeCommandEntryPoint -> input -> TEE_MemMove
    - TEE_MemMove@350 chain: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s -> TEE_MemMove
    - TEE_MemMove@401 chain: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s3 -> TEE_MemMove
    - TEE_MemMove@485 chain: TA_InvokeCommandEntryPoint -> shared_memory -> TEE_MemMove
[Phase 4] Generated 14 candidate flows
[SUCCESS] Saved 14 candidate flows to /workspace/benchmark/bad-partitioning/ta/results/ta_candidate_flows.json

[phase4 ] → /workspace/benchmark/bad-partitioning/ta/results/ta_candidate_flows.json

[phase5_command] → python3 taint_analyzer.py /workspace/benchmark/bad-partitioning/ta/results/ta_candidate_flows.json --phase12 /workspace/benchmark/bad-partitioning/ta/results/ta_phase12.json --output /workspace/benchmark/bad-partitioning/ta/results/ta_vulnerabilities.json --verbose
[INFO] $ /usr/bin/python3 /workspace/src/analyze_vulnerabilities/taint_analyzer.py --flows /workspace/benchmark/bad-partitioning/ta/results/ta_candidate_flows.json --phase12 /workspace/benchmark/bad-partitioning/ta/results/ta_phase12.json --output /workspace/benchmark/bad-partitioning/ta/results/ta_vulnerabilities.json --verbose  (cwd=/workspace/benchmark/bad-partitioning/ta)
[STDOUT] ============================================================
Taint Analysis Configuration
============================================================
Mode: Hybrid (DITING + LLM)
RAG: Disabled
Full mode: hybrid
LLM Provider: Using config default
Cache: Enabled
============================================================

[INFO] Loading input files...
[INFO] Loaded 14 flows for analysis
[INFO] Initializing LLM client...
[INFO] Using default LLM provider: openai
[INFO] Setting up prompt system...
[INFO] Setting up prompt system:
  - Mode: hybrid
  - RAG: disabled
  - Rules path: /workspace/rules/codeql_rules.json
[INFO] Using prompts from: /workspace/prompts/vulnerabilities_prompt/hybrid/no_rag
[INFO] Setting up: Hybrid mode without RAG
[INFO] DITING rules JSON set (3674 chars)
[INFO] Rule hints block set (312 chars)
[INFO] RULE_IDS set: unencrypted_output, weak_input_validation, shared_memory_overwrite
[DEBUG] Loaded prompt: hybrid/no_rag/system.txt
[INFO] Initializing analysis engine...
 conversations will be logged to /workspace/benchmark/bad-partitioning/ta/results/conversations.jsonl


[INFO] Starting analysis...
============================================================

[1/14] Analyzing: TA_InvokeCommandEntryPoint -> output -> produce -> ... (5 functions)

============================================================
[FLOW 1] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → output → produce → produce_2 → TEE_MemMove
  Sink: TEE_MemMove (param 0)
  [CACHE MISS] No cached data found

  [1/5] Analyzing TA_InvokeCommandEntryPoint...

[ANALYZING FUNCTION] TA_InvokeCommandEntryPoint at position 0
  Phase: start
[DEBUG] Loaded prompt: hybrid/no_rag/taint_start.txt
[EXTRACT] Only found 0 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 1 JSON lines from response
[EXTRACT WARNING] Expected 2 lines but found 1
[EXTRACT DEBUG] Response preview (first 300 chars):
  {
  "phase": "start",
  "taint_analysis": {
    "function": "TA_InvokeCommandEntryPoint",
    "tainted_vars": [],
    "propagation": [],
    "sanitizers": [],
    "taint_blocked": false
  },
  "structural_risks": []
}...
[PARSER] Extracted 1 JSON lines from response
  Line 1: {"phase":"start","taint_analysis":{"function":"TA_InvokeCommandEntryPoint","tainted_vars":[],"propag...

  [2/5] Analyzing output...

[ANALYZING FUNCTION] output at position 1
  Phase: middle
  Called by: TA_InvokeCommandEntryPoint
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
[DEBUG] Loaded prompt: hybrid/no_rag/taint_middle.txt
  [INCLUDING HISTORY] 1 previous exchanges
[EXTRACT] Only found 1 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"params","rhs":"params (memref buffers and values from REE) @ file:line 160-164","site":"/wor...
  Line 2: {"phase":"middle","taint_analysis":{"function":"output","tainted_vars":["param_types","params"],"pro...

  [3/5] Analyzing produce...

[ANALYZING FUNCTION] produce at position 2
  Phase: middle
  Called by: output
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 2 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"params[2].memref.buffer","rhs":"RE Safeguard from input (TEEI param) @ file:line 137","site"...
  Line 2: {"kind":"bounds_check","site":"/workspace/benchmark/bad-partitioning/ta/entry.c:137","evidence":"snp...

  [4/5] Analyzing produce_2...

[ANALYZING FUNCTION] produce_2 at position 3
  Phase: middle
  Called by: produce
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 3 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"params[2].memref.buffer","rhs":"REE-originated param used for output in produce_2 @ file:lin...
  Line 2: {"kind":"bounds_check","site":"/workspace/benchmark/bad-partitioning/ta/entry.c:121","evidence":"snp...

  [5/5] Analyzing TEE_MemMove...

[ANALYZING FUNCTION] TEE_MemMove at position 4
  Phase: middle
  Called by: produce_2
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 4 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"params[2].memref.buffer","rhs":"destination buffer for memmove in various calls (REE-visible...
  Line 2: {"kind":"bounds_check","site":"/workspace/benchmark/bad-partitioning/ta/entry.c:208","evidence":"par...

[VULNERABILITY DECISION] Making final decision for flow 1
[DEBUG] Loaded prompt: hybrid/no_rag/taint_end.txt

[FINAL DECISION] Preparing to analyze vulnerability for chain with 5 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 5 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: output (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “output” at ...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "output",     "tainted_vars": ["param_t...
    [3] Function: produce (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “produce” at...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "produce",     "tainted_vars": ["params...
    [4] Function: produce_2 (pos=3, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “produce_2” ...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "produce_2",     "tainted_vars": ["para...
    [5] Function: TEE_MemMove (pos=4, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “TEE_MemMove...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "TEE_MemMove",     "tainted_vars": ["pa...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Only found 0 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 1 JSON lines from response
[EXTRACT WARNING] Expected 3 lines but found 1
[EXTRACT DEBUG] Response preview (first 300 chars):
  {
  "phase": "end",
  "sink_targets": {
    "function": "TEE_MemMove",
    "lines": [116]
  },
  "evaluated_sink_lines": [
    {
      "line": 116,
      "function": "TEE_MemMove",
      "sink_function": "TEE_MemMove",
      "status": "safe",
      "why": "destination REE-visible buffer written from...
    [INFO] Missing non-critical fields: ['why_no_vulnerability'] - skipping retry
  Collected 2 risks from middle phase
  Collected 4 risks from middle phase
  Collected 7 risks from middle phase
  Collected 7 risks from middle phase
[DEBUG] Total structural_risks collected: 20

[FLOW 1] Analysis complete: SAFE
============================================================


[2/14] Analyzing: TA_InvokeCommandEntryPoint -> output -> produce -> ... (5 functions)

============================================================
[FLOW 2] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → output → produce → produce_2 → snprintf
  Sink: snprintf (param 0)
  [CACHE HIT] Reusing 4/5 functions
    Cached: TA_InvokeCommandEntryPoint → output → produce → produce_2
  [CONTEXT RESTORED] 4 exchanges from cache

  [5/5] Analyzing snprintf...

[ANALYZING FUNCTION] snprintf at position 4
  Phase: middle
  Called by: produce_2
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 4 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"params[2].memref.buffer","rhs":"destination REE-visible buffer, tainted via prior MEMMOVE/sn...
  Line 2: {"kind":"bounds_check","site":"/workspace/benchmark/bad-partitioning/ta/entry.c:117","evidence":"snp...

[VULNERABILITY DECISION] Making final decision for flow 2

[FINAL DECISION] Preparing to analyze vulnerability for chain with 5 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 5 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: output (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “output” at ...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "output",     "tainted_vars": ["param_t...
    [3] Function: produce (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “produce” at...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "produce",     "tainted_vars": ["params...
    [4] Function: produce_2 (pos=3, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “produce_2” ...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "produce_2",     "tainted_vars": ["para...
    [5] Function: snprintf (pos=4, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “snprintf” a...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "snprintf",     "tainted_vars": ["param...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Only found 0 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 1 JSON lines from response
[EXTRACT WARNING] Expected 3 lines but found 1
[EXTRACT DEBUG] Response preview (first 300 chars):
  {
  "phase": "end",
  "sink_targets": {
    "function": "snprintf",
    "lines": [117, 121, 122, 125, 126]
  },
  "evaluated_sink_lines": [
    {
      "line": 117,
      "function": "snprintf",
      "sink_function": "array_write",
      "status": "not_applicable",
      "why": "Source data (key2) ...
  Collected 2 risks from middle phase
  Collected 4 risks from middle phase
  Collected 7 risks from middle phase
  Collected 5 risks from middle phase
[DEBUG] Total structural_risks collected: 18

[FLOW 2] Analysis complete: SAFE
============================================================


[3/14] Analyzing: TA_InvokeCommandEntryPoint -> output -> produce -> ... (4 functions)

============================================================
[FLOW 3] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → output → produce → TEE_MemMove
  Sink: TEE_MemMove (param 0)
  [CACHE HIT] Reusing 3/4 functions
    Cached: TA_InvokeCommandEntryPoint → output → produce
  [CONTEXT RESTORED] 3 exchanges from cache

  [4/4] Analyzing TEE_MemMove...

[ANALYZING FUNCTION] TEE_MemMove at position 3
  Phase: middle
  Called by: produce
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 3 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"params[2].memref.size","rhs":"destination size from REE param @ file:line 137","site":"/work...
  Line 2: {"kind":"bounds_check","site":"/workspace/benchmark/bad-partitioning/ta/entry.c:136","evidence":"cop...

[VULNERABILITY DECISION] Making final decision for flow 3

[FINAL DECISION] Preparing to analyze vulnerability for chain with 4 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 4 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: output (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “output” at ...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "output",     "tainted_vars": ["param_t...
    [3] Function: produce (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “produce” at...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "produce",     "tainted_vars": ["params...
    [4] Function: TEE_MemMove (pos=3, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “TEE_MemMove...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "TEE_MemMove",     "tainted_vars": ["pa...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Only found 0 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 1 JSON lines from response
[EXTRACT WARNING] Expected 3 lines but found 1
[EXTRACT DEBUG] Response preview (first 300 chars):
  {
  "phase": "end",
  "sink_targets": {
    "function": "TEE_MemMove",
    "lines": [136]
  },
  "evaluated_sink_lines": [
    {
      "line": 136,
      "function": "TEE_MemMove",
      "sink_function": "TEE_MemMove",
      "status": "safe",
      "why": "source data is a constant in TA (not tainte...
  Collected 2 risks from middle phase
  Collected 4 risks from middle phase
  Collected 4 risks from middle phase
[DEBUG] Total structural_risks collected: 10

[FLOW 3] Analysis complete: SAFE
============================================================


[4/14] Analyzing: TA_InvokeCommandEntryPoint -> output -> produce -> ... (4 functions)

============================================================
[FLOW 4] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → output → produce → snprintf
  Sink: snprintf (param 0)
  [CACHE HIT] Reusing 3/4 functions
    Cached: TA_InvokeCommandEntryPoint → output → produce
  [CONTEXT RESTORED] 3 exchanges from cache

  [4/4] Analyzing snprintf...

[ANALYZING FUNCTION] snprintf at position 3
  Phase: middle
  Called by: produce
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 3 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"params[2].memref.buffer","rhs":"tainted input from produce() via params (line 144)","site":"...
  Line 2: {"kind":"bounds_check","site":"/workspace/benchmark/bad-partitioning/ta/entry.c:137","evidence":"for...

[VULNERABILITY DECISION] Making final decision for flow 4

[FINAL DECISION] Preparing to analyze vulnerability for chain with 4 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 4 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: output (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “output” at ...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "output",     "tainted_vars": ["param_t...
    [3] Function: produce (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “produce” at...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "produce",     "tainted_vars": ["params...
    [4] Function: snprintf (pos=3, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “snprintf” a...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "snprintf",     "tainted_vars": ["param...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Only found 2 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 3 JSON lines from response
  Collected 2 risks from middle phase
  Collected 4 risks from middle phase
  Collected 7 risks from middle phase
[DEBUG] Total structural_risks collected: 13

[FLOW 4] Analysis complete: VULNERABLE
============================================================


[5/14] Analyzing: TA_InvokeCommandEntryPoint -> output -> produce_3 -> ... (4 functions)

============================================================
[FLOW 5] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → output → produce_3 → TEE_MemMove
  Sink: TEE_MemMove (param 0)
  [CACHE HIT] Reusing 2/4 functions
    Cached: TA_InvokeCommandEntryPoint → output
  [CONTEXT RESTORED] 2 exchanges from cache

  [3/4] Analyzing produce_3...

[ANALYZING FUNCTION] produce_3 at position 2
  Phase: middle
  Called by: output
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 2 previous exchanges
[EXTRACT] Only found 1 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"size","rhs":"size (argument from caller) @ file:line 151-156","site":"/workspace/benchmark/b...
  Line 2: {"phase":"middle","taint_analysis":{"function":"produce_3","tainted_vars":["buf","size"],"propagatio...

  [4/4] Analyzing TEE_MemMove...

[ANALYZING FUNCTION] TEE_MemMove at position 3
  Phase: middle
  Called by: produce_3
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 3 previous exchanges
[EXTRACT] Only found 1 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"buf","rhs":"destination buffer (param) @ file:line 151-156","site":"/workspace/benchmark/bad...
  Line 2: {"phase":"middle","taint_analysis":{"function":"TEE_MemMove","tainted_vars":["buf","key","strlen(key...

[VULNERABILITY DECISION] Making final decision for flow 5

[FINAL DECISION] Preparing to analyze vulnerability for chain with 4 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 4 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: output (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “output” at ...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "output",     "tainted_vars": ["param_t...
    [3] Function: produce_3 (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “produce_3” ...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "produce_3",     "tainted_vars": ["buf"...
    [4] Function: TEE_MemMove (pos=3, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “TEE_MemMove...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "TEE_MemMove",     "tainted_vars": ["bu...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Only found 0 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 1 JSON lines from response
[EXTRACT WARNING] Expected 3 lines but found 1
[EXTRACT DEBUG] Response preview (first 300 chars):
  {
  "phase": "end",
  "sink_targets": {
    "function": "TEE_MemMove",
    "lines": [154]
  },
  "evaluated_sink_lines": [
    {
      "line": 154,
      "function": "produce_3",
      "sink_function": "TEE_MemMove",
      "status": "safe",
      "why": "source (key) is a local constant, not tainted...
  Collected 2 risks from middle phase
  Collected 1 risks from middle phase
  Collected 1 risks from middle phase
[DEBUG] Total structural_risks collected: 4

[FLOW 5] Analysis complete: SAFE
============================================================


[6/14] Analyzing: TA_InvokeCommandEntryPoint -> output -> produce_3 -> ... (4 functions)

============================================================
[FLOW 6] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → output → produce_3 → snprintf
  Sink: snprintf (param 0)
  [CACHE HIT] Reusing 3/4 functions
    Cached: TA_InvokeCommandEntryPoint → output → produce_3
  [CONTEXT RESTORED] 3 exchanges from cache

  [4/4] Analyzing snprintf...

[ANALYZING FUNCTION] snprintf at position 3
  Phase: middle
  Called by: produce_3
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 3 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"size","rhs":"size (argument from produce_3) @ file:line 191","site":"/workspace/benchmark/ba...
  Line 2: {"kind":"bounds_check","site":"/workspace/benchmark/bad-partitioning/ta/entry.c:155","evidence":"snp...

[VULNERABILITY DECISION] Making final decision for flow 6

[FINAL DECISION] Preparing to analyze vulnerability for chain with 4 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 4 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: output (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “output” at ...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "output",     "tainted_vars": ["param_t...
    [3] Function: produce_3 (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “produce_3” ...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "produce_3",     "tainted_vars": ["buf"...
    [4] Function: snprintf (pos=3, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “snprintf” a...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "snprintf",     "tainted_vars": ["buf",...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Only found 0 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 1 JSON lines from response
[EXTRACT WARNING] Expected 3 lines but found 1
[EXTRACT DEBUG] Response preview (first 300 chars):
  {
  "phase": "end",
  "sink_targets": {
    "function": "snprintf",
    "lines": [155]
  },
  "evaluated_sink_lines": [
    {
      "line": 155,
      "function": "produce_3",
      "sink_function": "snprintf",
      "status": "not_applicable",
      "why": "destination buffer is REE-visible and sou...
  Collected 2 risks from middle phase
  Collected 1 risks from middle phase
  Collected 7 risks from middle phase
[DEBUG] Total structural_risks collected: 10

[FLOW 6] Analysis complete: SAFE
============================================================


[7/14] Analyzing: TA_InvokeCommandEntryPoint -> output -> TEE_MemMove

============================================================
[FLOW 7] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → output → TEE_MemMove
  Sink: TEE_MemMove (param 0)
  [CACHE HIT] Reusing 2/3 functions
    Cached: TA_InvokeCommandEntryPoint → output
  [CONTEXT RESTORED] 2 exchanges from cache

  [3/3] Analyzing TEE_MemMove...

[ANALYZING FUNCTION] TEE_MemMove at position 2
  Phase: middle
  Called by: output
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 2 previous exchanges
[EXTRACT] Only found 1 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"strlen(key)","rhs":"key length derived from REE-origin length function @ file:line 171-173",...
  Line 2: {"phase":"middle","taint_analysis":{"function":"TEE_MemMove","tainted_vars":["params","key","strlen(...

[VULNERABILITY DECISION] Making final decision for flow 7

[FINAL DECISION] Preparing to analyze vulnerability for chain with 3 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 3 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: output (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “output” at ...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "output",     "tainted_vars": ["param_t...
    [3] Function: TEE_MemMove (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “TEE_MemMove...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "TEE_MemMove",     "tainted_vars": ["pa...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Only found 1 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 2 JSON lines from response
[EXTRACT WARNING] Expected 3 lines but found 2
[EXTRACT DEBUG] Response preview (first 300 chars):
  {
  "phase": "end",
  "sink_targets": {
    "function": "TEE_MemMove",
    "lines": [175]
  },
  "evaluated_sink_lines": [
    {
      "line": 175,
      "function": "output",
      "sink_function": "TEE_MemMove",
      "status": "vulnerable",
      "why": "TA-private data (key) copied into REE-visi...
  Collected 2 risks from middle phase
  Collected 1 risks from middle phase
[DEBUG] Total structural_risks collected: 3

[FLOW 7] Analysis complete: VULNERABLE
============================================================


[8/14] Analyzing: TA_InvokeCommandEntryPoint -> output -> snprintf

============================================================
[FLOW 8] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → output → snprintf
  Sink: snprintf (param 0)
  [CACHE HIT] Reusing 2/3 functions
    Cached: TA_InvokeCommandEntryPoint → output
  [CONTEXT RESTORED] 2 exchanges from cache

  [3/3] Analyzing snprintf...

[ANALYZING FUNCTION] snprintf at position 2
  Phase: middle
  Called by: output
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 2 previous exchanges
[EXTRACT] Only found 1 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"params","rhs":"params (memref buffers and values from REE) @ file:line 160-164","site":"/wor...
  Line 2: {"phase":"middle","taint_analysis":{"function":"snprintf","tainted_vars":["param_types","params"],"p...

[VULNERABILITY DECISION] Making final decision for flow 8

[FINAL DECISION] Preparing to analyze vulnerability for chain with 3 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 3 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: output (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “output” at ...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "output",     "tainted_vars": ["param_t...
    [3] Function: snprintf (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “snprintf” a...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "snprintf",     "tainted_vars": ["param...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Only found 0 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 1 JSON lines from response
[EXTRACT WARNING] Expected 3 lines but found 1
[EXTRACT DEBUG] Response preview (first 300 chars):
  {
  "phase": "end",
  "sink_targets": {
    "function": "snprintf",
    "lines": [176, 184, 185, 189, 190, 191]
  },
  "evaluated_sink_lines": [
    {
      "line": 176,
      "function": "snprintf",
      "sink_function": "snprintf",
      "status": "not_applicable",
      "why": "No evident taint ...
  Collected 2 risks from middle phase
  Collected 6 risks from middle phase
[DEBUG] Total structural_risks collected: 8

[FLOW 8] Analysis complete: SAFE
============================================================


[9/14] Analyzing: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> ... (5 functions)

============================================================
[FLOW 9] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → input → produce_i0 → produce_i2 → TEE_MemMove
  Sink: TEE_MemMove (param 0)
  [CACHE HIT] Reusing 1/5 functions
    Cached: TA_InvokeCommandEntryPoint
  [CONTEXT RESTORED] 1 exchanges from cache

  [2/5] Analyzing input...

[ANALYZING FUNCTION] input at position 1
  Phase: middle
  Called by: TA_InvokeCommandEntryPoint
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 1 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"tmp_arr[params[0].value.a]","rhs":"43","site":"/workspace/benchmark/bad-partitioning/ta/entr...
  Line 2: {"kind":"bounds_check","site":"/workspace/benchmark/bad-partitioning/ta/entry.c:290","evidence":"mem...

  [3/5] Analyzing produce_i0...

[ANALYZING FUNCTION] produce_i0 at position 2
  Phase: middle
  Called by: input
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 2 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"str","rhs":"buf3","site":"/workspace/benchmark/bad-partitioning/ta/entry.c:227"}...
  Line 2: {"kind":"bounds_check","site":"/workspace/benchmark/bad-partitioning/ta/entry.c:233","evidence":"if ...

  [4/5] Analyzing produce_i2...

[ANALYZING FUNCTION] produce_i2 at position 3
  Phase: middle
  Called by: produce_i0
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 3 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"str","rhs":"buf3","site":"/workspace/benchmark/bad-partitioning/ta/entry.c:227"}...
  Line 2: {"kind":"bounds_check","site":"/workspace/benchmark/bad-partitioning/ta/entry.c:233","evidence":"if ...

  [5/5] Analyzing TEE_MemMove...

[ANALYZING FUNCTION] TEE_MemMove at position 4
  Phase: middle
  Called by: produce_i2
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 4 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"str","rhs":"params[0].memref.buffer","site":"/workspace/benchmark/bad-partitioning/ta/entry....
  Line 2: {"kind":"bounds_check","site":"/workspace/benchmark/bad-partitioning/ta/entry.c:246","evidence":"mem...

[VULNERABILITY DECISION] Making final decision for flow 9

[FINAL DECISION] Preparing to analyze vulnerability for chain with 5 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 5 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: input (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “input” at a...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "input",     "tainted_vars": ["params[0...
    [3] Function: produce_i0 (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “produce_i0”...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "produce_i0",     "tainted_vars": ["par...
    [4] Function: produce_i2 (pos=3, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “produce_i2”...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "produce_i2",     "tainted_vars": ["a",...
    [5] Function: TEE_MemMove (pos=4, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “TEE_MemMove...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "TEE_MemMove",     "tainted_vars": ["bu...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Only found 2 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 3 JSON lines from response
  Collected 4 risks from middle phase
  Collected 2 risks from middle phase
  Collected 3 risks from middle phase
  Collected 8 risks from middle phase
[DEBUG] Total structural_risks collected: 17

[FLOW 9] Analysis complete: VULNERABLE
============================================================


[10/14] Analyzing: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> ... (4 functions)

============================================================
[FLOW 10] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → input → produce_i0 → TEE_MemMove
  Sink: TEE_MemMove (param 0)
  [CACHE HIT] Reusing 3/4 functions
    Cached: TA_InvokeCommandEntryPoint → input → produce_i0
  [CONTEXT RESTORED] 3 exchanges from cache

  [4/4] Analyzing TEE_MemMove...

[ANALYZING FUNCTION] TEE_MemMove at position 3
  Phase: middle
  Called by: produce_i0
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 3 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"size3","rhs":"produce_i0 argument size3 (memref.size) tainted from REE","site":"/workspace/b...
  Line 2: {"kind":"bounds_check","site":"/workspace/benchmark/bad-partitioning/ta/entry.c:227","evidence":"cop...

[VULNERABILITY DECISION] Making final decision for flow 10

[FINAL DECISION] Preparing to analyze vulnerability for chain with 4 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 4 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: input (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “input” at a...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "input",     "tainted_vars": ["params[0...
    [3] Function: produce_i0 (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “produce_i0”...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "produce_i0",     "tainted_vars": ["par...
    [4] Function: TEE_MemMove (pos=3, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “TEE_MemMove...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "TEE_MemMove",     "tainted_vars": ["st...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Found 3 JSON lines from response
  Collected 4 risks from middle phase
  Collected 2 risks from middle phase
  Collected 5 risks from middle phase
[DEBUG] Total structural_risks collected: 11

[FLOW 10] Analysis complete: VULNERABLE
============================================================


[11/14] Analyzing: TA_InvokeCommandEntryPoint -> input -> TEE_MemMove

============================================================
[FLOW 11] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → input → TEE_MemMove
  Sink: TEE_MemMove (param 0)
  [CACHE HIT] Reusing 2/3 functions
    Cached: TA_InvokeCommandEntryPoint → input
  [CONTEXT RESTORED] 2 exchanges from cache

  [3/3] Analyzing TEE_MemMove...

[ANALYZING FUNCTION] TEE_MemMove at position 2
  Phase: middle
  Called by: input
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 2 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"str","rhs":"params[0].memref.size","site":"/workspace/benchmark/bad-partitioning/ta/entry.c:...
  Line 2: {"kind":"bounds_check","site":"/workspace/benchmark/bad-partitioning/ta/entry.c:290","evidence":"cop...

[VULNERABILITY DECISION] Making final decision for flow 11

[FINAL DECISION] Preparing to analyze vulnerability for chain with 3 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 3 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: input (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “input” at a...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "input",     "tainted_vars": ["params[0...
    [3] Function: TEE_MemMove (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “TEE_MemMove...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "TEE_MemMove",     "tainted_vars": ["pa...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Found 3 JSON lines from response
  Collected 4 risks from middle phase
  Collected 5 risks from middle phase
[DEBUG] Total structural_risks collected: 9

[FLOW 11] Analysis complete: VULNERABLE
============================================================


[12/14] Analyzing: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s -> ... (4 functions)

============================================================
[FLOW 12] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → shared_memory → produce_s → TEE_MemMove
  Sink: TEE_MemMove (param 0)
  [CACHE HIT] Reusing 1/4 functions
    Cached: TA_InvokeCommandEntryPoint
  [CONTEXT RESTORED] 1 exchanges from cache

  [2/4] Analyzing shared_memory...

[ANALYZING FUNCTION] shared_memory at position 1
  Phase: middle
  Called by: TA_InvokeCommandEntryPoint
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 1 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"sz","rhs":"params[0].memref.size @ file:entry.c:423","site":"file:/workspace/benchmark/bad-p...
  Line 2: {"kind":"bounds_check","site":"file:/workspace/benchmark/bad-partitioning/ta/entry.c:419","evidence"...

  [3/4] Analyzing produce_s...

[ANALYZING FUNCTION] produce_s at position 2
  Phase: middle
  Called by: shared_memory
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 2 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"size","rhs":"params[0].memref.size @ file:/workspace/benchmark/bad-partitioning/ta/entry.c:3...
  Line 2: {"kind":"bounds_check","site":"file:/workspace/benchmark/bad-partitioning/ta/entry.c:346","evidence"...

  [4/4] Analyzing TEE_MemMove...

[ANALYZING FUNCTION] TEE_MemMove at position 3
  Phase: middle
  Called by: produce_s
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 3 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"str","rhs":"params[0].memref.buffer @ file:/workspace/benchmark/bad-partitioning/ta/entry.c:...
  Line 2: {"kind":"bounds_check","site":"file:/workspace/benchmark/bad-partitioning/ta/entry.c:346","evidence"...

[VULNERABILITY DECISION] Making final decision for flow 12

[FINAL DECISION] Preparing to analyze vulnerability for chain with 4 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 4 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: shared_memory (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “shared_memo...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "shared_memory",     "tainted_vars": ["...
    [3] Function: produce_s (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “produce_s” ...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "produce_s",     "tainted_vars": ["buf"...
    [4] Function: TEE_MemMove (pos=3, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “TEE_MemMove...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "TEE_MemMove",     "tainted_vars": ["st...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Only found 0 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 1 JSON lines from response
[EXTRACT WARNING] Expected 3 lines but found 1
[EXTRACT DEBUG] Response preview (first 300 chars):
  {
  "phase": "end",
  "sink_targets": {
    "function": "TEE_MemMove",
    "lines": [350]
  },
  "evaluated_sink_lines": [
    {
      "line": 350,
      "function": "produce_s",
      "sink_function": "TEE_MemMove",
      "status": "safe",
      "why": "Copy from a tainted REE-visible buffer into a...
  Collected 2 risks from middle phase
  Collected 1 risks from middle phase
  Collected 3 risks from middle phase
[DEBUG] Total structural_risks collected: 6

[FLOW 12] Analysis complete: SAFE
============================================================


[13/14] Analyzing: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s3 -> ... (4 functions)

============================================================
[FLOW 13] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → shared_memory → produce_s3 → TEE_MemMove
  Sink: TEE_MemMove (param 0)
  [CACHE HIT] Reusing 2/4 functions
    Cached: TA_InvokeCommandEntryPoint → shared_memory
  [CONTEXT RESTORED] 2 exchanges from cache

  [3/4] Analyzing produce_s3...

[ANALYZING FUNCTION] produce_s3 at position 2
  Phase: middle
  Called by: shared_memory
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 2 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"sz","rhs":"params[0].memref.size @ file:/workspace/benchmark/bad-partitioning/ta/entry.c:358...
  Line 2: {"kind":"bounds_check","site":"file:/workspace/benchmark/bad-partitioning/ta/entry.c:ToBeDetermined"...

  [4/4] Analyzing TEE_MemMove...

[ANALYZING FUNCTION] TEE_MemMove at position 3
  Phase: middle
  Called by: produce_s3
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 3 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"str","rhs":"params[0].memref.buffer @ file:/workspace/benchmark/bad-partitioning/ta/entry.c:...
  Line 2: {"kind":"bounds_check","site":"file:/workspace/benchmark/bad-partitioning/ta/entry.c:397","evidence"...

[VULNERABILITY DECISION] Making final decision for flow 13

[FINAL DECISION] Preparing to analyze vulnerability for chain with 4 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 4 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: shared_memory (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “shared_memo...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "shared_memory",     "tainted_vars": ["...
    [3] Function: produce_s3 (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “produce_s3”...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "produce_s3",     "tainted_vars": ["buf...
    [4] Function: TEE_MemMove (pos=3, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “TEE_MemMove...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "TEE_MemMove",     "tainted_vars": ["st...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Only found 0 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 1 JSON lines from response
[EXTRACT WARNING] Expected 3 lines but found 1
[EXTRACT DEBUG] Response preview (first 300 chars):
  {
  "phase": "end",
  "sink_targets": {
    "function": "TEE_MemMove",
    "lines": [401]
  },
  "evaluated_sink_lines": [
    {
      "line": 401,
      "function": "TEE_MemMove",
      "sink_function": "TEE_MemMove",
      "status": "vulnerable",
      "why": "Copy from REE-visible buffer into TA ...
  Collected 2 risks from middle phase
  Collected 2 risks from middle phase
  Collected 2 risks from middle phase
[DEBUG] Total structural_risks collected: 6

[FLOW 13] Analysis complete: VULNERABLE
============================================================


[14/14] Analyzing: TA_InvokeCommandEntryPoint -> shared_memory -> TEE_MemMove

============================================================
[FLOW 14] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → shared_memory → TEE_MemMove
  Sink: TEE_MemMove (param 0)
  [CACHE HIT] Reusing 2/3 functions
    Cached: TA_InvokeCommandEntryPoint → shared_memory
  [CONTEXT RESTORED] 2 exchanges from cache

  [3/3] Analyzing TEE_MemMove...

[ANALYZING FUNCTION] TEE_MemMove at position 2
  Phase: middle
  Called by: shared_memory
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 2 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"sz","rhs":"params[0].memref.size @ file:/workspace/benchmark/bad-partitioning/ta/entry.c:485...
  Line 2: {"kind":"bounds_check","site":"file:/workspace/benchmark/bad-partitioning/ta/entry.c:481","evidence"...

[VULNERABILITY DECISION] Making final decision for flow 14

[FINAL DECISION] Preparing to analyze vulnerability for chain with 3 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 3 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: shared_memory (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “shared_memo...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "shared_memory",     "tainted_vars": ["...
    [3] Function: TEE_MemMove (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “TEE_MemMove...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "TEE_MemMove",     "tainted_vars": ["st...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Only found 0 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 1 JSON lines from response
[EXTRACT WARNING] Expected 3 lines but found 1
[EXTRACT DEBUG] Response preview (first 300 chars):
  {
  "phase": "end",
  "sink_targets": {
    "function": "TEE_MemMove",
    "lines": [485]
  },
  "evaluated_sink_lines": [
    {
      "line": 485,
      "function": "TEE_MemMove",
      "sink_function": "TEE_MemMove",
      "status": "safe",
      "why": "Copy from REE-visible source into TA-privat...
  Collected 2 risks from middle phase
  Collected 2 risks from middle phase
[DEBUG] Total structural_risks collected: 4

[FLOW 14] Analysis complete: SAFE
============================================================

============================================================
[INFO] Analysis completed

============================================================
Analysis Summary
============================================================
Total flows analyzed: 14
Vulnerabilities found: 6
Detection rate: 42.9%

Execution time: 9.5 minutes
Average per flow: 40.52 seconds

Cache Performance:
  Hits: 0
  Partial hits: 13
  Misses: 1
  Hit rate: 92.9%
============================================================

[INFO] Analysis complete
[INFO] Results saved to: /workspace/benchmark/bad-partitioning/ta/results/ta_vulnerabilities.json
make -C host CROSS_COMPILE="arm-linux-gnueabihf-" --no-builtin-variables \
	TEEC_EXPORT=/workspace/benchmark/basicAlg_use/../../optee_client/out/export
make[1]: Entering directory '/workspace/benchmark/basicAlg_use/host'
arm-linux-gnueabihf-gcc -I../ta/include -I/workspace/benchmark/basicAlg_use/../../optee_client/out/export/include -I./include -c CryptoVerifyCaDebug.c -o CryptoVerifyCaDebug.o
arm-linux-gnueabihf-gcc -I../ta/include -I/workspace/benchmark/basicAlg_use/../../optee_client/out/export/include -I./include -c CryptoVerifyCa.c -o CryptoVerifyCa.o
arm-linux-gnueabihf-gcc -I../ta/include -I/workspace/benchmark/basicAlg_use/../../optee_client/out/export/include -I./include -c CryptoVerifyCaTest.c -o CryptoVerifyCaTest.o
arm-linux-gnueabihf-gcc -lteec -L/workspace/benchmark/basicAlg_use/../../optee_client/out/export/lib -o basicAlgUse CryptoVerifyCaDebug.o CryptoVerifyCa.o CryptoVerifyCaTest.o
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.o: in function `l_CryptoVerifyCa_TaskInit':
CryptoVerifyCa.c:(.text+0x1e): undefined reference to `TEEC_InitializeContext'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.o: in function `l_CryptoVerifyCa_OpenSession':
CryptoVerifyCa.c:(.text+0xac): undefined reference to `TEEC_OpenSession'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.o: in function `l_CryptoVerifyCa_SendCommand':
CryptoVerifyCa.c:(.text+0x158): undefined reference to `TEEC_InvokeCommand'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.o: in function `g_CryptoVerifyCa_Random':
CryptoVerifyCa.c:(.text+0x240): undefined reference to `TEEC_CloseSession'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.c:(.text+0x24e): undefined reference to `TEEC_FinalizeContext'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.o: in function `g_CryptoVerifyCa_Sha':
CryptoVerifyCa.c:(.text+0x326): undefined reference to `TEEC_CloseSession'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.c:(.text+0x334): undefined reference to `TEEC_FinalizeContext'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.o: in function `g_CryptoVerifyCa_hmac':
CryptoVerifyCa.c:(.text+0x406): undefined reference to `TEEC_CloseSession'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.c:(.text+0x414): undefined reference to `TEEC_FinalizeContext'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.o: in function `g_CryptoVerifyCa_Aes':
CryptoVerifyCa.c:(.text+0x506): undefined reference to `TEEC_CloseSession'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.c:(.text+0x514): undefined reference to `TEEC_FinalizeContext'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.o: in function `g_CryptoVerifyCa_Pbkdf':
CryptoVerifyCa.c:(.text+0x5e0): undefined reference to `TEEC_CloseSession'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.c:(.text+0x5ee): undefined reference to `TEEC_FinalizeContext'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.o: in function `g_CryptoVerifyCa_Rsa':
CryptoVerifyCa.c:(.text+0x6e8): undefined reference to `TEEC_CloseSession'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.c:(.text+0x6f6): undefined reference to `TEEC_FinalizeContext'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.o: in function `g_CryptoVerifyCa_base64':
CryptoVerifyCa.c:(.text+0x7de): undefined reference to `TEEC_CloseSession'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.c:(.text+0x7ec): undefined reference to `TEEC_FinalizeContext'
collect2: error: ld returned 1 exit status
make[1]: *** [Makefile:23: basicAlgUse] Error 1
make[1]: Leaving directory '/workspace/benchmark/basicAlg_use/host'
make: *** [Makefile:12: all] Error 2
make: Entering directory '/workspace/benchmark/basicAlg_use/ta'
arm-linux-gnueabihf-gcc -std=gnu99 -fdiagnostics-show-option -Wall -Wcast-align -Werror-implicit-function-declaration -Wextra -Wfloat-equal -Wformat-nonliteral -Wformat-security -Wformat=2 -Winit-self -Wmissing-declarations -Wmissing-format-attribute -Wmissing-include-dirs -Wmissing-noreturn -Wmissing-prototypes -Wnested-externs -Wpointer-arith -Wshadow -Wstrict-prototypes -Wswitch-default -Wwrite-strings -Wno-missing-field-initializers -Wno-format-zero-length -Waggregate-return -Wredundant-decls -Wold-style-definition -Wstrict-aliasing=2 -Wundef -pedantic -mcpu=cortex-a53 -Wno-error=cast-align -Os -g3 -fpie -mthumb -mthumb-interwork -fno-short-enums -fno-common -mno-unaligned-access -mfloat-abi=hard -funsafe-math-optimizations -funwind-tables -MD -MF ./.CryptoVerifyTaEntry.o.d -MT CryptoVerifyTaEntry.o -nostdinc -isystem /usr/lib/gcc-cross/arm-linux-gnueabihf/11/include -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=CryptoVerifyTaEntry_c -c CryptoVerifyTaEntry.c -o CryptoVerifyTaEntry.o
arm-linux-gnueabihf-objcopy --rename-section .rodata=.rodata.CryptoVerifyTaEntry.c --rename-section .rodata.str1.1=.rodata.str1.1.CryptoVerifyTaEntry.c ./CryptoVerifyTaEntry.o
arm-linux-gnueabihf-gcc -std=gnu99 -fdiagnostics-show-option -Wall -Wcast-align -Werror-implicit-function-declaration -Wextra -Wfloat-equal -Wformat-nonliteral -Wformat-security -Wformat=2 -Winit-self -Wmissing-declarations -Wmissing-format-attribute -Wmissing-include-dirs -Wmissing-noreturn -Wmissing-prototypes -Wnested-externs -Wpointer-arith -Wshadow -Wstrict-prototypes -Wswitch-default -Wwrite-strings -Wno-missing-field-initializers -Wno-format-zero-length -Waggregate-return -Wredundant-decls -Wold-style-definition -Wstrict-aliasing=2 -Wundef -pedantic -mcpu=cortex-a53 -Wno-error=cast-align -Os -g3 -fpie -mthumb -mthumb-interwork -fno-short-enums -fno-common -mno-unaligned-access -mfloat-abi=hard -funsafe-math-optimizations -funwind-tables -MD -MF ./.CryptoVerifyTaHandle.o.d -MT CryptoVerifyTaHandle.o -nostdinc -isystem /usr/lib/gcc-cross/arm-linux-gnueabihf/11/include -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=CryptoVerifyTaHandle_c -c CryptoVerifyTaHandle.c -o CryptoVerifyTaHandle.o
arm-linux-gnueabihf-objcopy --rename-section .rodata=.rodata.CryptoVerifyTaHandle.c --rename-section .rodata.str1.1=.rodata.str1.1.CryptoVerifyTaHandle.c ./CryptoVerifyTaHandle.o
arm-linux-gnueabihf-gcc -std=gnu99 -fdiagnostics-show-option -Wall -Wcast-align -Werror-implicit-function-declaration -Wextra -Wfloat-equal -Wformat-nonliteral -Wformat-security -Wformat=2 -Winit-self -Wmissing-declarations -Wmissing-format-attribute -Wmissing-include-dirs -Wmissing-noreturn -Wmissing-prototypes -Wnested-externs -Wpointer-arith -Wshadow -Wstrict-prototypes -Wswitch-default -Wwrite-strings -Wno-missing-field-initializers -Wno-format-zero-length -Waggregate-return -Wredundant-decls -Wold-style-definition -Wstrict-aliasing=2 -Wundef -pedantic -mcpu=cortex-a53 -Wno-error=cast-align -Os -g3 -fpie -mthumb -mthumb-interwork -fno-short-enums -fno-common -mno-unaligned-access -mfloat-abi=hard -funsafe-math-optimizations -funwind-tables -MD -MF ./.CryptoVerifyTaAes.o.d -MT CryptoVerifyTaAes.o -nostdinc -isystem /usr/lib/gcc-cross/arm-linux-gnueabihf/11/include -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=CryptoVerifyTaAes_c -c CryptoVerifyTaAes.c -o CryptoVerifyTaAes.o
arm-linux-gnueabihf-objcopy --rename-section .rodata=.rodata.CryptoVerifyTaAes.c --rename-section .rodata.str1.1=.rodata.str1.1.CryptoVerifyTaAes.c ./CryptoVerifyTaAes.o
arm-linux-gnueabihf-gcc -std=gnu99 -fdiagnostics-show-option -Wall -Wcast-align -Werror-implicit-function-declaration -Wextra -Wfloat-equal -Wformat-nonliteral -Wformat-security -Wformat=2 -Winit-self -Wmissing-declarations -Wmissing-format-attribute -Wmissing-include-dirs -Wmissing-noreturn -Wmissing-prototypes -Wnested-externs -Wpointer-arith -Wshadow -Wstrict-prototypes -Wswitch-default -Wwrite-strings -Wno-missing-field-initializers -Wno-format-zero-length -Waggregate-return -Wredundant-decls -Wold-style-definition -Wstrict-aliasing=2 -Wundef -pedantic -mcpu=cortex-a53 -Wno-error=cast-align -Os -g3 -fpie -mthumb -mthumb-interwork -fno-short-enums -fno-common -mno-unaligned-access -mfloat-abi=hard -funsafe-math-optimizations -funwind-tables -MD -MF ./.CryptoVerifyTaHash.o.d -MT CryptoVerifyTaHash.o -nostdinc -isystem /usr/lib/gcc-cross/arm-linux-gnueabihf/11/include -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=CryptoVerifyTaHash_c -c CryptoVerifyTaHash.c -o CryptoVerifyTaHash.o
arm-linux-gnueabihf-objcopy --rename-section .rodata=.rodata.CryptoVerifyTaHash.c --rename-section .rodata.str1.1=.rodata.str1.1.CryptoVerifyTaHash.c ./CryptoVerifyTaHash.o
arm-linux-gnueabihf-gcc -std=gnu99 -fdiagnostics-show-option -Wall -Wcast-align -Werror-implicit-function-declaration -Wextra -Wfloat-equal -Wformat-nonliteral -Wformat-security -Wformat=2 -Winit-self -Wmissing-declarations -Wmissing-format-attribute -Wmissing-include-dirs -Wmissing-noreturn -Wmissing-prototypes -Wnested-externs -Wpointer-arith -Wshadow -Wstrict-prototypes -Wswitch-default -Wwrite-strings -Wno-missing-field-initializers -Wno-format-zero-length -Waggregate-return -Wredundant-decls -Wold-style-definition -Wstrict-aliasing=2 -Wundef -pedantic -mcpu=cortex-a53 -Wno-error=cast-align -Os -g3 -fpie -mthumb -mthumb-interwork -fno-short-enums -fno-common -mno-unaligned-access -mfloat-abi=hard -funsafe-math-optimizations -funwind-tables -MD -MF ./.CryptoVerifyTaPbkdf2.o.d -MT CryptoVerifyTaPbkdf2.o -nostdinc -isystem /usr/lib/gcc-cross/arm-linux-gnueabihf/11/include -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=CryptoVerifyTaPbkdf2_c -c CryptoVerifyTaPbkdf2.c -o CryptoVerifyTaPbkdf2.o
arm-linux-gnueabihf-objcopy --rename-section .rodata=.rodata.CryptoVerifyTaPbkdf2.c --rename-section .rodata.str1.1=.rodata.str1.1.CryptoVerifyTaPbkdf2.c ./CryptoVerifyTaPbkdf2.o
arm-linux-gnueabihf-gcc -std=gnu99 -fdiagnostics-show-option -Wall -Wcast-align -Werror-implicit-function-declaration -Wextra -Wfloat-equal -Wformat-nonliteral -Wformat-security -Wformat=2 -Winit-self -Wmissing-declarations -Wmissing-format-attribute -Wmissing-include-dirs -Wmissing-noreturn -Wmissing-prototypes -Wnested-externs -Wpointer-arith -Wshadow -Wstrict-prototypes -Wswitch-default -Wwrite-strings -Wno-missing-field-initializers -Wno-format-zero-length -Waggregate-return -Wredundant-decls -Wold-style-definition -Wstrict-aliasing=2 -Wundef -pedantic -mcpu=cortex-a53 -Wno-error=cast-align -Os -g3 -fpie -mthumb -mthumb-interwork -fno-short-enums -fno-common -mno-unaligned-access -mfloat-abi=hard -funsafe-math-optimizations -funwind-tables -MD -MF ./.CryptoVerifyTaDebug.o.d -MT CryptoVerifyTaDebug.o -nostdinc -isystem /usr/lib/gcc-cross/arm-linux-gnueabihf/11/include -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=CryptoVerifyTaDebug_c -c CryptoVerifyTaDebug.c -o CryptoVerifyTaDebug.o
arm-linux-gnueabihf-objcopy --rename-section .rodata=.rodata.CryptoVerifyTaDebug.c --rename-section .rodata.str1.1=.rodata.str1.1.CryptoVerifyTaDebug.c ./CryptoVerifyTaDebug.o
arm-linux-gnueabihf-gcc -std=gnu99 -fdiagnostics-show-option -Wall -Wcast-align -Werror-implicit-function-declaration -Wextra -Wfloat-equal -Wformat-nonliteral -Wformat-security -Wformat=2 -Winit-self -Wmissing-declarations -Wmissing-format-attribute -Wmissing-include-dirs -Wmissing-noreturn -Wmissing-prototypes -Wnested-externs -Wpointer-arith -Wshadow -Wstrict-prototypes -Wswitch-default -Wwrite-strings -Wno-missing-field-initializers -Wno-format-zero-length -Waggregate-return -Wredundant-decls -Wold-style-definition -Wstrict-aliasing=2 -Wundef -pedantic -mcpu=cortex-a53 -Wno-error=cast-align -Os -g3 -fpie -mthumb -mthumb-interwork -fno-short-enums -fno-common -mno-unaligned-access -mfloat-abi=hard -funsafe-math-optimizations -funwind-tables -MD -MF ./.CryptoVerifyTaOther.o.d -MT CryptoVerifyTaOther.o -nostdinc -isystem /usr/lib/gcc-cross/arm-linux-gnueabihf/11/include -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=CryptoVerifyTaOther_c -c CryptoVerifyTaOther.c -o CryptoVerifyTaOther.o
arm-linux-gnueabihf-objcopy --rename-section .rodata=.rodata.CryptoVerifyTaOther.c --rename-section .rodata.str1.1=.rodata.str1.1.CryptoVerifyTaOther.c ./CryptoVerifyTaOther.o
arm-linux-gnueabihf-gcc -std=gnu99 -fdiagnostics-show-option -Wall -Wcast-align -Werror-implicit-function-declaration -Wextra -Wfloat-equal -Wformat-nonliteral -Wformat-security -Wformat=2 -Winit-self -Wmissing-declarations -Wmissing-format-attribute -Wmissing-include-dirs -Wmissing-noreturn -Wmissing-prototypes -Wnested-externs -Wpointer-arith -Wshadow -Wstrict-prototypes -Wswitch-default -Wwrite-strings -Wno-missing-field-initializers -Wno-format-zero-length -Waggregate-return -Wredundant-decls -Wold-style-definition -Wstrict-aliasing=2 -Wundef -pedantic -mcpu=cortex-a53 -Wno-error=cast-align -Os -g3 -fpie -mthumb -mthumb-interwork -fno-short-enums -fno-common -mno-unaligned-access -mfloat-abi=hard -funsafe-math-optimizations -funwind-tables -MD -MF ./.CryptoVerifyTaRsa.o.d -MT CryptoVerifyTaRsa.o -nostdinc -isystem /usr/lib/gcc-cross/arm-linux-gnueabihf/11/include -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=CryptoVerifyTaRsa_c -c CryptoVerifyTaRsa.c -o CryptoVerifyTaRsa.o
arm-linux-gnueabihf-objcopy --rename-section .rodata=.rodata.CryptoVerifyTaRsa.c --rename-section .rodata.str1.1=.rodata.str1.1.CryptoVerifyTaRsa.c ./CryptoVerifyTaRsa.o
arm-linux-gnueabihf-gcc -std=gnu99 -fdiagnostics-show-option -Wall -Wcast-align -Werror-implicit-function-declaration -Wextra -Wfloat-equal -Wformat-nonliteral -Wformat-security -Wformat=2 -Winit-self -Wmissing-declarations -Wmissing-format-attribute -Wmissing-include-dirs -Wmissing-noreturn -Wmissing-prototypes -Wnested-externs -Wpointer-arith -Wshadow -Wstrict-prototypes -Wswitch-default -Wwrite-strings -Wno-missing-field-initializers -Wno-format-zero-length -Waggregate-return -Wredundant-decls -Wold-style-definition -Wstrict-aliasing=2 -Wundef -pedantic -mcpu=cortex-a53 -Wno-error=cast-align -Os -g3 -fpie -mthumb -mthumb-interwork -fno-short-enums -fno-common -mno-unaligned-access -mfloat-abi=hard -funsafe-math-optimizations -funwind-tables -MD -MF ./.user_ta_header.o.d -MT user_ta_header.o -nostdinc -isystem /usr/lib/gcc-cross/arm-linux-gnueabihf/11/include -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=user_ta_header_c -c /workspace/optee_os/out/arm/export-ta_arm32/src/user_ta_header.c -o user_ta_header.o
arm-linux-gnueabihf-objcopy --rename-section .rodata=.rodata.user_ta_header.c --rename-section .rodata.str1.1=.rodata.str1.1.user_ta_header.c ./user_ta_header.o
mkdir -p ./
arm-linux-gnueabihf-cpp -Wp,-P,-MT,ta.lds,-MD,./.ta.ld.d -DASM=1 -nostdinc -isystem /usr/lib/gcc-cross/arm-linux-gnueabihf/11/include -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL='4' -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 /workspace/optee_os/out/arm/export-ta_arm32/src/ta.ld.S > ta.lds
arm-linux-gnueabihf-ld.bfd -pie -T ./ta.lds -Map=./ebb6f4b5-7e33-4ad2-9802-e64f2a7cc20c.map --sort-section=alignment ./CryptoVerifyTaEntry.o ./CryptoVerifyTaHandle.o ./CryptoVerifyTaAes.o ./CryptoVerifyTaHash.o ./CryptoVerifyTaPbkdf2.o ./CryptoVerifyTaDebug.o ./CryptoVerifyTaOther.o ./CryptoVerifyTaRsa.o ./user_ta_header.o  -L/workspace/optee_os/out/arm/export-ta_arm32/lib --start-group -lutils -lutee -lmbedtls --end-group -o ebb6f4b5-7e33-4ad2-9802-e64f2a7cc20c.elf
arm-linux-gnueabihf-objdump -l -x -d ebb6f4b5-7e33-4ad2-9802-e64f2a7cc20c.elf > ebb6f4b5-7e33-4ad2-9802-e64f2a7cc20c.dmp
arm-linux-gnueabihf-objcopy --strip-unneeded ebb6f4b5-7e33-4ad2-9802-e64f2a7cc20c.elf ebb6f4b5-7e33-4ad2-9802-e64f2a7cc20c.stripped.elf
/workspace/optee_os/out/arm/export-ta_arm32/scripts/sign.py --key /workspace/optee_os/out/arm/export-ta_arm32/keys/default_ta.pem --uuid ebb6f4b5-7e33-4ad2-9802-e64f2a7cc20c --version 0 --in ebb6f4b5-7e33-4ad2-9802-e64f2a7cc20c.stripped.elf --out ebb6f4b5-7e33-4ad2-9802-e64f2a7cc20c.ta
make: Leaving directory '/workspace/benchmark/basicAlg_use/ta'

[DEBUG] Report command: /usr/bin/python3 /workspace/src/report/generate_report.py --sinks /workspace/benchmark/bad-partitioning/ta/results/ta_sinks.json --flows /workspace/benchmark/bad-partitioning/ta/results/ta_candidate_flows.json --vulnerabilities /workspace/benchmark/bad-partitioning/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/bad-partitioning/ta/results/ta_phase12.json --project-name bad-partitioning --output /workspace/benchmark/bad-partitioning/ta/results/ta_vulnerability_report.html
[phase6_command] → python3 /workspace/src/report/generate_report.py /workspace/src/report/generate_report.py --sinks /workspace/benchmark/bad-partitioning/ta/results/ta_sinks.json --flows /workspace/benchmark/bad-partitioning/ta/results/ta_candidate_flows.json --vulnerabilities /workspace/benchmark/bad-partitioning/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/bad-partitioning/ta/results/ta_phase12.json --project-name bad-partitioning --output /workspace/benchmark/bad-partitioning/ta/results/ta_vulnerability_report.html
[INFO] $ /usr/bin/python3 /workspace/src/report/generate_report.py --sinks /workspace/benchmark/bad-partitioning/ta/results/ta_sinks.json --flows /workspace/benchmark/bad-partitioning/ta/results/ta_candidate_flows.json --vulnerabilities /workspace/benchmark/bad-partitioning/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/bad-partitioning/ta/results/ta_phase12.json --project-name bad-partitioning --output /workspace/benchmark/bad-partitioning/ta/results/ta_vulnerability_report.html  (cwd=/workspace/benchmark/bad-partitioning/ta)
[STDOUT] [INFO] conversations.jsonl から会話履歴を読み込みます: /workspace/benchmark/bad-partitioning/ta/results/conversations.jsonl
[INFO] 読み込み完了: 14 フロー, 78 会話
[INFO] 解析カバレッジ: 14/14 チェーン (100.0%)
[generate_report] HTMLレポートを生成しました: /workspace/benchmark/bad-partitioning/ta/results/ta_vulnerability_report.html
  検出脆弱性数: 18
  Structural Risks: 0
  会話履歴: conversations.jsonl を使用

[phase6 ] → /workspace/benchmark/bad-partitioning/ta/results/ta_vulnerability_report.html

[SUCCESS] All phases completed successfully for bad-partitioning
[INFO] Execution time recorded in: /workspace/benchmark/bad-partitioning/ta/results/time.txt
[INFO] Total execution time: 9m 56.65s

=== Project: basicAlg_use / TA: ta ===
[INFO] Analysis mode: Hybrid (DITING rules only) (excluding debug macros)
[INFO] Token tracking is enabled
[INFO] Debug macros will be excluded from analysis
[INFO] Cleaning dependencies for basicAlg_use
  - Removed stale dependency: ta/.CryptoVerifyTaHandle.o.d
  - Removed stale dependency: ta/.CryptoVerifyTaEntry.o.d
  - Removed stale dependency: ta/.CryptoVerifyTaOther.o.d
  - Removed stale dependency: ta/.user_ta_header.o.d
  - Removed stale dependency: ta/.CryptoVerifyTaAes.o.d
  - Removed stale dependency: ta/.CryptoVerifyTaRsa.o.d
  - Removed stale dependency: ta/.CryptoVerifyTaPbkdf2.o.d
  - Removed stale dependency: ta/.CryptoVerifyTaDebug.o.d
  - Removed stale dependency: ta/.CryptoVerifyTaHash.o.d
  - Executed 'make clean' in .
  - Executed 'make clean' in ta
  - Executed 'make clean' in host
  ✓ Cleaned 21 files
[INFO] $ bear -- make  (cwd=/workspace/benchmark/basicAlg_use)
[WARN]   ↳ rc=2
[INFO] $ bear -- make -C ta V=1  (cwd=/workspace/benchmark/basicAlg_use)
[INFO] TA DB saved: /workspace/benchmark/basicAlg_use/ta/compile_commands.json  entries=8
[DEBUG] Include paths:
  ✓ /workspace/benchmark/basicAlg_use/ta
  ✓ /workspace/benchmark/basicAlg_use/ta/include
  ✗ ./include
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaEntry.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=CryptoVerifyTaEntry_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaHandle.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=CryptoVerifyTaHandle_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaAes.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=CryptoVerifyTaAes_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaHash.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=CryptoVerifyTaHash_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaPbkdf2.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=CryptoVerifyTaPbkdf2_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaDebug.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=CryptoVerifyTaDebug_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaOther.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=CryptoVerifyTaOther_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaRsa.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=CryptoVerifyTaRsa_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
  [INFO] Skipping declaration of user-defined function: g_CryptoTaHandle_Random
  [INFO] Skipping declaration of user-defined function: g_CryptoTaHandle_Sha
  [INFO] Skipping declaration of user-defined function: g_CryptoTaHandle_Aes
  [INFO] Skipping declaration of user-defined function: g_CryptoTaHandle_Rsa
  [INFO] Skipping declaration of user-defined function: g_CryptoTaHandle_Pbkdf
  [INFO] Skipping declaration of user-defined function: g_CryptoTaHandle_hmac
  [INFO] Skipping declaration of user-defined function: g_CryptoTaHandle_base64
  [INFO] Skipping declaration of user-defined function: g_CryptoTaRsa_rsaEncOper
  [INFO] Skipping declaration of user-defined function: g_CryptoTaRsa_rsaDecOper
  [INFO] Skipping declaration of user-defined function: g_CryptoTaRsa_rsaSignOper
  [INFO] Skipping declaration of user-defined function: g_CryptoTaRsa_rsaVerifyOper
  [INFO] Skipping declaration of user-defined function: g_CryptoTaAes_AesOper
  [INFO] Skipping declaration of user-defined function: g_TA_Printf
  [INFO] Skipping declaration of user-defined function: g_CryptoTaHash_sha
  [INFO] Skipping declaration of user-defined function: g_CryptoTaHash_hmac
  [INFO] Skipping declaration of user-defined function: g_CryptoTaOther_Random
  [INFO] Skipping declaration of user-defined function: g_CryptoTaOther_base64
  [INFO] Skipping declaration of user-defined function: g_CryptoTaPbkdf_PBKDF2
  [INFO] Skipping declaration of user-defined function: g_CryptoTaRsa_rsaEncOper
  [INFO] Skipping declaration of user-defined function: g_CryptoTaRsa_rsaDecOper
  [INFO] Skipping declaration of user-defined function: g_CryptoTaRsa_rsaSignOper
  [INFO] Skipping declaration of user-defined function: g_CryptoTaRsa_rsaVerifyOper
  [INFO] Skipping declaration of user-defined function: g_CryptoTaHandle_Random
  [INFO] Skipping declaration of user-defined function: g_CryptoTaHandle_Sha
  [INFO] Skipping declaration of user-defined function: g_CryptoTaHandle_hmac
  [INFO] Skipping declaration of user-defined function: g_CryptoTaHandle_Aes
  [INFO] Skipping declaration of user-defined function: g_CryptoTaHandle_Pbkdf
  [INFO] Skipping declaration of user-defined function: g_CryptoTaHandle_Rsa
  [INFO] Skipping declaration of user-defined function: g_CryptoTaHandle_base64
  [INFO] Skipping declaration of user-defined function: g_TA_Printf
  [INFO] Skipping declaration of user-defined function: g_CryptoTaAes_AesOper
  [INFO] Skipping declaration of user-defined function: g_TA_Printf
  [INFO] Skipping declaration of user-defined function: g_CryptoTaHash_sha
  [INFO] Skipping declaration of user-defined function: g_CryptoTaHash_hmac
  [INFO] Skipping declaration of user-defined function: g_CryptoTaPbkdf_PBKDF2
  [INFO] Skipping declaration of user-defined function: g_TA_Printf
  [INFO] Skipping declaration of user-defined function: g_CryptoTaOther_Random
  [INFO] Skipping declaration of user-defined function: g_CryptoTaOther_base64
  [INFO] Skipping declaration of user-defined function: g_CryptoTaRsa_rsaEncOper
  [INFO] Skipping declaration of user-defined function: g_CryptoTaRsa_rsaDecOper
  [INFO] Skipping declaration of user-defined function: g_CryptoTaRsa_rsaSignOper
  [INFO] Skipping declaration of user-defined function: g_CryptoTaRsa_rsaVerifyOper
[phase1-2] → /workspace/benchmark/basicAlg_use/ta/results/ta_phase12.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/identify_sinks.py -i /workspace/benchmark/basicAlg_use/ta/results/ta_phase12.json -o /workspace/benchmark/basicAlg_use/ta/results/ta_sinks.json --llm-only --no-rag  (cwd=/workspace/benchmark/basicAlg_use/ta)
[STDOUT] [WARN] TokenTrackingClient not available. Token tracking disabled.
[INFO] LLM retry handler initialized (max retries: 3)
[INFO] LLM logs will be saved to: /workspace/benchmark/basicAlg_use/ta/results/llm_logs
使用中のLLMプロバイダー: openai
呼び出し済み外部 API を抽出中...
外部 API 関数: 22 個
外部 API 関数をシンクとして解析中（LLMのみ）...
  Analyzing TEE_AllocateOperation with LLM...
[DEBUG] LLM call attempt 1/3
  → Not a sink: TEE_AllocateOperation (is_sink_candidate=False)
  Analyzing TEE_AllocateTransientObject with LLM...
[DEBUG] LLM call attempt 1/3
  → Not a sink: TEE_AllocateTransientObject (is_sink_candidate=False)
  Analyzing TEE_AsymmetricDecrypt with LLM...
[DEBUG] LLM call attempt 1/3
  → Sink identified: TEE_AsymmetricDecrypt with 2 dangerous params: [0, 2]
  Analyzing TEE_AsymmetricEncrypt with LLM...
[DEBUG] LLM call attempt 1/3
  → Not a sink: TEE_AsymmetricEncrypt (is_sink_candidate=False)
  Analyzing TEE_AsymmetricSignDigest with LLM...
[DEBUG] LLM call attempt 1/3
  → Sink identified: TEE_AsymmetricSignDigest with 1 dangerous params: [3]
  Analyzing TEE_AsymmetricVerifyDigest with LLM...
[DEBUG] LLM call attempt 1/3
  → Not a sink: TEE_AsymmetricVerifyDigest (is_sink_candidate=False)
  Analyzing TEE_CipherDoFinal with LLM...
[DEBUG] LLM call attempt 1/3
  → Sink identified: TEE_CipherDoFinal with 1 dangerous params: [0]
  Analyzing TEE_CipherInit with LLM...
[DEBUG] LLM call attempt 1/3
  → Not a sink: TEE_CipherInit (is_sink_candidate=False)
  Analyzing TEE_CipherUpdate with LLM...
[DEBUG] LLM call attempt 1/3
  → Not a sink: TEE_CipherUpdate (is_sink_candidate=False)
  Analyzing TEE_DeriveKey with LLM...
[DEBUG] LLM call attempt 1/3
  → Sink identified: TEE_DeriveKey with 1 dangerous params: [1]
  Analyzing TEE_DigestDoFinal with LLM...
[DEBUG] LLM call attempt 1/3
  → Sink identified: TEE_DigestDoFinal with 1 dangerous params: [3]
  Analyzing TEE_DigestUpdate with LLM...
[DEBUG] LLM call attempt 1/3
  → Not a sink: TEE_DigestUpdate (is_sink_candidate=False)
  Analyzing TEE_FreeOperation with LLM...
[DEBUG] LLM call attempt 1/3
  → Not a sink: TEE_FreeOperation (is_sink_candidate=False)
  Analyzing TEE_FreeTransientObject with LLM...
[DEBUG] LLM call attempt 1/3
  → Not a sink: TEE_FreeTransientObject (is_sink_candidate=False)
  Analyzing TEE_GenerateRandom with LLM...
[DEBUG] LLM call attempt 1/3
  → Sink identified: TEE_GenerateRandom with 2 dangerous params: [0, 1]
  Analyzing TEE_GetObjectBufferAttribute with LLM...
[DEBUG] LLM call attempt 1/3
  → Sink identified: TEE_GetObjectBufferAttribute with 1 dangerous params: [2]
  Analyzing TEE_InitRefAttribute with LLM...
[DEBUG] LLM call attempt 1/3
  → Sink identified: TEE_InitRefAttribute with 1 dangerous params: [0]
  Analyzing TEE_MemFill with LLM...
[DEBUG] LLM call attempt 1/3
  → Sink identified: TEE_MemFill with 2 dangerous params: [0, 1]
  Analyzing TEE_MemMove with LLM...
[DEBUG] LLM call attempt 1/3
  → Sink identified: TEE_MemMove with 1 dangerous params: [0]
  Analyzing TEE_PopulateTransientObject with LLM...
[DEBUG] LLM call attempt 1/3
  → Not a sink: TEE_PopulateTransientObject (is_sink_candidate=False)
  Analyzing TEE_SetOperationKey with LLM...
[DEBUG] LLM call attempt 1/3
  → Not a sink: TEE_SetOperationKey (is_sink_candidate=False)
  Analyzing UNUSED with LLM...
[DEBUG] LLM call attempt 1/3
  → Not a sink: UNUSED (is_sink_candidate=False)

抽出されたシンク候補: 13 個
全関数の解析時間: 1.42分
  - LLM解析時間: 1.42分
結果を /workspace/benchmark/basicAlg_use/ta/results/ta_sinks.json に保存しました

[phase3 ] → /workspace/benchmark/basicAlg_use/ta/results/ta_sinks.json

[phase4 ] Integrated candidate flow generation
          → generate_candidate_flows.py --compile-db compile_commands.json --sinks ta_sinks.json --phase12 ta_phase12.json --sources ... --output ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_flows/generate_candidate_flows.py --compile-db /workspace/benchmark/basicAlg_use/ta/compile_commands.json --sinks /workspace/benchmark/basicAlg_use/ta/results/ta_sinks.json --phase12 /workspace/benchmark/basicAlg_use/ta/results/ta_phase12.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/basicAlg_use/ta/results/ta_candidate_flows.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --verbose  (cwd=/workspace/benchmark/basicAlg_use/ta)
[STDOUT] [INFO] Loaded 13 sink functions
[INFO] Source functions: ['TA_InvokeCommandEntryPoint', 'TA_OpenSessionEntryPoint']
[ClangUtils] Loaded 8 compile entries
[SinkDetector] Tracking 10 sink functions
  Active sinks: {'TEE_AsymmetricDecrypt', 'TEE_MemMove', 'TEE_GenerateRandom', 'TEE_InitRefAttribute', 'TEE_CipherDoFinal', 'TEE_DeriveKey', 'TEE_MemFill', 'TEE_DigestDoFinal', 'TEE_GetObjectBufferAttribute', 'TEE_AsymmetricSignDigest'}
  Identified 83 macros from phase12
[Phase 4] Starting integrated candidate flow generation...
[Step 1] Parsing source files...
  Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaEntry.c...
  [WARN] 3 errors in /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaEntry.c
  Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaHandle.c...
  [WARN] 3 errors in /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaHandle.c
  Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaAes.c...
  [WARN] 3 errors in /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaAes.c
  Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaHash.c...
  [WARN] 3 errors in /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaHash.c
  Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaPbkdf2.c...
  [WARN] 3 errors in /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaPbkdf2.c
  Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaDebug.c...
  [WARN] 3 errors in /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaDebug.c
  Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaOther.c...
  [WARN] 3 errors in /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaOther.c
  Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaRsa.c...
  [WARN] 3 errors in /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaRsa.c
[Step 2] Building call graph...
[CallGraphBuilder] Building call graph...
  Found 34 function definitions
  Found 219 unique call edges
[Step 3] Detecting sink calls...
  Scanning /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaEntry.c...
    Entering function: TA_CreateEntryPoint
    Entering function: TA_OpenSessionEntryPoint
    Entering function: TA_CloseSessionEntryPoint
    Entering function: TA_DestroyEntryPoint
    Entering function: TA_InvokeCommandEntryPoint
  Scanning /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaHandle.c...
    Entering function: l_CryptoTaHandle_SetAes128Key
    Entering function: l_CryptoTaHandle_SetAesAction
    Entering function: l_CryptoTaHandle_SetRsa1024Key
    Entering function: l_CryptoTaHandle_SetRsa2048Key
    Entering function: g_CryptoTaHandle_Random
    Entering function: g_CryptoTaHandle_Sha
    Entering function: g_CryptoTaHandle_hmac
    Entering function: g_CryptoTaHandle_Aes
      -> Detected sink: TEE_MemMove at line 396 in g_CryptoTaHandle_Aes
    Entering function: g_CryptoTaHandle_Pbkdf
    Entering function: g_CryptoTaHandle_Rsa
    Entering function: g_CryptoTaHandle_base64
    Found 1 sink calls
      - TEE_MemMove at line 396 in g_CryptoTaHandle_Aes
  Scanning /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaAes.c...
    Entering function: g_CryptoTaAes_AesOper
      -> Detected sink: TEE_InitRefAttribute at line 140 in g_CryptoTaAes_AesOper
      -> Detected sink: TEE_CipherDoFinal at line 199 in g_CryptoTaAes_AesOper
    Found 2 sink calls
      - TEE_InitRefAttribute at line 140 in g_CryptoTaAes_AesOper
      - TEE_CipherDoFinal at line 199 in g_CryptoTaAes_AesOper
  Scanning /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaHash.c...
    Entering function: g_CryptoTaHash_sha
      -> Detected sink: TEE_DigestDoFinal at line 133 in g_CryptoTaHash_sha
    Entering function: g_CryptoTaHash_hmac
      -> Detected sink: TEE_DeriveKey at line 251 in g_CryptoTaHash_hmac
      -> Detected sink: TEE_GetObjectBufferAttribute at line 253 in g_CryptoTaHash_hmac
    Found 3 sink calls
      - TEE_DigestDoFinal at line 133 in g_CryptoTaHash_sha
      - TEE_DeriveKey at line 251 in g_CryptoTaHash_hmac
      - TEE_GetObjectBufferAttribute at line 253 in g_CryptoTaHash_hmac
  Scanning /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaPbkdf2.c...
    Entering function: l_CryptoTaPbkdf_HMAC
      -> Detected sink: TEE_MemMove at line 110 in l_CryptoTaPbkdf_HMAC
      -> Detected sink: TEE_MemMove at line 114 in l_CryptoTaPbkdf_HMAC
      -> Detected sink: TEE_MemMove at line 156 in l_CryptoTaPbkdf_HMAC
    Entering function: g_CryptoTaPbkdf_PBKDF2
      -> Detected sink: TEE_MemFill at line 229 in g_CryptoTaPbkdf_PBKDF2
      -> Detected sink: TEE_MemMove at line 230 in g_CryptoTaPbkdf_PBKDF2
      -> Detected sink: TEE_MemFill at line 240 in g_CryptoTaPbkdf_PBKDF2
      -> Detected sink: TEE_MemMove at line 241 in g_CryptoTaPbkdf_PBKDF2
      -> Detected sink: TEE_MemMove at line 264 in g_CryptoTaPbkdf_PBKDF2
    Found 10 sink calls
      - TEE_MemMove at line 110 in l_CryptoTaPbkdf_HMAC
      - TEE_MemMove at line 114 in l_CryptoTaPbkdf_HMAC
      - TEE_MemMove at line 156 in l_CryptoTaPbkdf_HMAC
      - TEE_MemFill at line 229 in g_CryptoTaPbkdf_PBKDF2
      - TEE_MemFill at line 229 in g_CryptoTaPbkdf_PBKDF2
      - TEE_MemMove at line 230 in g_CryptoTaPbkdf_PBKDF2
      - TEE_MemFill at line 240 in g_CryptoTaPbkdf_PBKDF2
      - TEE_MemFill at line 240 in g_CryptoTaPbkdf_PBKDF2
      - TEE_MemMove at line 241 in g_CryptoTaPbkdf_PBKDF2
      - TEE_MemMove at line 264 in g_CryptoTaPbkdf_PBKDF2
  Scanning /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaDebug.c...
    Entering function: g_TA_Printf
  Scanning /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaOther.c...
    Entering function: g_CryptoTaOther_Random
      -> Detected sink: TEE_GenerateRandom at line 120 in g_CryptoTaOther_Random
    Entering function: l_DeviceIdTaBase64_encode
    Entering function: l_DeviceIdTaBase64_decode
    Entering function: g_CryptoTaOther_base64
    Found 2 sink calls
      - TEE_GenerateRandom at line 120 in g_CryptoTaOther_Random
      - TEE_GenerateRandom at line 120 in g_CryptoTaOther_Random
  Scanning /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaRsa.c...
    Entering function: l_CryptoTaRsa_CleanUpKeyPairObj
    Entering function: l_CryptoTaRsa_CleanUpPublicHandle
    Entering function: l_CryptoTaRsa_SetRsaPrivateKey
      -> Detected sink: TEE_MemFill at line 152 in l_CryptoTaRsa_SetRsaPrivateKey
    Entering function: l_CryptoTaRsa_SetRsaPublicKey
      -> Detected sink: TEE_MemFill at line 210 in l_CryptoTaRsa_SetRsaPublicKey
    Entering function: g_CryptoTaRsa_rsaEncOper
    Entering function: g_CryptoTaRsa_rsaDecOper
      -> Detected sink: TEE_AsymmetricDecrypt at line 345 in g_CryptoTaRsa_rsaDecOper
    Entering function: g_CryptoTaRsa_rsaSignOper
      -> Detected sink: TEE_AsymmetricSignDigest at line 415 in g_CryptoTaRsa_rsaSignOper
    Entering function: g_CryptoTaRsa_rsaVerifyOper
      -> Detected sink: TEE_MemMove at line 490 in g_CryptoTaRsa_rsaVerifyOper
      -> Detected sink: TEE_MemMove at line 498 in g_CryptoTaRsa_rsaVerifyOper
    Found 9 sink calls
      - TEE_MemFill at line 152 in l_CryptoTaRsa_SetRsaPrivateKey
      - TEE_MemFill at line 152 in l_CryptoTaRsa_SetRsaPrivateKey
      - TEE_MemFill at line 210 in l_CryptoTaRsa_SetRsaPublicKey
      - TEE_MemFill at line 210 in l_CryptoTaRsa_SetRsaPublicKey
      - TEE_AsymmetricDecrypt at line 345 in g_CryptoTaRsa_rsaDecOper
      - TEE_AsymmetricDecrypt at line 345 in g_CryptoTaRsa_rsaDecOper
      - TEE_AsymmetricSignDigest at line 415 in g_CryptoTaRsa_rsaSignOper
      - TEE_MemMove at line 490 in g_CryptoTaRsa_rsaVerifyOper
      - TEE_MemMove at line 498 in g_CryptoTaRsa_rsaVerifyOper
[SinkDetector] Found 27 unique sink calls
  Sink call breakdown:
    - TEE_MemMove (function): 9 calls
    - TEE_InitRefAttribute (function): 1 calls
    - TEE_CipherDoFinal (function): 1 calls
    - TEE_DigestDoFinal (function): 1 calls
    - TEE_DeriveKey (function): 1 calls
    - TEE_GetObjectBufferAttribute (function): 1 calls
    - TEE_MemFill (function): 8 calls
    - TEE_GenerateRandom (function): 2 calls
    - TEE_AsymmetricDecrypt (function): 2 calls
    - TEE_AsymmetricSignDigest (function): 1 calls
  Total: 27 function calls, 0 macro calls

  Calls by containing function:
    g_CryptoTaHandle_Aes: TEE_MemMove@396
    g_CryptoTaAes_AesOper: TEE_InitRefAttribute@140, TEE_CipherDoFinal@199
    g_CryptoTaHash_sha: TEE_DigestDoFinal@133
    g_CryptoTaHash_hmac: TEE_DeriveKey@251, TEE_GetObjectBufferAttribute@253
    l_CryptoTaPbkdf_HMAC: TEE_MemMove@110, TEE_MemMove@114, TEE_MemMove@156
    g_CryptoTaPbkdf_PBKDF2: TEE_MemFill@229, TEE_MemFill@229, TEE_MemMove@230, TEE_MemFill@240, TEE_MemFill@240, TEE_MemMove@241, TEE_MemMove@264
    g_CryptoTaOther_Random: TEE_GenerateRandom@120, TEE_GenerateRandom@120
    l_CryptoTaRsa_SetRsaPrivateKey: TEE_MemFill@152, TEE_MemFill@152
    l_CryptoTaRsa_SetRsaPublicKey: TEE_MemFill@210, TEE_MemFill@210
    g_CryptoTaRsa_rsaDecOper: TEE_AsymmetricDecrypt@345, TEE_AsymmetricDecrypt@345
    g_CryptoTaRsa_rsaSignOper: TEE_AsymmetricSignDigest@415
    g_CryptoTaRsa_rsaVerifyOper: TEE_MemMove@490, TEE_MemMove@498
[Step 4] Tracing call chains...
[ChainTracer] Processing TEE_MemMove at line 396 in g_CryptoTaHandle_Aes
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes
  Found 1 paths
[ChainTracer] Processing TEE_InitRefAttribute at line 140 in g_CryptoTaAes_AesOper
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper
  Found 1 paths
[ChainTracer] Processing TEE_CipherDoFinal at line 199 in g_CryptoTaAes_AesOper
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper
  Found 1 paths
[ChainTracer] Processing TEE_DigestDoFinal at line 133 in g_CryptoTaHash_sha
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Sha -> g_CryptoTaHash_sha
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC -> g_CryptoTaHash_sha
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC -> g_CryptoTaHash_sha
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC -> g_CryptoTaHash_sha
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC -> g_CryptoTaHash_sha
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> g_CryptoTaHash_sha
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> g_CryptoTaHash_sha
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> g_CryptoTaHash_sha
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> g_CryptoTaHash_sha
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> g_CryptoTaHash_sha
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> g_CryptoTaHash_sha
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> g_CryptoTaHash_sha
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> g_CryptoTaHash_sha
  Found 13 paths
[ChainTracer] Processing TEE_DeriveKey at line 251 in g_CryptoTaHash_hmac
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_hmac -> g_CryptoTaHash_hmac
  Found 1 paths
[ChainTracer] Processing TEE_GetObjectBufferAttribute at line 253 in g_CryptoTaHash_hmac
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_hmac -> g_CryptoTaHash_hmac
  Found 1 paths
[ChainTracer] Processing TEE_MemMove at line 110 in l_CryptoTaPbkdf_HMAC
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC
  Found 2 paths
[ChainTracer] Processing TEE_MemMove at line 114 in l_CryptoTaPbkdf_HMAC
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC
  Found 2 paths
[ChainTracer] Processing TEE_MemMove at line 156 in l_CryptoTaPbkdf_HMAC
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC
  Found 2 paths
[ChainTracer] Processing TEE_MemFill at line 229 in g_CryptoTaPbkdf_PBKDF2
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2
  Found 1 paths
[ChainTracer] Processing TEE_MemFill at line 229 in g_CryptoTaPbkdf_PBKDF2
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2
  Found 1 paths
[ChainTracer] Processing TEE_MemMove at line 230 in g_CryptoTaPbkdf_PBKDF2
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2
  Found 1 paths
[ChainTracer] Processing TEE_MemFill at line 240 in g_CryptoTaPbkdf_PBKDF2
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2
  Found 1 paths
[ChainTracer] Processing TEE_MemFill at line 240 in g_CryptoTaPbkdf_PBKDF2
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2
  Found 1 paths
[ChainTracer] Processing TEE_MemMove at line 241 in g_CryptoTaPbkdf_PBKDF2
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2
  Found 1 paths
[ChainTracer] Processing TEE_MemMove at line 264 in g_CryptoTaPbkdf_PBKDF2
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2
  Found 1 paths
[ChainTracer] Processing TEE_GenerateRandom at line 120 in g_CryptoTaOther_Random
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Random -> g_CryptoTaOther_Random
  Found 1 paths
[ChainTracer] Processing TEE_GenerateRandom at line 120 in g_CryptoTaOther_Random
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Random -> g_CryptoTaOther_Random
  Found 1 paths
[ChainTracer] Processing TEE_MemFill at line 152 in l_CryptoTaRsa_SetRsaPrivateKey
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper -> l_CryptoTaRsa_SetRsaPrivateKey
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper -> l_CryptoTaRsa_SetRsaPrivateKey
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper -> l_CryptoTaRsa_SetRsaPrivateKey
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper -> l_CryptoTaRsa_SetRsaPrivateKey
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> l_CryptoTaRsa_SetRsaPrivateKey
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> l_CryptoTaRsa_SetRsaPrivateKey
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> l_CryptoTaRsa_SetRsaPrivateKey
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> l_CryptoTaRsa_SetRsaPrivateKey
  Found 8 paths
[ChainTracer] Processing TEE_MemFill at line 152 in l_CryptoTaRsa_SetRsaPrivateKey
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper -> l_CryptoTaRsa_SetRsaPrivateKey
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper -> l_CryptoTaRsa_SetRsaPrivateKey
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper -> l_CryptoTaRsa_SetRsaPrivateKey
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper -> l_CryptoTaRsa_SetRsaPrivateKey
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> l_CryptoTaRsa_SetRsaPrivateKey
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> l_CryptoTaRsa_SetRsaPrivateKey
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> l_CryptoTaRsa_SetRsaPrivateKey
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> l_CryptoTaRsa_SetRsaPrivateKey
  Found 8 paths
[ChainTracer] Processing TEE_MemFill at line 210 in l_CryptoTaRsa_SetRsaPublicKey
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaEncOper -> l_CryptoTaRsa_SetRsaPublicKey
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaEncOper -> l_CryptoTaRsa_SetRsaPublicKey
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaEncOper -> l_CryptoTaRsa_SetRsaPublicKey
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaEncOper -> l_CryptoTaRsa_SetRsaPublicKey
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> l_CryptoTaRsa_SetRsaPublicKey
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> l_CryptoTaRsa_SetRsaPublicKey
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> l_CryptoTaRsa_SetRsaPublicKey
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> l_CryptoTaRsa_SetRsaPublicKey
  Found 8 paths
[ChainTracer] Processing TEE_MemFill at line 210 in l_CryptoTaRsa_SetRsaPublicKey
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaEncOper -> l_CryptoTaRsa_SetRsaPublicKey
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaEncOper -> l_CryptoTaRsa_SetRsaPublicKey
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaEncOper -> l_CryptoTaRsa_SetRsaPublicKey
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaEncOper -> l_CryptoTaRsa_SetRsaPublicKey
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> l_CryptoTaRsa_SetRsaPublicKey
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> l_CryptoTaRsa_SetRsaPublicKey
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> l_CryptoTaRsa_SetRsaPublicKey
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> l_CryptoTaRsa_SetRsaPublicKey
  Found 8 paths
[ChainTracer] Processing TEE_AsymmetricDecrypt at line 345 in g_CryptoTaRsa_rsaDecOper
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper
  Found 4 paths
[ChainTracer] Processing TEE_AsymmetricDecrypt at line 345 in g_CryptoTaRsa_rsaDecOper
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper
  Found 4 paths
[ChainTracer] Processing TEE_AsymmetricSignDigest at line 415 in g_CryptoTaRsa_rsaSignOper
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper
  Found 4 paths
[ChainTracer] Processing TEE_MemMove at line 490 in g_CryptoTaRsa_rsaVerifyOper
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper
  Found 4 paths
[ChainTracer] Processing TEE_MemMove at line 498 in g_CryptoTaRsa_rsaVerifyOper
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper
    Path found: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper
  Found 4 paths
[Step 5] Optimizing flows...
[FlowOptimizer] Optimizing 34 flows...
  Initial flows:
    - TEE_MemMove@396 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> TEE_MemMove
    - TEE_InitRefAttribute@140 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper -> TEE_InitRefAttribute
    - TEE_CipherDoFinal@199 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper -> TEE_CipherDoFinal
    - TEE_DigestDoFinal@133 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Sha -> g_CryptoTaHash_sha -> TEE_DigestDoFinal
    - TEE_DigestDoFinal@133 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC -> g_CryptoTaHash_sha -> TEE_DigestDoFinal
    - TEE_DigestDoFinal@133 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> g_CryptoTaHash_sha -> TEE_DigestDoFinal
    - TEE_DigestDoFinal@133 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> g_CryptoTaHash_sha -> TEE_DigestDoFinal
    - TEE_DeriveKey@251 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_hmac -> g_CryptoTaHash_hmac -> TEE_DeriveKey
    - TEE_GetObjectBufferAttribute@253 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_hmac -> g_CryptoTaHash_hmac -> TEE_GetObjectBufferAttribute
    - TEE_MemMove@110 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC -> TEE_MemMove
    - TEE_MemMove@114 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC -> TEE_MemMove
    - TEE_MemMove@156 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC -> TEE_MemMove
    - TEE_MemFill@229 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> TEE_MemFill
    - TEE_MemFill@229 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> TEE_MemFill
    - TEE_MemMove@230 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> TEE_MemMove
    - TEE_MemFill@240 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> TEE_MemFill
    - TEE_MemFill@240 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> TEE_MemFill
    - TEE_MemMove@241 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> TEE_MemMove
    - TEE_MemMove@264 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> TEE_MemMove
    - TEE_GenerateRandom@120 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Random -> g_CryptoTaOther_Random -> TEE_GenerateRandom
    - TEE_GenerateRandom@120 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Random -> g_CryptoTaOther_Random -> TEE_GenerateRandom
    - TEE_MemFill@152 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper -> l_CryptoTaRsa_SetRsaPrivateKey -> TEE_MemFill
    - TEE_MemFill@152 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> l_CryptoTaRsa_SetRsaPrivateKey -> TEE_MemFill
    - TEE_MemFill@152 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper -> l_CryptoTaRsa_SetRsaPrivateKey -> TEE_MemFill
    - TEE_MemFill@152 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> l_CryptoTaRsa_SetRsaPrivateKey -> TEE_MemFill
    - TEE_MemFill@210 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaEncOper -> l_CryptoTaRsa_SetRsaPublicKey -> TEE_MemFill
    - TEE_MemFill@210 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> l_CryptoTaRsa_SetRsaPublicKey -> TEE_MemFill
    - TEE_MemFill@210 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaEncOper -> l_CryptoTaRsa_SetRsaPublicKey -> TEE_MemFill
    - TEE_MemFill@210 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> l_CryptoTaRsa_SetRsaPublicKey -> TEE_MemFill
    - TEE_AsymmetricDecrypt@345 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper -> TEE_AsymmetricDecrypt
    - TEE_AsymmetricDecrypt@345 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper -> TEE_AsymmetricDecrypt
    - TEE_AsymmetricSignDigest@415 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> TEE_AsymmetricSignDigest
    - TEE_MemMove@490 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> TEE_MemMove
    - TEE_MemMove@498 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> TEE_MemMove
  Merged param_indices [0, 1] for TEE_MemFill at line 229
  Merged param_indices [0, 1] for TEE_MemFill at line 240
  Merged param_indices [0, 1] for TEE_GenerateRandom at line 120
  Merged param_indices [0, 1] for TEE_MemFill at line 152
  Merged param_indices [0, 1] for TEE_MemFill at line 152
  Merged param_indices [0, 1] for TEE_MemFill at line 210
  Merged param_indices [0, 1] for TEE_MemFill at line 210
  Merged param_indices [0, 2] for TEE_AsymmetricDecrypt at line 345
  Merging same function sinks...
    Grouping: TEE_MemMove@396 in g_CryptoTaHandle_Aes with chain TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> TEE_MemMove
    Grouping: TEE_InitRefAttribute@140 in g_CryptoTaAes_AesOper with chain TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper -> TEE_InitRefAttribute
    Grouping: TEE_CipherDoFinal@199 in g_CryptoTaAes_AesOper with chain TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper -> TEE_CipherDoFinal
    Grouping: TEE_DigestDoFinal@133 in g_CryptoTaHash_sha with chain TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Sha -> g_CryptoTaHash_sha -> TEE_DigestDoFinal
    Grouping: TEE_DigestDoFinal@133 in g_CryptoTaHash_sha with chain TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC -> g_CryptoTaHash_sha -> TEE_DigestDoFinal
    Grouping: TEE_DigestDoFinal@133 in g_CryptoTaHash_sha with chain TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> g_CryptoTaHash_sha -> TEE_DigestDoFinal
    Grouping: TEE_DigestDoFinal@133 in g_CryptoTaHash_sha with chain TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> g_CryptoTaHash_sha -> TEE_DigestDoFinal
    Grouping: TEE_DeriveKey@251 in g_CryptoTaHash_hmac with chain TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_hmac -> g_CryptoTaHash_hmac -> TEE_DeriveKey
    Grouping: TEE_GetObjectBufferAttribute@253 in g_CryptoTaHash_hmac with chain TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_hmac -> g_CryptoTaHash_hmac -> TEE_GetObjectBufferAttribute
    Grouping: TEE_MemMove@110 in l_CryptoTaPbkdf_HMAC with chain TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC -> TEE_MemMove
    Grouping: TEE_MemMove@114 in l_CryptoTaPbkdf_HMAC with chain TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC -> TEE_MemMove
    Grouping: TEE_MemMove@156 in l_CryptoTaPbkdf_HMAC with chain TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC -> TEE_MemMove
    Grouping: TEE_MemFill@229 in g_CryptoTaPbkdf_PBKDF2 with chain TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> TEE_MemFill
    Grouping: TEE_MemMove@230 in g_CryptoTaPbkdf_PBKDF2 with chain TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> TEE_MemMove
    Grouping: TEE_MemFill@240 in g_CryptoTaPbkdf_PBKDF2 with chain TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> TEE_MemFill
    Grouping: TEE_MemMove@241 in g_CryptoTaPbkdf_PBKDF2 with chain TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> TEE_MemMove
    Grouping: TEE_MemMove@264 in g_CryptoTaPbkdf_PBKDF2 with chain TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> TEE_MemMove
    Grouping: TEE_GenerateRandom@120 in g_CryptoTaOther_Random with chain TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Random -> g_CryptoTaOther_Random -> TEE_GenerateRandom
    Grouping: TEE_MemFill@152 in l_CryptoTaRsa_SetRsaPrivateKey with chain TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper -> l_CryptoTaRsa_SetRsaPrivateKey -> TEE_MemFill
    Grouping: TEE_MemFill@152 in l_CryptoTaRsa_SetRsaPrivateKey with chain TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> l_CryptoTaRsa_SetRsaPrivateKey -> TEE_MemFill
    Grouping: TEE_MemFill@210 in l_CryptoTaRsa_SetRsaPublicKey with chain TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaEncOper -> l_CryptoTaRsa_SetRsaPublicKey -> TEE_MemFill
    Grouping: TEE_MemFill@210 in l_CryptoTaRsa_SetRsaPublicKey with chain TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> l_CryptoTaRsa_SetRsaPublicKey -> TEE_MemFill
    Grouping: TEE_AsymmetricDecrypt@345 in g_CryptoTaRsa_rsaDecOper with chain TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper -> TEE_AsymmetricDecrypt
    Grouping: TEE_AsymmetricSignDigest@415 in g_CryptoTaRsa_rsaSignOper with chain TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> TEE_AsymmetricSignDigest
    Grouping: TEE_MemMove@490 in g_CryptoTaRsa_rsaVerifyOper with chain TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> TEE_MemMove
    Grouping: TEE_MemMove@498 in g_CryptoTaRsa_rsaVerifyOper with chain TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> TEE_MemMove
    Merging 3 flows at lines [110, 114, 156] in l_CryptoTaPbkdf_HMAC with chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC -> TEE_MemMove
    Merging 2 flows at lines [229, 240] in g_CryptoTaPbkdf_PBKDF2 with chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> TEE_MemFill
    Merging 3 flows at lines [230, 241, 264] in g_CryptoTaPbkdf_PBKDF2 with chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> TEE_MemMove
    Merging 2 flows at lines [490, 498] in g_CryptoTaRsa_rsaVerifyOper with chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> TEE_MemMove
[FlowOptimizer] Optimized to 20 flows
  Final flows:
    - TEE_MemMove@396 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> TEE_MemMove
    - TEE_InitRefAttribute@140 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper -> TEE_InitRefAttribute
    - TEE_CipherDoFinal@199 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper -> TEE_CipherDoFinal
    - TEE_DigestDoFinal@133 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Sha -> g_CryptoTaHash_sha -> TEE_DigestDoFinal
    - TEE_DigestDoFinal@133 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC -> g_CryptoTaHash_sha -> TEE_DigestDoFinal
    - TEE_DigestDoFinal@133 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> g_CryptoTaHash_sha -> TEE_DigestDoFinal
    - TEE_DigestDoFinal@133 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> g_CryptoTaHash_sha -> TEE_DigestDoFinal
    - TEE_DeriveKey@251 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_hmac -> g_CryptoTaHash_hmac -> TEE_DeriveKey
    - TEE_GetObjectBufferAttribute@253 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_hmac -> g_CryptoTaHash_hmac -> TEE_GetObjectBufferAttribute
    - TEE_MemMove@[110, 114, 156] chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC -> TEE_MemMove
    - TEE_MemFill@[229, 240] chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> TEE_MemFill
    - TEE_MemMove@[230, 241, 264] chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> TEE_MemMove
    - TEE_GenerateRandom@120 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Random -> g_CryptoTaOther_Random -> TEE_GenerateRandom
    - TEE_MemFill@152 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper -> l_CryptoTaRsa_SetRsaPrivateKey -> TEE_MemFill
    - TEE_MemFill@152 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> l_CryptoTaRsa_SetRsaPrivateKey -> TEE_MemFill
    - TEE_MemFill@210 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaEncOper -> l_CryptoTaRsa_SetRsaPublicKey -> TEE_MemFill
    - TEE_MemFill@210 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> l_CryptoTaRsa_SetRsaPublicKey -> TEE_MemFill
    - TEE_AsymmetricDecrypt@345 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper -> TEE_AsymmetricDecrypt
    - TEE_AsymmetricSignDigest@415 chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> TEE_AsymmetricSignDigest
    - TEE_MemMove@[490, 498] chain: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> TEE_MemMove
[Phase 4] Generated 20 candidate flows
[SUCCESS] Saved 20 candidate flows to /workspace/benchmark/basicAlg_use/ta/results/ta_candidate_flows.json

[phase4 ] → /workspace/benchmark/basicAlg_use/ta/results/ta_candidate_flows.json

[phase5_command] → python3 taint_analyzer.py /workspace/benchmark/basicAlg_use/ta/results/ta_candidate_flows.json --phase12 /workspace/benchmark/basicAlg_use/ta/results/ta_phase12.json --output /workspace/benchmark/basicAlg_use/ta/results/ta_vulnerabilities.json --verbose
[INFO] $ /usr/bin/python3 /workspace/src/analyze_vulnerabilities/taint_analyzer.py --flows /workspace/benchmark/basicAlg_use/ta/results/ta_candidate_flows.json --phase12 /workspace/benchmark/basicAlg_use/ta/results/ta_phase12.json --output /workspace/benchmark/basicAlg_use/ta/results/ta_vulnerabilities.json --verbose  (cwd=/workspace/benchmark/basicAlg_use/ta)
[STDOUT] ============================================================
Taint Analysis Configuration
============================================================
Mode: Hybrid (DITING + LLM)
RAG: Disabled
Full mode: hybrid
LLM Provider: Using config default
Cache: Enabled
============================================================

[INFO] Loading input files...
[INFO] Loaded 20 flows for analysis
[INFO] Initializing LLM client...
[INFO] Using default LLM provider: openai
[INFO] Setting up prompt system...
[INFO] Setting up prompt system:
  - Mode: hybrid
  - RAG: disabled
  - Rules path: /workspace/rules/codeql_rules.json
[INFO] Using prompts from: /workspace/prompts/vulnerabilities_prompt/hybrid/no_rag
[INFO] Setting up: Hybrid mode without RAG
[INFO] DITING rules JSON set (3674 chars)
[INFO] Rule hints block set (312 chars)
[INFO] RULE_IDS set: unencrypted_output, weak_input_validation, shared_memory_overwrite
[DEBUG] Loaded prompt: hybrid/no_rag/system.txt
[INFO] Initializing analysis engine...
 conversations will be logged to /workspace/benchmark/basicAlg_use/ta/results/conversations.jsonl


[INFO] Starting analysis...
============================================================

[1/20] Analyzing: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> TEE_MemMove

============================================================
[FLOW 1] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_Aes → TEE_MemMove
  Sink: TEE_MemMove (param 0)
  [CACHE MISS] No cached data found

  [1/3] Analyzing TA_InvokeCommandEntryPoint...

[ANALYZING FUNCTION] TA_InvokeCommandEntryPoint at position 0
  Phase: start
[DEBUG] Loaded prompt: hybrid/no_rag/taint_start.txt
[EXTRACT] Only found 1 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"cmd_id","rhs":"paramTypes and params[4] (REe-originated inputs)","site":"/workspace/benchmar...
  Line 2: {"phase":"start","taint_analysis":{"function":"TA_InvokeCommandEntryPoint","tainted_vars":["params",...

  [2/3] Analyzing g_CryptoTaHandle_Aes...

[ANALYZING FUNCTION] g_CryptoTaHandle_Aes at position 1
  Phase: middle
  Called by: TA_InvokeCommandEntryPoint
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
[DEBUG] Loaded prompt: hybrid/no_rag/taint_middle.txt
  [INCLUDING HISTORY] 1 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"l_aesOper.outBuf","rhs":"test (local stack array)","site":"/workspace/benchmark/basicAlg_use...
  Line 2: {"kind":"bounds_check","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaHandle.c:396","evi...

  [3/3] Analyzing TEE_MemMove...

[ANALYZING FUNCTION] TEE_MemMove at position 2
  Phase: middle
  Called by: g_CryptoTaHandle_Aes
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 2 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"test","rhs":"local stack initializer","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVer...
  Line 2: {"kind":"bounds_check","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaHandle.c:396","evi...

[VULNERABILITY DECISION] Making final decision for flow 1
[DEBUG] Loaded prompt: hybrid/no_rag/taint_end.txt

[FINAL DECISION] Preparing to analyze vulnerability for chain with 3 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 3 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: g_CryptoTaHandle_Aes (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaH...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaHandle_Aes",     "tainted_va...
    [3] Function: TEE_MemMove (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “TEE_MemMove...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "TEE_MemMove",     "tainted_vars": ["l_...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Only found 0 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 1 JSON lines from response
[EXTRACT WARNING] Expected 3 lines but found 1
[EXTRACT DEBUG] Response preview (first 300 chars):
  {
  "phase": "end",
  "sink_targets": {
    "function": "TEE_MemMove",
    "lines": [396]
  },
  "evaluated_sink_lines": [
    {
      "line": 396,
      "function": "TEE_MemMove",
      "sink_function": "TEE_MemMove",
      "status": "safe",
      "why": "Source data copied into REE-visible buffer ...
  Collected 1 risks from start phase
  Collected 3 risks from middle phase
  Collected 2 risks from middle phase
[DEBUG] Total structural_risks collected: 6

[FLOW 1] Analysis complete: SAFE
============================================================


[2/20] Analyzing: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper -> ... (4 functions)

============================================================
[FLOW 2] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_Aes → g_CryptoTaAes_AesOper → TEE_InitRefAttribute
  Sink: TEE_InitRefAttribute (param 0)
  [CACHE HIT] Reusing 2/4 functions
    Cached: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_Aes
  [CONTEXT RESTORED] 2 exchanges from cache

  [3/4] Analyzing g_CryptoTaAes_AesOper...

[ANALYZING FUNCTION] g_CryptoTaAes_AesOper at position 2
  Phase: middle
  Called by: g_CryptoTaHandle_Aes
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 2 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"l_pOperation","rhs":"aesOper.outBuf (via l_pOutbuf)","site":"/workspace/benchmark/basicAlg_u...
  Line 2: {"kind":"bounds_check","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaAes.c:199","eviden...

  [4/4] Analyzing TEE_InitRefAttribute...

[ANALYZING FUNCTION] TEE_InitRefAttribute at position 3
  Phase: middle
  Called by: g_CryptoTaAes_AesOper
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 3 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"l_pAttr","rhs":"aesOper.key","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaAes....
  Line 2: {"kind":"bounds_check","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaAes.c:140","eviden...

[VULNERABILITY DECISION] Making final decision for flow 2

[FINAL DECISION] Preparing to analyze vulnerability for chain with 4 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 4 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: g_CryptoTaHandle_Aes (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaH...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaHandle_Aes",     "tainted_va...
    [3] Function: g_CryptoTaAes_AesOper (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaA...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaAes_AesOper",     "tainted_v...
    [4] Function: TEE_InitRefAttribute (pos=3, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “TEE_InitRef...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "TEE_InitRefAttribute",     "tainted_va...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Only found 0 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 1 JSON lines from response
[EXTRACT WARNING] Expected 3 lines but found 1
[EXTRACT DEBUG] Response preview (first 300 chars):
  {
  "phase": "end",
  "sink_targets": {
    "function": "TEE_InitRefAttribute",
    "lines": [140]
  },
  "evaluated_sink_lines": [
    {
      "line": 140,
      "function": "TEE_InitRefAttribute",
      "sink_function": "TEE_InitRefAttribute",
      "status": "safe",
      "why": "Initialization o...
    [INFO] Missing non-critical fields: ['why_no_vulnerability'] - skipping retry
  Collected 1 risks from start phase
  Collected 3 risks from middle phase
  Collected 1 risks from middle phase
  Collected 1 risks from middle phase
[DEBUG] Total structural_risks collected: 6

[FLOW 2] Analysis complete: SAFE
============================================================


[3/20] Analyzing: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper -> ... (4 functions)

============================================================
[FLOW 3] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_Aes → g_CryptoTaAes_AesOper → TEE_CipherDoFinal
  Sink: TEE_CipherDoFinal (param 0)
  [CACHE HIT] Reusing 3/4 functions
    Cached: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_Aes → g_CryptoTaAes_AesOper
  [CONTEXT RESTORED] 3 exchanges from cache

  [4/4] Analyzing TEE_CipherDoFinal...

[ANALYZING FUNCTION] TEE_CipherDoFinal at position 3
  Phase: middle
  Called by: g_CryptoTaAes_AesOper
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 3 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"l_pOperation","rhs":"l_pOperation (TEECrypto)","site":"/workspace/benchmark/basicAlg_use/ta/...
  Line 2: {"kind":"bounds_check","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaes.c:199","evidenc...

[VULNERABILITY DECISION] Making final decision for flow 3

[FINAL DECISION] Preparing to analyze vulnerability for chain with 4 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 4 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: g_CryptoTaHandle_Aes (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaH...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaHandle_Aes",     "tainted_va...
    [3] Function: g_CryptoTaAes_AesOper (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaA...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaAes_AesOper",     "tainted_v...
    [4] Function: TEE_CipherDoFinal (pos=3, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “TEE_CipherD...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "TEE_CipherDoFinal",     "tainted_vars"...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Found 3 JSON lines from response
  Collected 1 risks from start phase
  Collected 3 risks from middle phase
  Collected 1 risks from middle phase
  Collected 1 risks from middle phase
[DEBUG] Total structural_risks collected: 6

[FLOW 3] Analysis complete: VULNERABLE
============================================================


[4/20] Analyzing: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Sha -> g_CryptoTaHash_sha -> ... (4 functions)

============================================================
[FLOW 4] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_Sha → g_CryptoTaHash_sha → TEE_DigestDoFinal
  Sink: TEE_DigestDoFinal (param 3)
  [CACHE HIT] Reusing 1/4 functions
    Cached: TA_InvokeCommandEntryPoint
  [CONTEXT RESTORED] 1 exchanges from cache

  [2/4] Analyzing g_CryptoTaHandle_Sha...

[ANALYZING FUNCTION] g_CryptoTaHandle_Sha at position 1
  Phase: middle
  Called by: TA_InvokeCommandEntryPoint
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 1 previous exchanges
[EXTRACT] Only found 1 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"l_OutputLen","rhs":"params[2].memref.size","site":" /workspace/benchmark/basicAlg_use/ta/Cry...
  Line 2: {"phase":"middle","taint_analysis":{"function":"g_CryptoTaHandle_Sha","tainted_vars":["paramTypes","...

  [3/4] Analyzing g_CryptoTaHash_sha...

[ANALYZING FUNCTION] g_CryptoTaHash_sha at position 2
  Phase: middle
  Called by: g_CryptoTaHandle_Sha
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 2 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"pOutLen","rhs":"pOutLen","site":" /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaHash.c:...
  Line 2: {"kind":"bounds_check","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaHash.c:122-134","e...

  [4/4] Analyzing TEE_DigestDoFinal...

[ANALYZING FUNCTION] TEE_DigestDoFinal at position 3
  Phase: middle
  Called by: g_CryptoTaHash_sha
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 3 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"pOutLen","rhs":"pOutLen (REE-visible pointer)","site":"/workspace/benchmark/basicAlg_use/ta/...
  Line 2: {"kind":"bounds_check","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaHash.c:133-135","e...

[VULNERABILITY DECISION] Making final decision for flow 4

[FINAL DECISION] Preparing to analyze vulnerability for chain with 4 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 4 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: g_CryptoTaHandle_Sha (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaH...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaHandle_Sha",     "tainted_va...
    [3] Function: g_CryptoTaHash_sha (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaH...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaHash_sha",     "tainted_vars...
    [4] Function: TEE_DigestDoFinal (pos=3, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “TEE_DigestD...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "TEE_DigestDoFinal",     "tainted_vars"...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Only found 0 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 1 JSON lines from response
[EXTRACT WARNING] Expected 3 lines but found 1
[EXTRACT DEBUG] Response preview (first 300 chars):
  {
  "phase": "end",
  "sink_targets": {
    "function": "TEE_DigestDoFinal",
    "lines": [133]
  },
  "evaluated_sink_lines": [
    {
      "line": 133,
      "function": "g_CryptoTaHash_sha",
      "sink_function": "TEE_DigestDoFinal",
      "status": "safe",
      "why": "Digest finalization writ...
  Collected 1 risks from start phase
  Collected 2 risks from middle phase
  Collected 3 risks from middle phase
  Collected 2 risks from middle phase
[DEBUG] Total structural_risks collected: 8

[FLOW 4] Analysis complete: SAFE
============================================================


[5/20] Analyzing: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> ... (6 functions)

============================================================
[FLOW 5] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_Pbkdf → g_CryptoTaPbkdf_PBKDF2 → l_CryptoTaPbkdf_HMAC → g_CryptoTaHash_sha → TEE_DigestDoFinal
  Sink: TEE_DigestDoFinal (param 3)
  [CACHE HIT] Reusing 1/6 functions
    Cached: TA_InvokeCommandEntryPoint
  [CONTEXT RESTORED] 1 exchanges from cache

  [2/6] Analyzing g_CryptoTaHandle_Pbkdf...

[ANALYZING FUNCTION] g_CryptoTaHandle_Pbkdf at position 1
  Phase: middle
  Called by: TA_InvokeCommandEntryPoint
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 1 previous exchanges
[EXTRACT] Only found 1 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"l_ResLen","rhs":"params[0].memref.size","site":"/workspace/benchmark/basicAlg_use/ta/CryptoV...
  Line 2: {"phase":"middle","taint_analysis":{"function":"g_CryptoTaHandle_Pbkdf","tainted_vars":["params","pa...

  [3/6] Analyzing g_CryptoTaPbkdf_PBKDF2...

[ANALYZING FUNCTION] g_CryptoTaPbkdf_PBKDF2 at position 2
  Phase: middle
  Called by: g_CryptoTaHandle_Pbkdf
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 2 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"output","rhs":"resultBuf","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaPbkdf2....
  Line 2: {"kind":"bounds_check","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaPbkdf2.c:214-221",...

  [4/6] Analyzing l_CryptoTaPbkdf_HMAC...

[ANALYZING FUNCTION] l_CryptoTaPbkdf_HMAC at position 3
  Phase: middle
  Called by: g_CryptoTaPbkdf_PBKDF2
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 3 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"output","rhs":"y_Hash","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaPbkdf2.c:1...
  Line 2: {"kind":"bounds_check","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaPbkdf2.c:108-115",...

  [5/6] Analyzing g_CryptoTaHash_sha...

[ANALYZING FUNCTION] g_CryptoTaHash_sha at position 4
  Phase: middle
  Called by: l_CryptoTaPbkdf_HMAC
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 4 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"l_RetVal","rhs":"ret","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaHash.c:94-9...
  Line 2: {"kind":"bounds_check","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaHash.c:130-131","e...

  [6/6] Analyzing TEE_DigestDoFinal...

[ANALYZING FUNCTION] TEE_DigestDoFinal at position 5
  Phase: middle
  Called by: g_CryptoTaHash_sha
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 5 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"pOutLen","rhs":"caller-provided length pointer","site":"/workspace/benchmark/basicAlg_use/ta...
  Line 2: {"kind":"bounds_check","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaHash.c:133-133","e...

[VULNERABILITY DECISION] Making final decision for flow 5

[FINAL DECISION] Preparing to analyze vulnerability for chain with 6 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 6 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: g_CryptoTaHandle_Pbkdf (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaH...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaHandle_Pbkdf",     "tainted_...
    [3] Function: g_CryptoTaPbkdf_PBKDF2 (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaP...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaPbkdf_PBKDF2",     "tainted_...
    [4] Function: l_CryptoTaPbkdf_HMAC (pos=3, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “l_CryptoTaP...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "l_CryptoTaPbkdf_HMAC",     "tainted_va...
    [5] Function: g_CryptoTaHash_sha (pos=4, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaH...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaHash_sha",     "tainted_vars...
    [6] Function: TEE_DigestDoFinal (pos=5, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “TEE_DigestD...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "TEE_DigestDoFinal",     "tainted_vars"...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Only found 1 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 2 JSON lines from response
[EXTRACT WARNING] Expected 3 lines but found 2
[EXTRACT DEBUG] Response preview (first 300 chars):
  {
  "phase": "end",
  "sink_targets": {
    "function": "TEE_DigestDoFinal",
    "lines": [133]
  },
  "evaluated_sink_lines": [
    {
      "line": 133,
      "function": "TEE_DigestDoFinal",
      "sink_function": "TEE_DigestDoFinal",
      "status": "vulnerable",
      "why": "Caller-provided out...
  Collected 1 risks from start phase
  Collected 2 risks from middle phase
  Collected 3 risks from middle phase
  Collected 4 risks from middle phase
  Collected 2 risks from middle phase
  Collected 2 risks from middle phase
[DEBUG] Total structural_risks collected: 14

[FLOW 5] Analysis complete: VULNERABLE
============================================================


[6/20] Analyzing: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> ... (5 functions)

============================================================
[FLOW 6] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_Rsa → g_CryptoTaRsa_rsaSignOper → g_CryptoTaHash_sha → TEE_DigestDoFinal
  Sink: TEE_DigestDoFinal (param 3)
  [CACHE HIT] Reusing 1/5 functions
    Cached: TA_InvokeCommandEntryPoint
  [CONTEXT RESTORED] 1 exchanges from cache

  [2/5] Analyzing g_CryptoTaHandle_Rsa...

[ANALYZING FUNCTION] g_CryptoTaHandle_Rsa at position 1
  Phase: middle
  Called by: TA_InvokeCommandEntryPoint
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 1 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"l_KeyType","rhs":"params[2].value.a @ file:line 450","site":"/workspace/benchmark/basicAlg_u...
  Line 2: {"kind":"unknown","site":"","evidence":"no explicit bounds check or sanitization observed on input b...

  [3/5] Analyzing g_CryptoTaRsa_rsaSignOper...

[ANALYZING FUNCTION] g_CryptoTaRsa_rsaSignOper at position 2
  Phase: middle
  Called by: g_CryptoTaHandle_Rsa
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 2 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"l_rsaOper","rhs":"rsaOper @ file:line 373","site":"/workspace/benchmark/basicAlg_use/ta/Cryp...
  Line 2: {"kind":"unknown","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaRsa.c:373-429","evidenc...

  [4/5] Analyzing g_CryptoTaHash_sha...

[ANALYZING FUNCTION] g_CryptoTaHash_sha at position 3
  Phase: middle
  Called by: g_CryptoTaRsa_rsaSignOper
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 3 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"pOutLen","rhs":"pointer to length output (REE-visible)","site":"/workspace/benchmark/basicAl...
  Line 2: {"kind":"unknown","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaHash.c:93-152","evidenc...

  [5/5] Analyzing TEE_DigestDoFinal...

[ANALYZING FUNCTION] TEE_DigestDoFinal at position 4
  Phase: middle
  Called by: g_CryptoTaHash_sha
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 4 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"inLen","rhs":"previous input length used in digest update","site":"/workspace/benchmark/basi...
  Line 2: {"kind":"unknown","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaHash.c:133","evidence":...

[VULNERABILITY DECISION] Making final decision for flow 6

[FINAL DECISION] Preparing to analyze vulnerability for chain with 5 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 5 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: g_CryptoTaHandle_Rsa (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaH...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaHandle_Rsa",     "tainted_va...
    [3] Function: g_CryptoTaRsa_rsaSignOper (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaR...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaRsa_rsaSignOper",     "taint...
    [4] Function: g_CryptoTaHash_sha (pos=3, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaH...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaHash_sha",     "tainted_vars...
    [5] Function: TEE_DigestDoFinal (pos=4, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “TEE_DigestD...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "TEE_DigestDoFinal",     "tainted_vars"...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Only found 2 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 3 JSON lines from response
  Collected 1 risks from start phase
  Collected 1 risks from middle phase
  Collected 1 risks from middle phase
  Collected 1 risks from middle phase
  Collected 2 risks from middle phase
[DEBUG] Total structural_risks collected: 7

[FLOW 6] Analysis complete: VULNERABLE
============================================================


[7/20] Analyzing: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> ... (5 functions)

============================================================
[FLOW 7] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_Rsa → g_CryptoTaRsa_rsaVerifyOper → g_CryptoTaHash_sha → TEE_DigestDoFinal
  Sink: TEE_DigestDoFinal (param 3)
  [CACHE HIT] Reusing 2/5 functions
    Cached: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_Rsa
  [CONTEXT RESTORED] 2 exchanges from cache

  [3/5] Analyzing g_CryptoTaRsa_rsaVerifyOper...

[ANALYZING FUNCTION] g_CryptoTaRsa_rsaVerifyOper at position 2
  Phase: middle
  Called by: g_CryptoTaHandle_Rsa
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 2 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"pOutLen","rhs":"l_OutputLen (output length)","site":"/workspace/benchmark/basicAlg_use/ta/Cr...
  Line 2: {"kind":"unknown","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaRsa.c:450","evidence":"...

  [4/5] Analyzing g_CryptoTaHash_sha...

[ANALYZING FUNCTION] g_CryptoTaHash_sha at position 3
  Phase: middle
  Called by: g_CryptoTaRsa_rsaVerifyOper
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 3 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"pOutLen","rhs":"pOutLen (output length pointer)","site":"/workspace/benchmark/basicAlg_use/t...
  Line 2: {"kind":"unknown","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaHash.c:100-115","eviden...

  [5/5] Analyzing TEE_DigestDoFinal...

[ANALYZING FUNCTION] TEE_DigestDoFinal at position 4
  Phase: middle
  Called by: g_CryptoTaHash_sha
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 4 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"pOutLen","rhs":"pointer to output length (TA may modify)","site":"/workspace/benchmark/basic...
  Line 2: {"kind":"unknown","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaHash.c:133-134","eviden...

[VULNERABILITY DECISION] Making final decision for flow 7

[FINAL DECISION] Preparing to analyze vulnerability for chain with 5 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 5 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: g_CryptoTaHandle_Rsa (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaH...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaHandle_Rsa",     "tainted_va...
    [3] Function: g_CryptoTaRsa_rsaVerifyOper (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaR...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaRsa_rsaVerifyOper",     "tai...
    [4] Function: g_CryptoTaHash_sha (pos=3, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaH...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaHash_sha",     "tainted_vars...
    [5] Function: TEE_DigestDoFinal (pos=4, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “TEE_DigestD...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "TEE_DigestDoFinal",     "tainted_vars"...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Only found 0 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 1 JSON lines from response
[EXTRACT WARNING] Expected 3 lines but found 1
[EXTRACT DEBUG] Response preview (first 300 chars):
  {
  "phase": "end",
  "sink_targets": {
    "function": "TEE_DigestDoFinal",
    "lines": [133]
  },
  "evaluated_sink_lines": [
    {
      "line": 133,
      "function": "TEE_DigestDoFinal",
      "sink_function": "TEE_DigestDoFinal",
      "status": "not_applicable",
      "why": "No explicit une...
  Collected 1 risks from start phase
  Collected 1 risks from middle phase
  Collected 1 risks from middle phase
  Collected 1 risks from middle phase
  Collected 1 risks from middle phase
[DEBUG] Total structural_risks collected: 5

[FLOW 7] Analysis complete: SAFE
============================================================


[8/20] Analyzing: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_hmac -> g_CryptoTaHash_hmac -> ... (4 functions)

============================================================
[FLOW 8] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_hmac → g_CryptoTaHash_hmac → TEE_DeriveKey
  Sink: TEE_DeriveKey (param 1)
  [CACHE HIT] Reusing 1/4 functions
    Cached: TA_InvokeCommandEntryPoint
  [CONTEXT RESTORED] 1 exchanges from cache

  [2/4] Analyzing g_CryptoTaHandle_hmac...

[ANALYZING FUNCTION] g_CryptoTaHandle_hmac at position 1
  Phase: middle
  Called by: TA_InvokeCommandEntryPoint
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 1 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"l_OutPut","rhs":"g_CryptoTaHash_hmac(...)","site":"/workspace/benchmark/basicAlg_use/ta/Cryp...
  Line 2: {"kind":"unknown","site":"/workspace/benchmark/basicAlg_use/ta/CryptoTaHandle.c:366-368","evidence":...

  [3/4] Analyzing g_CryptoTaHash_hmac...

[ANALYZING FUNCTION] g_CryptoTaHash_hmac at position 2
  Phase: middle
  Called by: g_CryptoTaHandle_hmac
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 2 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"count","rhs":"l_Count","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaHash.c:170...
  Line 2: {"kind":"unknown","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaHash.c:170-171","eviden...

  [4/4] Analyzing TEE_DeriveKey...

[ANALYZING FUNCTION] TEE_DeriveKey at position 3
  Phase: middle
  Called by: g_CryptoTaHash_hmac
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 3 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"l_SvHandle","rhs":"derived key object handle (TA-private)","site":"/workspace/benchmark/basi...
  Line 2: {"kind":"unknown","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaHash.c:251","evidence":...

[VULNERABILITY DECISION] Making final decision for flow 8

[FINAL DECISION] Preparing to analyze vulnerability for chain with 4 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 4 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: g_CryptoTaHandle_hmac (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaH...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaHandle_hmac",     "tainted_v...
    [3] Function: g_CryptoTaHash_hmac (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaH...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaHash_hmac",     "tainted_var...
    [4] Function: TEE_DeriveKey (pos=3, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “TEE_DeriveK...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "TEE_DeriveKey",     "tainted_vars": ["...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Found 3 JSON lines from response
  Collected 1 risks from start phase
  Collected 1 risks from middle phase
  Collected 2 risks from middle phase
  Collected 1 risks from middle phase
[DEBUG] Total structural_risks collected: 6

[FLOW 8] Analysis complete: VULNERABLE
============================================================


[9/20] Analyzing: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_hmac -> g_CryptoTaHash_hmac -> ... (4 functions)

============================================================
[FLOW 9] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_hmac → g_CryptoTaHash_hmac → TEE_GetObjectBufferAttribute
  Sink: TEE_GetObjectBufferAttribute (param 2)
  [CACHE HIT] Reusing 3/4 functions
    Cached: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_hmac → g_CryptoTaHash_hmac
  [CONTEXT RESTORED] 3 exchanges from cache

  [4/4] Analyzing TEE_GetObjectBufferAttribute...

[ANALYZING FUNCTION] TEE_GetObjectBufferAttribute at position 3
  Phase: middle
  Called by: g_CryptoTaHash_hmac
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 3 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"OutLen","rhs":"length written to output","site":"/workspace/benchmark/basicAlg_use/ta/Crypto...
  Line 2: {"kind":"unknown","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaHash.c:253","evidence":...

[VULNERABILITY DECISION] Making final decision for flow 9

[FINAL DECISION] Preparing to analyze vulnerability for chain with 4 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 4 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: g_CryptoTaHandle_hmac (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaH...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaHandle_hmac",     "tainted_v...
    [3] Function: g_CryptoTaHash_hmac (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaH...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaHash_hmac",     "tainted_var...
    [4] Function: TEE_GetObjectBufferAttribute (pos=3, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “TEE_GetObje...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "TEE_GetObjectBufferAttribute",     "ta...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Only found 0 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 1 JSON lines from response
[EXTRACT WARNING] Expected 3 lines but found 1
[EXTRACT DEBUG] Response preview (first 300 chars):
  {
  "phase": "end",
  "sink_targets": {
    "function": "TEE_GetObjectBufferAttribute",
    "lines": [253]
  },
  "evaluated_sink_lines": [
    {
      "line": 253,
      "function": "TEE_GetObjectBufferAttribute",
      "sink_function": "TEE_GetObjectBufferAttribute",
      "status": "vulnerable",
...
  Collected 1 risks from start phase
  Collected 1 risks from middle phase
  Collected 2 risks from middle phase
  Collected 2 risks from middle phase
[DEBUG] Total structural_risks collected: 6

[FLOW 9] Analysis complete: VULNERABLE
============================================================


[10/20] Analyzing: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> ... (5 functions)

============================================================
[FLOW 10] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_Pbkdf → g_CryptoTaPbkdf_PBKDF2 → l_CryptoTaPbkdf_HMAC → TEE_MemMove
  Sink: TEE_MemMove (param 0)
  [CACHE HIT] Reusing 4/5 functions
    Cached: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_Pbkdf → g_CryptoTaPbkdf_PBKDF2 → l_CryptoTaPbkdf_HMAC
  [CONTEXT RESTORED] 4 exchanges from cache

  [5/5] Analyzing TEE_MemMove...

[ANALYZING FUNCTION] TEE_MemMove at position 4
  Phase: middle
  Called by: l_CryptoTaPbkdf_HMAC
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 4 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"output","rhs":"y_Hash","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaPbkdf2.c:1...
  Line 2: {"kind":"bounds_check","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaPbkdf2.c:108-115",...

[VULNERABILITY DECISION] Making final decision for flow 10

[FINAL DECISION] Preparing to analyze vulnerability for chain with 5 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 5 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: g_CryptoTaHandle_Pbkdf (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaH...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaHandle_Pbkdf",     "tainted_...
    [3] Function: g_CryptoTaPbkdf_PBKDF2 (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaP...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaPbkdf_PBKDF2",     "tainted_...
    [4] Function: l_CryptoTaPbkdf_HMAC (pos=3, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “l_CryptoTaP...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "l_CryptoTaPbkdf_HMAC",     "tainted_va...
    [5] Function: TEE_MemMove (pos=4, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “TEE_MemMove...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "l_CryptoTaPbkdf_HMAC",     "tainted_va...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Only found 0 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 1 JSON lines from response
[EXTRACT WARNING] Expected 3 lines but found 1
[EXTRACT DEBUG] Response preview (first 300 chars):
  {
  "phase": "end",
  "sink_targets": {
    "function": "TEE_MemMove",
    "lines": [110, 114, 156]
  },
  "evaluated_sink_lines": [
    {
      "line": 110,
      "function": "l_CryptoTaPbkdf_HMAC",
      "sink_function": "TEE_MemMove",
      "status": "safe",
      "why": "Copy from tainted input ...
  Collected 1 risks from start phase
  Collected 2 risks from middle phase
  Collected 3 risks from middle phase
  Collected 4 risks from middle phase
  Collected 1 risks from middle phase
[DEBUG] Total structural_risks collected: 11

[FLOW 10] Analysis complete: SAFE
============================================================


[11/20] Analyzing: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> ... (4 functions)

============================================================
[FLOW 11] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_Pbkdf → g_CryptoTaPbkdf_PBKDF2 → TEE_MemFill
  Sink: TEE_MemFill (param 0)
  [CACHE HIT] Reusing 3/4 functions
    Cached: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_Pbkdf → g_CryptoTaPbkdf_PBKDF2
  [CONTEXT RESTORED] 3 exchanges from cache

  [4/4] Analyzing TEE_MemFill...

[ANALYZING FUNCTION] TEE_MemFill at position 3
  Phase: middle
  Called by: g_CryptoTaPbkdf_PBKDF2
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 3 previous exchanges
[EXTRACT] Only found 1 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"U_tmp","rhs":"S","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaPbkdf2.c:230"}...
  Line 2: {"phase":"middle","taint_analysis":{"function":"TEE_MemFill","tainted_vars":["U_tmp","Slen","S","U_t...

[VULNERABILITY DECISION] Making final decision for flow 11

[FINAL DECISION] Preparing to analyze vulnerability for chain with 4 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 4 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: g_CryptoTaHandle_Pbkdf (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaH...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaHandle_Pbkdf",     "tainted_...
    [3] Function: g_CryptoTaPbkdf_PBKDF2 (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaP...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaPbkdf_PBKDF2",     "tainted_...
    [4] Function: TEE_MemFill (pos=3, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “TEE_MemFill...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "TEE_MemFill",     "tainted_vars": ["U_...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Only found 0 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 1 JSON lines from response
[EXTRACT WARNING] Expected 3 lines but found 1
[EXTRACT DEBUG] Response preview (first 300 chars):
  {
  "phase": "end",
  "sink_targets": {
    "function": "TEE_MemFill",
    "lines": [229, 240]
  },
  "evaluated_sink_lines": [
    {
      "line": 229,
      "function": "TEE_MemFill",
      "sink_function": "TEE_MemFill",
      "status": "safe",
      "why": "Destination is TA-private stack buffer...
  Collected 1 risks from start phase
  Collected 2 risks from middle phase
  Collected 3 risks from middle phase
  Collected 2 risks from middle phase
[DEBUG] Total structural_risks collected: 8

[FLOW 11] Analysis complete: SAFE
============================================================


[12/20] Analyzing: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> ... (4 functions)

============================================================
[FLOW 12] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_Pbkdf → g_CryptoTaPbkdf_PBKDF2 → TEE_MemMove
  Sink: TEE_MemMove (param 0)
  [CACHE HIT] Reusing 3/4 functions
    Cached: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_Pbkdf → g_CryptoTaPbkdf_PBKDF2
  [CONTEXT RESTORED] 3 exchanges from cache

  [4/4] Analyzing TEE_MemMove...

[ANALYZING FUNCTION] TEE_MemMove at position 3
  Phase: middle
  Called by: g_CryptoTaPbkdf_PBKDF2
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 3 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"U_tmp","rhs":"tmp_hmac","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaPbkdf2.c:...
  Line 2: {"kind":"bounds_check","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaPbkdf2.c:230","evi...

[VULNERABILITY DECISION] Making final decision for flow 12

[FINAL DECISION] Preparing to analyze vulnerability for chain with 4 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 4 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: g_CryptoTaHandle_Pbkdf (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaH...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaHandle_Pbkdf",     "tainted_...
    [3] Function: g_CryptoTaPbkdf_PBKDF2 (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaP...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaPbkdf_PBKDF2",     "tainted_...
    [4] Function: TEE_MemMove (pos=3, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “TEE_MemMove...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "TEE_MemMove",     "tainted_vars": ["U_...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Only found 2 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 3 JSON lines from response
  Collected 1 risks from start phase
  Collected 2 risks from middle phase
  Collected 3 risks from middle phase
  Collected 4 risks from middle phase
[DEBUG] Total structural_risks collected: 10

[FLOW 12] Analysis complete: VULNERABLE
============================================================


[13/20] Analyzing: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Random -> g_CryptoTaOther_Random -> ... (4 functions)

============================================================
[FLOW 13] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_Random → g_CryptoTaOther_Random → TEE_GenerateRandom
  Sink: TEE_GenerateRandom (param 0)
  [CACHE HIT] Reusing 1/4 functions
    Cached: TA_InvokeCommandEntryPoint
  [CONTEXT RESTORED] 1 exchanges from cache

  [2/4] Analyzing g_CryptoTaHandle_Random...

[ANALYZING FUNCTION] g_CryptoTaHandle_Random at position 1
  Phase: middle
  Called by: TA_InvokeCommandEntryPoint
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 1 previous exchanges
[EXTRACT] Only found 1 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"l_pBuf","rhs":"params[0].memref.buffer","site":"/workspace/benchmark/basicAlg_use/ta/CryptoT...
  Line 2: {"phase":"middle","taint_analysis":{"function":"g_CryptoTaHandle_Random","tainted_vars":["l_RandomLe...

  [3/4] Analyzing g_CryptoTaOther_Random...

[ANALYZING FUNCTION] g_CryptoTaOther_Random at position 2
  Phase: middle
  Called by: g_CryptoTaHandle_Random
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 2 previous exchanges
[EXTRACT] Only found 1 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"output","rhs":"output buffer pointer (caller-provided)","site":"/workspace/benchmark/basicAl...
  Line 2: {"phase":"middle","taint_analysis":{"function":"g_CryptoTaOther_Random","tainted_vars":["len","outpu...

  [4/4] Analyzing TEE_GenerateRandom...

[ANALYZING FUNCTION] TEE_GenerateRandom at position 3
  Phase: middle
  Called by: g_CryptoTaOther_Random
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 3 previous exchanges
[EXTRACT] Only found 1 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"output","rhs":"caller-provided output buffer","site":"/workspace/benchmark/basicAlg_use/ta/C...
  Line 2: {"phase":"middle","taint_analysis":{"function":"TEE_GenerateRandom","tainted_vars":["len","output"],...

[VULNERABILITY DECISION] Making final decision for flow 13

[FINAL DECISION] Preparing to analyze vulnerability for chain with 4 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 4 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: g_CryptoTaHandle_Random (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaH...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaHandle_Random",     "tainted...
    [3] Function: g_CryptoTaOther_Random (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaO...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaOther_Random",     "tainted_...
    [4] Function: TEE_GenerateRandom (pos=3, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “TEE_Generat...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "TEE_GenerateRandom",     "tainted_vars...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Only found 0 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 1 JSON lines from response
[EXTRACT WARNING] Expected 3 lines but found 1
[EXTRACT DEBUG] Response preview (first 300 chars):
  {
  "phase": "end",
  "sink_targets": {
    "function": "TEE_GenerateRandom",
    "lines": [120]
  },
  "evaluated_sink_lines": [
    {
      "line": 120,
      "function": "TEE_GenerateRandom",
      "sink_function": "TEE_GenerateRandom",
      "status": "safe",
      "why": "Random output to REE-v...
  Collected 1 risks from start phase
  Collected 1 risks from middle phase
  Collected 1 risks from middle phase
  Collected 1 risks from middle phase
[DEBUG] Total structural_risks collected: 4

[FLOW 13] Analysis complete: SAFE
============================================================


[14/20] Analyzing: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper -> ... (5 functions)

============================================================
[FLOW 14] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_Rsa → g_CryptoTaRsa_rsaDecOper → l_CryptoTaRsa_SetRsaPrivateKey → TEE_MemFill
  Sink: TEE_MemFill (param 0)
  [CACHE HIT] Reusing 2/5 functions
    Cached: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_Rsa
  [CONTEXT RESTORED] 2 exchanges from cache

  [3/5] Analyzing g_CryptoTaRsa_rsaDecOper...

[ANALYZING FUNCTION] g_CryptoTaRsa_rsaDecOper at position 2
  Phase: middle
  Called by: g_CryptoTaHandle_Rsa
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 2 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"l_rsaOper","rhs":"rsaOper passed into function @ file:line 312-315","site":"/workspace/bench...
  Line 2: {"kind":"unknown","site":"","evidence":"no explicit bounds checking visible in this mid-hop for inBu...

  [4/5] Analyzing l_CryptoTaRsa_SetRsaPrivateKey...

[ANALYZING FUNCTION] l_CryptoTaRsa_SetRsaPrivateKey at position 3
  Phase: middle
  Called by: g_CryptoTaRsa_rsaDecOper
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 3 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"g_PrivateKeyAttr[2].content.ref.length","rhs":"rsaOper.Dlen @ file:line 167","site":"/worksp...
  Line 2: {"kind":"unknown","site":"","evidence":"no explicit bounds validation visible for inputs to key popu...

  [5/5] Analyzing TEE_MemFill...

[ANALYZING FUNCTION] TEE_MemFill at position 4
  Phase: middle
  Called by: l_CryptoTaRsa_SetRsaPrivateKey
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 4 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"g_PrivateKeyAttr","rhs":"destination buffer initialization with zeros @ file:line 152","site...
  Line 2: {"kind":"unknown","site":"","evidence":"no explicit bounds checks observed for memory-fill operation...

[VULNERABILITY DECISION] Making final decision for flow 14

[FINAL DECISION] Preparing to analyze vulnerability for chain with 5 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 5 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: g_CryptoTaHandle_Rsa (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaH...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaHandle_Rsa",     "tainted_va...
    [3] Function: g_CryptoTaRsa_rsaDecOper (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaR...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaRsa_rsaDecOper",     "tainte...
    [4] Function: l_CryptoTaRsa_SetRsaPrivateKey (pos=3, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “l_CryptoTaR...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "l_CryptoTaRsa_SetRsaPrivateKey",     "...
    [5] Function: TEE_MemFill (pos=4, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “TEE_MemFill...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "TEE_MemFill",     "tainted_vars": ["g_...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Only found 0 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 1 JSON lines from response
[EXTRACT WARNING] Expected 3 lines but found 1
[EXTRACT DEBUG] Response preview (first 300 chars):
  {
  "phase": "end",
  "sink_targets": {
    "function": "TEE_MemFill",
    "lines": [152]
  },
  "evaluated_sink_lines": [
    {
      "line": 152,
      "function": "TEE_MemFill",
      "sink_function": "TEE_MemFill",
      "status": "safe",
      "why": "TA-private memory initialization performed ...
  Collected 1 risks from start phase
  Collected 1 risks from middle phase
  Collected 1 risks from middle phase
  Collected 2 risks from middle phase
  Collected 1 risks from middle phase
[DEBUG] Total structural_risks collected: 6

[FLOW 14] Analysis complete: SAFE
============================================================


[15/20] Analyzing: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> ... (5 functions)

============================================================
[FLOW 15] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_Rsa → g_CryptoTaRsa_rsaSignOper → l_CryptoTaRsa_SetRsaPrivateKey → TEE_MemFill
  Sink: TEE_MemFill (param 0)
  [CACHE HIT] Reusing 3/5 functions
    Cached: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_Rsa → g_CryptoTaRsa_rsaSignOper
  [CONTEXT RESTORED] 3 exchanges from cache

  [4/5] Analyzing l_CryptoTaRsa_SetRsaPrivateKey...

[ANALYZING FUNCTION] l_CryptoTaRsa_SetRsaPrivateKey at position 3
  Phase: middle
  Called by: g_CryptoTaRsa_rsaSignOper
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 3 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"g_PrivateKeyAttr[2].content.ref.length","rhs":"rsaOper.Dlen @ file:line 167","site":"/worksp...
  Line 2: {"kind":"unknown","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaRsa.c:149-172","evidenc...

  [5/5] Analyzing TEE_MemFill...

[ANALYZING FUNCTION] TEE_MemFill at position 4
  Phase: middle
  Called by: l_CryptoTaRsa_SetRsaPrivateKey
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 4 previous exchanges
[EXTRACT] Only found 0 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 1 JSON lines from response
[EXTRACT WARNING] Expected 2 lines but found 1
[EXTRACT DEBUG] Response preview (first 300 chars):
  {
  "phase": "middle",
  "taint_analysis": {
    "function": "TEE_MemFill",
    "tainted_vars": [],
    "propagation": [],
    "sanitizers": [],
    "taint_blocked": false
  },
  "structural_risks": []
}...
[PARSER] Extracted 1 JSON lines from response
  Line 1: {"phase":"middle","taint_analysis":{"function":"TEE_MemFill","tainted_vars":[],"propagation":[],"san...

[VULNERABILITY DECISION] Making final decision for flow 15

[FINAL DECISION] Preparing to analyze vulnerability for chain with 5 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 5 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: g_CryptoTaHandle_Rsa (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaH...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaHandle_Rsa",     "tainted_va...
    [3] Function: g_CryptoTaRsa_rsaSignOper (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaR...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaRsa_rsaSignOper",     "taint...
    [4] Function: l_CryptoTaRsa_SetRsaPrivateKey (pos=3, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “l_CryptoTaR...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "l_CryptoTaRsa_SetRsaPrivateKey",     "...
    [5] Function: TEE_MemFill (pos=4, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “TEE_MemFill...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "TEE_MemFill",     "tainted_vars": [], ...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Only found 0 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 1 JSON lines from response
[EXTRACT WARNING] Expected 3 lines but found 1
[EXTRACT DEBUG] Response preview (first 300 chars):
  {
  "phase": "end",
  "sink_targets": {
    "function": "TEE_MemFill",
    "lines": [152]
  },
  "evaluated_sink_lines": [
    {
      "line": 152,
      "function": "l_CryptoTaRsa_SetRsaPrivateKey",
      "sink_function": "TEE_MemFill",
      "status": "safe",
      "why": "Destination TA-private b...
    [INFO] Missing non-critical fields: ['why_no_vulnerability'] - skipping retry
  Collected 1 risks from start phase
  Collected 1 risks from middle phase
  Collected 1 risks from middle phase
  Collected 1 risks from middle phase
[DEBUG] Total structural_risks collected: 4

[FLOW 15] Analysis complete: SAFE
============================================================


[16/20] Analyzing: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaEncOper -> ... (5 functions)

============================================================
[FLOW 16] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_Rsa → g_CryptoTaRsa_rsaEncOper → l_CryptoTaRsa_SetRsaPublicKey → TEE_MemFill
  Sink: TEE_MemFill (param 0)
  [CACHE HIT] Reusing 2/5 functions
    Cached: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_Rsa
  [CONTEXT RESTORED] 2 exchanges from cache

  [3/5] Analyzing g_CryptoTaRsa_rsaEncOper...

[ANALYZING FUNCTION] g_CryptoTaRsa_rsaEncOper at position 2
  Phase: middle
  Called by: g_CryptoTaHandle_Rsa
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 2 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"l_rsaOper","rhs":"l_CryptoTaRsa_rsaEncOper parameters (via rsaOper) @ file:line 471","site":...
  Line 2: {"kind":"unknown","site":"","evidence":"no explicit bounds/type validations observed on inputs withi...

  [4/5] Analyzing l_CryptoTaRsa_SetRsaPublicKey...

[ANALYZING FUNCTION] l_CryptoTaRsa_SetRsaPublicKey at position 3
  Phase: middle
  Called by: g_CryptoTaRsa_rsaEncOper
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 3 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"rsaOper","rhs":"REE-origin input object rsaOper passed into setter","site":"/workspace/bench...
  Line 2: {"kind":"unknown","site":"","evidence":"no explicit sanitization observed on rsaOper contents within...

  [5/5] Analyzing TEE_MemFill...

[ANALYZING FUNCTION] TEE_MemFill at position 4
  Phase: middle
  Called by: l_CryptoTaRsa_SetRsaPublicKey
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 4 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"g_PublicKeyAttr","rhs":"constant zero source within TA (not REE-origin)","site":"/workspace/...
  Line 2: {"kind":"unknown","site":"","evidence":"no sanitizers observed related to this TA-private memory fil...

[VULNERABILITY DECISION] Making final decision for flow 16

[FINAL DECISION] Preparing to analyze vulnerability for chain with 5 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 5 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: g_CryptoTaHandle_Rsa (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaH...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaHandle_Rsa",     "tainted_va...
    [3] Function: g_CryptoTaRsa_rsaEncOper (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaR...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaRsa_rsaEncOper",     "tainte...
    [4] Function: l_CryptoTaRsa_SetRsaPublicKey (pos=3, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “l_CryptoTaR...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "l_CryptoTaRsa_SetRsaPublicKey",     "t...
    [5] Function: TEE_MemFill (pos=4, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “TEE_MemFill...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "TEE_MemFill",     "tainted_vars": ["g_...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Only found 0 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 1 JSON lines from response
[EXTRACT WARNING] Expected 3 lines but found 1
[EXTRACT DEBUG] Response preview (first 300 chars):
  {
  "phase": "end",
  "sink_targets": {
    "function": "TEE_MemFill",
    "lines": [210]
  },
  "evaluated_sink_lines": [
    {
      "line": 210,
      "function": "TEE_MemFill",
      "sink_function": "TEE_MemFill",
      "status": "safe",
      "why": "Sink operates on a TA-private memory buffer...
  Collected 1 risks from start phase
  Collected 1 risks from middle phase
  Collected 3 risks from middle phase
  Collected 1 risks from middle phase
  Collected 1 risks from middle phase
[DEBUG] Total structural_risks collected: 7

[FLOW 16] Analysis complete: SAFE
============================================================


[17/20] Analyzing: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> ... (5 functions)

============================================================
[FLOW 17] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_Rsa → g_CryptoTaRsa_rsaVerifyOper → l_CryptoTaRsa_SetRsaPublicKey → TEE_MemFill
  Sink: TEE_MemFill (param 0)
  [CACHE HIT] Reusing 3/5 functions
    Cached: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_Rsa → g_CryptoTaRsa_rsaVerifyOper
  [CONTEXT RESTORED] 3 exchanges from cache

  [4/5] Analyzing l_CryptoTaRsa_SetRsaPublicKey...

[ANALYZING FUNCTION] l_CryptoTaRsa_SetRsaPublicKey at position 3
  Phase: middle
  Called by: g_CryptoTaRsa_rsaVerifyOper
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 3 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"g_MaxKeySize","rhs":"(rsaOper.Nlen)*8U","site":"/workspace/benchmark/basicAlg_use/ta/CryptoV...
  Line 2: {"kind":"unknown","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaRsa.c:207","evidence":"...

  [5/5] Analyzing TEE_MemFill...

[ANALYZING FUNCTION] TEE_MemFill at position 4
  Phase: middle
  Called by: l_CryptoTaRsa_SetRsaPublicKey
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 4 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"g_PublicKeyAttr[1]","rhs":"values derived from rsaOper.Edata/Elen","site":"/workspace/benchm...
  Line 2: {"kind":"unknown","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaRsa.c:210","evidence":"...

[VULNERABILITY DECISION] Making final decision for flow 17

[FINAL DECISION] Preparing to analyze vulnerability for chain with 5 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 5 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: g_CryptoTaHandle_Rsa (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaH...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaHandle_Rsa",     "tainted_va...
    [3] Function: g_CryptoTaRsa_rsaVerifyOper (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaR...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaRsa_rsaVerifyOper",     "tai...
    [4] Function: l_CryptoTaRsa_SetRsaPublicKey (pos=3, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “l_CryptoTaR...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "l_CryptoTaRsa_SetRsaPublicKey",     "t...
    [5] Function: TEE_MemFill (pos=4, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “TEE_MemFill...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "TEE_MemFill",     "tainted_vars": ["g_...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Only found 0 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 1 JSON lines from response
[EXTRACT WARNING] Expected 3 lines but found 1
[EXTRACT DEBUG] Response preview (first 300 chars):
  {
  "phase": "end",
  "sink_targets": {
    "function": "TEE_MemFill",
    "lines": [210]
  },
  "evaluated_sink_lines": [
    {
      "line": 210,
      "function": "TEE_MemFill",
      "sink_function": "TEE_MemFill",
      "status": "safe",
      "why": "Destination buffer is TA-private and the fi...
  Collected 1 risks from start phase
  Collected 1 risks from middle phase
  Collected 1 risks from middle phase
  Collected 1 risks from middle phase
  Collected 1 risks from middle phase
[DEBUG] Total structural_risks collected: 5

[FLOW 17] Analysis complete: SAFE
============================================================


[18/20] Analyzing: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper -> ... (4 functions)

============================================================
[FLOW 18] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_Rsa → g_CryptoTaRsa_rsaDecOper → TEE_AsymmetricDecrypt
  Sink: TEE_AsymmetricDecrypt (param 0)
  [CACHE HIT] Reusing 3/4 functions
    Cached: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_Rsa → g_CryptoTaRsa_rsaDecOper
  [CONTEXT RESTORED] 3 exchanges from cache

  [4/4] Analyzing TEE_AsymmetricDecrypt...

[ANALYZING FUNCTION] TEE_AsymmetricDecrypt at position 3
  Phase: middle
  Called by: g_CryptoTaRsa_rsaDecOper
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 3 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"g_pOperationHandle","rhs":"callee handle for operation (TA-private) @ file:line 328-335","si...
  Line 2: {"kind":"unknown","site":"","evidence":"no bounds checks or sanitizers evident on inBuf/outBuf usage...

[VULNERABILITY DECISION] Making final decision for flow 18

[FINAL DECISION] Preparing to analyze vulnerability for chain with 4 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 4 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: g_CryptoTaHandle_Rsa (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaH...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaHandle_Rsa",     "tainted_va...
    [3] Function: g_CryptoTaRsa_rsaDecOper (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaR...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaRsa_rsaDecOper",     "tainte...
    [4] Function: TEE_AsymmetricDecrypt (pos=3, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “TEE_Asymmet...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "TEE_AsymmetricDecrypt",     "tainted_v...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Only found 1 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 2 JSON lines from response
[EXTRACT WARNING] Expected 3 lines but found 2
[EXTRACT DEBUG] Response preview (first 300 chars):
  {
  "phase": "end",
  "sink_targets": {
    "function": "TEE_AsymmetricDecrypt",
    "lines": [345]
  },
  "evaluated_sink_lines": [
    {
      "line": 345,
      "function": "TEE_AsymmetricDecrypt",
      "sink_function": "TEE_AsymmetricDecrypt",
      "status": "vulnerable",
      "why": "TA-orig...
  Collected 1 risks from start phase
  Collected 1 risks from middle phase
  Collected 1 risks from middle phase
  Collected 2 risks from middle phase
[DEBUG] Total structural_risks collected: 6

[FLOW 18] Analysis complete: VULNERABLE
============================================================


[19/20] Analyzing: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> ... (4 functions)

============================================================
[FLOW 19] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_Rsa → g_CryptoTaRsa_rsaSignOper → TEE_AsymmetricSignDigest
  Sink: TEE_AsymmetricSignDigest (param 3)
  [CACHE HIT] Reusing 3/4 functions
    Cached: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_Rsa → g_CryptoTaRsa_rsaSignOper
  [CONTEXT RESTORED] 3 exchanges from cache

  [4/4] Analyzing TEE_AsymmetricSignDigest...

[ANALYZING FUNCTION] TEE_AsymmetricSignDigest at position 3
  Phase: middle
  Called by: g_CryptoTaRsa_rsaSignOper
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 3 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"g_pOperationHandle","rhs":"g_pOperationHandle @ file:line 415","site":"/workspace/benchmark/...
  Line 2: {"kind":"unknown","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaRsa.c:415","evidence":"...

[VULNERABILITY DECISION] Making final decision for flow 19

[FINAL DECISION] Preparing to analyze vulnerability for chain with 4 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 4 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: g_CryptoTaHandle_Rsa (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaH...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaHandle_Rsa",     "tainted_va...
    [3] Function: g_CryptoTaRsa_rsaSignOper (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaR...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaRsa_rsaSignOper",     "taint...
    [4] Function: TEE_AsymmetricSignDigest (pos=3, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “TEE_Asymmet...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "TEE_AsymmetricSignDigest",     "tainte...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Only found 1 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 2 JSON lines from response
[EXTRACT WARNING] Expected 3 lines but found 2
[EXTRACT DEBUG] Response preview (first 300 chars):
  {
  "phase": "end",
  "sink_targets": {
    "function": "TEE_AsymmetricSignDigest",
    "lines": [415]
  },
  "evaluated_sink_lines": [
    {
      "line": 415,
      "function": "TEE_AsymmetricSignDigest",
      "sink_function": "TEE_AsymmetricSignDigest",
      "status": "vulnerable",
      "why":...
  Collected 1 risks from start phase
  Collected 1 risks from middle phase
  Collected 1 risks from middle phase
  Collected 1 risks from middle phase
[DEBUG] Total structural_risks collected: 4

[FLOW 19] Analysis complete: VULNERABLE
============================================================


[20/20] Analyzing: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> ... (4 functions)

============================================================
[FLOW 20] Starting analysis
  Chain: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_Rsa → g_CryptoTaRsa_rsaVerifyOper → TEE_MemMove
  Sink: TEE_MemMove (param 0)
  [CACHE HIT] Reusing 3/4 functions
    Cached: TA_InvokeCommandEntryPoint → g_CryptoTaHandle_Rsa → g_CryptoTaRsa_rsaVerifyOper
  [CONTEXT RESTORED] 3 exchanges from cache

  [4/4] Analyzing TEE_MemMove...

[ANALYZING FUNCTION] TEE_MemMove at position 3
  Phase: middle
  Called by: g_CryptoTaRsa_rsaVerifyOper
[DEBUG] get_middle_prompt: mode=hybrid, rag=False
  [INCLUDING HISTORY] 3 previous exchanges
[EXTRACT] Found 2 JSON lines from response
[PARSER] Extracted 2 JSON lines from response
  Line 1: {"lhs":"size","rhs":"sizeof(VERIFY_RESULT_FAIL)","site":"/workspace/benchmark/basicAlg_use/ta/Crypto...
  Line 2: {"kind":"unknown","site":"/workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaRsa.c:490","evidence":"...

[VULNERABILITY DECISION] Making final decision for flow 20

[FINAL DECISION] Preparing to analyze vulnerability for chain with 4 functions

[CONVERSATION HISTORY FOR FINAL DECISION]
  Including 4 exchanges:
    [1] Function: TA_InvokeCommandEntryPoint (pos=0, phase=start)
        Q: You are a deterministic taint analyst for OP‑TEE Trusted Applications (TAs). Analyze the user‑define...
        A: {   "phase": "start",   "taint_analysis": {     "function": "TA_InvokeCommandEntryPoint",     "taint...
    [2] Function: g_CryptoTaHandle_Rsa (pos=1, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaH...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaHandle_Rsa",     "tainted_va...
    [3] Function: g_CryptoTaRsa_rsaVerifyOper (pos=2, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “g_CryptoTaR...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "g_CryptoTaRsa_rsaVerifyOper",     "tai...
    [4] Function: TEE_MemMove (pos=3, phase=middle)
        Q: You are a deterministic taint analyst for OP‑TEE TAs. Analyze the user‑defined function “TEE_MemMove...
        A: {   "phase": "middle",   "taint_analysis": {     "function": "TEE_MemMove",     "tainted_vars": ["ou...
  Adding final decision prompt
[END CONVERSATION HISTORY]

[EXTRACT] Only found 0 single-line JSON, trying multiline extraction
[EXTRACT MULTILINE] Found 1 multiline JSON objects
[EXTRACT] Found 1 JSON lines from response
[EXTRACT WARNING] Expected 3 lines but found 1
[EXTRACT DEBUG] Response preview (first 300 chars):
  {
  "phase": "end",
  "sink_targets": {
    "function": "TEE_MemMove",
    "lines": [490, 498]
  },
  "evaluated_sink_lines": [
    {
      "line": 490,
      "function": "TEE_MemMove",
      "sink_function": "TEE_MemMove",
      "status": "safe",
      "why": "Source is a constant VERIFY_RESULT_FAI...
  Collected 1 risks from start phase
  Collected 1 risks from middle phase
  Collected 1 risks from middle phase
  Collected 1 risks from middle phase
[DEBUG] Total structural_risks collected: 4

[FLOW 20] Analysis complete: SAFE
============================================================

============================================================
[INFO] Analysis completed

============================================================
Analysis Summary
============================================================
Total flows analyzed: 20
Vulnerabilities found: 8
Detection rate: 40.0%

Execution time: 10.4 minutes
Average per flow: 31.31 seconds

Cache Performance:
  Hits: 0
  Partial hits: 19
  Misses: 1
  Hit rate: 95.0%
============================================================

[INFO] Analysis complete
[INFO] Results saved to: /workspace/benchmark/basicAlg_use/ta/results/ta_vulnerabilities.json

[DEBUG] Report command: /usr/bin/python3 /workspace/src/report/generate_report.py --sinks /workspace/benchmark/basicAlg_use/ta/results/ta_sinks.json --flows /workspace/benchmark/basicAlg_use/ta/results/ta_candidate_flows.json --vulnerabilities /workspace/benchmark/basicAlg_use/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/basicAlg_use/ta/results/ta_phase12.json --project-name basicAlg_use --output /workspace/benchmark/basicAlg_use/ta/results/ta_vulnerability_report.html
[phase6_command] → python3 /workspace/src/report/generate_report.py /workspace/src/report/generate_report.py --sinks /workspace/benchmark/basicAlg_use/ta/results/ta_sinks.json --flows /workspace/benchmark/basicAlg_use/ta/results/ta_candidate_flows.json --vulnerabilities /workspace/benchmark/basicAlg_use/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/basicAlg_use/ta/results/ta_phase12.json --project-name basicAlg_use --output /workspace/benchmark/basicAlg_use/ta/results/ta_vulnerability_report.html
[INFO] $ /usr/bin/python3 /workspace/src/report/generate_report.py --sinks /workspace/benchmark/basicAlg_use/ta/results/ta_sinks.json --flows /workspace/benchmark/basicAlg_use/ta/results/ta_candidate_flows.json --vulnerabilities /workspace/benchmark/basicAlg_use/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/basicAlg_use/ta/results/ta_phase12.json --project-name basicAlg_use --output /workspace/benchmark/basicAlg_use/ta/results/ta_vulnerability_report.html  (cwd=/workspace/benchmark/basicAlg_use/ta)
[STDOUT] [INFO] conversations.jsonl から会話履歴を読み込みます: /workspace/benchmark/basicAlg_use/ta/results/conversations.jsonl
[INFO] 読み込み完了: 20 フロー, 128 会話
[INFO] 解析カバレッジ: 20/20 チェーン (100.0%)
[generate_report] HTMLレポートを生成しました: /workspace/benchmark/basicAlg_use/ta/results/ta_vulnerability_report.html
  検出脆弱性数: 7
  Structural Risks: 0
  会話履歴: conversations.jsonl を使用

[phase6 ] → /workspace/benchmark/basicAlg_use/ta/results/ta_vulnerability_report.html

[SUCCESS] All phases completed successfully for basicAlg_use
[INFO] Execution time recorded in: /workspace/benchmark/basicAlg_use/ta/results/time.txt
[INFO] Total execution time: 11m 54.42s
