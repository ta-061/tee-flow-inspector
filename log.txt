make -C host CROSS_COMPILE="arm-linux-gnueabihf-" --no-builtin-variables \
	TEEC_EXPORT=/workspace/benchmark/acipher/../../optee_client/out/export
make[1]: Entering directory '/workspace/benchmark/acipher/host'
arm-linux-gnueabihf-gcc -Wall -I../ta/include -I./include -I/workspace/benchmark/acipher/../../optee_client/out/export/include -c main.c -o main.o
arm-linux-gnueabihf-gcc  -o optee_example_acipher main.o -lteec -L/workspace/benchmark/acipher/../../optee_client/out/export/lib
make[1]: Leaving directory '/workspace/benchmark/acipher/host'
make -C ta CROSS_COMPILE="arm-linux-gnueabihf-" LDFLAGS="" \
	TA_DEV_KIT_DIR=/workspace/benchmark/acipher/../../optee_os/out/arm/export-ta_arm32
make[1]: Entering directory '/workspace/benchmark/acipher/ta'
  CC      acipher_ta.o
  CC      user_ta_header.o
  CPP     ta.lds
  LD      a734eed9-d6a1-4244-aa50-7c99719e7b7b.elf
  OBJDUMP a734eed9-d6a1-4244-aa50-7c99719e7b7b.dmp
  OBJCOPY a734eed9-d6a1-4244-aa50-7c99719e7b7b.stripped.elf
  SIGN    a734eed9-d6a1-4244-aa50-7c99719e7b7b.ta
make[1]: Leaving directory '/workspace/benchmark/acipher/ta'
[INFO] Loaded sink definitions from /workspace/rules/generated_sink_definitions.json
[INFO] PatternMatcher initialized with 3 sink functions
[INFO] Sample sinks: TEE_MemMove(params: [0, 1, 2]), snprintf(params: [0, 1, 2, 3]), TEEC_InvokeCommand(params: [1, 2])
使用中のLLMプロバイダー: openrouter
呼び出し済み外部 API を抽出中...
外部 API 関数: 8 個
外部 API 関数をシンクとして解析中...

[DEBUG] PatternMatcher initialized
[DEBUG] Loaded rules count: 3
[DEBUG] Known functions in index: 3

[DEBUG] Analyzing: TEE_AllocateOperation
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_AllocateTransientObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_AsymmetricEncrypt
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_FreeOperation
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_FreeTransientObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_GenerateKey
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_GetObjectInfo1
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_SetOperationKey
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()
抽出されたシンク候補: 5 個
結果を /workspace/benchmark/acipher/ta/results/ta_sinks.json に保存しました
[DEBUG] Include paths:
  ✓ /workspace/benchmark/acipher/ta
  ✓ /workspace/benchmark/acipher/ta/include
  ✓ ./include
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/acipher/ta/acipher_ta.c
  Args: -I/workspace/benchmark/acipher/ta -I/workspace/benchmark/acipher/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TA_OPTEE_CORE_API_COMPAT_1_1=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=acipher_ta_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[find_sink_calls] 5 call sites → /workspace/benchmark/acipher/ta/results/ta_vulnerable_destinations.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/acipher/ta
  ✓ /workspace/benchmark/acipher/ta/include
  ✓ ./include
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/acipher/ta/acipher_ta.c
  Args: -I/workspace/benchmark/acipher/ta -I/workspace/benchmark/acipher/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TA_OPTEE_CORE_API_COMPAT_1_1=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=acipher_ta_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[generate_call_graph_advanced] 21 edges, 7 functions → /workspace/benchmark/acipher/ta/results/ta_call_graph.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/acipher/ta
  ✓ /workspace/benchmark/acipher/ta/include
  ✓ ./include
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/acipher/ta/acipher_ta.c
  Args: -I/workspace/benchmark/acipher/ta -I/workspace/benchmark/acipher/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TA_OPTEE_CORE_API_COMPAT_1_1=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=acipher_ta_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[extract_sink_calls] 5 entries → /workspace/benchmark/acipher/ta/results/ta_vulnerable_destinations.json
[DEBUG] 入力チェーン数: 5
[DEBUG] ソース関数マッピング: {'TA_InvokeCommandEntryPoint': [], 'TA_OpenSessionEntryPoint': []}
[DEBUG] ソース関数: ['TA_InvokeCommandEntryPoint', 'TA_OpenSessionEntryPoint']
[DEBUG] ステップ1後: 5 CDFs
[DEBUG] ステップ2後: 5 CDFs（同じVD+ソースの最長チェーンのみ）
[DEBUG] ステップ3後: 5 CDFs（0 個のサブチェーンを削除）
[DEBUG] ステップ4: 2 グループ
[DEBUG] ステップ4後: 2 CDFs（1 グループがマージされた）
[DEBUG] 最終的な危険フロー:
  - TEE_GetObjectInfo1 at line 73, params=[0]: TA_InvokeCommandEntryPoint -> cmd_enc -> TEE_GetObjectInfo1
  - TEE_AsymmetricEncrypt at line 97, params=[0, 1, 2, 3]: TA_InvokeCommandEntryPoint -> cmd_enc -> TEE_AsymmetricEncrypt

[generate_candidate_flows] 2 件 → /workspace/benchmark/acipher/ta/results/ta_candidate_flows.json
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[DEBUG] Using prompts directory: /workspace/prompts/vulnerabilities_prompt
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
[DEBUG] RAG system already initialized
[INFO] RAG mode disabled
[INFO] RAG disabled
使用中のLLMプロバイダー: openrouter
[taint_analyzer] 2 個の候補フローを解析中...
  [1/2] チェーン: TA_InvokeCommandEntryPoint -> cmd_enc -> TEE_GetObjectInfo1
[DEBUG] Loaded prompt: taint_start.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle.txt
[DEBUG] get_middle_prompt called: sink_function=TEE_GetObjectInfo1, param_index=0
[DEBUG] Loaded prompt: taint_end.txt
  [2/2] チェーン: TA_InvokeCommandEntryPoint -> cmd_enc -> TEE_AsymmetricEncrypt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle_multi_params.txt
[taint_analyzer] 解析完了: 0 件の脆弱性を検出
  結果: /workspace/benchmark/acipher/ta/results/ta_vulnerabilities.json
  ログ: /workspace/benchmark/acipher/ta/results/taint_analysis_log.txt
Traceback (most recent call last):
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 169, in <module>
    main()
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 138, in main
    generate_summary_report(out_dir, statistics, vulnerabilities)
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 161, in generate_summary_report
    from .report_generator import ReportGenerator
ImportError: attempted relative import with no known parent package
[generate_report] HTMLレポートを生成しました: /workspace/benchmark/acipher/ta/results/ta_vulnerability_report.html
  検出脆弱性数: 0
  AI対話履歴を含めました: /workspace/benchmark/acipher/ta/results/taint_analysis_log.txt
  対話チェーン数: 2
make -C host CROSS_COMPILE="arm-linux-gnueabihf-" --no-builtin-variables \
	TEEC_EXPORT=/workspace/benchmark/aes/../../optee_client/out/export
make[1]: Entering directory '/workspace/benchmark/aes/host'
arm-linux-gnueabihf-gcc -Wall -I../ta/include -I./include -I/workspace/benchmark/aes/../../optee_client/out/export/include -c main.c -o main.o
arm-linux-gnueabihf-gcc  -o optee_example_aes main.o -lteec -L/workspace/benchmark/aes/../../optee_client/out/export/lib
make[1]: Leaving directory '/workspace/benchmark/aes/host'
make -C ta CROSS_COMPILE="arm-linux-gnueabihf-" LDFLAGS="" \
	TA_DEV_KIT_DIR=/workspace/benchmark/aes/../../optee_os/out/arm/export-ta_arm32
make[1]: Entering directory '/workspace/benchmark/aes/ta'
  CC      aes_ta.o
  CC      user_ta_header.o
  CPP     ta.lds
  LD      5dbac793-f574-4871-8ad3-04331ec17f24.elf
  OBJDUMP 5dbac793-f574-4871-8ad3-04331ec17f24.dmp
  OBJCOPY 5dbac793-f574-4871-8ad3-04331ec17f24.stripped.elf
  SIGN    5dbac793-f574-4871-8ad3-04331ec17f24.ta
make[1]: Leaving directory '/workspace/benchmark/aes/ta'
[INFO] Loaded sink definitions from /workspace/rules/generated_sink_definitions.json
[INFO] PatternMatcher initialized with 3 sink functions
[INFO] Sample sinks: TEE_MemMove(params: [0, 1, 2]), snprintf(params: [0, 1, 2, 3]), TEEC_InvokeCommand(params: [1, 2])
使用中のLLMプロバイダー: openrouter
呼び出し済み外部 API を抽出中...
外部 API 関数: 13 個
外部 API 関数をシンクとして解析中...

[DEBUG] PatternMatcher initialized
[DEBUG] Loaded rules count: 3
[DEBUG] Known functions in index: 3

[DEBUG] Analyzing: TEE_AllocateOperation
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_AllocateTransientObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_CipherInit
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_CipherUpdate
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_Free
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_FreeOperation
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_FreeTransientObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_InitRefAttribute
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_Malloc
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_PopulateTransientObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_ResetOperation
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_ResetTransientObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_SetOperationKey
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()
抽出されたシンク候補: 7 個
結果を /workspace/benchmark/aes/ta/results/ta_sinks.json に保存しました

=== Project: acipher / TA: ta ===
[INFO] RAG mode is disabled for this analysis
[INFO] Cleaning dependencies for acipher
  - Removed stale dependency: ta/.user_ta_header.o.d
  - Removed stale dependency: ta/.acipher_ta.o.d
  - Executed 'make clean' in .
  - Executed 'make clean' in ta
  - Executed 'make clean' in host
  ✓ Cleaned 5 files
[INFO] $ bear -- make  (cwd=/workspace/benchmark/acipher)
[INFO] TA DB saved: /workspace/benchmark/acipher/ta/compile_commands.json  entries=1
[DEBUG] Include paths:
  ✓ /workspace/benchmark/acipher/ta
  ✓ /workspace/benchmark/acipher/ta/include
  ✗ ./include
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/acipher/ta/acipher_ta.c
  Args: -I/workspace/benchmark/acipher/ta -I/workspace/benchmark/acipher/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TA_OPTEE_CORE_API_COMPAT_1_1=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=acipher_ta_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[phase1-2] → /workspace/benchmark/acipher/ta/results/ta_phase12.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/identify_sinks.py -i /workspace/benchmark/acipher/ta/results/ta_phase12.json -o /workspace/benchmark/acipher/ta/results/ta_sinks.json --no-rag  (cwd=/workspace/benchmark/acipher/ta)
[phase3 ] → /workspace/benchmark/acipher/ta/results/ta_sinks.json

[phase3.1] → python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/acipher/ta/compile_commands.json --sinks /workspace/benchmark/acipher/ta/results/ta_sinks.json --output /workspace/benchmark/acipher/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/acipher/ta/compile_commands.json --sinks /workspace/benchmark/acipher/ta/results/ta_sinks.json --output /workspace/benchmark/acipher/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/acipher/ta)
[phase3.4] → /workspace/benchmark/acipher/ta/results/ta_vulnerable_destinations.json

[phase3.2] → python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/acipher/ta/compile_commands.json --output /workspace/benchmark/acipher/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/acipher/ta/compile_commands.json --output /workspace/benchmark/acipher/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/acipher/ta)
[phase3.5] → /workspace/benchmark/acipher/ta/results/ta_call_graph.json

[phase3.3] → python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/acipher/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/acipher/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/acipher/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/acipher/ta/results/ta_chains.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/acipher/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/acipher/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/acipher/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/acipher/ta/results/ta_chains.json  (cwd=/workspace/benchmark/acipher/ta)
[phase3.6] → /workspace/benchmark/acipher/ta/results/ta_chains.json

[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/extract_sink_calls.py --compile-db /workspace/benchmark/acipher/ta/compile_commands.json --sinks /workspace/benchmark/acipher/ta/results/ta_sinks.json --output /workspace/benchmark/acipher/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/acipher/ta)
[phase3.7] → /workspace/benchmark/acipher/ta/results/ta_vulnerable_destinations.json

[phase5_command] → python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/acipher/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/acipher/ta/results/ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/acipher/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/acipher/ta/results/ta_candidate_flows.json  (cwd=/workspace/benchmark/acipher/ta)
[phase5 ] → /workspace/benchmark/acipher/ta/results/ta_candidate_flows.json

[INFO] $ /usr/bin/python3 /workspace/src/analyze_vulnerabilities/taint_analyzer.py --flows /workspace/benchmark/acipher/ta/results/ta_candidate_flows.json --phase12 /workspace/benchmark/acipher/ta/results/ta_phase12.json --output /workspace/benchmark/acipher/ta/results/ta_vulnerabilities.json --generate-summary --no-rag  (cwd=/workspace/benchmark/acipher/ta)
[WARN]   ↳ rc=1
[INFO] $ /usr/bin/python3 /workspace/src/report/generate_report.py --vulnerabilities /workspace/benchmark/acipher/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/acipher/ta/results/ta_phase12.json --project-name acipher --output /workspace/benchmark/acipher/ta/results/ta_vulnerability_report.html  (cwd=/workspace/benchmark/acipher/ta)
[phase7 ] → /workspace/benchmark/acipher/ta/results/ta_vulnerability_report.html


=== Project: aes / TA: ta ===
[INFO] RAG mode is disabled for this analysis
[INFO] Cleaning dependencies for aes
  - Removed stale dependency: ta/.user_ta_header.o.d
  - Removed stale dependency: ta/.aes_ta.o.d
  - Executed 'make clean' in .
  - Executed 'make clean' in ta
  - Executed 'make clean' in host
  ✓ Cleaned 5 files
[INFO] $ bear -- make  (cwd=/workspace/benchmark/aes)
[INFO] TA DB saved: /workspace/benchmark/aes/ta/compile_commands.json  entries=1
[DEBUG] Include paths:
  ✓ /workspace/benchmark/aes/ta
  ✓ /workspace/benchmark/aes/ta/include
  ✗ ./include
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/aes/ta/aes_ta.c
  Args: -I/workspace/benchmark/aes/ta -I/workspace/benchmark/aes/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TA_OPTEE_CORE_API_COMPAT_1_1=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=aes_ta_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[phase1-2] → /workspace/benchmark/aes/ta/results/ta_phase12.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/identify_sinks.py -i /workspace/benchmark/aes/ta/results/ta_phase12.json -o /workspace/benchmark/aes/ta/results/ta_sinks.json --no-rag  (cwd=/workspace/benchmark/aes/ta)
[phase3 ] → /workspace/benchmark/aes/ta/results/ta_sinks.json

[phase3.1] → python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/aes/ta/compile_commands.json --sinks /workspace/benchmark/aes/ta/results/ta_sinks.json --output /workspace/benchmark/aes/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[DEBUG] Include paths:
  ✓ /workspace/benchmark/aes/ta
  ✓ /workspace/benchmark/aes/ta/include
  ✓ ./include
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/aes/ta/aes_ta.c
  Args: -I/workspace/benchmark/aes/ta -I/workspace/benchmark/aes/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TA_OPTEE_CORE_API_COMPAT_1_1=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=aes_ta_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[find_sink_calls] 8 call sites → /workspace/benchmark/aes/ta/results/ta_vulnerable_destinations.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/aes/ta
  ✓ /workspace/benchmark/aes/ta/include
  ✓ ./include
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/aes/ta/aes_ta.c
  Args: -I/workspace/benchmark/aes/ta -I/workspace/benchmark/aes/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TA_OPTEE_CORE_API_COMPAT_1_1=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=aes_ta_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[generate_call_graph_advanced] 47 edges, 12 functions → /workspace/benchmark/aes/ta/results/ta_call_graph.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/aes/ta
  ✓ /workspace/benchmark/aes/ta/include
  ✓ ./include
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/aes/ta/aes_ta.c
  Args: -I/workspace/benchmark/aes/ta -I/workspace/benchmark/aes/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TA_OPTEE_CORE_API_COMPAT_1_1=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=aes_ta_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[extract_sink_calls] 8 entries → /workspace/benchmark/aes/ta/results/ta_vulnerable_destinations.json
[DEBUG] 入力チェーン数: 8
[DEBUG] ソース関数マッピング: {'TA_InvokeCommandEntryPoint': [], 'TA_OpenSessionEntryPoint': []}
[DEBUG] ソース関数: ['TA_InvokeCommandEntryPoint', 'TA_OpenSessionEntryPoint']
[DEBUG] ステップ1後: 8 CDFs
[DEBUG] ステップ2後: 8 CDFs（同じVD+ソースの最長チェーンのみ）
[DEBUG] ステップ3後: 8 CDFs（0 個のサブチェーンを削除）
[DEBUG] ステップ4: 4 グループ
[DEBUG] ステップ4後: 4 CDFs（2 グループがマージされた）
[DEBUG] 最終的な危険フロー:
  - TEE_Malloc at line 188, params=[0]: TA_InvokeCommandEntryPoint -> alloc_resources -> TEE_Malloc
  - TEE_CipherInit at line 322, params=[1, 2]: TA_InvokeCommandEntryPoint -> reset_aes_iv -> TEE_CipherInit
  - TEE_CipherUpdate at line 360, params=[0, 1, 2, 3]: TA_InvokeCommandEntryPoint -> cipher_buffer -> TEE_CipherUpdate
  - TEE_Malloc at line 387, params=[0]: TA_OpenSessionEntryPoint -> TEE_Malloc

[generate_candidate_flows] 4 件 → /workspace/benchmark/aes/ta/results/ta_candidate_flows.json
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[DEBUG] Using prompts directory: /workspace/prompts/vulnerabilities_prompt
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
[DEBUG] RAG system already initialized
[INFO] RAG mode disabled
[INFO] RAG disabled
使用中のLLMプロバイダー: openrouter
[taint_analyzer] 4 個の候補フローを解析中...
  [1/4] チェーン: TA_InvokeCommandEntryPoint -> alloc_resources -> TEE_Malloc
[DEBUG] Loaded prompt: taint_start.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle.txt
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Loaded prompt: taint_end.txt
  [2/4] チェーン: TA_InvokeCommandEntryPoint -> reset_aes_iv -> TEE_CipherInit
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle_multi_params.txt
  [3/4] チェーン: TA_InvokeCommandEntryPoint -> cipher_buffer -> TEE_CipherUpdate
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [4/4] チェーン: TA_OpenSessionEntryPoint -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[taint_analyzer] 解析完了: 0 件の脆弱性を検出
  結果: /workspace/benchmark/aes/ta/results/ta_vulnerabilities.json
  ログ: /workspace/benchmark/aes/ta/results/taint_analysis_log.txt
Traceback (most recent call last):
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 169, in <module>
    main()
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 138, in main
    generate_summary_report(out_dir, statistics, vulnerabilities)
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 161, in generate_summary_report
    from .report_generator import ReportGenerator
ImportError: attempted relative import with no known parent package
[generate_report] HTMLレポートを生成しました: /workspace/benchmark/aes/ta/results/ta_vulnerability_report.html
  検出脆弱性数: 0
  AI対話履歴を含めました: /workspace/benchmark/aes/ta/results/taint_analysis_log.txt
  対話チェーン数: 4
make -C host CROSS_COMPILE="arm-linux-gnueabihf-" --no-builtin-variables \
	TEEC_EXPORT=/workspace/benchmark/hotp/../../optee_client/out/export
make[1]: Entering directory '/workspace/benchmark/hotp/host'
arm-linux-gnueabihf-gcc -Wall -I../ta/include -I./include -I/workspace/benchmark/hotp/../../optee_client/out/export/include -c main.c -o main.o
arm-linux-gnueabihf-gcc  -o optee_example_hotp main.o -lteec -L/workspace/benchmark/hotp/../../optee_client/out/export/lib
make[1]: Leaving directory '/workspace/benchmark/hotp/host'
make -C ta CROSS_COMPILE="arm-linux-gnueabihf-" LDFLAGS="" \
	TA_DEV_KIT_DIR=/workspace/benchmark/hotp/../../optee_os/out/arm/export-ta_arm32
make[1]: Entering directory '/workspace/benchmark/hotp/ta'
  CC      hotp_ta.o
  CC      user_ta_header.o
  CPP     ta.lds
  LD      484d4143-2d53-4841-3120-4a6f636b6542.elf
  OBJDUMP 484d4143-2d53-4841-3120-4a6f636b6542.dmp
  OBJCOPY 484d4143-2d53-4841-3120-4a6f636b6542.stripped.elf
  SIGN    484d4143-2d53-4841-3120-4a6f636b6542.ta
make[1]: Leaving directory '/workspace/benchmark/hotp/ta'
[INFO] Loaded sink definitions from /workspace/rules/generated_sink_definitions.json
[INFO] PatternMatcher initialized with 3 sink functions
[INFO] Sample sinks: TEE_MemMove(params: [0, 1, 2]), snprintf(params: [0, 1, 2, 3]), TEEC_InvokeCommand(params: [1, 2])
使用中のLLMプロバイダー: openrouter
呼び出し済み外部 API を抽出中...
外部 API 関数: 12 個
外部 API 関数をシンクとして解析中...

[DEBUG] PatternMatcher initialized
[DEBUG] Loaded rules count: 3
[DEBUG] Known functions in index: 3

[DEBUG] Analyzing: TEE_AllocateOperation
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_AllocateTransientObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_FreeOperation
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_FreeTransientObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_InitRefAttribute
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_MACComputeFinal
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_MACInit
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_MACUpdate
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_PopulateTransientObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_SetOperationKey
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: memcpy
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: memset
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()
抽出されたシンク候補: 10 個
結果を /workspace/benchmark/hotp/ta/results/ta_sinks.json に保存しました
[DEBUG] Include paths:
  ✓ /workspace/benchmark/hotp/ta
  ✓ /workspace/benchmark/hotp/ta/include
  ✓ ./include
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/hotp/ta/hotp_ta.c
  Args: -I/workspace/benchmark/hotp/ta -I/workspace/benchmark/hotp/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TA_OPTEE_CORE_API_COMPAT_1_1=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=hotp_ta_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[find_sink_calls] 8 call sites → /workspace/benchmark/hotp/ta/results/ta_vulnerable_destinations.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/hotp/ta
  ✓ /workspace/benchmark/hotp/ta/include
  ✓ ./include
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/hotp/ta/hotp_ta.c
  Args: -I/workspace/benchmark/hotp/ta -I/workspace/benchmark/hotp/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TA_OPTEE_CORE_API_COMPAT_1_1=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=hotp_ta_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[generate_call_graph_advanced] 26 edges, 9 functions → /workspace/benchmark/hotp/ta/results/ta_call_graph.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/aes/ta/compile_commands.json --sinks /workspace/benchmark/aes/ta/results/ta_sinks.json --output /workspace/benchmark/aes/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/aes/ta)
[phase3.4] → /workspace/benchmark/aes/ta/results/ta_vulnerable_destinations.json

[phase3.2] → python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/aes/ta/compile_commands.json --output /workspace/benchmark/aes/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/aes/ta/compile_commands.json --output /workspace/benchmark/aes/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/aes/ta)
[phase3.5] → /workspace/benchmark/aes/ta/results/ta_call_graph.json

[phase3.3] → python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/aes/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/aes/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/aes/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/aes/ta/results/ta_chains.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/aes/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/aes/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/aes/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/aes/ta/results/ta_chains.json  (cwd=/workspace/benchmark/aes/ta)
[phase3.6] → /workspace/benchmark/aes/ta/results/ta_chains.json

[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/extract_sink_calls.py --compile-db /workspace/benchmark/aes/ta/compile_commands.json --sinks /workspace/benchmark/aes/ta/results/ta_sinks.json --output /workspace/benchmark/aes/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/aes/ta)
[phase3.7] → /workspace/benchmark/aes/ta/results/ta_vulnerable_destinations.json

[phase5_command] → python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/aes/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/aes/ta/results/ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/aes/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/aes/ta/results/ta_candidate_flows.json  (cwd=/workspace/benchmark/aes/ta)
[phase5 ] → /workspace/benchmark/aes/ta/results/ta_candidate_flows.json

[INFO] $ /usr/bin/python3 /workspace/src/analyze_vulnerabilities/taint_analyzer.py --flows /workspace/benchmark/aes/ta/results/ta_candidate_flows.json --phase12 /workspace/benchmark/aes/ta/results/ta_phase12.json --output /workspace/benchmark/aes/ta/results/ta_vulnerabilities.json --generate-summary --no-rag  (cwd=/workspace/benchmark/aes/ta)
[WARN]   ↳ rc=1
[INFO] $ /usr/bin/python3 /workspace/src/report/generate_report.py --vulnerabilities /workspace/benchmark/aes/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/aes/ta/results/ta_phase12.json --project-name aes --output /workspace/benchmark/aes/ta/results/ta_vulnerability_report.html  (cwd=/workspace/benchmark/aes/ta)
[phase7 ] → /workspace/benchmark/aes/ta/results/ta_vulnerability_report.html


=== Project: hotp / TA: ta ===
[INFO] RAG mode is disabled for this analysis
[INFO] Cleaning dependencies for hotp
  - Removed stale dependency: ta/.user_ta_header.o.d
  - Removed stale dependency: ta/.hotp_ta.o.d
  - Executed 'make clean' in .
  - Executed 'make clean' in ta
  - Executed 'make clean' in host
  ✓ Cleaned 5 files
[INFO] $ bear -- make  (cwd=/workspace/benchmark/hotp)
[INFO] TA DB saved: /workspace/benchmark/hotp/ta/compile_commands.json  entries=1
[DEBUG] Include paths:
  ✓ /workspace/benchmark/hotp/ta
  ✓ /workspace/benchmark/hotp/ta/include
  ✗ ./include
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/hotp/ta/hotp_ta.c
  Args: -I/workspace/benchmark/hotp/ta -I/workspace/benchmark/hotp/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TA_OPTEE_CORE_API_COMPAT_1_1=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=hotp_ta_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[phase1-2] → /workspace/benchmark/hotp/ta/results/ta_phase12.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/identify_sinks.py -i /workspace/benchmark/hotp/ta/results/ta_phase12.json -o /workspace/benchmark/hotp/ta/results/ta_sinks.json --no-rag  (cwd=/workspace/benchmark/hotp/ta)
[phase3 ] → /workspace/benchmark/hotp/ta/results/ta_sinks.json

[phase3.1] → python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/hotp/ta/compile_commands.json --sinks /workspace/benchmark/hotp/ta/results/ta_sinks.json --output /workspace/benchmark/hotp/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/hotp/ta/compile_commands.json --sinks /workspace/benchmark/hotp/ta/results/ta_sinks.json --output /workspace/benchmark/hotp/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/hotp/ta)
[phase3.4] → /workspace/benchmark/hotp/ta/results/ta_vulnerable_destinations.json

[phase3.2] → python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/hotp/ta/compile_commands.json --output /workspace/benchmark/hotp/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/hotp/ta/compile_commands.json --output /workspace/benchmark/hotp/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/hotp/ta)
[phase3.5] → /workspace/benchmark/hotp/ta/results/ta_call_graph.json

[phase3.3] → python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/hotp/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/hotp/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/hotp/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/hotp/ta/results/ta_chains.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/hotp/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/hotp/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/hotp/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/hotp/ta/results/ta_chains.json  (cwd=/workspace/benchmark/hotp/ta)
[phase3.6] → /workspace/benchmark/hotp/ta/results/ta_chains.json

[DEBUG] Include paths:
  ✓ /workspace/benchmark/hotp/ta
  ✓ /workspace/benchmark/hotp/ta/include
  ✓ ./include
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/hotp/ta/hotp_ta.c
  Args: -I/workspace/benchmark/hotp/ta -I/workspace/benchmark/hotp/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TA_OPTEE_CORE_API_COMPAT_1_1=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=hotp_ta_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[extract_sink_calls] 8 entries → /workspace/benchmark/hotp/ta/results/ta_vulnerable_destinations.json
[DEBUG] 入力チェーン数: 8
[DEBUG] ソース関数マッピング: {'TA_InvokeCommandEntryPoint': [], 'TA_OpenSessionEntryPoint': []}
[DEBUG] ソース関数: ['TA_InvokeCommandEntryPoint', 'TA_OpenSessionEntryPoint']
[DEBUG] ステップ1後: 8 CDFs
[DEBUG] ステップ2後: 8 CDFs（同じVD+ソースの最長チェーンのみ）
[DEBUG] ステップ3後: 8 CDFs（0 個のサブチェーンを削除）
[DEBUG] ステップ4: 3 グループ
[DEBUG] ステップ4後: 3 CDFs（3 グループがマージされた）
[DEBUG] 最終的な危険フロー:
  - TEE_MACComputeFinal at line 108, params=[0, 2, 3]: TA_InvokeCommandEntryPoint -> get_hotp -> hmac_sha1 -> TEE_MACComputeFinal
  - memset at line 152, params=[0, 2]: TA_InvokeCommandEntryPoint -> register_shared_key -> memset
  - memcpy at line 153, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> register_shared_key -> memcpy

[generate_candidate_flows] 3 件 → /workspace/benchmark/hotp/ta/results/ta_candidate_flows.json
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[DEBUG] Using prompts directory: /workspace/prompts/vulnerabilities_prompt
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
[DEBUG] RAG system already initialized
[INFO] RAG mode disabled
[INFO] RAG disabled
使用中のLLMプロバイダー: openrouter
[taint_analyzer] 3 個の候補フローを解析中...
  [1/3] チェーン: TA_InvokeCommandEntryPoint -> get_hotp -> hmac_sha1 -> TEE_MACComputeFinal
[DEBUG] Loaded prompt: taint_start.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle_multi_params.txt
[DEBUG] Loaded prompt: taint_end.txt
  [2/3] チェーン: TA_InvokeCommandEntryPoint -> register_shared_key -> memset
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [3/3] チェーン: TA_InvokeCommandEntryPoint -> register_shared_key -> memcpy
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[taint_analyzer] 解析完了: 0 件の脆弱性を検出
  結果: /workspace/benchmark/hotp/ta/results/ta_vulnerabilities.json
  ログ: /workspace/benchmark/hotp/ta/results/taint_analysis_log.txt
Traceback (most recent call last):
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 169, in <module>
    main()
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 138, in main
    generate_summary_report(out_dir, statistics, vulnerabilities)
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 161, in generate_summary_report
    from .report_generator import ReportGenerator
ImportError: attempted relative import with no known parent package
[generate_report] HTMLレポートを生成しました: /workspace/benchmark/hotp/ta/results/ta_vulnerability_report.html
  検出脆弱性数: 0
  AI対話履歴を含めました: /workspace/benchmark/hotp/ta/results/taint_analysis_log.txt
  対話チェーン数: 3
make -C host CROSS_COMPILE="arm-linux-gnueabihf-" --no-builtin-variables \
	TEEC_EXPORT=/workspace/benchmark/random/../../optee_client/out/export
make[1]: Entering directory '/workspace/benchmark/random/host'
arm-linux-gnueabihf-gcc -Wall -I../ta/include -I./include -I/workspace/benchmark/random/../../optee_client/out/export/include -c main.c -o main.o
arm-linux-gnueabihf-gcc  -o optee_example_random main.o -lteec -L/workspace/benchmark/random/../../optee_client/out/export/lib
make[1]: Leaving directory '/workspace/benchmark/random/host'
make -C ta CROSS_COMPILE="arm-linux-gnueabihf-" LDFLAGS="" \
	TA_DEV_KIT_DIR=/workspace/benchmark/random/../../optee_os/out/arm/export-ta_arm32
make[1]: Entering directory '/workspace/benchmark/random/ta'
  CC      random_example_ta.o
  CC      user_ta_header.o
  CPP     ta.lds
  LD      b6c53aba-9669-4668-a7f2-205629d00f86.elf
  OBJDUMP b6c53aba-9669-4668-a7f2-205629d00f86.dmp
  OBJCOPY b6c53aba-9669-4668-a7f2-205629d00f86.stripped.elf
  SIGN    b6c53aba-9669-4668-a7f2-205629d00f86.ta
make[1]: Leaving directory '/workspace/benchmark/random/ta'
[INFO] Loaded sink definitions from /workspace/rules/generated_sink_definitions.json
[INFO] PatternMatcher initialized with 3 sink functions
[INFO] Sample sinks: TEE_MemMove(params: [0, 1, 2]), snprintf(params: [0, 1, 2, 3]), TEEC_InvokeCommand(params: [1, 2])
使用中のLLMプロバイダー: openrouter
呼び出し済み外部 API を抽出中...
外部 API 関数: 4 個
外部 API 関数をシンクとして解析中...

[DEBUG] PatternMatcher initialized
[DEBUG] Loaded rules count: 3
[DEBUG] Known functions in index: 3

[DEBUG] Analyzing: TEE_Free
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_GenerateRandom
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_Malloc
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_MemMove
  - Is known: True
  - Is sink: True
  - Dangerous params: {0, 1, 2}
  - Rule IDs: {'unencrypted_data_output', 'input_validation_weaknesses'}
抽出されたシンク候補: 10 個
結果を /workspace/benchmark/random/ta/results/ta_sinks.json に保存しました
[DEBUG] Include paths:
  ✓ /workspace/benchmark/random/ta
  ✓ /workspace/benchmark/random/ta/include
  ✓ ./include
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/random/ta/random_example_ta.c
  Args: -I/workspace/benchmark/random/ta -I/workspace/benchmark/random/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TA_OPTEE_CORE_API_COMPAT_1_1=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=random_example_ta_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[find_sink_calls] 7 call sites → /workspace/benchmark/random/ta/results/ta_vulnerable_destinations.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/random/ta
  ✓ /workspace/benchmark/random/ta/include
  ✓ ./include
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/random/ta/random_example_ta.c
  Args: -I/workspace/benchmark/random/ta -I/workspace/benchmark/random/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TA_OPTEE_CORE_API_COMPAT_1_1=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=random_example_ta_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[generate_call_graph_advanced] 7 edges, 6 functions → /workspace/benchmark/random/ta/results/ta_call_graph.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/random/ta
  ✓ /workspace/benchmark/random/ta/include
  ✓ ./include
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/random/ta/random_example_ta.c
  Args: -I/workspace/benchmark/random/ta -I/workspace/benchmark/random/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TA_OPTEE_CORE_API_COMPAT_1_1=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=random_example_ta_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[extract_sink_calls] 7 entries → /workspace/benchmark/random/ta/results/ta_vulnerable_destinations.json
[DEBUG] 入力チェーン数: 7
[DEBUG] ソース関数マッピング: {'TA_InvokeCommandEntryPoint': [], 'TA_OpenSessionEntryPoint': []}
[DEBUG] ソース関数: ['TA_InvokeCommandEntryPoint', 'TA_OpenSessionEntryPoint']
[DEBUG] ステップ1後: 7 CDFs
[DEBUG] ステップ2後: 7 CDFs（同じVD+ソースの最長チェーンのみ）
[DEBUG] ステップ3後: 7 CDFs（0 個のサブチェーンを削除）
[DEBUG] ステップ4: 4 グループ
[DEBUG] ステップ4後: 4 CDFs（2 グループがマージされた）
[DEBUG] 最終的な危険フロー:
  - TEE_Malloc at line 78, params=[0]: TA_InvokeCommandEntryPoint -> random_number_generate -> TEE_Malloc
  - TEE_GenerateRandom at line 90, params=[0, 1]: TA_InvokeCommandEntryPoint -> random_number_generate -> TEE_GenerateRandom
  - TEE_MemMove at line 91, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> random_number_generate -> TEE_MemMove
  - TEE_Free at line 92, params=[0]: TA_InvokeCommandEntryPoint -> random_number_generate -> TEE_Free

[generate_candidate_flows] 4 件 → /workspace/benchmark/random/ta/results/ta_candidate_flows.json
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[DEBUG] Using prompts directory: /workspace/prompts/vulnerabilities_prompt
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
[DEBUG] RAG system already initialized
[INFO] RAG mode disabled
[INFO] RAG disabled
使用中のLLMプロバイダー: openrouter
[taint_analyzer] 4 個の候補フローを解析中...
  [1/4] チェーン: TA_InvokeCommandEntryPoint -> random_number_generate -> TEE_Malloc
[DEBUG] Loaded prompt: taint_start.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle.txt
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Loaded prompt: taint_end.txt
  [2/4] チェーン: TA_InvokeCommandEntryPoint -> random_number_generate -> TEE_GenerateRandom
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle_multi_params.txt
  [3/4] チェーン: TA_InvokeCommandEntryPoint -> random_number_generate -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [4/4] チェーン: TA_InvokeCommandEntryPoint -> random_number_generate -> TEE_Free
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Free, param_index=0
[taint_analyzer] 解析完了: 0 件の脆弱性を検出
  結果: /workspace/benchmark/random/ta/results/ta_vulnerabilities.json
  ログ: /workspace/benchmark/random/ta/results/taint_analysis_log.txt
Traceback (most recent call last):
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 169, in <module>
    main()
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 138, in main
    generate_summary_report(out_dir, statistics, vulnerabilities)
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 161, in generate_summary_report
    from .report_generator import ReportGenerator
ImportError: attempted relative import with no known parent package
[generate_report] HTMLレポートを生成しました: /workspace/benchmark/random/ta/results/ta_vulnerability_report.html
  検出脆弱性数: 0
  AI対話履歴を含めました: /workspace/benchmark/random/ta/results/taint_analysis_log.txt
  対話チェーン数: 4
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/extract_sink_calls.py --compile-db /workspace/benchmark/hotp/ta/compile_commands.json --sinks /workspace/benchmark/hotp/ta/results/ta_sinks.json --output /workspace/benchmark/hotp/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/hotp/ta)
[phase3.7] → /workspace/benchmark/hotp/ta/results/ta_vulnerable_destinations.json

[phase5_command] → python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/hotp/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/hotp/ta/results/ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/hotp/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/hotp/ta/results/ta_candidate_flows.json  (cwd=/workspace/benchmark/hotp/ta)
[phase5 ] → /workspace/benchmark/hotp/ta/results/ta_candidate_flows.json

[INFO] $ /usr/bin/python3 /workspace/src/analyze_vulnerabilities/taint_analyzer.py --flows /workspace/benchmark/hotp/ta/results/ta_candidate_flows.json --phase12 /workspace/benchmark/hotp/ta/results/ta_phase12.json --output /workspace/benchmark/hotp/ta/results/ta_vulnerabilities.json --generate-summary --no-rag  (cwd=/workspace/benchmark/hotp/ta)
[WARN]   ↳ rc=1
[INFO] $ /usr/bin/python3 /workspace/src/report/generate_report.py --vulnerabilities /workspace/benchmark/hotp/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/hotp/ta/results/ta_phase12.json --project-name hotp --output /workspace/benchmark/hotp/ta/results/ta_vulnerability_report.html  (cwd=/workspace/benchmark/hotp/ta)
[phase7 ] → /workspace/benchmark/hotp/ta/results/ta_vulnerability_report.html


=== Project: random / TA: ta ===
[INFO] RAG mode is disabled for this analysis
[INFO] Cleaning dependencies for random
  - Removed stale dependency: ta/.random_example_ta.o.d
  - Removed stale dependency: ta/.user_ta_header.o.d
  - Executed 'make clean' in .
  - Executed 'make clean' in ta
  - Executed 'make clean' in host
  ✓ Cleaned 5 files
[INFO] $ bear -- make  (cwd=/workspace/benchmark/random)
[INFO] TA DB saved: /workspace/benchmark/random/ta/compile_commands.json  entries=1
[DEBUG] Include paths:
  ✓ /workspace/benchmark/random/ta
  ✓ /workspace/benchmark/random/ta/include
  ✗ ./include
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/random/ta/random_example_ta.c
  Args: -I/workspace/benchmark/random/ta -I/workspace/benchmark/random/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TA_OPTEE_CORE_API_COMPAT_1_1=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=random_example_ta_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[phase1-2] → /workspace/benchmark/random/ta/results/ta_phase12.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/identify_sinks.py -i /workspace/benchmark/random/ta/results/ta_phase12.json -o /workspace/benchmark/random/ta/results/ta_sinks.json --no-rag  (cwd=/workspace/benchmark/random/ta)
[phase3 ] → /workspace/benchmark/random/ta/results/ta_sinks.json

[phase3.1] → python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/random/ta/compile_commands.json --sinks /workspace/benchmark/random/ta/results/ta_sinks.json --output /workspace/benchmark/random/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/random/ta/compile_commands.json --sinks /workspace/benchmark/random/ta/results/ta_sinks.json --output /workspace/benchmark/random/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/random/ta)
[phase3.4] → /workspace/benchmark/random/ta/results/ta_vulnerable_destinations.json

[phase3.2] → python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/random/ta/compile_commands.json --output /workspace/benchmark/random/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/random/ta/compile_commands.json --output /workspace/benchmark/random/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/random/ta)
[phase3.5] → /workspace/benchmark/random/ta/results/ta_call_graph.json

[phase3.3] → python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/random/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/random/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/random/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/random/ta/results/ta_chains.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/random/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/random/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/random/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/random/ta/results/ta_chains.json  (cwd=/workspace/benchmark/random/ta)
[phase3.6] → /workspace/benchmark/random/ta/results/ta_chains.json

[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/extract_sink_calls.py --compile-db /workspace/benchmark/random/ta/compile_commands.json --sinks /workspace/benchmark/random/ta/results/ta_sinks.json --output /workspace/benchmark/random/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/random/ta)
[phase3.7] → /workspace/benchmark/random/ta/results/ta_vulnerable_destinations.json

[phase5_command] → python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/random/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/random/ta/results/ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/random/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/random/ta/results/ta_candidate_flows.json  (cwd=/workspace/benchmark/random/ta)
[phase5 ] → /workspace/benchmark/random/ta/results/ta_candidate_flows.json

[INFO] $ /usr/bin/python3 /workspace/src/analyze_vulnerabilities/taint_analyzer.py --flows /workspace/benchmark/random/ta/results/ta_candidate_flows.json --phase12 /workspace/benchmark/random/ta/results/ta_phase12.json --output /workspace/benchmark/random/ta/results/ta_vulnerabilities.json --generate-summary --no-rag  (cwd=/workspace/benchmark/random/ta)
[WARN]   ↳ rc=1
[INFO] $ /usr/bin/python3 /workspace/src/report/generate_report.py --vulnerabilities /workspace/benchmark/random/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/random/ta/results/ta_phase12.json --project-name random --output /workspace/benchmark/random/ta/results/ta_vulnerability_report.html  (cwd=/workspace/benchmark/random/ta)
[phase7 ] → /workspace/benchmark/random/ta/results/ta_vulnerability_report.html


=== Project: secure_storage / TA: ta ===
[INFO] RAG mode is disabled for this analysis
[INFO] Cleaning dependencies for secure_storage
make -C host CROSS_COMPILE="arm-linux-gnueabihf-" --no-builtin-variables \
	TEEC_EXPORT=/workspace/benchmark/secure_storage/../../optee_client/out/export
make[1]: Entering directory '/workspace/benchmark/secure_storage/host'
arm-linux-gnueabihf-gcc -Wall -I../ta/include -I./include -I/workspace/benchmark/secure_storage/../../optee_client/out/export/include -c main.c -o main.o
arm-linux-gnueabihf-gcc  -o optee_example_secure_storage main.o -lteec -L/workspace/benchmark/secure_storage/../../optee_client/out/export/lib
make[1]: Leaving directory '/workspace/benchmark/secure_storage/host'
make -C ta CROSS_COMPILE="arm-linux-gnueabihf-" LDFLAGS="" \
	TA_DEV_KIT_DIR=/workspace/benchmark/secure_storage/../../optee_os/out/arm/export-ta_arm32
make[1]: Entering directory '/workspace/benchmark/secure_storage/ta'
  CC      secure_storage_ta.o
  CC      user_ta_header.o
  CPP     ta.lds
  LD      f4e750bb-1437-4fbf-8785-8d3580c34994.elf
  OBJDUMP f4e750bb-1437-4fbf-8785-8d3580c34994.dmp
  OBJCOPY f4e750bb-1437-4fbf-8785-8d3580c34994.stripped.elf
  SIGN    f4e750bb-1437-4fbf-8785-8d3580c34994.ta
make[1]: Leaving directory '/workspace/benchmark/secure_storage/ta'
[INFO] Loaded sink definitions from /workspace/rules/generated_sink_definitions.json
[INFO] PatternMatcher initialized with 3 sink functions
[INFO] Sample sinks: TEE_MemMove(params: [0, 1, 2]), snprintf(params: [0, 1, 2, 3]), TEEC_InvokeCommand(params: [1, 2])
使用中のLLMプロバイダー: openrouter
呼び出し済み外部 API を抽出中...
外部 API 関数: 10 個
外部 API 関数をシンクとして解析中...

[DEBUG] PatternMatcher initialized
[DEBUG] Loaded rules count: 3
[DEBUG] Known functions in index: 3

[DEBUG] Analyzing: TEE_CloseAndDeletePersistentObject1
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_CloseObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_CreatePersistentObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_Free
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_GetObjectInfo1
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_Malloc
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_MemMove
  - Is known: True
  - Is sink: True
  - Dangerous params: {0, 1, 2}
  - Rule IDs: {'unencrypted_data_output', 'input_validation_weaknesses'}

[DEBUG] Analyzing: TEE_OpenPersistentObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_ReadObjectData
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_WriteObjectData
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()
抽出されたシンク候補: 15 個
結果を /workspace/benchmark/secure_storage/ta/results/ta_sinks.json に保存しました
[DEBUG] Include paths:
  ✓ /workspace/benchmark/secure_storage/ta
  ✓ /workspace/benchmark/secure_storage/ta/include
  ✓ ./include
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/secure_storage/ta/secure_storage_ta.c
  Args: -I/workspace/benchmark/secure_storage/ta -I/workspace/benchmark/secure_storage/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TA_OPTEE_CORE_API_COMPAT_1_1=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=secure_storage_ta_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[find_sink_calls] 28 call sites → /workspace/benchmark/secure_storage/ta/results/ta_vulnerable_destinations.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/secure_storage/ta
  ✓ /workspace/benchmark/secure_storage/ta/include
  ✓ ./include
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/secure_storage/ta/secure_storage_ta.c
  Args: -I/workspace/benchmark/secure_storage/ta -I/workspace/benchmark/secure_storage/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TA_OPTEE_CORE_API_COMPAT_1_1=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=secure_storage_ta_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[generate_call_graph_advanced] 40 edges, 8 functions → /workspace/benchmark/secure_storage/ta/results/ta_call_graph.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/secure_storage/ta
  ✓ /workspace/benchmark/secure_storage/ta/include
  ✓ ./include
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/secure_storage/ta/secure_storage_ta.c
  Args: -I/workspace/benchmark/secure_storage/ta -I/workspace/benchmark/secure_storage/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TA_OPTEE_CORE_API_COMPAT_1_1=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=secure_storage_ta_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[extract_sink_calls] 28 entries → /workspace/benchmark/secure_storage/ta/results/ta_vulnerable_destinations.json
[DEBUG] 入力チェーン数: 28
[DEBUG] ソース関数マッピング: {'TA_InvokeCommandEntryPoint': [], 'TA_OpenSessionEntryPoint': []}
[DEBUG] ソース関数: ['TA_InvokeCommandEntryPoint', 'TA_OpenSessionEntryPoint']
[DEBUG] ステップ1後: 28 CDFs
[DEBUG] ステップ2後: 28 CDFs（同じVD+ソースの最長チェーンのみ）
[DEBUG] ステップ3後: 28 CDFs（0 個のサブチェーンを削除）
[DEBUG] ステップ4: 13 グループ
[DEBUG] ステップ4後: 13 CDFs（8 グループがマージされた）
[DEBUG] 最終的な危険フロー:
  - TEE_Malloc at line 52, params=[0]: TA_InvokeCommandEntryPoint -> delete_object -> TEE_Malloc
  - TEE_MemMove at line 56, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> delete_object -> TEE_MemMove
  - TEE_Malloc at line 100, params=[0]: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_Malloc
  - TEE_MemMove at line 104, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_MemMove
  - TEE_Malloc at line 107, params=[0]: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_Malloc
  - TEE_MemMove at line 110, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_MemMove
  - TEE_CreatePersistentObject at line 120, params=[1, 2, 6, 7]: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_CreatePersistentObject
  - TEE_WriteObjectData at line 133, params=[1, 2]: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_WriteObjectData
  - TEE_Malloc at line 168, params=[0]: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_Malloc
  - TEE_MemMove at line 172, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_MemMove
  - TEE_Malloc at line 175, params=[0]: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_Malloc
  - TEE_ReadObjectData at line 211, params=[0, 2]: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_ReadObjectData
  - TEE_MemMove at line 214, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_MemMove

[generate_candidate_flows] 13 件 → /workspace/benchmark/secure_storage/ta/results/ta_candidate_flows.json
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[DEBUG] Using prompts directory: /workspace/prompts/vulnerabilities_prompt
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
[DEBUG] RAG system already initialized
[INFO] RAG mode disabled
[INFO] RAG disabled
使用中のLLMプロバイダー: openrouter
[taint_analyzer] 13 個の候補フローを解析中...
  [1/13] チェーン: TA_InvokeCommandEntryPoint -> delete_object -> TEE_Malloc
[DEBUG] Loaded prompt: taint_start.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle.txt
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Loaded prompt: taint_end.txt
  [2/13] チェーン: TA_InvokeCommandEntryPoint -> delete_object -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle_multi_params.txt
  [3/13] チェーン: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
  [4/13] チェーン: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [5/13] チェーン: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
  [6/13] チェーン: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [7/13] チェーン: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_CreatePersistentObject
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [8/13] チェーン: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_WriteObjectData
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [9/13] チェーン: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
  [10/13] チェーン: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [11/13] チェーン: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
  [12/13] チェーン: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_ReadObjectData
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [13/13] チェーン: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[taint_analyzer] 解析完了: 1 件の脆弱性を検出
  結果: /workspace/benchmark/secure_storage/ta/results/ta_vulnerabilities.json
  ログ: /workspace/benchmark/secure_storage/ta/results/taint_analysis_log.txt
Traceback (most recent call last):
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 169, in <module>
    main()
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 138, in main
    generate_summary_report(out_dir, statistics, vulnerabilities)
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 161, in generate_summary_report
    from .report_generator import ReportGenerator
ImportError: attempted relative import with no known parent package
[generate_report] HTMLレポートを生成しました: /workspace/benchmark/secure_storage/ta/results/ta_vulnerability_report.html
  検出脆弱性数: 1
  AI対話履歴を含めました: /workspace/benchmark/secure_storage/ta/results/taint_analysis_log.txt
  対話チェーン数: 9
make -C host CROSS_COMPILE="arm-linux-gnueabihf-" --no-builtin-variables \
	TEEC_EXPORT=/workspace/benchmark/secvideo_demo/../../optee_client/out/export
make[1]: Entering directory '/workspace/benchmark/secvideo_demo/host'
arm-linux-gnueabihf-gcc -Wall -I../ta/include -I/workspace/benchmark/secvideo_demo/../../optee_client/out/export/include -I./include -c secvideo_demo.c -o secvideo_demo.o
secvideo_demo.c: In function ‘allocate_outputmem’:
secvideo_demo.c:119:13: warning: unused variable ‘ret’ [-Wunused-variable]
  119 |         int ret, secfb_dev;
      |             ^~~
arm-linux-gnueabihf-gcc -o secvideo_demo secvideo_demo.o -lteec -L/workspace/benchmark/secvideo_demo/../../optee_client/out/export/lib -lpthread
make[1]: Leaving directory '/workspace/benchmark/secvideo_demo/host'
make -C ta CROSS_COMPILE="arm-linux-gnueabihf-" LDFLAGS="" \
	TA_DEV_KIT_DIR=/workspace/benchmark/secvideo_demo/../../optee_os/out/arm/export-ta_arm32
make[1]: Entering directory '/workspace/benchmark/secvideo_demo/ta'
  CC      secvideo_demo_ta.o
secvideo_demo_ta.c: In function ‘clear_screen’:
secvideo_demo_ta.c:96:24: warning: unused variable ‘offset’ [-Wunused-variable]
   96 |         size_t out_sz, offset = 0;
      |                        ^~~~~~
secvideo_demo_ta.c:96:16: warning: unused variable ‘out_sz’ [-Wunused-variable]
   96 |         size_t out_sz, offset = 0;
      |                ^~~~~~
secvideo_demo_ta.c:93:20: warning: unused variable ‘res’ [-Wunused-variable]
   93 |         TEE_Result res;
      |                    ^~~
  CC      user_ta_header.o
  CPP     ta.lds
  LD      ffa39702-9ce0-47e0-a1cb4048cfdb847d.elf
  OBJDUMP ffa39702-9ce0-47e0-a1cb4048cfdb847d.dmp
  OBJCOPY ffa39702-9ce0-47e0-a1cb4048cfdb847d.stripped.elf
  SIGN    ffa39702-9ce0-47e0-a1cb4048cfdb847d.ta
make[1]: Leaving directory '/workspace/benchmark/secvideo_demo/ta'
[INFO] Loaded sink definitions from /workspace/rules/generated_sink_definitions.json
[INFO] PatternMatcher initialized with 3 sink functions
[INFO] Sample sinks: TEE_MemMove(params: [0, 1, 2]), snprintf(params: [0, 1, 2, 3]), TEEC_InvokeCommand(params: [1, 2])
使用中のLLMプロバイダー: openrouter
呼び出し済み外部 API を抽出中...
外部 API 関数: 11 個
外部 API 関数をシンクとして解析中...

[DEBUG] PatternMatcher initialized
[DEBUG] Loaded rules count: 3
[DEBUG] Known functions in index: 3

[DEBUG] Analyzing: TEE_AllocateOperation
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_AllocateTransientObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_CheckMemoryAccessRights
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_CipherDoFinal
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_CipherInit
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_Free
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_FreeTransientObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_Malloc
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_PopulateTransientObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_SetOperationKey
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: memset
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()
抽出されたシンク候補: 9 個
結果を /workspace/benchmark/secvideo_demo/ta/results/ta_sinks.json に保存しました
  - Removed stale dependency: ta/.user_ta_header.o.d
  - Removed stale dependency: ta/.secure_storage_ta.o.d
  - Executed 'make clean' in .
  - Executed 'make clean' in ta
  - Executed 'make clean' in host
  ✓ Cleaned 5 files
[INFO] $ bear -- make  (cwd=/workspace/benchmark/secure_storage)
[INFO] TA DB saved: /workspace/benchmark/secure_storage/ta/compile_commands.json  entries=1
[DEBUG] Include paths:
  ✓ /workspace/benchmark/secure_storage/ta
  ✓ /workspace/benchmark/secure_storage/ta/include
  ✗ ./include
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/secure_storage/ta/secure_storage_ta.c
  Args: -I/workspace/benchmark/secure_storage/ta -I/workspace/benchmark/secure_storage/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TA_OPTEE_CORE_API_COMPAT_1_1=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=secure_storage_ta_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[phase1-2] → /workspace/benchmark/secure_storage/ta/results/ta_phase12.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/identify_sinks.py -i /workspace/benchmark/secure_storage/ta/results/ta_phase12.json -o /workspace/benchmark/secure_storage/ta/results/ta_sinks.json --no-rag  (cwd=/workspace/benchmark/secure_storage/ta)
[phase3 ] → /workspace/benchmark/secure_storage/ta/results/ta_sinks.json

[phase3.1] → python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/secure_storage/ta/compile_commands.json --sinks /workspace/benchmark/secure_storage/ta/results/ta_sinks.json --output /workspace/benchmark/secure_storage/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/secure_storage/ta/compile_commands.json --sinks /workspace/benchmark/secure_storage/ta/results/ta_sinks.json --output /workspace/benchmark/secure_storage/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/secure_storage/ta)
[phase3.4] → /workspace/benchmark/secure_storage/ta/results/ta_vulnerable_destinations.json

[phase3.2] → python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/secure_storage/ta/compile_commands.json --output /workspace/benchmark/secure_storage/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/secure_storage/ta/compile_commands.json --output /workspace/benchmark/secure_storage/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/secure_storage/ta)
[phase3.5] → /workspace/benchmark/secure_storage/ta/results/ta_call_graph.json

[phase3.3] → python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/secure_storage/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/secure_storage/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/secure_storage/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/secure_storage/ta/results/ta_chains.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/secure_storage/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/secure_storage/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/secure_storage/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/secure_storage/ta/results/ta_chains.json  (cwd=/workspace/benchmark/secure_storage/ta)
[phase3.6] → /workspace/benchmark/secure_storage/ta/results/ta_chains.json

[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/extract_sink_calls.py --compile-db /workspace/benchmark/secure_storage/ta/compile_commands.json --sinks /workspace/benchmark/secure_storage/ta/results/ta_sinks.json --output /workspace/benchmark/secure_storage/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/secure_storage/ta)
[phase3.7] → /workspace/benchmark/secure_storage/ta/results/ta_vulnerable_destinations.json

[phase5_command] → python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/secure_storage/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/secure_storage/ta/results/ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/secure_storage/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/secure_storage/ta/results/ta_candidate_flows.json  (cwd=/workspace/benchmark/secure_storage/ta)
[phase5 ] → /workspace/benchmark/secure_storage/ta/results/ta_candidate_flows.json

[INFO] $ /usr/bin/python3 /workspace/src/analyze_vulnerabilities/taint_analyzer.py --flows /workspace/benchmark/secure_storage/ta/results/ta_candidate_flows.json --phase12 /workspace/benchmark/secure_storage/ta/results/ta_phase12.json --output /workspace/benchmark/secure_storage/ta/results/ta_vulnerabilities.json --generate-summary --no-rag  (cwd=/workspace/benchmark/secure_storage/ta)
[WARN]   ↳ rc=1
[INFO] $ /usr/bin/python3 /workspace/src/report/generate_report.py --vulnerabilities /workspace/benchmark/secure_storage/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/secure_storage/ta/results/ta_phase12.json --project-name secure_storage --output /workspace/benchmark/secure_storage/ta/results/ta_vulnerability_report.html  (cwd=/workspace/benchmark/secure_storage/ta)
[phase7 ] → /workspace/benchmark/secure_storage/ta/results/ta_vulnerability_report.html


=== Project: secvideo_demo / TA: ta ===
[INFO] RAG mode is disabled for this analysis
[INFO] Cleaning dependencies for secvideo_demo
  - Executed 'make clean' in .
  - Executed 'make clean' in ta
  - Executed 'make clean' in host
  ✓ Cleaned 3 files
[INFO] $ bear -- make  (cwd=/workspace/benchmark/secvideo_demo)
[INFO] TA DB saved: /workspace/benchmark/secvideo_demo/ta/compile_commands.json  entries=1
[DEBUG] Include paths:
  ✓ /workspace/benchmark/secvideo_demo/ta
  ✓ /workspace/benchmark/secvideo_demo/ta/include
  ✗ ./include
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/secvideo_demo/ta/secvideo_demo_ta.c
  Args: -I/workspace/benchmark/secvideo_demo/ta -I/workspace/benchmark/secvideo_demo/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=secvideo_demo_ta_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[phase1-2] → /workspace/benchmark/secvideo_demo/ta/results/ta_phase12.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/identify_sinks.py -i /workspace/benchmark/secvideo_demo/ta/results/ta_phase12.json -o /workspace/benchmark/secvideo_demo/ta/results/ta_sinks.json --no-rag  (cwd=/workspace/benchmark/secvideo_demo/ta)
[phase3 ] → /workspace/benchmark/secvideo_demo/ta/results/ta_sinks.json

[DEBUG] Include paths:
  ✓ /workspace/benchmark/secvideo_demo/ta
  ✓ /workspace/benchmark/secvideo_demo/ta/include
  ✓ ./include
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/secvideo_demo/ta/secvideo_demo_ta.c
  Args: -I/workspace/benchmark/secvideo_demo/ta -I/workspace/benchmark/secvideo_demo/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=secvideo_demo_ta_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[find_sink_calls] 9 call sites → /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerable_destinations.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/secvideo_demo/ta
  ✓ /workspace/benchmark/secvideo_demo/ta/include
  ✓ ./include
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/secvideo_demo/ta/secvideo_demo_ta.c
  Args: -I/workspace/benchmark/secvideo_demo/ta -I/workspace/benchmark/secvideo_demo/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=secvideo_demo_ta_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[generate_call_graph_advanced] 31 edges, 8 functions → /workspace/benchmark/secvideo_demo/ta/results/ta_call_graph.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/secvideo_demo/ta
  ✓ /workspace/benchmark/secvideo_demo/ta/include
  ✓ ./include
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/secvideo_demo/ta/secvideo_demo_ta.c
  Args: -I/workspace/benchmark/secvideo_demo/ta -I/workspace/benchmark/secvideo_demo/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=secvideo_demo_ta_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[extract_sink_calls] 9 entries → /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerable_destinations.json
[DEBUG] 入力チェーン数: 9
[DEBUG] ソース関数マッピング: {'TA_InvokeCommandEntryPoint': [], 'TA_OpenSessionEntryPoint': []}
[DEBUG] ソース関数: ['TA_InvokeCommandEntryPoint', 'TA_OpenSessionEntryPoint']
[DEBUG] ステップ1後: 9 CDFs
[DEBUG] ステップ2後: 9 CDFs（同じVD+ソースの最長チェーンのみ）
[DEBUG] ステップ3後: 9 CDFs（0 個のサブチェーンを削除）
[DEBUG] ステップ4: 4 グループ
[DEBUG] ステップ4後: 4 CDFs（3 グループがマージされた）
[DEBUG] 最終的な危険フロー:
  - TEE_Malloc at line 107, params=[0]: TA_InvokeCommandEntryPoint -> clear_screen -> TEE_Malloc
  - memset at line 110, params=[0, 2]: TA_InvokeCommandEntryPoint -> clear_screen -> memset
  - TEE_PopulateTransientObject at line 143, params=[1, 2]: TA_InvokeCommandEntryPoint -> image_data -> decrypt -> TEE_PopulateTransientObject
  - TEE_CipherDoFinal at line 158, params=[0, 2, 3, 4]: TA_InvokeCommandEntryPoint -> image_data -> decrypt -> TEE_CipherDoFinal

[generate_candidate_flows] 4 件 → /workspace/benchmark/secvideo_demo/ta/results/ta_candidate_flows.json
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[DEBUG] Using prompts directory: /workspace/prompts/vulnerabilities_prompt
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
[DEBUG] RAG system already initialized
[INFO] RAG mode disabled
[INFO] RAG disabled
使用中のLLMプロバイダー: openrouter
[taint_analyzer] 4 個の候補フローを解析中...
  [1/4] チェーン: TA_InvokeCommandEntryPoint -> clear_screen -> TEE_Malloc
[DEBUG] Loaded prompt: taint_start.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle.txt
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Loaded prompt: taint_end.txt
  [2/4] チェーン: TA_InvokeCommandEntryPoint -> clear_screen -> memset
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle_multi_params.txt
  [3/4] チェーン: TA_InvokeCommandEntryPoint -> image_data -> decrypt -> TEE_PopulateTransientObject
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [4/4] チェーン: TA_InvokeCommandEntryPoint -> image_data -> decrypt -> TEE_CipherDoFinal
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[taint_analyzer] 解析完了: 0 件の脆弱性を検出
  結果: /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerabilities.json
  ログ: /workspace/benchmark/secvideo_demo/ta/results/taint_analysis_log.txt
Traceback (most recent call last):
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 169, in <module>
    main()
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 138, in main
    generate_summary_report(out_dir, statistics, vulnerabilities)
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 161, in generate_summary_report
    from .report_generator import ReportGenerator
ImportError: attempted relative import with no known parent package
[generate_report] HTMLレポートを生成しました: /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerability_report.html
  検出脆弱性数: 0
  AI対話履歴を含めました: /workspace/benchmark/secvideo_demo/ta/results/taint_analysis_log.txt
  対話チェーン数: 4
make -C host CROSS_COMPILE="arm-linux-gnueabihf-" --no-builtin-variables  \
	TEEC_EXPORT=/workspace/benchmark/optee-fiovb/../../optee_client/out/export
make[1]: Entering directory '/workspace/benchmark/optee-fiovb/host'
arm-linux-gnueabihf-gcc -Wall -I../ta/include -I./ -I/workspace/benchmark/optee-fiovb/../../optee_client/out/export/include -c main.c -o main.o
arm-linux-gnueabihf-gcc -o fiovb main.o  -lteec -L/workspace/benchmark/optee-fiovb/../../optee_client/out/export/lib
make[1]: Leaving directory '/workspace/benchmark/optee-fiovb/host'
make -C ta CROSS_COMPILE="arm-linux-gnueabihf-" LDFLAGS=""  \
	TA_DEV_KIT_DIR=/workspace/benchmark/optee-fiovb/../../optee_os/out/arm/export-ta_arm32
make[1]: Entering directory '/workspace/benchmark/optee-fiovb/ta'
  CC      entry.o
entry.c: In function ‘write_value’:
entry.c:71:49: warning: ISO C forbids empty initializer braces [-Wpedantic]
   71 |         char name_full[TEE_OBJECT_ID_MAX_LEN] = { };
      |                                                 ^
entry.c: In function ‘delete_value’:
entry.c:144:49: warning: ISO C forbids empty initializer braces [-Wpedantic]
  144 |         char name_full[TEE_OBJECT_ID_MAX_LEN] = { };
      |                                                 ^
In file included from entry.c:6:
entry.c: In function ‘is_rollback_protected’:
./include/ta_fiovb.h:11:33: warning: passing argument 1 of ‘read_value’ discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
   11 | #define ROLLBACK_PROT           "rollback_protection"
      |                                 ^~~~~~~~~~~~~~~~~~~~~
entry.c:173:26: note: in expansion of macro ‘ROLLBACK_PROT’
  173 |         res = read_value(ROLLBACK_PROT, strlen(ROLLBACK_PROT) + 1,
      |                          ^~~~~~~~~~~~~
entry.c:105:36: note: expected ‘char *’ but argument is of type ‘const char *’
  105 | static TEE_Result read_value(char *name, uint32_t name_sz,
      |                              ~~~~~~^~~~
In file included from entry.c:6:
entry.c: In function ‘is_version_incremental’:
./include/ta_fiovb.h:12:33: warning: passing argument 1 of ‘read_value’ discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
   12 | #define BOOTFIRM_VER            "bootfirmware_version"
      |                                 ^~~~~~~~~~~~~~~~~~~~~~
entry.c:192:26: note: in expansion of macro ‘BOOTFIRM_VER’
  192 |         res = read_value(BOOTFIRM_VER, strlen(BOOTFIRM_VER) + 1,
      |                          ^~~~~~~~~~~~
entry.c:105:36: note: expected ‘char *’ but argument is of type ‘const char *’
  105 | static TEE_Result read_value(char *name, uint32_t name_sz,
      |                              ~~~~~~^~~~
entry.c:185:45: warning: unused parameter ‘new_ver_sz’ [-Wunused-parameter]
  185 |                                    uint32_t new_ver_sz)
      |                                    ~~~~~~~~~^~~~~~~~~~
In file included from entry.c:6:
entry.c: In function ‘increase_boot_firmware’:
./include/ta_fiovb.h:12:33: warning: passing argument 1 of ‘write_value’ discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
   12 | #define BOOTFIRM_VER            "bootfirmware_version"
      |                                 ^~~~~~~~~~~~~~~~~~~~~~
entry.c:222:28: note: in expansion of macro ‘BOOTFIRM_VER’
  222 |         return write_value(BOOTFIRM_VER, strlen(BOOTFIRM_VER) + 1,
      |                            ^~~~~~~~~~~~
entry.c:65:37: note: expected ‘char *’ but argument is of type ‘const char *’
   65 | static TEE_Result write_value(char *name, uint32_t name_sz,
      |                               ~~~~~~^~~~
  CC      user_ta_header.o
  CPP     ta.lds
  LD      22250a54-0bf1-48fe-8002-7b20f1c9c9b1.elf
  OBJDUMP 22250a54-0bf1-48fe-8002-7b20f1c9c9b1.dmp
  OBJCOPY 22250a54-0bf1-48fe-8002-7b20f1c9c9b1.stripped.elf
  SIGN    22250a54-0bf1-48fe-8002-7b20f1c9c9b1.ta
make[1]: Leaving directory '/workspace/benchmark/optee-fiovb/ta'
[INFO] Loaded sink definitions from /workspace/rules/generated_sink_definitions.json
[INFO] PatternMatcher initialized with 3 sink functions
[INFO] Sample sinks: TEE_MemMove(params: [0, 1, 2]), snprintf(params: [0, 1, 2, 3]), TEEC_InvokeCommand(params: [1, 2])
使用中のLLMプロバイダー: openrouter
呼び出し済み外部 API を抽出中...
外部 API 関数: 12 個
外部 API 関数をシンクとして解析中...

[DEBUG] PatternMatcher initialized
[DEBUG] Loaded rules count: 3
[DEBUG] Known functions in index: 3

[DEBUG] Analyzing: TEE_CloseAndDeletePersistentObject1
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_CloseObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_CreatePersistentObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_Free
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_Malloc
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_MemMove
  - Is known: True
  - Is sink: True
  - Dangerous params: {0, 1, 2}
  - Rule IDs: {'input_validation_weaknesses', 'unencrypted_data_output'}

[DEBUG] Analyzing: TEE_OpenPersistentObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_ReadObjectData
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: strcmp
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: strlen
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: strncmp
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: strtoul
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()
抽出されたシンク候補: 11 個
結果を /workspace/benchmark/optee-fiovb/ta/results/ta_sinks.json に保存しました
[DEBUG] Include paths:
  ✓ /workspace/benchmark/optee-fiovb/ta
  ✓ /workspace/benchmark/optee-fiovb/ta/include
  ✓ ./include
  ✓ ./.
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/optee-fiovb/ta/entry.c
  Args: -I/workspace/benchmark/optee-fiovb/ta -I/workspace/benchmark/optee-fiovb/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=entry_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[find_sink_calls] 18 call sites → /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerable_destinations.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/optee-fiovb/ta
  ✓ /workspace/benchmark/optee-fiovb/ta/include
  ✓ ./include
  ✓ ./.
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/optee-fiovb/ta/entry.c
  Args: -I/workspace/benchmark/optee-fiovb/ta -I/workspace/benchmark/optee-fiovb/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=entry_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[generate_call_graph_advanced] 58 edges, 16 functions → /workspace/benchmark/optee-fiovb/ta/results/ta_call_graph.json
[phase3.1] → python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/secvideo_demo/ta/compile_commands.json --sinks /workspace/benchmark/secvideo_demo/ta/results/ta_sinks.json --output /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/secvideo_demo/ta/compile_commands.json --sinks /workspace/benchmark/secvideo_demo/ta/results/ta_sinks.json --output /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/secvideo_demo/ta)
[phase3.4] → /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerable_destinations.json

[phase3.2] → python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/secvideo_demo/ta/compile_commands.json --output /workspace/benchmark/secvideo_demo/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/secvideo_demo/ta/compile_commands.json --output /workspace/benchmark/secvideo_demo/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/secvideo_demo/ta)
[phase3.5] → /workspace/benchmark/secvideo_demo/ta/results/ta_call_graph.json

[phase3.3] → python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/secvideo_demo/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/secvideo_demo/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/secvideo_demo/ta/results/ta_chains.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/secvideo_demo/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/secvideo_demo/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/secvideo_demo/ta/results/ta_chains.json  (cwd=/workspace/benchmark/secvideo_demo/ta)
[phase3.6] → /workspace/benchmark/secvideo_demo/ta/results/ta_chains.json

[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/extract_sink_calls.py --compile-db /workspace/benchmark/secvideo_demo/ta/compile_commands.json --sinks /workspace/benchmark/secvideo_demo/ta/results/ta_sinks.json --output /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/secvideo_demo/ta)
[phase3.7] → /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerable_destinations.json

[phase5_command] → python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/secvideo_demo/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/secvideo_demo/ta/results/ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/secvideo_demo/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/secvideo_demo/ta/results/ta_candidate_flows.json  (cwd=/workspace/benchmark/secvideo_demo/ta)
[phase5 ] → /workspace/benchmark/secvideo_demo/ta/results/ta_candidate_flows.json

[INFO] $ /usr/bin/python3 /workspace/src/analyze_vulnerabilities/taint_analyzer.py --flows /workspace/benchmark/secvideo_demo/ta/results/ta_candidate_flows.json --phase12 /workspace/benchmark/secvideo_demo/ta/results/ta_phase12.json --output /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerabilities.json --generate-summary --no-rag  (cwd=/workspace/benchmark/secvideo_demo/ta)
[WARN]   ↳ rc=1
[INFO] $ /usr/bin/python3 /workspace/src/report/generate_report.py --vulnerabilities /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/secvideo_demo/ta/results/ta_phase12.json --project-name secvideo_demo --output /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerability_report.html  (cwd=/workspace/benchmark/secvideo_demo/ta)
[phase7 ] → /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerability_report.html


=== Project: optee-fiovb / TA: ta ===
[INFO] RAG mode is disabled for this analysis
[INFO] Cleaning dependencies for optee-fiovb
  - Removed stale dependency: ta/.entry.o.d
  - Removed stale dependency: ta/.user_ta_header.o.d
  - Executed 'make clean' in .
  - Executed 'make clean' in ta
  - Executed 'make clean' in host
  ✓ Cleaned 5 files
[INFO] $ bear -- make  (cwd=/workspace/benchmark/optee-fiovb)
[INFO] TA DB saved: /workspace/benchmark/optee-fiovb/ta/compile_commands.json  entries=1
[DEBUG] Include paths:
  ✓ /workspace/benchmark/optee-fiovb/ta
  ✓ /workspace/benchmark/optee-fiovb/ta/include
  ✗ ./include
  ✓ ./.
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/optee-fiovb/ta/entry.c
  Args: -I/workspace/benchmark/optee-fiovb/ta -I/workspace/benchmark/optee-fiovb/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=entry_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[phase1-2] → /workspace/benchmark/optee-fiovb/ta/results/ta_phase12.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/identify_sinks.py -i /workspace/benchmark/optee-fiovb/ta/results/ta_phase12.json -o /workspace/benchmark/optee-fiovb/ta/results/ta_sinks.json --no-rag  (cwd=/workspace/benchmark/optee-fiovb/ta)
[phase3 ] → /workspace/benchmark/optee-fiovb/ta/results/ta_sinks.json

[phase3.1] → python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/optee-fiovb/ta/compile_commands.json --sinks /workspace/benchmark/optee-fiovb/ta/results/ta_sinks.json --output /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/optee-fiovb/ta/compile_commands.json --sinks /workspace/benchmark/optee-fiovb/ta/results/ta_sinks.json --output /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/optee-fiovb/ta)
[phase3.4] → /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerable_destinations.json

[phase3.2] → python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/optee-fiovb/ta/compile_commands.json --output /workspace/benchmark/optee-fiovb/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/optee-fiovb/ta/compile_commands.json --output /workspace/benchmark/optee-fiovb/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/optee-fiovb/ta)
[phase3.5] → /workspace/benchmark/optee-fiovb/ta/results/ta_call_graph.json

[DEBUG] Include paths:
  ✓ /workspace/benchmark/optee-fiovb/ta
  ✓ /workspace/benchmark/optee-fiovb/ta/include
  ✓ ./include
  ✓ ./.
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/optee-fiovb/ta/entry.c
  Args: -I/workspace/benchmark/optee-fiovb/ta -I/workspace/benchmark/optee-fiovb/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=entry_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[extract_sink_calls] 18 entries → /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerable_destinations.json
[DEBUG] 入力チェーン数: 18
[DEBUG] ソース関数マッピング: {'TA_InvokeCommandEntryPoint': [], 'TA_OpenSessionEntryPoint': []}
[DEBUG] ソース関数: ['TA_InvokeCommandEntryPoint', 'TA_OpenSessionEntryPoint']
[DEBUG] ステップ1後: 54 CDFs
[DEBUG] ステップ2後: 18 CDFs（同じVD+ソースの最長チェーンのみ）
[DEBUG] ステップ3後: 18 CDFs（0 個のサブチェーンを削除）
[DEBUG] ステップ4: 8 グループ
[DEBUG] ステップ4後: 8 CDFs（6 グループがマージされた）
[DEBUG] 最終的な危険フロー:
  - TEE_MemMove at line 36, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_rollback_protected -> read_value -> get_named_object_name -> TEE_MemMove
  - TEE_MemMove at line 39, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_rollback_protected -> read_value -> get_named_object_name -> TEE_MemMove
  - strcmp at line 58, params=[0, 1]: TA_InvokeCommandEntryPoint -> write_persist_value -> check_valid_value -> strcmp
  - TEE_ReadObjectData at line 128, params=[0, 2]: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_rollback_protected -> read_value -> TEE_ReadObjectData
  - TEE_Malloc at line 264, params=[0]: TA_InvokeCommandEntryPoint -> write_persist_value -> TEE_Malloc
  - TEE_MemMove at line 268, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> write_persist_value -> TEE_MemMove
  - TEE_Malloc at line 320, params=[0]: TA_InvokeCommandEntryPoint -> read_persist_value -> TEE_Malloc
  - TEE_MemMove at line 326, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> read_persist_value -> TEE_MemMove

[generate_candidate_flows] 8 件 → /workspace/benchmark/optee-fiovb/ta/results/ta_candidate_flows.json
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[DEBUG] Using prompts directory: /workspace/prompts/vulnerabilities_prompt
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
[DEBUG] RAG system already initialized
[INFO] RAG mode disabled
[INFO] RAG disabled
使用中のLLMプロバイダー: openrouter
[taint_analyzer] 8 個の候補フローを解析中...
  [1/8] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_rollback_protected -> read_value -> get_named_object_name -> TEE_MemMove
[DEBUG] Loaded prompt: taint_start.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle_multi_params.txt
[DEBUG] Loaded prompt: taint_end.txt
  [2/8] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_rollback_protected -> read_value -> get_named_object_name -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [3/8] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> check_valid_value -> strcmp
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [4/8] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_rollback_protected -> read_value -> TEE_ReadObjectData
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [5/8] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
  [6/8] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [7/8] チェーン: TA_InvokeCommandEntryPoint -> read_persist_value -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
  [8/8] チェーン: TA_InvokeCommandEntryPoint -> read_persist_value -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[taint_analyzer] 解析完了: 0 件の脆弱性を検出
  結果: /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerabilities.json
  ログ: /workspace/benchmark/optee-fiovb/ta/results/taint_analysis_log.txt
Traceback (most recent call last):
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 169, in <module>
    main()
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 138, in main
    generate_summary_report(out_dir, statistics, vulnerabilities)
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 161, in generate_summary_report
    from .report_generator import ReportGenerator
ImportError: attempted relative import with no known parent package
[generate_report] HTMLレポートを生成しました: /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerability_report.html
  検出脆弱性数: 0
  AI対話履歴を含めました: /workspace/benchmark/optee-fiovb/ta/results/taint_analysis_log.txt
  対話チェーン数: 7
make -C host CROSS_COMPILE="arm-linux-gnueabihf-" --no-builtin-variables  \
	TEEC_EXPORT=/workspace/benchmark/optee-sdp/../../optee_client/out/export
make[1]: Entering directory '/workspace/benchmark/optee-sdp/host'
arm-linux-gnueabihf-gcc -Wall -I../ta/include -I./ -I/workspace/benchmark/optee-sdp/../../optee_client/out/export/include -c smaf-optee.c -o smaf-optee.o
smaf-optee.c: In function ‘sdp_ta_region_create’:
smaf-optee.c:33:9: warning: implicit declaration of function ‘memset’ [-Wimplicit-function-declaration]
   33 |         memset(&op, 0, sizeof(op));
      |         ^~~~~~
smaf-optee.c:10:1: note: include ‘<string.h>’ or provide a declaration of ‘memset’
    9 | #include <tee_client_api.h>
  +++ |+#include <string.h>
   10 | 
smaf-optee.c:33:9: warning: incompatible implicit declaration of built-in function ‘memset’ [-Wbuiltin-declaration-mismatch]
   33 |         memset(&op, 0, sizeof(op));
      |         ^~~~~~
smaf-optee.c:33:9: note: include ‘<string.h>’ or provide a declaration of ‘memset’
smaf-optee.c:30:21: warning: variable ‘res’ set but not used [-Wunused-but-set-variable]
   30 |         TEEC_Result res;
      |                     ^~~
smaf-optee.c: In function ‘sdp_ta_region_destroy’:
smaf-optee.c:52:9: warning: incompatible implicit declaration of built-in function ‘memset’ [-Wbuiltin-declaration-mismatch]
   52 |         memset(&op, 0, sizeof(op));
      |         ^~~~~~
smaf-optee.c:52:9: note: include ‘<string.h>’ or provide a declaration of ‘memset’
smaf-optee.c:49:21: warning: variable ‘res’ set but not used [-Wunused-but-set-variable]
   49 |         TEEC_Result res;
      |                     ^~~
smaf-optee.c: In function ‘sdp_ta_region_update’:
smaf-optee.c:71:9: warning: incompatible implicit declaration of built-in function ‘memset’ [-Wbuiltin-declaration-mismatch]
   71 |         memset(&op, 0, sizeof(op));
      |         ^~~~~~
smaf-optee.c:71:9: note: include ‘<string.h>’ or provide a declaration of ‘memset’
smaf-optee.c:68:21: warning: variable ‘res’ set but not used [-Wunused-but-set-variable]
   68 |         TEEC_Result res;
      |                     ^~~
smaf-optee.c: In function ‘sdp_init_session’:
smaf-optee.c:96:21: warning: variable ‘res’ set but not used [-Wunused-but-set-variable]
   96 |         TEEC_Result res;
      |                     ^~~
smaf-optee.c: In function ‘smaf_optee_ta_dump_status’:
smaf-optee.c:123:9: warning: incompatible implicit declaration of built-in function ‘memset’ [-Wbuiltin-declaration-mismatch]
  123 |         memset(&op, 0, sizeof(op));
      |         ^~~~~~
smaf-optee.c:123:9: note: include ‘<string.h>’ or provide a declaration of ‘memset’
smaf-optee.c:130:16: warning: implicit declaration of function ‘malloc’ [-Wimplicit-function-declaration]
  130 |         dump = malloc(MAX_DUMP_SIZE);
      |                ^~~~~~
smaf-optee.c:10:1: note: include ‘<stdlib.h>’ or provide a declaration of ‘malloc’
    9 | #include <tee_client_api.h>
  +++ |+#include <stdlib.h>
   10 | 
smaf-optee.c:130:16: warning: incompatible implicit declaration of built-in function ‘malloc’ [-Wbuiltin-declaration-mismatch]
  130 |         dump = malloc(MAX_DUMP_SIZE);
      |                ^~~~~~
smaf-optee.c:130:16: note: include ‘<stdlib.h>’ or provide a declaration of ‘malloc’
smaf-optee.c:137:9: warning: implicit declaration of function ‘printf’ [-Wimplicit-function-declaration]
  137 |         printf("%s", dump);
      |         ^~~~~~
smaf-optee.c:10:1: note: include ‘<stdio.h>’ or provide a declaration of ‘printf’
    9 | #include <tee_client_api.h>
  +++ |+#include <stdio.h>
   10 | 
smaf-optee.c:137:9: warning: incompatible implicit declaration of built-in function ‘printf’ [-Wbuiltin-declaration-mismatch]
  137 |         printf("%s", dump);
      |         ^~~~~~
smaf-optee.c:137:9: note: include ‘<stdio.h>’ or provide a declaration of ‘printf’
smaf-optee.c:139:9: warning: implicit declaration of function ‘free’ [-Wimplicit-function-declaration]
  139 |         free(dump);
      |         ^~~~
smaf-optee.c:139:9: note: include ‘<stdlib.h>’ or provide a declaration of ‘free’
smaf-optee.c:139:9: warning: incompatible implicit declaration of built-in function ‘free’ [-Wbuiltin-declaration-mismatch]
smaf-optee.c:139:9: note: include ‘<stdlib.h>’ or provide a declaration of ‘free’
smaf-optee.c:119:21: warning: variable ‘res’ set but not used [-Wunused-but-set-variable]
  119 |         TEEC_Result res;
      |                     ^~~
arm-linux-gnueabihf-gcc -o smaf-optee smaf-optee.o  -lteec -L/workspace/benchmark/optee-sdp/../../optee_client/out/export/lib
make[1]: Leaving directory '/workspace/benchmark/optee-sdp/host'
make -C ta CROSS_COMPILE="arm-linux-gnueabihf-" LDFLAGS="" \
	TA_DEV_KIT_DIR=/workspace/benchmark/optee-sdp/../../optee_os/out/arm/export-ta_arm32
make[1]: Entering directory '/workspace/benchmark/optee-sdp/ta'
  CC      sdp_ta.o
  CC      platform/stub.o
platform/stub.c: In function ‘platform_dump_status’:
platform/stub.c:211:33: warning: pointer of type ‘void *’ used in arithmetic [-Wpointer-arith]
  211 |         params[0].memref.buffer += writed;
      |                                 ^~
platform/stub.c:216:41: warning: pointer of type ‘void *’ used in arithmetic [-Wpointer-arith]
  216 |                 params[0].memref.buffer += writed;
      |                                         ^~
platform/stub.c:221:33: warning: pointer of type ‘void *’ used in arithmetic [-Wpointer-arith]
  221 |         params[0].memref.buffer += writed;
      |                                 ^~
platform/stub.c:225:33: warning: pointer of type ‘void *’ used in arithmetic [-Wpointer-arith]
  225 |         params[0].memref.buffer += writed;
      |                                 ^~
platform/stub.c:229:33: warning: pointer of type ‘void *’ used in arithmetic [-Wpointer-arith]
  229 |         params[0].memref.buffer += writed;
      |                                 ^~
platform/stub.c:236:49: warning: pointer of type ‘void *’ used in arithmetic [-Wpointer-arith]
  236 |                         params[0].memref.buffer += writed;
      |                                                 ^~
platform/stub.c:242:65: warning: pointer of type ‘void *’ used in arithmetic [-Wpointer-arith]
  242 |                                         params[0].memref.buffer += writed;
      |                                                                 ^~
platform/stub.c:208:15: warning: unused variable ‘tmp’ [-Wunused-variable]
  208 |         char *tmp = params[0].memref.buffer;
      |               ^~~
platform/stub.c: In function ‘platform_dump_device’:
platform/stub.c:253:16: warning: unused variable ‘j’ [-Wunused-variable]
  253 |         int i, j, writed;
      |                ^
  CC      user_ta_header.o
  CPP     ta.lds
  LD      b9aa5f00-d229-11e4-925c0002a5d5c51b.elf
  OBJDUMP b9aa5f00-d229-11e4-925c0002a5d5c51b.dmp
  OBJCOPY b9aa5f00-d229-11e4-925c0002a5d5c51b.stripped.elf
  SIGN    b9aa5f00-d229-11e4-925c0002a5d5c51b.ta
make[1]: Leaving directory '/workspace/benchmark/optee-sdp/ta'
[INFO] Loaded sink definitions from /workspace/rules/generated_sink_definitions.json
[INFO] PatternMatcher initialized with 3 sink functions
[INFO] Sample sinks: TEE_MemMove(params: [0, 1, 2]), snprintf(params: [0, 1, 2, 3]), TEEC_InvokeCommand(params: [1, 2])
使用中のLLMプロバイダー: openrouter
呼び出し済み外部 API を抽出中...
外部 API 関数: 13 個
外部 API 関数をシンクとして解析中...

[DEBUG] PatternMatcher initialized
[DEBUG] Loaded rules count: 3
[DEBUG] Known functions in index: 3

[DEBUG] Analyzing: memset
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: platform_add_device_to_region
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: platform_check_permissions
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: platform_create_region
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: platform_destroy_region
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: platform_dump_device
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: platform_dump_status
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: platform_find_device_by_name
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: platform_find_region_by_id
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: platform_init
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: platform_remove_device_from_region
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: snprintf
  - Is known: True
  - Is sink: True
  - Dangerous params: {0, 1, 2, 3}
  - Rule IDs: {'input_validation_weaknesses', 'unencrypted_data_output'}

[DEBUG] Analyzing: strcmp
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()
抽出されたシンク候補: 38 個
結果を /workspace/benchmark/optee-sdp/ta/results/ta_sinks.json に保存しました
[DEBUG] Include paths:
  ✓ /workspace/benchmark/optee-sdp/ta
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/optee-sdp/ta/sdp_ta.c
  Args: -I/workspace/benchmark/optee-sdp/ta -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=sdp_ta_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/optee-sdp/ta/platform/stub.c
  Args: -I/workspace/benchmark/optee-sdp/ta -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=platform_stub_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[find_sink_calls] 55 call sites → /workspace/benchmark/optee-sdp/ta/results/ta_vulnerable_destinations.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/optee-sdp/ta
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/optee-sdp/ta/sdp_ta.c
  Args: -I/workspace/benchmark/optee-sdp/ta -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=sdp_ta_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/optee-sdp/ta/platform/stub.c
  Args: -I/workspace/benchmark/optee-sdp/ta -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=platform_stub_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[generate_call_graph_advanced] 34 edges, 26 functions → /workspace/benchmark/optee-sdp/ta/results/ta_call_graph.json
[DEBUG] No parameter dependency detected, but tracing callers anyway
[DEBUG] No parameter dependency detected, but tracing callers anyway
[phase3.3] → python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/optee-fiovb/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/optee-fiovb/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/optee-fiovb/ta/results/ta_chains.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/optee-fiovb/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/optee-fiovb/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/optee-fiovb/ta/results/ta_chains.json  (cwd=/workspace/benchmark/optee-fiovb/ta)
[phase3.6] → /workspace/benchmark/optee-fiovb/ta/results/ta_chains.json

[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/extract_sink_calls.py --compile-db /workspace/benchmark/optee-fiovb/ta/compile_commands.json --sinks /workspace/benchmark/optee-fiovb/ta/results/ta_sinks.json --output /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/optee-fiovb/ta)
[phase3.7] → /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerable_destinations.json

[phase5_command] → python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/optee-fiovb/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/optee-fiovb/ta/results/ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/optee-fiovb/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/optee-fiovb/ta/results/ta_candidate_flows.json  (cwd=/workspace/benchmark/optee-fiovb/ta)
[phase5 ] → /workspace/benchmark/optee-fiovb/ta/results/ta_candidate_flows.json

[INFO] $ /usr/bin/python3 /workspace/src/analyze_vulnerabilities/taint_analyzer.py --flows /workspace/benchmark/optee-fiovb/ta/results/ta_candidate_flows.json --phase12 /workspace/benchmark/optee-fiovb/ta/results/ta_phase12.json --output /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerabilities.json --generate-summary --no-rag  (cwd=/workspace/benchmark/optee-fiovb/ta)
[WARN]   ↳ rc=1
[INFO] $ /usr/bin/python3 /workspace/src/report/generate_report.py --vulnerabilities /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/optee-fiovb/ta/results/ta_phase12.json --project-name optee-fiovb --output /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerability_report.html  (cwd=/workspace/benchmark/optee-fiovb/ta)
[phase7 ] → /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerability_report.html


=== Project: optee-sdp / TA: ta ===
[INFO] RAG mode is disabled for this analysis
[INFO] Cleaning dependencies for optee-sdp
  - Removed stale dependency: ta/.sdp_ta.o.d
  - Removed stale dependency: ta/.user_ta_header.o.d
  - Removed stale dependency: ta/platform/.stub.o.d
  - Executed 'make clean' in .
  - Executed 'make clean' in ta
  - Executed 'make clean' in host
  ✓ Cleaned 7 files
[INFO] $ bear -- make  (cwd=/workspace/benchmark/optee-sdp)
[INFO] TA DB saved: /workspace/benchmark/optee-sdp/ta/compile_commands.json  entries=2
[DEBUG] Include paths:
  ✓ /workspace/benchmark/optee-sdp/ta
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/optee-sdp/ta/sdp_ta.c
  Args: -I/workspace/benchmark/optee-sdp/ta -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=sdp_ta_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/optee-sdp/ta/platform/stub.c
  Args: -I/workspace/benchmark/optee-sdp/ta -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=platform_stub_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[phase1-2] → /workspace/benchmark/optee-sdp/ta/results/ta_phase12.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/identify_sinks.py -i /workspace/benchmark/optee-sdp/ta/results/ta_phase12.json -o /workspace/benchmark/optee-sdp/ta/results/ta_sinks.json --no-rag  (cwd=/workspace/benchmark/optee-sdp/ta)
[phase3 ] → /workspace/benchmark/optee-sdp/ta/results/ta_sinks.json

[phase3.1] → python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/optee-sdp/ta/compile_commands.json --sinks /workspace/benchmark/optee-sdp/ta/results/ta_sinks.json --output /workspace/benchmark/optee-sdp/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/optee-sdp/ta/compile_commands.json --sinks /workspace/benchmark/optee-sdp/ta/results/ta_sinks.json --output /workspace/benchmark/optee-sdp/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/optee-sdp/ta)
[phase3.4] → /workspace/benchmark/optee-sdp/ta/results/ta_vulnerable_destinations.json

[phase3.2] → python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/optee-sdp/ta/compile_commands.json --output /workspace/benchmark/optee-sdp/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/optee-sdp/ta/compile_commands.json --output /workspace/benchmark/optee-sdp/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/optee-sdp/ta)
[phase3.5] → /workspace/benchmark/optee-sdp/ta/results/ta_call_graph.json

[phase3.3] → python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/optee-sdp/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/optee-sdp/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/optee-sdp/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/optee-sdp/ta/results/ta_chains.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/optee-sdp/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/optee-sdp/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/optee-sdp/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/optee-sdp/ta/results/ta_chains.json  (cwd=/workspace/benchmark/optee-sdp/ta)
[phase3.6] → /workspace/benchmark/optee-sdp/ta/results/ta_chains.json

[DEBUG] Include paths:
  ✓ /workspace/benchmark/optee-sdp/ta
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/optee-sdp/ta/sdp_ta.c
  Args: -I/workspace/benchmark/optee-sdp/ta -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=sdp_ta_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/optee-sdp/ta/platform/stub.c
  Args: -I/workspace/benchmark/optee-sdp/ta -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=platform_stub_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[extract_sink_calls] 55 entries → /workspace/benchmark/optee-sdp/ta/results/ta_vulnerable_destinations.json
[DEBUG] 入力チェーン数: 55
[DEBUG] ソース関数マッピング: {'TA_InvokeCommandEntryPoint': [], 'TA_OpenSessionEntryPoint': []}
[DEBUG] ソース関数: ['TA_InvokeCommandEntryPoint', 'TA_OpenSessionEntryPoint']
[DEBUG] ステップ1後: 53 CDFs
[DEBUG] ステップ2後: 53 CDFs（同じVD+ソースの最長チェーンのみ）
[DEBUG] ステップ3後: 53 CDFs（0 個のサブチェーンを削除）
[DEBUG] ステップ4: 16 グループ
[DEBUG] ステップ4後: 16 CDFs（15 グループがマージされた）
[DEBUG] 最終的な危険フロー:
  - platform_create_region at line 86, params=[0, 1, 2, 3]: TA_InvokeCommandEntryPoint -> create_region -> platform_create_region
  - platform_destroy_region at line 108, params=[0]: TA_InvokeCommandEntryPoint -> destroy_region -> platform_destroy_region
  - platform_add_device_to_region at line 155, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> update_region -> platform_add_device_to_region
  - platform_remove_device_from_region at line 157, params=[0, 1]: TA_InvokeCommandEntryPoint -> update_region -> platform_remove_device_from_region
  - platform_dump_status at line 173, params=[0, 1]: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status
  - platform_dump_device at line 174, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_device
  - memset at line 112, params=[0, 2]: TA_InvokeCommandEntryPoint -> destroy_region -> platform_destroy_region -> memset
  - snprintf at line 210, params=[0, 1, 2, 3]: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
  - snprintf at line 215, params=[0, 1, 2, 3]: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
  - snprintf at line 220, params=[0, 1, 2, 3]: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
  - snprintf at line 224, params=[0, 1, 2, 3]: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
  - snprintf at line 228, params=[0, 1, 2, 3]: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
  - snprintf at line 235, params=[0, 1, 2, 3]: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
  - snprintf at line 241, params=[0, 1, 2, 3]: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
  - snprintf at line 256, params=[0, 1, 2, 3]: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_device -> snprintf
  - snprintf at line 261, params=[0, 1, 2, 3]: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_device -> snprintf

[generate_candidate_flows] 16 件 → /workspace/benchmark/optee-sdp/ta/results/ta_candidate_flows.json
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[DEBUG] Using prompts directory: /workspace/prompts/vulnerabilities_prompt
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
[DEBUG] RAG system already initialized
[INFO] RAG mode disabled
[INFO] RAG disabled
使用中のLLMプロバイダー: openrouter
[taint_analyzer] 16 個の候補フローを解析中...
  [1/16] チェーン: TA_InvokeCommandEntryPoint -> create_region -> platform_create_region
[DEBUG] Loaded prompt: taint_start.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle.txt
[DEBUG] Loaded prompt: taint_middle_multi_params.txt
[DEBUG] Loaded prompt: taint_end.txt
  [2/16] チェーン: TA_InvokeCommandEntryPoint -> destroy_region -> platform_destroy_region
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=platform_destroy_region, param_index=0
  [3/16] チェーン: TA_InvokeCommandEntryPoint -> update_region -> platform_add_device_to_region
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [4/16] チェーン: TA_InvokeCommandEntryPoint -> update_region -> platform_remove_device_from_region
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [5/16] チェーン: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [6/16] チェーン: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_device
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [7/16] チェーン: TA_InvokeCommandEntryPoint -> destroy_region -> platform_destroy_region -> memset
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [8/16] チェーン: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [9/16] チェーン: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [10/16] チェーン: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [11/16] チェーン: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [12/16] チェーン: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [13/16] チェーン: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [14/16] チェーン: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [15/16] チェーン: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_device -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [16/16] チェーン: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_device -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[taint_analyzer] 解析完了: 1 件の脆弱性を検出
  結果: /workspace/benchmark/optee-sdp/ta/results/ta_vulnerabilities.json
  ログ: /workspace/benchmark/optee-sdp/ta/results/taint_analysis_log.txt
Traceback (most recent call last):
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 169, in <module>
    main()
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 138, in main
    generate_summary_report(out_dir, statistics, vulnerabilities)
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 161, in generate_summary_report
    from .report_generator import ReportGenerator
ImportError: attempted relative import with no known parent package
[generate_report] HTMLレポートを生成しました: /workspace/benchmark/optee-sdp/ta/results/ta_vulnerability_report.html
  検出脆弱性数: 1
  AI対話履歴を含めました: /workspace/benchmark/optee-sdp/ta/results/taint_analysis_log.txt
  対話チェーン数: 9
make -C host CROSS_COMPILE="arm-linux-gnueabihf-" --no-builtin-variables \
	TEEC_EXPORT=/workspace/benchmark/Lenet5_in_OPTEE/../../optee_client/out/export
make[1]: Entering directory '/workspace/benchmark/Lenet5_in_OPTEE/host'
arm-linux-gnueabihf-gcc -Wall -I../ta/include -I./include -I/workspace/benchmark/Lenet5_in_OPTEE/../../optee_client/out/export/include -c main.c -o main.o
arm-linux-gnueabihf-gcc -o optee_lenet5 main.o -lteec -L/workspace/benchmark/Lenet5_in_OPTEE/../../optee_client/out/export/lib
make[1]: Leaving directory '/workspace/benchmark/Lenet5_in_OPTEE/host'
make -C ta CROSS_COMPILE="arm-linux-gnueabihf-" LDFLAGS="" \
	TA_DEV_KIT_DIR=/workspace/benchmark/Lenet5_in_OPTEE/../../optee_os/out/arm/export-ta_arm32
make[1]: Entering directory '/workspace/benchmark/Lenet5_in_OPTEE/ta'
  CC      lenet5_ta.o
  CC      lenet.o
lenet.c: In function ‘f64rand’:
lenet.c:264:27: warning: dereferencing type-punned pointer will break strict-aliasing rules [-Wstrict-aliasing]
  264 |         return *(double *)&lvalue - 3;
      |                           ^~~~~~~
lenet.c: In function ‘TrainBatch’:
lenet.c:287:57: warning: dereferencing type-punned pointer might break strict-aliasing rules [-Wstrict-aliasing]
  287 |                                 buffer[j] += ((double *)&deltas)[j];
      |                                                         ^~~~~~~
lenet.c: In function ‘Initial’:
lenet.c:309:32: warning: dereferencing type-punned pointer will break strict-aliasing rules [-Wstrict-aliasing]
  309 |         for (int *pos = (int *)lenet->bias0_1; pos < (int *)(lenet + 1); *pos++ = 0);
      |                                ^~~~~
  CC      e_exp.o
In file included from e_exp.c:76:
e_exp.c: In function ‘__ieee754_exp’:
./include/fdlibm.h:32:27: warning: dereferencing type-punned pointer will break strict-aliasing rules [-Wstrict-aliasing]
   32 | #define __HI(x) *(1+(int*)&x)
e_exp.c:112:15: note: in expansion of macro ‘__HI’
  112 |         hx  = __HI(x);  /* high word of x */
      |               ^~~~
./include/fdlibm.h:33:24: warning: dereferencing type-punned pointer will break strict-aliasing rules [-Wstrict-aliasing]
   33 | #define __LO(x) *(int*)&x
e_exp.c:119:34: note: in expansion of macro ‘__LO’
  119 |                 if(((hx&0xfffff)|__LO(x))!=0)
      |                                  ^~~~
./include/fdlibm.h:32:27: warning: dereferencing type-punned pointer will break strict-aliasing rules [-Wstrict-aliasing]
   32 | #define __HI(x) *(1+(int*)&x)
e_exp.c:150:13: note: in expansion of macro ‘__HI’
  150 |             __HI(y) += (k<<20); /* add k to y's exponent */
      |             ^~~~
./include/fdlibm.h:32:27: warning: dereferencing type-punned pointer will break strict-aliasing rules [-Wstrict-aliasing]
   32 | #define __HI(x) *(1+(int*)&x)
e_exp.c:153:13: note: in expansion of macro ‘__HI’
  153 |             __HI(y) += ((k+1000)<<20);/* add k to y's exponent */
      |             ^~~~
e_exp.c:153:27: warning: ‘k’ may be used uninitialized in this function [-Wmaybe-uninitialized]
  153 |             __HI(y) += ((k+1000)<<20);/* add k to y's exponent */
      |                         ~~^~~~~~
e_exp.c:108:21: warning: ‘lo’ may be used uninitialized in this function [-Wmaybe-uninitialized]
  108 |         double y,hi,lo,c,t;
      |                     ^~
e_exp.c:108:18: warning: ‘hi’ may be used uninitialized in this function [-Wmaybe-uninitialized]
  108 |         double y,hi,lo,c,t;
      |                  ^~
  CC      e_sqrt.o
In file included from e_sqrt.c:83:
e_sqrt.c: In function ‘__ieee754_sqrt’:
./include/fdlibm.h:32:27: warning: dereferencing type-punned pointer will break strict-aliasing rules [-Wstrict-aliasing]
   32 | #define __HI(x) *(1+(int*)&x)
e_sqrt.c:103:15: note: in expansion of macro ‘__HI’
  103 |         ix0 = __HI(x);                  /* high word of x */
      |               ^~~~
./include/fdlibm.h:33:24: warning: dereferencing type-punned pointer will break strict-aliasing rules [-Wstrict-aliasing]
   33 | #define __LO(x) *(int*)&x
e_sqrt.c:104:15: note: in expansion of macro ‘__LO’
  104 |         ix1 = __LO(x);          /* low word of x */
      |               ^~~~
./include/fdlibm.h:32:27: warning: dereferencing type-punned pointer will break strict-aliasing rules [-Wstrict-aliasing]
   32 | #define __HI(x) *(1+(int*)&x)
e_sqrt.c:189:9: note: in expansion of macro ‘__HI’
  189 |         __HI(z) = ix0;
      |         ^~~~
./include/fdlibm.h:33:24: warning: dereferencing type-punned pointer will break strict-aliasing rules [-Wstrict-aliasing]
   33 | #define __LO(x) *(int*)&x
e_sqrt.c:190:9: note: in expansion of macro ‘__LO’
  190 |         __LO(z) = ix1;
      |         ^~~~
  CC      user_ta_header.o
  CPP     ta.lds
  LD      b13bc418-3b81-11eb-adc1-0242ac120002.elf
  OBJDUMP b13bc418-3b81-11eb-adc1-0242ac120002.dmp
  OBJCOPY b13bc418-3b81-11eb-adc1-0242ac120002.stripped.elf
  SIGN    b13bc418-3b81-11eb-adc1-0242ac120002.ta
make[1]: Leaving directory '/workspace/benchmark/Lenet5_in_OPTEE/ta'
[INFO] Loaded sink definitions from /workspace/rules/generated_sink_definitions.json
[INFO] PatternMatcher initialized with 3 sink functions
[INFO] Sample sinks: TEE_MemMove(params: [0, 1, 2]), snprintf(params: [0, 1, 2, 3]), TEEC_InvokeCommand(params: [1, 2])
使用中のLLMプロバイダー: openrouter
呼び出し済み外部 API を抽出中...
外部 API 関数: 9 個
外部 API 関数をシンクとして解析中...

[DEBUG] PatternMatcher initialized
[DEBUG] Loaded rules count: 3
[DEBUG] Known functions in index: 3

[DEBUG] Analyzing: Initial
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: Predict
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_GenerateRandom
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_Malloc
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TrainBatch
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: __HI
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: __LO
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: __ieee754_exp
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: __ieee754_sqrt
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()
抽出されたシンク候補: 23 個
結果を /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_sinks.json に保存しました
[DEBUG] Include paths:
  ✓ /workspace/benchmark/Lenet5_in_OPTEE/ta
  ✓ /workspace/benchmark/Lenet5_in_OPTEE/ta/include
  ✓ ./include
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/lenet5_ta.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=lenet5_ta_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/lenet.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=lenet_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/e_exp.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=e_exp_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/e_sqrt.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=e_sqrt_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[find_sink_calls] 13 call sites → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerable_destinations.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/Lenet5_in_OPTEE/ta
  ✓ /workspace/benchmark/Lenet5_in_OPTEE/ta/include
  ✓ ./include
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/lenet5_ta.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=lenet5_ta_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/lenet.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=lenet_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/e_exp.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=e_exp_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/e_sqrt.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=e_sqrt_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[generate_call_graph_advanced] 42 edges, 23 functions → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_call_graph.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/extract_sink_calls.py --compile-db /workspace/benchmark/optee-sdp/ta/compile_commands.json --sinks /workspace/benchmark/optee-sdp/ta/results/ta_sinks.json --output /workspace/benchmark/optee-sdp/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/optee-sdp/ta)
[phase3.7] → /workspace/benchmark/optee-sdp/ta/results/ta_vulnerable_destinations.json

[phase5_command] → python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/optee-sdp/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/optee-sdp/ta/results/ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/optee-sdp/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/optee-sdp/ta/results/ta_candidate_flows.json  (cwd=/workspace/benchmark/optee-sdp/ta)
[phase5 ] → /workspace/benchmark/optee-sdp/ta/results/ta_candidate_flows.json

[INFO] $ /usr/bin/python3 /workspace/src/analyze_vulnerabilities/taint_analyzer.py --flows /workspace/benchmark/optee-sdp/ta/results/ta_candidate_flows.json --phase12 /workspace/benchmark/optee-sdp/ta/results/ta_phase12.json --output /workspace/benchmark/optee-sdp/ta/results/ta_vulnerabilities.json --generate-summary --no-rag  (cwd=/workspace/benchmark/optee-sdp/ta)
[WARN]   ↳ rc=1
[INFO] $ /usr/bin/python3 /workspace/src/report/generate_report.py --vulnerabilities /workspace/benchmark/optee-sdp/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/optee-sdp/ta/results/ta_phase12.json --project-name optee-sdp --output /workspace/benchmark/optee-sdp/ta/results/ta_vulnerability_report.html  (cwd=/workspace/benchmark/optee-sdp/ta)
[phase7 ] → /workspace/benchmark/optee-sdp/ta/results/ta_vulnerability_report.html


=== Project: Lenet5_in_OPTEE / TA: ta ===
[INFO] RAG mode is disabled for this analysis
[INFO] Cleaning dependencies for Lenet5_in_OPTEE
  - Removed stale dependency: ta/.user_ta_header.o.d
  - Removed stale dependency: ta/.lenet.o.d
  - Removed stale dependency: ta/.lenet5_ta.o.d
  - Executed 'make clean' in .
  - Executed 'make clean' in ta
  - Executed 'make clean' in host
  ✓ Cleaned 9 files
[INFO] $ bear -- make  (cwd=/workspace/benchmark/Lenet5_in_OPTEE)
[INFO] TA DB saved: /workspace/benchmark/Lenet5_in_OPTEE/ta/compile_commands.json  entries=4
[DEBUG] Include paths:
  ✓ /workspace/benchmark/Lenet5_in_OPTEE/ta
  ✓ /workspace/benchmark/Lenet5_in_OPTEE/ta/include
  ✗ ./include
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/lenet5_ta.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=lenet5_ta_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/lenet.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=lenet_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/e_exp.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=e_exp_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/e_sqrt.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=e_sqrt_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[phase1-2] → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_phase12.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/identify_sinks.py -i /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_phase12.json -o /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_sinks.json --no-rag  (cwd=/workspace/benchmark/Lenet5_in_OPTEE/ta)
[phase3 ] → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_sinks.json

[phase3.1] → python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/Lenet5_in_OPTEE/ta/compile_commands.json --sinks /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_sinks.json --output /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/Lenet5_in_OPTEE/ta/compile_commands.json --sinks /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_sinks.json --output /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/Lenet5_in_OPTEE/ta)
[phase3.4] → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerable_destinations.json

[phase3.2] → python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/Lenet5_in_OPTEE/ta/compile_commands.json --output /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/Lenet5_in_OPTEE/ta/compile_commands.json --output /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/Lenet5_in_OPTEE/ta)
[phase3.5] → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_call_graph.json

[phase3.3] → python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/Lenet5_in_OPTEE/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_chains.json
[DEBUG] No parameter dependency detected, but tracing callers anyway
[DEBUG] No parameter dependency detected, but tracing callers anyway
[DEBUG] Include paths:
  ✓ /workspace/benchmark/Lenet5_in_OPTEE/ta
  ✓ /workspace/benchmark/Lenet5_in_OPTEE/ta/include
  ✓ ./include
  ✓ ./.
  ✓ .
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/lenet5_ta.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=lenet5_ta_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/lenet.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=lenet_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/e_exp.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=e_exp_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/e_sqrt.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -std=gnu99 -fdiagnostics-show-option -fpie -fno-short-enums -fno-common -funsafe-math-optimizations -funwind-tables -DCFG_TEE_TA_LOG_LEVEL=4 -I./include -I./. -DARM32=1 -D__ILP32__=1 -DMBEDTLS_SELF_TEST -DTRACE_LEVEL=4 -I. -I/workspace/optee_os/out/arm/export-ta_arm32/include -DCFG_TA_MBEDTLS_SELF_TEST=1 -DCFG_TA_MBEDTLS=1 -DCFG_ARM32_ta_arm32=1 -DCFG_TA_DYNLINK=1 -DCFG_TA_MBEDTLS_MPI=1 -DCFG_TEE_TA_LOG_LEVEL=4 -DCFG_SYSTEM_PTA=1 -DCFG_TA_FLOAT_SUPPORT=1 -D__FILE_ID__=e_sqrt_c --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[extract_sink_calls] 13 entries → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerable_destinations.json
[DEBUG] 入力チェーン数: 13
[DEBUG] ソース関数マッピング: {'TA_InvokeCommandEntryPoint': [], 'TA_OpenSessionEntryPoint': []}
[DEBUG] ソース関数: ['TA_InvokeCommandEntryPoint', 'TA_OpenSessionEntryPoint']
[DEBUG] ステップ1後: 13 CDFs
[DEBUG] ステップ2後: 13 CDFs（同じVD+ソースの最長チェーンのみ）
[DEBUG] ステップ3後: 13 CDFs（0 個のサブチェーンを削除）
[DEBUG] ステップ4: 4 グループ
[DEBUG] ステップ4後: 4 CDFs（3 グループがマージされた）
[DEBUG] 最終的な危険フロー:
  - TEE_Malloc at line 93, params=[0]: TA_InvokeCommandEntryPoint -> ta_init -> TEE_Malloc
  - TrainBatch at line 137, params=[0, 1, 2, 3, 4, 5]: TA_InvokeCommandEntryPoint -> ta_trainBatch -> TrainBatch
  - Predict at line 156, params=[0, 1, 2, 3]: TA_InvokeCommandEntryPoint -> ta_predict -> Predict
  - TEE_GenerateRandom at line 252, params=[0, 2]: TA_InvokeCommandEntryPoint -> ta_init -> Initial -> f64rand -> rand -> TEE_GenerateRandom

[generate_candidate_flows] 4 件 → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_candidate_flows.json
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[DEBUG] Using prompts directory: /workspace/prompts/vulnerabilities_prompt
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
[DEBUG] RAG system already initialized
[INFO] RAG mode disabled
[INFO] RAG disabled
使用中のLLMプロバイダー: openrouter
[taint_analyzer] 4 個の候補フローを解析中...
  [1/4] チェーン: TA_InvokeCommandEntryPoint -> ta_init -> TEE_Malloc
[DEBUG] Loaded prompt: taint_start.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle.txt
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Loaded prompt: taint_end.txt
  [2/4] チェーン: TA_InvokeCommandEntryPoint -> ta_trainBatch -> TrainBatch
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle_multi_params.txt
  [3/4] チェーン: TA_InvokeCommandEntryPoint -> ta_predict -> Predict
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [4/4] チェーン: TA_InvokeCommandEntryPoint -> ta_init -> Initial -> f64rand -> rand -> TEE_GenerateRandom
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[taint_analyzer] 解析完了: 0 件の脆弱性を検出
  結果: /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerabilities.json
  ログ: /workspace/benchmark/Lenet5_in_OPTEE/ta/results/taint_analysis_log.txt
Traceback (most recent call last):
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 169, in <module>
    main()
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 138, in main
    generate_summary_report(out_dir, statistics, vulnerabilities)
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 161, in generate_summary_report
    from .report_generator import ReportGenerator
ImportError: attempted relative import with no known parent package
[generate_report] HTMLレポートを生成しました: /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerability_report.html
  検出脆弱性数: 0
  AI対話履歴を含めました: /workspace/benchmark/Lenet5_in_OPTEE/ta/results/taint_analysis_log.txt
  対話チェーン数: 4
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/Lenet5_in_OPTEE/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_chains.json  (cwd=/workspace/benchmark/Lenet5_in_OPTEE/ta)
[phase3.6] → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_chains.json

[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/extract_sink_calls.py --compile-db /workspace/benchmark/Lenet5_in_OPTEE/ta/compile_commands.json --sinks /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_sinks.json --output /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/Lenet5_in_OPTEE/ta)
[phase3.7] → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerable_destinations.json

[phase5_command] → python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_candidate_flows.json  (cwd=/workspace/benchmark/Lenet5_in_OPTEE/ta)
[phase5 ] → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_candidate_flows.json

[INFO] $ /usr/bin/python3 /workspace/src/analyze_vulnerabilities/taint_analyzer.py --flows /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_candidate_flows.json --phase12 /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_phase12.json --output /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerabilities.json --generate-summary --no-rag  (cwd=/workspace/benchmark/Lenet5_in_OPTEE/ta)
[WARN]   ↳ rc=1
[INFO] $ /usr/bin/python3 /workspace/src/report/generate_report.py --vulnerabilities /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_phase12.json --project-name Lenet5_in_OPTEE --output /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerability_report.html  (cwd=/workspace/benchmark/Lenet5_in_OPTEE/ta)
[phase7 ] → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerability_report.html

