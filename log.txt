make -C host CROSS_COMPILE="arm-linux-gnueabihf-" --no-builtin-variables \
	TEEC_EXPORT=/workspace/benchmark/acipher/../../optee_client/out/export
make[1]: Entering directory '/workspace/benchmark/acipher/host'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/workspace/benchmark/acipher/host'
make -C ta CROSS_COMPILE="arm-linux-gnueabihf-" LDFLAGS="" \
	TA_DEV_KIT_DIR=/workspace/benchmark/acipher/../../optee_os/out/arm/export-ta_arm32
make[1]: Entering directory '/workspace/benchmark/acipher/ta'
make[1]: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'acipher_ta.o'.  Stop.
make[1]: Leaving directory '/workspace/benchmark/acipher/ta'
make: *** [Makefile:14: all] Error 2
make: Entering directory '/workspace/benchmark/acipher/ta'
make: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'acipher_ta.o'.  Stop.
make: Leaving directory '/workspace/benchmark/acipher/ta'
CMake Warning (dev) in CMakeLists.txt:
  No cmake_minimum_required command is present.  A line of code such as

    cmake_minimum_required(VERSION 3.22)

  should be added at the top of the file.  The version specified may be lower
  if you wish to support older CMake versions for this project.  For more
  information run "cmake --help-policy CMP0000".
This warning is for project developers.  Use -Wno-dev to suppress it.

-- Configuring done
-- Generating done
-- Build files have been written to: /workspace/benchmark/acipher/build
[INFO] Loaded sink definitions from /workspace/rules/generated_sink_definitions.json
[INFO] PatternMatcher initialized with 3 sink functions
[INFO] Sample sinks: TEE_MemMove(params: [0, 1, 2]), snprintf(params: [0, 1, 2, 3]), TEEC_InvokeCommand(params: [1, 2])
使用中のLLMプロバイダー: openrouter
呼び出し済み外部 API を抽出中...
外部 API 関数: 8 個
外部 API 関数をシンクとして解析中...

[DEBUG] PatternMatcher initialized
[DEBUG] Loaded rules count: 3
[DEBUG] Known functions in index: 3

[DEBUG] Analyzing: TEE_AllocateOperation
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_AllocateTransientObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_AsymmetricEncrypt
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_FreeOperation
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_FreeTransientObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_GenerateKey
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_GetObjectInfo1
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_SetOperationKey
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()
抽出されたシンク候補: 4 個
結果を /workspace/benchmark/acipher/ta/results/ta_sinks.json に保存しました
[DEBUG] Include paths:
  ✓ /workspace/benchmark/acipher/ta
  ✓ /workspace/benchmark/acipher/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/acipher/ta/acipher_ta.c
  Args: -I/workspace/benchmark/acipher/ta -I/workspace/benchmark/acipher/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[find_sink_calls] 4 call sites → /workspace/benchmark/acipher/ta/results/ta_vulnerable_destinations.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/acipher/ta
  ✓ /workspace/benchmark/acipher/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/acipher/ta/acipher_ta.c
  Args: -I/workspace/benchmark/acipher/ta -I/workspace/benchmark/acipher/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[generate_call_graph_advanced] 21 edges, 7 functions → /workspace/benchmark/acipher/ta/results/ta_call_graph.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/acipher/ta
  ✓ /workspace/benchmark/acipher/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/acipher/ta/acipher_ta.c
  Args: -I/workspace/benchmark/acipher/ta -I/workspace/benchmark/acipher/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[extract_sink_calls] 4 entries → /workspace/benchmark/acipher/ta/results/ta_vulnerable_destinations.json
[DEBUG] 入力チェーン数: 4
[DEBUG] ソース関数マッピング: {'TA_InvokeCommandEntryPoint': [], 'TA_OpenSessionEntryPoint': []}
[DEBUG] ソース関数: ['TA_InvokeCommandEntryPoint', 'TA_OpenSessionEntryPoint']
[DEBUG] ステップ1後: 4 CDFs
[DEBUG] ステップ2後: 4 CDFs（同じVD+ソースの最長チェーンのみ）
[DEBUG] ステップ3後: 4 CDFs（0 個のサブチェーンを削除）
[DEBUG] ステップ4: 2 グループ
[DEBUG] ステップ4後: 2 CDFs（1 グループがマージされた）
[DEBUG] 最終的な危険フロー:
  - TEE_GetObjectInfo1 at line 73, params=[0]: TA_InvokeCommandEntryPoint -> cmd_enc -> TEE_GetObjectInfo1
  - TEE_AsymmetricEncrypt at line 97, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> cmd_enc -> TEE_AsymmetricEncrypt

[generate_candidate_flows] 2 件 → /workspace/benchmark/acipher/ta/results/ta_candidate_flows.json
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[DEBUG] Using prompts directory: /workspace/prompts/vulnerabilities_prompt
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
[DEBUG] RAG system already initialized
[INFO] RAG mode disabled
[INFO] RAG disabled
使用中のLLMプロバイダー: openrouter
[taint_analyzer] 2 個の候補フローを解析中...
  [1/2] チェーン: TA_InvokeCommandEntryPoint -> cmd_enc -> TEE_GetObjectInfo1
[DEBUG] Loaded prompt: taint_start.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle.txt
[DEBUG] get_middle_prompt called: sink_function=TEE_GetObjectInfo1, param_index=0
[DEBUG] Loaded prompt: taint_end.txt
  [2/2] チェーン: TA_InvokeCommandEntryPoint -> cmd_enc -> TEE_AsymmetricEncrypt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle_multi_params.txt
[taint_analyzer] 解析完了: 0 件の脆弱性を検出
  結果: /workspace/benchmark/acipher/ta/results/ta_vulnerabilities.json
  ログ: /workspace/benchmark/acipher/ta/results/taint_analysis_log.txt
Traceback (most recent call last):
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 169, in <module>
    main()
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 138, in main
    generate_summary_report(out_dir, statistics, vulnerabilities)
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 161, in generate_summary_report
    from .report_generator import ReportGenerator
ImportError: attempted relative import with no known parent package
[generate_report] HTMLレポートを生成しました: /workspace/benchmark/acipher/ta/results/ta_vulnerability_report.html
  検出脆弱性数: 0
  AI対話履歴を含めました: /workspace/benchmark/acipher/ta/results/taint_analysis_log.txt
  対話チェーン数: 2
make -C host CROSS_COMPILE="arm-linux-gnueabihf-" --no-builtin-variables \
	TEEC_EXPORT=/workspace/benchmark/aes/../../optee_client/out/export
make[1]: Entering directory '/workspace/benchmark/aes/host'
arm-linux-gnueabihf-gcc  -o optee_example_aes main.o -lteec -L/workspace/benchmark/aes/../../optee_client/out/export/lib
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: main.o: relocation R_ARM_THM_MOVW_ABS_NC against `a local symbol' can not be used when making a shared object; recompile with -fPIC
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: main.o(.text+0x20): unresolvable R_ARM_THM_CALL relocation against symbol `TEEC_InitializeContext'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: final link failed
collect2: error: ld returned 1 exit status
make[1]: *** [Makefile:21: optee_example_aes] Error 1
make[1]: Leaving directory '/workspace/benchmark/aes/host'
make: *** [Makefile:12: all] Error 2
make: Entering directory '/workspace/benchmark/aes/ta'
make: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'aes_ta.o'.  Stop.
make: Leaving directory '/workspace/benchmark/aes/ta'
CMake Warning (dev) in CMakeLists.txt:
  No cmake_minimum_required command is present.  A line of code such as

    cmake_minimum_required(VERSION 3.22)

  should be added at the top of the file.  The version specified may be lower
  if you wish to support older CMake versions for this project.  For more
  information run "cmake --help-policy CMP0000".
This warning is for project developers.  Use -Wno-dev to suppress it.

-- Configuring done
-- Generating done
-- Build files have been written to: /workspace/benchmark/aes/build
[INFO] Loaded sink definitions from /workspace/rules/generated_sink_definitions.json
[INFO] PatternMatcher initialized with 3 sink functions
[INFO] Sample sinks: TEE_MemMove(params: [0, 1, 2]), snprintf(params: [0, 1, 2, 3]), TEEC_InvokeCommand(params: [1, 2])
使用中のLLMプロバイダー: openrouter
呼び出し済み外部 API を抽出中...
外部 API 関数: 13 個
外部 API 関数をシンクとして解析中...

[DEBUG] PatternMatcher initialized
[DEBUG] Loaded rules count: 3
[DEBUG] Known functions in index: 3

[DEBUG] Analyzing: TEE_AllocateOperation
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_AllocateTransientObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_CipherInit
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_CipherUpdate
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_Free
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_FreeOperation
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_FreeTransientObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_InitRefAttribute
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_Malloc
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_PopulateTransientObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_ResetOperation
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_ResetTransientObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_SetOperationKey
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()
抽出されたシンク候補: 4 個
結果を /workspace/benchmark/aes/ta/results/ta_sinks.json に保存しました
[DEBUG] Include paths:
  ✓ /workspace/benchmark/aes/ta
  ✓ /workspace/benchmark/aes/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/aes/ta/aes_ta.c
  Args: -I/workspace/benchmark/aes/ta -I/workspace/benchmark/aes/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[find_sink_calls] 5 call sites → /workspace/benchmark/aes/ta/results/ta_vulnerable_destinations.json

=== Project: acipher / TA: ta ===
[INFO] RAG mode is disabled for this analysis
[INFO] $ bear -- make  (cwd=/workspace/benchmark/acipher)
[WARN]   ↳ rc=2
[INFO] $ bear -- make -C ta V=1  (cwd=/workspace/benchmark/acipher)
[WARN]   ↳ rc=2
[INFO] $ cmake -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -Bbuild -H.  (cwd=/workspace/benchmark/acipher)
[WARN] bear が拾えなかった .c がある → dummy 補完
[INFO] ★ dummy DB 1 entries → /workspace/benchmark/acipher/build/compile_commands.json
[INFO] TA DB saved: /workspace/benchmark/acipher/ta/compile_commands.json  entries=1
[DEBUG] Include paths:
  ✓ /workspace/benchmark/acipher/ta
  ✓ /workspace/benchmark/acipher/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/acipher/ta/acipher_ta.c
  Args: -I/workspace/benchmark/acipher/ta -I/workspace/benchmark/acipher/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[phase1-2] → /workspace/benchmark/acipher/ta/results/ta_phase12.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/identify_sinks.py -i /workspace/benchmark/acipher/ta/results/ta_phase12.json -o /workspace/benchmark/acipher/ta/results/ta_sinks.json --no-rag  (cwd=/workspace/benchmark/acipher/ta)
[phase3 ] → /workspace/benchmark/acipher/ta/results/ta_sinks.json

[phase3.1] → python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/acipher/ta/compile_commands.json --sinks /workspace/benchmark/acipher/ta/results/ta_sinks.json --output /workspace/benchmark/acipher/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/acipher/ta/compile_commands.json --sinks /workspace/benchmark/acipher/ta/results/ta_sinks.json --output /workspace/benchmark/acipher/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/acipher/ta)
[phase3.4] → /workspace/benchmark/acipher/ta/results/ta_vulnerable_destinations.json

[phase3.2] → python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/acipher/ta/compile_commands.json --output /workspace/benchmark/acipher/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/acipher/ta/compile_commands.json --output /workspace/benchmark/acipher/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/acipher/ta)
[phase3.5] → /workspace/benchmark/acipher/ta/results/ta_call_graph.json

[phase3.3] → python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/acipher/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/acipher/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/acipher/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/acipher/ta/results/ta_chains.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/acipher/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/acipher/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/acipher/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/acipher/ta/results/ta_chains.json  (cwd=/workspace/benchmark/acipher/ta)
[phase3.6] → /workspace/benchmark/acipher/ta/results/ta_chains.json

[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/extract_sink_calls.py --compile-db /workspace/benchmark/acipher/ta/compile_commands.json --sinks /workspace/benchmark/acipher/ta/results/ta_sinks.json --output /workspace/benchmark/acipher/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/acipher/ta)
[phase3.7] → /workspace/benchmark/acipher/ta/results/ta_vulnerable_destinations.json

[phase5_command] → python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/acipher/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/acipher/ta/results/ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/acipher/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/acipher/ta/results/ta_candidate_flows.json  (cwd=/workspace/benchmark/acipher/ta)
[phase5 ] → /workspace/benchmark/acipher/ta/results/ta_candidate_flows.json

[INFO] $ /usr/bin/python3 /workspace/src/analyze_vulnerabilities/taint_analyzer.py --flows /workspace/benchmark/acipher/ta/results/ta_candidate_flows.json --phase12 /workspace/benchmark/acipher/ta/results/ta_phase12.json --output /workspace/benchmark/acipher/ta/results/ta_vulnerabilities.json --generate-summary --no-rag  (cwd=/workspace/benchmark/acipher/ta)
[WARN]   ↳ rc=1
[INFO] $ /usr/bin/python3 /workspace/src/report/generate_report.py --vulnerabilities /workspace/benchmark/acipher/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/acipher/ta/results/ta_phase12.json --project-name acipher --output /workspace/benchmark/acipher/ta/results/ta_vulnerability_report.html  (cwd=/workspace/benchmark/acipher/ta)
[phase7 ] → /workspace/benchmark/acipher/ta/results/ta_vulnerability_report.html


=== Project: aes / TA: ta ===
[INFO] RAG mode is disabled for this analysis
[INFO] $ bear -- make  (cwd=/workspace/benchmark/aes)
[WARN]   ↳ rc=2
[INFO] $ bear -- make -C ta V=1  (cwd=/workspace/benchmark/aes)
[WARN]   ↳ rc=2
[INFO] $ cmake -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -Bbuild -H.  (cwd=/workspace/benchmark/aes)
[WARN] bear が拾えなかった .c がある → dummy 補完
[INFO] ★ dummy DB 1 entries → /workspace/benchmark/aes/build/compile_commands.json
[INFO] TA DB saved: /workspace/benchmark/aes/ta/compile_commands.json  entries=1
[DEBUG] Include paths:
  ✓ /workspace/benchmark/aes/ta
  ✓ /workspace/benchmark/aes/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/aes/ta/aes_ta.c
  Args: -I/workspace/benchmark/aes/ta -I/workspace/benchmark/aes/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[phase1-2] → /workspace/benchmark/aes/ta/results/ta_phase12.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/identify_sinks.py -i /workspace/benchmark/aes/ta/results/ta_phase12.json -o /workspace/benchmark/aes/ta/results/ta_sinks.json --no-rag  (cwd=/workspace/benchmark/aes/ta)
[phase3 ] → /workspace/benchmark/aes/ta/results/ta_sinks.json

[phase3.1] → python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/aes/ta/compile_commands.json --sinks /workspace/benchmark/aes/ta/results/ta_sinks.json --output /workspace/benchmark/aes/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/aes/ta/compile_commands.json --sinks /workspace/benchmark/aes/ta/results/ta_sinks.json --output /workspace/benchmark/aes/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/aes/ta)
[phase3.4] → /workspace/benchmark/aes/ta/results/ta_vulnerable_destinations.json

[phase3.2] → python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/aes/ta/compile_commands.json --output /workspace/benchmark/aes/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[DEBUG] Include paths:
  ✓ /workspace/benchmark/aes/ta
  ✓ /workspace/benchmark/aes/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/aes/ta/aes_ta.c
  Args: -I/workspace/benchmark/aes/ta -I/workspace/benchmark/aes/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[generate_call_graph_advanced] 47 edges, 12 functions → /workspace/benchmark/aes/ta/results/ta_call_graph.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/aes/ta
  ✓ /workspace/benchmark/aes/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/aes/ta/aes_ta.c
  Args: -I/workspace/benchmark/aes/ta -I/workspace/benchmark/aes/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[extract_sink_calls] 5 entries → /workspace/benchmark/aes/ta/results/ta_vulnerable_destinations.json
[DEBUG] 入力チェーン数: 5
[DEBUG] ソース関数マッピング: {'TA_InvokeCommandEntryPoint': [], 'TA_OpenSessionEntryPoint': []}
[DEBUG] ソース関数: ['TA_InvokeCommandEntryPoint', 'TA_OpenSessionEntryPoint']
[DEBUG] ステップ1後: 5 CDFs
[DEBUG] ステップ2後: 5 CDFs（同じVD+ソースの最長チェーンのみ）
[DEBUG] ステップ3後: 5 CDFs（0 個のサブチェーンを削除）
[DEBUG] ステップ4: 3 グループ
[DEBUG] ステップ4後: 3 CDFs（1 グループがマージされた）
[DEBUG] 最終的な危険フロー:
  - TEE_Malloc at line 188, params=[0]: TA_InvokeCommandEntryPoint -> alloc_resources -> TEE_Malloc
  - TEE_CipherUpdate at line 360, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> cipher_buffer -> TEE_CipherUpdate
  - TEE_Malloc at line 387, params=[0]: TA_OpenSessionEntryPoint -> TEE_Malloc

[generate_candidate_flows] 3 件 → /workspace/benchmark/aes/ta/results/ta_candidate_flows.json
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[DEBUG] Using prompts directory: /workspace/prompts/vulnerabilities_prompt
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
[DEBUG] RAG system already initialized
[INFO] RAG mode disabled
[INFO] RAG disabled
使用中のLLMプロバイダー: openrouter
[taint_analyzer] 3 個の候補フローを解析中...
  [1/3] チェーン: TA_InvokeCommandEntryPoint -> alloc_resources -> TEE_Malloc
[DEBUG] Loaded prompt: taint_start.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle.txt
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Loaded prompt: taint_end.txt
  [2/3] チェーン: TA_InvokeCommandEntryPoint -> cipher_buffer -> TEE_CipherUpdate
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle_multi_params.txt
  [3/3] チェーン: TA_OpenSessionEntryPoint -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[taint_analyzer] 解析完了: 0 件の脆弱性を検出
  結果: /workspace/benchmark/aes/ta/results/ta_vulnerabilities.json
  ログ: /workspace/benchmark/aes/ta/results/taint_analysis_log.txt
Traceback (most recent call last):
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 169, in <module>
    main()
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 138, in main
    generate_summary_report(out_dir, statistics, vulnerabilities)
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 161, in generate_summary_report
    from .report_generator import ReportGenerator
ImportError: attempted relative import with no known parent package
[generate_report] HTMLレポートを生成しました: /workspace/benchmark/aes/ta/results/ta_vulnerability_report.html
  検出脆弱性数: 0
  AI対話履歴を含めました: /workspace/benchmark/aes/ta/results/taint_analysis_log.txt
  対話チェーン数: 3
make -C host CROSS_COMPILE="arm-linux-gnueabihf-" --no-builtin-variables \
	TEEC_EXPORT=/workspace/benchmark/hotp/../../optee_client/out/export
make[1]: Entering directory '/workspace/benchmark/hotp/host'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/workspace/benchmark/hotp/host'
make -C ta CROSS_COMPILE="arm-linux-gnueabihf-" LDFLAGS="" \
	TA_DEV_KIT_DIR=/workspace/benchmark/hotp/../../optee_os/out/arm/export-ta_arm32
make[1]: Entering directory '/workspace/benchmark/hotp/ta'
make[1]: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'hotp_ta.o'.  Stop.
make[1]: Leaving directory '/workspace/benchmark/hotp/ta'
make: *** [Makefile:14: all] Error 2
make: Entering directory '/workspace/benchmark/hotp/ta'
make: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'hotp_ta.o'.  Stop.
make: Leaving directory '/workspace/benchmark/hotp/ta'
CMake Warning (dev) in CMakeLists.txt:
  No cmake_minimum_required command is present.  A line of code such as

    cmake_minimum_required(VERSION 3.22)

  should be added at the top of the file.  The version specified may be lower
  if you wish to support older CMake versions for this project.  For more
  information run "cmake --help-policy CMP0000".
This warning is for project developers.  Use -Wno-dev to suppress it.

-- Configuring done
-- Generating done
-- Build files have been written to: /workspace/benchmark/hotp/build
[INFO] Loaded sink definitions from /workspace/rules/generated_sink_definitions.json
[INFO] PatternMatcher initialized with 3 sink functions
[INFO] Sample sinks: TEE_MemMove(params: [0, 1, 2]), snprintf(params: [0, 1, 2, 3]), TEEC_InvokeCommand(params: [1, 2])
使用中のLLMプロバイダー: openrouter
呼び出し済み外部 API を抽出中...
外部 API 関数: 12 個
外部 API 関数をシンクとして解析中...

[DEBUG] PatternMatcher initialized
[DEBUG] Loaded rules count: 3
[DEBUG] Known functions in index: 3

[DEBUG] Analyzing: TEE_AllocateOperation
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_AllocateTransientObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_FreeOperation
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_FreeTransientObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_InitRefAttribute
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_MACComputeFinal
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_MACInit
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_MACUpdate
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_PopulateTransientObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_SetOperationKey
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: memcpy
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: memset
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()
抽出されたシンク候補: 9 個
結果を /workspace/benchmark/hotp/ta/results/ta_sinks.json に保存しました
[DEBUG] Include paths:
  ✓ /workspace/benchmark/hotp/ta
  ✓ /workspace/benchmark/hotp/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/hotp/ta/hotp_ta.c
  Args: -I/workspace/benchmark/hotp/ta -I/workspace/benchmark/hotp/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[find_sink_calls] 9 call sites → /workspace/benchmark/hotp/ta/results/ta_vulnerable_destinations.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/hotp/ta
  ✓ /workspace/benchmark/hotp/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/hotp/ta/hotp_ta.c
  Args: -I/workspace/benchmark/hotp/ta -I/workspace/benchmark/hotp/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[generate_call_graph_advanced] 26 edges, 9 functions → /workspace/benchmark/hotp/ta/results/ta_call_graph.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/hotp/ta
  ✓ /workspace/benchmark/hotp/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/hotp/ta/hotp_ta.c
  Args: -I/workspace/benchmark/hotp/ta -I/workspace/benchmark/hotp/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[extract_sink_calls] 9 entries → /workspace/benchmark/hotp/ta/results/ta_vulnerable_destinations.json
[DEBUG] 入力チェーン数: 9
[DEBUG] ソース関数マッピング: {'TA_InvokeCommandEntryPoint': [], 'TA_OpenSessionEntryPoint': []}
[DEBUG] ソース関数: ['TA_InvokeCommandEntryPoint', 'TA_OpenSessionEntryPoint']
[DEBUG] ステップ1後: 9 CDFs
[DEBUG] ステップ2後: 9 CDFs（同じVD+ソースの最長チェーンのみ）
[DEBUG] ステップ3後: 9 CDFs（0 個のサブチェーンを削除）
[DEBUG] ステップ4: 3 グループ
[DEBUG] ステップ4後: 3 CDFs（3 グループがマージされた）
[DEBUG] 最終的な危険フロー:
  - TEE_MACComputeFinal at line 108, params=[0, 1, 2, 3]: TA_InvokeCommandEntryPoint -> get_hotp -> hmac_sha1 -> TEE_MACComputeFinal
  - memset at line 152, params=[0, 2]: TA_InvokeCommandEntryPoint -> register_shared_key -> memset
  - memcpy at line 153, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> register_shared_key -> memcpy

[generate_candidate_flows] 3 件 → /workspace/benchmark/hotp/ta/results/ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/aes/ta/compile_commands.json --output /workspace/benchmark/aes/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/aes/ta)
[phase3.5] → /workspace/benchmark/aes/ta/results/ta_call_graph.json

[phase3.3] → python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/aes/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/aes/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/aes/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/aes/ta/results/ta_chains.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/aes/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/aes/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/aes/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/aes/ta/results/ta_chains.json  (cwd=/workspace/benchmark/aes/ta)
[phase3.6] → /workspace/benchmark/aes/ta/results/ta_chains.json

[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/extract_sink_calls.py --compile-db /workspace/benchmark/aes/ta/compile_commands.json --sinks /workspace/benchmark/aes/ta/results/ta_sinks.json --output /workspace/benchmark/aes/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/aes/ta)
[phase3.7] → /workspace/benchmark/aes/ta/results/ta_vulnerable_destinations.json

[phase5_command] → python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/aes/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/aes/ta/results/ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/aes/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/aes/ta/results/ta_candidate_flows.json  (cwd=/workspace/benchmark/aes/ta)
[phase5 ] → /workspace/benchmark/aes/ta/results/ta_candidate_flows.json

[INFO] $ /usr/bin/python3 /workspace/src/analyze_vulnerabilities/taint_analyzer.py --flows /workspace/benchmark/aes/ta/results/ta_candidate_flows.json --phase12 /workspace/benchmark/aes/ta/results/ta_phase12.json --output /workspace/benchmark/aes/ta/results/ta_vulnerabilities.json --generate-summary --no-rag  (cwd=/workspace/benchmark/aes/ta)
[WARN]   ↳ rc=1
[INFO] $ /usr/bin/python3 /workspace/src/report/generate_report.py --vulnerabilities /workspace/benchmark/aes/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/aes/ta/results/ta_phase12.json --project-name aes --output /workspace/benchmark/aes/ta/results/ta_vulnerability_report.html  (cwd=/workspace/benchmark/aes/ta)
[phase7 ] → /workspace/benchmark/aes/ta/results/ta_vulnerability_report.html


=== Project: hotp / TA: ta ===
[INFO] RAG mode is disabled for this analysis
[INFO] $ bear -- make  (cwd=/workspace/benchmark/hotp)
[WARN]   ↳ rc=2
[INFO] $ bear -- make -C ta V=1  (cwd=/workspace/benchmark/hotp)
[WARN]   ↳ rc=2
[INFO] $ cmake -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -Bbuild -H.  (cwd=/workspace/benchmark/hotp)
[WARN] bear が拾えなかった .c がある → dummy 補完
[INFO] ★ dummy DB 1 entries → /workspace/benchmark/hotp/build/compile_commands.json
[INFO] TA DB saved: /workspace/benchmark/hotp/ta/compile_commands.json  entries=1
[DEBUG] Include paths:
  ✓ /workspace/benchmark/hotp/ta
  ✓ /workspace/benchmark/hotp/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/hotp/ta/hotp_ta.c
  Args: -I/workspace/benchmark/hotp/ta -I/workspace/benchmark/hotp/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[phase1-2] → /workspace/benchmark/hotp/ta/results/ta_phase12.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/identify_sinks.py -i /workspace/benchmark/hotp/ta/results/ta_phase12.json -o /workspace/benchmark/hotp/ta/results/ta_sinks.json --no-rag  (cwd=/workspace/benchmark/hotp/ta)
[phase3 ] → /workspace/benchmark/hotp/ta/results/ta_sinks.json

[phase3.1] → python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/hotp/ta/compile_commands.json --sinks /workspace/benchmark/hotp/ta/results/ta_sinks.json --output /workspace/benchmark/hotp/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/hotp/ta/compile_commands.json --sinks /workspace/benchmark/hotp/ta/results/ta_sinks.json --output /workspace/benchmark/hotp/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/hotp/ta)
[phase3.4] → /workspace/benchmark/hotp/ta/results/ta_vulnerable_destinations.json

[phase3.2] → python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/hotp/ta/compile_commands.json --output /workspace/benchmark/hotp/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/hotp/ta/compile_commands.json --output /workspace/benchmark/hotp/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/hotp/ta)
[phase3.5] → /workspace/benchmark/hotp/ta/results/ta_call_graph.json

[phase3.3] → python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/hotp/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/hotp/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/hotp/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/hotp/ta/results/ta_chains.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/hotp/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/hotp/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/hotp/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/hotp/ta/results/ta_chains.json  (cwd=/workspace/benchmark/hotp/ta)
[phase3.6] → /workspace/benchmark/hotp/ta/results/ta_chains.json

[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/extract_sink_calls.py --compile-db /workspace/benchmark/hotp/ta/compile_commands.json --sinks /workspace/benchmark/hotp/ta/results/ta_sinks.json --output /workspace/benchmark/hotp/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/hotp/ta)
[phase3.7] → /workspace/benchmark/hotp/ta/results/ta_vulnerable_destinations.json

[phase5_command] → python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/hotp/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/hotp/ta/results/ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/hotp/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/hotp/ta/results/ta_candidate_flows.json  (cwd=/workspace/benchmark/hotp/ta)
[phase5 ] → /workspace/benchmark/hotp/ta/results/ta_candidate_flows.json

/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[DEBUG] Using prompts directory: /workspace/prompts/vulnerabilities_prompt
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
[DEBUG] RAG system already initialized
[INFO] RAG mode disabled
[INFO] RAG disabled
使用中のLLMプロバイダー: openrouter
[taint_analyzer] 3 個の候補フローを解析中...
  [1/3] チェーン: TA_InvokeCommandEntryPoint -> get_hotp -> hmac_sha1 -> TEE_MACComputeFinal
[DEBUG] Loaded prompt: taint_start.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle_multi_params.txt
[DEBUG] Loaded prompt: taint_end.txt
  [2/3] チェーン: TA_InvokeCommandEntryPoint -> register_shared_key -> memset
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [3/3] チェーン: TA_InvokeCommandEntryPoint -> register_shared_key -> memcpy
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[taint_analyzer] 解析完了: 0 件の脆弱性を検出
  結果: /workspace/benchmark/hotp/ta/results/ta_vulnerabilities.json
  ログ: /workspace/benchmark/hotp/ta/results/taint_analysis_log.txt
Traceback (most recent call last):
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 169, in <module>
    main()
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 138, in main
    generate_summary_report(out_dir, statistics, vulnerabilities)
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 161, in generate_summary_report
    from .report_generator import ReportGenerator
ImportError: attempted relative import with no known parent package
[generate_report] HTMLレポートを生成しました: /workspace/benchmark/hotp/ta/results/ta_vulnerability_report.html
  検出脆弱性数: 0
  AI対話履歴を含めました: /workspace/benchmark/hotp/ta/results/taint_analysis_log.txt
  対話チェーン数: 3
make -C host CROSS_COMPILE="arm-linux-gnueabihf-" --no-builtin-variables \
	TEEC_EXPORT=/workspace/benchmark/random/../../optee_client/out/export
make[1]: Entering directory '/workspace/benchmark/random/host'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/workspace/benchmark/random/host'
make -C ta CROSS_COMPILE="arm-linux-gnueabihf-" LDFLAGS="" \
	TA_DEV_KIT_DIR=/workspace/benchmark/random/../../optee_os/out/arm/export-ta_arm32
make[1]: Entering directory '/workspace/benchmark/random/ta'
make[1]: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'random_example_ta.o'.  Stop.
make[1]: Leaving directory '/workspace/benchmark/random/ta'
make: *** [Makefile:14: all] Error 2
make: Entering directory '/workspace/benchmark/random/ta'
make: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'random_example_ta.o'.  Stop.
make: Leaving directory '/workspace/benchmark/random/ta'
CMake Warning (dev) in CMakeLists.txt:
  No cmake_minimum_required command is present.  A line of code such as

    cmake_minimum_required(VERSION 3.22)

  should be added at the top of the file.  The version specified may be lower
  if you wish to support older CMake versions for this project.  For more
  information run "cmake --help-policy CMP0000".
This warning is for project developers.  Use -Wno-dev to suppress it.

-- Configuring done
-- Generating done
-- Build files have been written to: /workspace/benchmark/random/build
[INFO] Loaded sink definitions from /workspace/rules/generated_sink_definitions.json
[INFO] PatternMatcher initialized with 3 sink functions
[INFO] Sample sinks: TEE_MemMove(params: [0, 1, 2]), snprintf(params: [0, 1, 2, 3]), TEEC_InvokeCommand(params: [1, 2])
使用中のLLMプロバイダー: openrouter
呼び出し済み外部 API を抽出中...
外部 API 関数: 4 個
外部 API 関数をシンクとして解析中...

[DEBUG] PatternMatcher initialized
[DEBUG] Loaded rules count: 3
[DEBUG] Known functions in index: 3

[DEBUG] Analyzing: TEE_Free
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_GenerateRandom
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_Malloc
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_MemMove
  - Is known: True
  - Is sink: True
  - Dangerous params: {0, 1, 2}
  - Rule IDs: {'input_validation_weaknesses', 'unencrypted_data_output'}
抽出されたシンク候補: 9 個
結果を /workspace/benchmark/random/ta/results/ta_sinks.json に保存しました
[DEBUG] Include paths:
  ✓ /workspace/benchmark/random/ta
  ✓ /workspace/benchmark/random/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/random/ta/random_example_ta.c
  Args: -I/workspace/benchmark/random/ta -I/workspace/benchmark/random/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  [3] assigning to 'char *' from incompatible type 'void'
[find_sink_calls] 6 call sites → /workspace/benchmark/random/ta/results/ta_vulnerable_destinations.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/random/ta
  ✓ /workspace/benchmark/random/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/random/ta/random_example_ta.c
  Args: -I/workspace/benchmark/random/ta -I/workspace/benchmark/random/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  [3] assigning to 'char *' from incompatible type 'void'
[generate_call_graph_advanced] 7 edges, 6 functions → /workspace/benchmark/random/ta/results/ta_call_graph.json
  [3] assigning to 'char *' from incompatible type 'void'
[DEBUG] Include paths:
  ✓ /workspace/benchmark/random/ta
  ✓ /workspace/benchmark/random/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/random/ta/random_example_ta.c
  Args: -I/workspace/benchmark/random/ta -I/workspace/benchmark/random/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  [3] assigning to 'char *' from incompatible type 'void'
[extract_sink_calls] 6 entries → /workspace/benchmark/random/ta/results/ta_vulnerable_destinations.json
[DEBUG] 入力チェーン数: 6
[DEBUG] ソース関数マッピング: {'TA_InvokeCommandEntryPoint': [], 'TA_OpenSessionEntryPoint': []}
[DEBUG] ソース関数: ['TA_InvokeCommandEntryPoint', 'TA_OpenSessionEntryPoint']
[DEBUG] ステップ1後: 6 CDFs
[DEBUG] ステップ2後: 6 CDFs（同じVD+ソースの最長チェーンのみ）
[DEBUG] ステップ3後: 6 CDFs（0 個のサブチェーンを削除）
[DEBUG] ステップ4: 3 グループ
[DEBUG] ステップ4後: 3 CDFs（2 グループがマージされた）
[DEBUG] 最終的な危険フロー:
  - TEE_Malloc at line 78, params=[0]: TA_InvokeCommandEntryPoint -> random_number_generate -> TEE_Malloc
  - TEE_GenerateRandom at line 90, params=[0, 2]: TA_InvokeCommandEntryPoint -> random_number_generate -> TEE_GenerateRandom
  - TEE_MemMove at line 91, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> random_number_generate -> TEE_MemMove

[generate_candidate_flows] 3 件 → /workspace/benchmark/random/ta/results/ta_candidate_flows.json
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[DEBUG] Using prompts directory: /workspace/prompts/vulnerabilities_prompt
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
[DEBUG] RAG system already initialized
[INFO] RAG mode disabled
[INFO] RAG disabled
使用中のLLMプロバイダー: openrouter
[taint_analyzer] 3 個の候補フローを解析中...
  [1/3] チェーン: TA_InvokeCommandEntryPoint -> random_number_generate -> TEE_Malloc
[DEBUG] Loaded prompt: taint_start.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle.txt
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Loaded prompt: taint_end.txt
  [2/3] チェーン: TA_InvokeCommandEntryPoint -> random_number_generate -> TEE_GenerateRandom
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle_multi_params.txt
  [3/3] チェーン: TA_InvokeCommandEntryPoint -> random_number_generate -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[taint_analyzer] 解析完了: 3 件の脆弱性を検出
  結果: /workspace/benchmark/random/ta/results/ta_vulnerabilities.json
  ログ: /workspace/benchmark/random/ta/results/taint_analysis_log.txt
Traceback (most recent call last):
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 169, in <module>
    main()
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 138, in main
    generate_summary_report(out_dir, statistics, vulnerabilities)
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 161, in generate_summary_report
    from .report_generator import ReportGenerator
ImportError: attempted relative import with no known parent package
[generate_report] HTMLレポートを生成しました: /workspace/benchmark/random/ta/results/ta_vulnerability_report.html
  検出脆弱性数: 3
  AI対話履歴を含めました: /workspace/benchmark/random/ta/results/taint_analysis_log.txt
  対話チェーン数: 3
make -C host CROSS_COMPILE="arm-linux-gnueabihf-" --no-builtin-variables \
	TEEC_EXPORT=/workspace/benchmark/secure_storage/../../optee_client/out/export
make[1]: Entering directory '/workspace/benchmark/secure_storage/host'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/workspace/benchmark/secure_storage/host'
make -C ta CROSS_COMPILE="arm-linux-gnueabihf-" LDFLAGS="" \
	TA_DEV_KIT_DIR=/workspace/benchmark/secure_storage/../../optee_os/out/arm/export-ta_arm32
make[1]: Entering directory '/workspace/benchmark/secure_storage/ta'
make[1]: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'secure_storage_ta.o'.  Stop.
make[1]: Leaving directory '/workspace/benchmark/secure_storage/ta'
make: *** [Makefile:14: all] Error 2
make: Entering directory '/workspace/benchmark/secure_storage/ta'
make: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'secure_storage_ta.o'.  Stop.
make: Leaving directory '/workspace/benchmark/secure_storage/ta'
CMake Warning (dev) in CMakeLists.txt:
  No cmake_minimum_required command is present.  A line of code such as

    cmake_minimum_required(VERSION 3.22)

  should be added at the top of the file.  The version specified may be lower
  if you wish to support older CMake versions for this project.  For more
  information run "cmake --help-policy CMP0000".
This warning is for project developers.  Use -Wno-dev to suppress it.

-- Configuring done
-- Generating done
-- Build files have been written to: /workspace/benchmark/secure_storage/build
[INFO] Loaded sink definitions from /workspace/rules/generated_sink_definitions.json
[INFO] PatternMatcher initialized with 3 sink functions
[INFO] Sample sinks: TEE_MemMove(params: [0, 1, 2]), snprintf(params: [0, 1, 2, 3]), TEEC_InvokeCommand(params: [1, 2])
使用中のLLMプロバイダー: openrouter
呼び出し済み外部 API を抽出中...
外部 API 関数: 10 個
外部 API 関数をシンクとして解析中...

[DEBUG] PatternMatcher initialized
[DEBUG] Loaded rules count: 3
[DEBUG] Known functions in index: 3

[DEBUG] Analyzing: TEE_CloseAndDeletePersistentObject1
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_CloseObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_CreatePersistentObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_Free
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_GetObjectInfo1
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_Malloc
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_MemMove
  - Is known: True
  - Is sink: True
  - Dangerous params: {0, 1, 2}
  - Rule IDs: {'input_validation_weaknesses', 'unencrypted_data_output'}

[DEBUG] Analyzing: TEE_OpenPersistentObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_ReadObjectData
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_WriteObjectData
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()
抽出されたシンク候補: 20 個
結果を /workspace/benchmark/secure_storage/ta/results/ta_sinks.json に保存しました
[INFO] $ /usr/bin/python3 /workspace/src/analyze_vulnerabilities/taint_analyzer.py --flows /workspace/benchmark/hotp/ta/results/ta_candidate_flows.json --phase12 /workspace/benchmark/hotp/ta/results/ta_phase12.json --output /workspace/benchmark/hotp/ta/results/ta_vulnerabilities.json --generate-summary --no-rag  (cwd=/workspace/benchmark/hotp/ta)
[WARN]   ↳ rc=1
[INFO] $ /usr/bin/python3 /workspace/src/report/generate_report.py --vulnerabilities /workspace/benchmark/hotp/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/hotp/ta/results/ta_phase12.json --project-name hotp --output /workspace/benchmark/hotp/ta/results/ta_vulnerability_report.html  (cwd=/workspace/benchmark/hotp/ta)
[phase7 ] → /workspace/benchmark/hotp/ta/results/ta_vulnerability_report.html


=== Project: random / TA: ta ===
[INFO] RAG mode is disabled for this analysis
[INFO] $ bear -- make  (cwd=/workspace/benchmark/random)
[WARN]   ↳ rc=2
[INFO] $ bear -- make -C ta V=1  (cwd=/workspace/benchmark/random)
[WARN]   ↳ rc=2
[INFO] $ cmake -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -Bbuild -H.  (cwd=/workspace/benchmark/random)
[WARN] bear が拾えなかった .c がある → dummy 補完
[INFO] ★ dummy DB 1 entries → /workspace/benchmark/random/build/compile_commands.json
[INFO] TA DB saved: /workspace/benchmark/random/ta/compile_commands.json  entries=1
[DEBUG] Include paths:
  ✓ /workspace/benchmark/random/ta
  ✓ /workspace/benchmark/random/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/random/ta/random_example_ta.c
  Args: -I/workspace/benchmark/random/ta -I/workspace/benchmark/random/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  [3] assigning to 'char *' from incompatible type 'void'
[phase1-2] → /workspace/benchmark/random/ta/results/ta_phase12.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/identify_sinks.py -i /workspace/benchmark/random/ta/results/ta_phase12.json -o /workspace/benchmark/random/ta/results/ta_sinks.json --no-rag  (cwd=/workspace/benchmark/random/ta)
[phase3 ] → /workspace/benchmark/random/ta/results/ta_sinks.json

[phase3.1] → python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/random/ta/compile_commands.json --sinks /workspace/benchmark/random/ta/results/ta_sinks.json --output /workspace/benchmark/random/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/random/ta/compile_commands.json --sinks /workspace/benchmark/random/ta/results/ta_sinks.json --output /workspace/benchmark/random/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/random/ta)
[phase3.4] → /workspace/benchmark/random/ta/results/ta_vulnerable_destinations.json

[phase3.2] → python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/random/ta/compile_commands.json --output /workspace/benchmark/random/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/random/ta/compile_commands.json --output /workspace/benchmark/random/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/random/ta)
[phase3.5] → /workspace/benchmark/random/ta/results/ta_call_graph.json

[phase3.3] → python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/random/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/random/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/random/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/random/ta/results/ta_chains.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/random/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/random/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/random/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/random/ta/results/ta_chains.json  (cwd=/workspace/benchmark/random/ta)
[phase3.6] → /workspace/benchmark/random/ta/results/ta_chains.json

[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/extract_sink_calls.py --compile-db /workspace/benchmark/random/ta/compile_commands.json --sinks /workspace/benchmark/random/ta/results/ta_sinks.json --output /workspace/benchmark/random/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/random/ta)
[phase3.7] → /workspace/benchmark/random/ta/results/ta_vulnerable_destinations.json

[phase5_command] → python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/random/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/random/ta/results/ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/random/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/random/ta/results/ta_candidate_flows.json  (cwd=/workspace/benchmark/random/ta)
[phase5 ] → /workspace/benchmark/random/ta/results/ta_candidate_flows.json

[INFO] $ /usr/bin/python3 /workspace/src/analyze_vulnerabilities/taint_analyzer.py --flows /workspace/benchmark/random/ta/results/ta_candidate_flows.json --phase12 /workspace/benchmark/random/ta/results/ta_phase12.json --output /workspace/benchmark/random/ta/results/ta_vulnerabilities.json --generate-summary --no-rag  (cwd=/workspace/benchmark/random/ta)
[WARN]   ↳ rc=1
[INFO] $ /usr/bin/python3 /workspace/src/report/generate_report.py --vulnerabilities /workspace/benchmark/random/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/random/ta/results/ta_phase12.json --project-name random --output /workspace/benchmark/random/ta/results/ta_vulnerability_report.html  (cwd=/workspace/benchmark/random/ta)
[phase7 ] → /workspace/benchmark/random/ta/results/ta_vulnerability_report.html


=== Project: secure_storage / TA: ta ===
[INFO] RAG mode is disabled for this analysis
[INFO] $ bear -- make  (cwd=/workspace/benchmark/secure_storage)
[WARN]   ↳ rc=2
[INFO] $ bear -- make -C ta V=1  (cwd=/workspace/benchmark/secure_storage)
[WARN]   ↳ rc=2
[INFO] $ cmake -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -Bbuild -H.  (cwd=/workspace/benchmark/secure_storage)
[WARN] bear が拾えなかった .c がある → dummy 補完
[INFO] ★ dummy DB 1 entries → /workspace/benchmark/secure_storage/build/compile_commands.json
[INFO] TA DB saved: /workspace/benchmark/secure_storage/ta/compile_commands.json  entries=1
[DEBUG] Include paths:
  ✓ /workspace/benchmark/secure_storage/ta
  ✓ /workspace/benchmark/secure_storage/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/secure_storage/ta/secure_storage_ta.c
  Args: -I/workspace/benchmark/secure_storage/ta -I/workspace/benchmark/secure_storage/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[phase1-2] → /workspace/benchmark/secure_storage/ta/results/ta_phase12.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/identify_sinks.py -i /workspace/benchmark/secure_storage/ta/results/ta_phase12.json -o /workspace/benchmark/secure_storage/ta/results/ta_sinks.json --no-rag  (cwd=/workspace/benchmark/secure_storage/ta)
[phase3 ] → /workspace/benchmark/secure_storage/ta/results/ta_sinks.json

[DEBUG] Include paths:
  ✓ /workspace/benchmark/secure_storage/ta
  ✓ /workspace/benchmark/secure_storage/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/secure_storage/ta/secure_storage_ta.c
  Args: -I/workspace/benchmark/secure_storage/ta -I/workspace/benchmark/secure_storage/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[find_sink_calls] 33 call sites → /workspace/benchmark/secure_storage/ta/results/ta_vulnerable_destinations.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/secure_storage/ta
  ✓ /workspace/benchmark/secure_storage/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/secure_storage/ta/secure_storage_ta.c
  Args: -I/workspace/benchmark/secure_storage/ta -I/workspace/benchmark/secure_storage/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[generate_call_graph_advanced] 40 edges, 8 functions → /workspace/benchmark/secure_storage/ta/results/ta_call_graph.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/secure_storage/ta
  ✓ /workspace/benchmark/secure_storage/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/secure_storage/ta/secure_storage_ta.c
  Args: -I/workspace/benchmark/secure_storage/ta -I/workspace/benchmark/secure_storage/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[extract_sink_calls] 33 entries → /workspace/benchmark/secure_storage/ta/results/ta_vulnerable_destinations.json
[DEBUG] 入力チェーン数: 33
[DEBUG] ソース関数マッピング: {'TA_InvokeCommandEntryPoint': [], 'TA_OpenSessionEntryPoint': []}
[DEBUG] ソース関数: ['TA_InvokeCommandEntryPoint', 'TA_OpenSessionEntryPoint']
[DEBUG] ステップ1後: 33 CDFs
[DEBUG] ステップ2後: 33 CDFs（同じVD+ソースの最長チェーンのみ）
[DEBUG] ステップ3後: 33 CDFs（0 個のサブチェーンを削除）
[DEBUG] ステップ4: 14 グループ
[DEBUG] ステップ4後: 14 CDFs（8 グループがマージされた）
[DEBUG] 最終的な危険フロー:
  - TEE_Malloc at line 52, params=[0]: TA_InvokeCommandEntryPoint -> delete_object -> TEE_Malloc
  - TEE_MemMove at line 56, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> delete_object -> TEE_MemMove
  - TEE_Malloc at line 100, params=[0]: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_Malloc
  - TEE_MemMove at line 104, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_MemMove
  - TEE_Malloc at line 107, params=[0]: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_Malloc
  - TEE_MemMove at line 110, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_MemMove
  - TEE_CreatePersistentObject at line 120, params=[0, 1, 2, 3, 4, 5, 6, 7]: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_CreatePersistentObject
  - TEE_WriteObjectData at line 133, params=[1, 2]: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_WriteObjectData
  - TEE_Malloc at line 168, params=[0]: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_Malloc
  - TEE_MemMove at line 172, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_MemMove
  - TEE_Malloc at line 175, params=[0]: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_Malloc
  - TEE_GetObjectInfo1 at line 195, params=[0]: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_GetObjectInfo1
  - TEE_ReadObjectData at line 211, params=[0, 2]: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_ReadObjectData
  - TEE_MemMove at line 214, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_MemMove

[generate_candidate_flows] 14 件 → /workspace/benchmark/secure_storage/ta/results/ta_candidate_flows.json
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[DEBUG] Using prompts directory: /workspace/prompts/vulnerabilities_prompt
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
[DEBUG] RAG system already initialized
[INFO] RAG mode disabled
[INFO] RAG disabled
使用中のLLMプロバイダー: openrouter
[taint_analyzer] 14 個の候補フローを解析中...
  [1/14] チェーン: TA_InvokeCommandEntryPoint -> delete_object -> TEE_Malloc
[DEBUG] Loaded prompt: taint_start.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle.txt
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Loaded prompt: taint_end.txt
  [2/14] チェーン: TA_InvokeCommandEntryPoint -> delete_object -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle_multi_params.txt
  [3/14] チェーン: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
  [4/14] チェーン: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [5/14] チェーン: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
  [6/14] チェーン: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [7/14] チェーン: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_CreatePersistentObject
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [8/14] チェーン: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_WriteObjectData
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [9/14] チェーン: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
  [10/14] チェーン: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [11/14] チェーン: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
  [12/14] チェーン: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_GetObjectInfo1
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_GetObjectInfo1, param_index=0
  [13/14] チェーン: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_ReadObjectData
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [14/14] チェーン: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[taint_analyzer] 解析完了: 0 件の脆弱性を検出
  結果: /workspace/benchmark/secure_storage/ta/results/ta_vulnerabilities.json
  ログ: /workspace/benchmark/secure_storage/ta/results/taint_analysis_log.txt
Traceback (most recent call last):
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 169, in <module>
    main()
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 138, in main
    generate_summary_report(out_dir, statistics, vulnerabilities)
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 161, in generate_summary_report
    from .report_generator import ReportGenerator
ImportError: attempted relative import with no known parent package
[generate_report] HTMLレポートを生成しました: /workspace/benchmark/secure_storage/ta/results/ta_vulnerability_report.html
  検出脆弱性数: 0
  AI対話履歴を含めました: /workspace/benchmark/secure_storage/ta/results/taint_analysis_log.txt
  対話チェーン数: 10
make -C host CROSS_COMPILE="arm-linux-gnueabihf-" --no-builtin-variables \
	TEEC_EXPORT=/workspace/benchmark/secvideo_demo/../../optee_client/out/export
make[1]: Entering directory '/workspace/benchmark/secvideo_demo/host'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/workspace/benchmark/secvideo_demo/host'
make -C ta CROSS_COMPILE="arm-linux-gnueabihf-" LDFLAGS="" \
	TA_DEV_KIT_DIR=/workspace/benchmark/secvideo_demo/../../optee_os/out/arm/export-ta_arm32
make[1]: Entering directory '/workspace/benchmark/secvideo_demo/ta'
make[1]: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'secvideo_demo_ta.o'.  Stop.
make[1]: Leaving directory '/workspace/benchmark/secvideo_demo/ta'
make: *** [Makefile:14: all] Error 2
make: Entering directory '/workspace/benchmark/secvideo_demo/ta'
make: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'secvideo_demo_ta.o'.  Stop.
make: Leaving directory '/workspace/benchmark/secvideo_demo/ta'
make: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'secvideo_demo_ta.o'.  Stop.
[INFO] Loaded sink definitions from /workspace/rules/generated_sink_definitions.json
[INFO] PatternMatcher initialized with 3 sink functions
[INFO] Sample sinks: TEE_MemMove(params: [0, 1, 2]), snprintf(params: [0, 1, 2, 3]), TEEC_InvokeCommand(params: [1, 2])
使用中のLLMプロバイダー: openrouter
呼び出し済み外部 API を抽出中...
外部 API 関数: 11 個
外部 API 関数をシンクとして解析中...

[DEBUG] PatternMatcher initialized
[DEBUG] Loaded rules count: 3
[DEBUG] Known functions in index: 3

[DEBUG] Analyzing: TEE_AllocateOperation
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_AllocateTransientObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_CheckMemoryAccessRights
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_CipherDoFinal
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_CipherInit
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_Free
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_FreeTransientObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_Malloc
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_PopulateTransientObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_SetOperationKey
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: memset
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()
抽出されたシンク候補: 11 個
結果を /workspace/benchmark/secvideo_demo/ta/results/ta_sinks.json に保存しました
[DEBUG] Include paths:
  ✓ /workspace/benchmark/secvideo_demo/ta
  ✓ /workspace/benchmark/secvideo_demo/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/secvideo_demo/ta/secvideo_demo_ta.c
  Args: -I/workspace/benchmark/secvideo_demo/ta -I/workspace/benchmark/secvideo_demo/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[find_sink_calls] 10 call sites → /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerable_destinations.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/secvideo_demo/ta
  ✓ /workspace/benchmark/secvideo_demo/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/secvideo_demo/ta/secvideo_demo_ta.c
  Args: -I/workspace/benchmark/secvideo_demo/ta -I/workspace/benchmark/secvideo_demo/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[generate_call_graph_advanced] 31 edges, 8 functions → /workspace/benchmark/secvideo_demo/ta/results/ta_call_graph.json
[phase3.1] → python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/secure_storage/ta/compile_commands.json --sinks /workspace/benchmark/secure_storage/ta/results/ta_sinks.json --output /workspace/benchmark/secure_storage/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/secure_storage/ta/compile_commands.json --sinks /workspace/benchmark/secure_storage/ta/results/ta_sinks.json --output /workspace/benchmark/secure_storage/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/secure_storage/ta)
[phase3.4] → /workspace/benchmark/secure_storage/ta/results/ta_vulnerable_destinations.json

[phase3.2] → python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/secure_storage/ta/compile_commands.json --output /workspace/benchmark/secure_storage/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/secure_storage/ta/compile_commands.json --output /workspace/benchmark/secure_storage/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/secure_storage/ta)
[phase3.5] → /workspace/benchmark/secure_storage/ta/results/ta_call_graph.json

[phase3.3] → python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/secure_storage/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/secure_storage/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/secure_storage/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/secure_storage/ta/results/ta_chains.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/secure_storage/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/secure_storage/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/secure_storage/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/secure_storage/ta/results/ta_chains.json  (cwd=/workspace/benchmark/secure_storage/ta)
[phase3.6] → /workspace/benchmark/secure_storage/ta/results/ta_chains.json

[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/extract_sink_calls.py --compile-db /workspace/benchmark/secure_storage/ta/compile_commands.json --sinks /workspace/benchmark/secure_storage/ta/results/ta_sinks.json --output /workspace/benchmark/secure_storage/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/secure_storage/ta)
[phase3.7] → /workspace/benchmark/secure_storage/ta/results/ta_vulnerable_destinations.json

[phase5_command] → python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/secure_storage/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/secure_storage/ta/results/ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/secure_storage/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/secure_storage/ta/results/ta_candidate_flows.json  (cwd=/workspace/benchmark/secure_storage/ta)
[phase5 ] → /workspace/benchmark/secure_storage/ta/results/ta_candidate_flows.json

[INFO] $ /usr/bin/python3 /workspace/src/analyze_vulnerabilities/taint_analyzer.py --flows /workspace/benchmark/secure_storage/ta/results/ta_candidate_flows.json --phase12 /workspace/benchmark/secure_storage/ta/results/ta_phase12.json --output /workspace/benchmark/secure_storage/ta/results/ta_vulnerabilities.json --generate-summary --no-rag  (cwd=/workspace/benchmark/secure_storage/ta)
[WARN]   ↳ rc=1
[INFO] $ /usr/bin/python3 /workspace/src/report/generate_report.py --vulnerabilities /workspace/benchmark/secure_storage/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/secure_storage/ta/results/ta_phase12.json --project-name secure_storage --output /workspace/benchmark/secure_storage/ta/results/ta_vulnerability_report.html  (cwd=/workspace/benchmark/secure_storage/ta)
[phase7 ] → /workspace/benchmark/secure_storage/ta/results/ta_vulnerability_report.html


=== Project: secvideo_demo / TA: ta ===
[INFO] RAG mode is disabled for this analysis
[INFO] $ bear -- make  (cwd=/workspace/benchmark/secvideo_demo)
[WARN]   ↳ rc=2
[INFO] $ bear -- make -C ta V=1  (cwd=/workspace/benchmark/secvideo_demo)
[WARN]   ↳ rc=2
[INFO] $ bear -- make  (cwd=/workspace/benchmark/secvideo_demo/ta)
[WARN]   ↳ rc=2
[WARN] build failed/empty → dummy DB
[INFO] ★ dummy DB 1 entries → /workspace/benchmark/secvideo_demo/ta/compile_commands_full.json
[INFO] TA DB saved: /workspace/benchmark/secvideo_demo/ta/compile_commands.json  entries=1
[DEBUG] Include paths:
  ✓ /workspace/benchmark/secvideo_demo/ta
  ✓ /workspace/benchmark/secvideo_demo/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/secvideo_demo/ta/secvideo_demo_ta.c
  Args: -I/workspace/benchmark/secvideo_demo/ta -I/workspace/benchmark/secvideo_demo/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[phase1-2] → /workspace/benchmark/secvideo_demo/ta/results/ta_phase12.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/identify_sinks.py -i /workspace/benchmark/secvideo_demo/ta/results/ta_phase12.json -o /workspace/benchmark/secvideo_demo/ta/results/ta_sinks.json --no-rag  (cwd=/workspace/benchmark/secvideo_demo/ta)
[phase3 ] → /workspace/benchmark/secvideo_demo/ta/results/ta_sinks.json

[phase3.1] → python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/secvideo_demo/ta/compile_commands.json --sinks /workspace/benchmark/secvideo_demo/ta/results/ta_sinks.json --output /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/secvideo_demo/ta/compile_commands.json --sinks /workspace/benchmark/secvideo_demo/ta/results/ta_sinks.json --output /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/secvideo_demo/ta)
[phase3.4] → /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerable_destinations.json

[phase3.2] → python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/secvideo_demo/ta/compile_commands.json --output /workspace/benchmark/secvideo_demo/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/secvideo_demo/ta/compile_commands.json --output /workspace/benchmark/secvideo_demo/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/secvideo_demo/ta)
[phase3.5] → /workspace/benchmark/secvideo_demo/ta/results/ta_call_graph.json

[phase3.3] → python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/secvideo_demo/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/secvideo_demo/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/secvideo_demo/ta/results/ta_chains.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/secvideo_demo/ta
  ✓ /workspace/benchmark/secvideo_demo/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/secvideo_demo/ta/secvideo_demo_ta.c
  Args: -I/workspace/benchmark/secvideo_demo/ta -I/workspace/benchmark/secvideo_demo/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[extract_sink_calls] 10 entries → /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerable_destinations.json
[DEBUG] 入力チェーン数: 10
[DEBUG] ソース関数マッピング: {'TA_InvokeCommandEntryPoint': [], 'TA_OpenSessionEntryPoint': []}
[DEBUG] ソース関数: ['TA_InvokeCommandEntryPoint', 'TA_OpenSessionEntryPoint']
[DEBUG] ステップ1後: 10 CDFs
[DEBUG] ステップ2後: 10 CDFs（同じVD+ソースの最長チェーンのみ）
[DEBUG] ステップ3後: 10 CDFs（0 個のサブチェーンを削除）
[DEBUG] ステップ4: 5 グループ
[DEBUG] ステップ4後: 5 CDFs（4 グループがマージされた）
[DEBUG] 最終的な危険フロー:
  - TEE_Malloc at line 107, params=[0]: TA_InvokeCommandEntryPoint -> clear_screen -> TEE_Malloc
  - memset at line 110, params=[0, 2]: TA_InvokeCommandEntryPoint -> clear_screen -> memset
  - TEE_PopulateTransientObject at line 143, params=[1, 2]: TA_InvokeCommandEntryPoint -> image_data -> decrypt -> TEE_PopulateTransientObject
  - TEE_CipherInit at line 154, params=[1, 2]: TA_InvokeCommandEntryPoint -> image_data -> decrypt -> TEE_CipherInit
  - TEE_CipherDoFinal at line 158, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> image_data -> decrypt -> TEE_CipherDoFinal

[generate_candidate_flows] 5 件 → /workspace/benchmark/secvideo_demo/ta/results/ta_candidate_flows.json
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[DEBUG] Using prompts directory: /workspace/prompts/vulnerabilities_prompt
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
[DEBUG] RAG system already initialized
[INFO] RAG mode disabled
[INFO] RAG disabled
使用中のLLMプロバイダー: openrouter
[taint_analyzer] 5 個の候補フローを解析中...
  [1/5] チェーン: TA_InvokeCommandEntryPoint -> clear_screen -> TEE_Malloc
[DEBUG] Loaded prompt: taint_start.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle.txt
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Loaded prompt: taint_end.txt
  [2/5] チェーン: TA_InvokeCommandEntryPoint -> clear_screen -> memset
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle_multi_params.txt
  [3/5] チェーン: TA_InvokeCommandEntryPoint -> image_data -> decrypt -> TEE_PopulateTransientObject
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [4/5] チェーン: TA_InvokeCommandEntryPoint -> image_data -> decrypt -> TEE_CipherInit
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [5/5] チェーン: TA_InvokeCommandEntryPoint -> image_data -> decrypt -> TEE_CipherDoFinal
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[taint_analyzer] 解析完了: 0 件の脆弱性を検出
  結果: /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerabilities.json
  ログ: /workspace/benchmark/secvideo_demo/ta/results/taint_analysis_log.txt
Traceback (most recent call last):
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 169, in <module>
    main()
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 138, in main
    generate_summary_report(out_dir, statistics, vulnerabilities)
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 161, in generate_summary_report
    from .report_generator import ReportGenerator
ImportError: attempted relative import with no known parent package
[generate_report] HTMLレポートを生成しました: /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerability_report.html
  検出脆弱性数: 0
  AI対話履歴を含めました: /workspace/benchmark/secvideo_demo/ta/results/taint_analysis_log.txt
  対話チェーン数: 5
make -C host CROSS_COMPILE="arm-linux-gnueabihf-" --no-builtin-variables  \
	TEEC_EXPORT=/workspace/benchmark/optee-fiovb/../../optee_client/out/export
make[1]: Entering directory '/workspace/benchmark/optee-fiovb/host'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/workspace/benchmark/optee-fiovb/host'
make -C ta CROSS_COMPILE="arm-linux-gnueabihf-" LDFLAGS=""  \
	TA_DEV_KIT_DIR=/workspace/benchmark/optee-fiovb/../../optee_os/out/arm/export-ta_arm32
make[1]: Entering directory '/workspace/benchmark/optee-fiovb/ta'
make[1]: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'entry.o'.  Stop.
make[1]: Leaving directory '/workspace/benchmark/optee-fiovb/ta'
make: *** [Makefile:18: all] Error 2
make: Entering directory '/workspace/benchmark/optee-fiovb/ta'
make: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'entry.o'.  Stop.
make: Leaving directory '/workspace/benchmark/optee-fiovb/ta'
CMake Error at CMakeLists.txt:31 (install):
  install FILES given no DESTINATION!


CMake Warning (dev) in CMakeLists.txt:
  No cmake_minimum_required command is present.  A line of code such as

    cmake_minimum_required(VERSION 3.22)

  should be added at the top of the file.  The version specified may be lower
  if you wish to support older CMake versions for this project.  For more
  information run "cmake --help-policy CMP0000".
This warning is for project developers.  Use -Wno-dev to suppress it.

-- Configuring incomplete, errors occurred!
See also "/workspace/benchmark/optee-fiovb/build/CMakeFiles/CMakeOutput.log".
gmake: Makefile: No such file or directory
gmake: *** No rule to make target 'Makefile'.  Stop.
make: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'entry.o'.  Stop.
[INFO] Loaded sink definitions from /workspace/rules/generated_sink_definitions.json
[INFO] PatternMatcher initialized with 3 sink functions
[INFO] Sample sinks: TEE_MemMove(params: [0, 1, 2]), snprintf(params: [0, 1, 2, 3]), TEEC_InvokeCommand(params: [1, 2])
使用中のLLMプロバイダー: openrouter
呼び出し済み外部 API を抽出中...
外部 API 関数: 12 個
外部 API 関数をシンクとして解析中...

[DEBUG] PatternMatcher initialized
[DEBUG] Loaded rules count: 3
[DEBUG] Known functions in index: 3

[DEBUG] Analyzing: TEE_CloseAndDeletePersistentObject1
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_CloseObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_CreatePersistentObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_Free
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_Malloc
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_MemMove
  - Is known: True
  - Is sink: True
  - Dangerous params: {0, 1, 2}
  - Rule IDs: {'unencrypted_data_output', 'input_validation_weaknesses'}

[DEBUG] Analyzing: TEE_OpenPersistentObject
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_ReadObjectData
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: strcmp
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: strlen
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: strncmp
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: strtoul
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()
抽出されたシンク候補: 10 個
結果を /workspace/benchmark/optee-fiovb/ta/results/ta_sinks.json に保存しました
[DEBUG] Include paths:
  ✓ /workspace/benchmark/optee-fiovb/ta
  ✓ /workspace/benchmark/optee-fiovb/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/optee-fiovb/ta/entry.c
  Args: -I/workspace/benchmark/optee-fiovb/ta -I/workspace/benchmark/optee-fiovb/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[find_sink_calls] 23 call sites → /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerable_destinations.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/optee-fiovb/ta
  ✓ /workspace/benchmark/optee-fiovb/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/optee-fiovb/ta/entry.c
  Args: -I/workspace/benchmark/optee-fiovb/ta -I/workspace/benchmark/optee-fiovb/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[generate_call_graph_advanced] 58 edges, 16 functions → /workspace/benchmark/optee-fiovb/ta/results/ta_call_graph.json
[DEBUG] No parameter dependency detected, but tracing callers anyway
[DEBUG] Include paths:
  ✓ /workspace/benchmark/optee-fiovb/ta
  ✓ /workspace/benchmark/optee-fiovb/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/optee-fiovb/ta/entry.c
  Args: -I/workspace/benchmark/optee-fiovb/ta -I/workspace/benchmark/optee-fiovb/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[extract_sink_calls] 23 entries → /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerable_destinations.json
[DEBUG] 入力チェーン数: 23
[DEBUG] ソース関数マッピング: {'TA_InvokeCommandEntryPoint': [], 'TA_OpenSessionEntryPoint': []}
[DEBUG] ソース関数: ['TA_InvokeCommandEntryPoint', 'TA_OpenSessionEntryPoint']
[DEBUG] ステップ1後: 62 CDFs
[DEBUG] ステップ2後: 23 CDFs（同じVD+ソースの最長チェーンのみ）
[DEBUG] ステップ3後: 23 CDFs（0 個のサブチェーンを削除）
[DEBUG] ステップ4: 14 グループ
[DEBUG] ステップ4後: 14 CDFs（5 グループがマージされた）
[DEBUG] 最終的な危険フロー:
  - strlen at line 29, params=[1]: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_rollback_protected -> read_value -> get_named_object_name -> strlen
  - TEE_MemMove at line 36, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_rollback_protected -> read_value -> get_named_object_name -> TEE_MemMove
  - TEE_MemMove at line 39, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_rollback_protected -> read_value -> get_named_object_name -> TEE_MemMove
  - TEE_ReadObjectData at line 128, params=[0, 2]: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_rollback_protected -> read_value -> TEE_ReadObjectData
  - strlen at line 173, params=[1]: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_rollback_protected -> strlen
  - strlen at line 192, params=[1]: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_version_incremental -> strlen
  - strlen at line 222, params=[1]: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> strlen
  - strlen at line 260, params=[1]: TA_InvokeCommandEntryPoint -> write_persist_value -> strlen
  - TEE_Malloc at line 264, params=[0]: TA_InvokeCommandEntryPoint -> write_persist_value -> TEE_Malloc
  - TEE_MemMove at line 268, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> write_persist_value -> TEE_MemMove
  - strlen at line 281, params=[1]: TA_InvokeCommandEntryPoint -> write_persist_value -> strlen
  - TEE_Malloc at line 320, params=[0]: TA_InvokeCommandEntryPoint -> read_persist_value -> TEE_Malloc
  - TEE_MemMove at line 326, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> read_persist_value -> TEE_MemMove
  - strlen at line 356, params=[1]: TA_InvokeCommandEntryPoint -> delete_persist_value -> strlen

[generate_candidate_flows] 14 件 → /workspace/benchmark/optee-fiovb/ta/results/ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/secvideo_demo/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/secvideo_demo/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/secvideo_demo/ta/results/ta_chains.json  (cwd=/workspace/benchmark/secvideo_demo/ta)
[phase3.6] → /workspace/benchmark/secvideo_demo/ta/results/ta_chains.json

[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/extract_sink_calls.py --compile-db /workspace/benchmark/secvideo_demo/ta/compile_commands.json --sinks /workspace/benchmark/secvideo_demo/ta/results/ta_sinks.json --output /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/secvideo_demo/ta)
[phase3.7] → /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerable_destinations.json

[phase5_command] → python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/secvideo_demo/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/secvideo_demo/ta/results/ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/secvideo_demo/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/secvideo_demo/ta/results/ta_candidate_flows.json  (cwd=/workspace/benchmark/secvideo_demo/ta)
[phase5 ] → /workspace/benchmark/secvideo_demo/ta/results/ta_candidate_flows.json

[INFO] $ /usr/bin/python3 /workspace/src/analyze_vulnerabilities/taint_analyzer.py --flows /workspace/benchmark/secvideo_demo/ta/results/ta_candidate_flows.json --phase12 /workspace/benchmark/secvideo_demo/ta/results/ta_phase12.json --output /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerabilities.json --generate-summary --no-rag  (cwd=/workspace/benchmark/secvideo_demo/ta)
[WARN]   ↳ rc=1
[INFO] $ /usr/bin/python3 /workspace/src/report/generate_report.py --vulnerabilities /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/secvideo_demo/ta/results/ta_phase12.json --project-name secvideo_demo --output /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerability_report.html  (cwd=/workspace/benchmark/secvideo_demo/ta)
[phase7 ] → /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerability_report.html


=== Project: optee-fiovb / TA: ta ===
[INFO] RAG mode is disabled for this analysis
[INFO] $ bear -- make  (cwd=/workspace/benchmark/optee-fiovb)
[WARN]   ↳ rc=2
[INFO] $ bear -- make -C ta V=1  (cwd=/workspace/benchmark/optee-fiovb)
[WARN]   ↳ rc=2
[INFO] $ cmake -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -Bbuild -H.  (cwd=/workspace/benchmark/optee-fiovb)
[WARN]   ↳ rc=1
[INFO] $ cmake --build build  (cwd=/workspace/benchmark/optee-fiovb)
[WARN]   ↳ rc=2
[INFO] $ bear -- make  (cwd=/workspace/benchmark/optee-fiovb/ta)
[WARN]   ↳ rc=2
[WARN] build failed/empty → dummy DB
[INFO] ★ dummy DB 1 entries → /workspace/benchmark/optee-fiovb/ta/compile_commands_full.json
[INFO] TA DB saved: /workspace/benchmark/optee-fiovb/ta/compile_commands.json  entries=1
[DEBUG] Include paths:
  ✓ /workspace/benchmark/optee-fiovb/ta
  ✓ /workspace/benchmark/optee-fiovb/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/optee-fiovb/ta/entry.c
  Args: -I/workspace/benchmark/optee-fiovb/ta -I/workspace/benchmark/optee-fiovb/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[phase1-2] → /workspace/benchmark/optee-fiovb/ta/results/ta_phase12.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/identify_sinks.py -i /workspace/benchmark/optee-fiovb/ta/results/ta_phase12.json -o /workspace/benchmark/optee-fiovb/ta/results/ta_sinks.json --no-rag  (cwd=/workspace/benchmark/optee-fiovb/ta)
[phase3 ] → /workspace/benchmark/optee-fiovb/ta/results/ta_sinks.json

[phase3.1] → python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/optee-fiovb/ta/compile_commands.json --sinks /workspace/benchmark/optee-fiovb/ta/results/ta_sinks.json --output /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/optee-fiovb/ta/compile_commands.json --sinks /workspace/benchmark/optee-fiovb/ta/results/ta_sinks.json --output /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/optee-fiovb/ta)
[phase3.4] → /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerable_destinations.json

[phase3.2] → python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/optee-fiovb/ta/compile_commands.json --output /workspace/benchmark/optee-fiovb/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/optee-fiovb/ta/compile_commands.json --output /workspace/benchmark/optee-fiovb/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/optee-fiovb/ta)
[phase3.5] → /workspace/benchmark/optee-fiovb/ta/results/ta_call_graph.json

[phase3.3] → python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/optee-fiovb/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/optee-fiovb/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/optee-fiovb/ta/results/ta_chains.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/optee-fiovb/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/optee-fiovb/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/optee-fiovb/ta/results/ta_chains.json  (cwd=/workspace/benchmark/optee-fiovb/ta)
[phase3.6] → /workspace/benchmark/optee-fiovb/ta/results/ta_chains.json

[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/extract_sink_calls.py --compile-db /workspace/benchmark/optee-fiovb/ta/compile_commands.json --sinks /workspace/benchmark/optee-fiovb/ta/results/ta_sinks.json --output /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/optee-fiovb/ta)
[phase3.7] → /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerable_destinations.json

[phase5_command] → python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/optee-fiovb/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/optee-fiovb/ta/results/ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/optee-fiovb/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/optee-fiovb/ta/results/ta_candidate_flows.json  (cwd=/workspace/benchmark/optee-fiovb/ta)
[phase5 ] → /workspace/benchmark/optee-fiovb/ta/results/ta_candidate_flows.json

/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[DEBUG] Using prompts directory: /workspace/prompts/vulnerabilities_prompt
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
[DEBUG] RAG system already initialized
[INFO] RAG mode disabled
[INFO] RAG disabled
使用中のLLMプロバイダー: openrouter
[taint_analyzer] 14 個の候補フローを解析中...
  [1/14] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_rollback_protected -> read_value -> get_named_object_name -> strlen
[DEBUG] Loaded prompt: taint_start.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=strlen, param_index=1
[DEBUG] Loaded prompt: taint_end.txt
  [2/14] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_rollback_protected -> read_value -> get_named_object_name -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle_multi_params.txt
  [3/14] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_rollback_protected -> read_value -> get_named_object_name -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [4/14] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_rollback_protected -> read_value -> TEE_ReadObjectData
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [5/14] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_rollback_protected -> strlen
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=strlen, param_index=1
  [6/14] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_version_incremental -> strlen
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=strlen, param_index=1
  [7/14] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> strlen
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=strlen, param_index=1
  [8/14] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> strlen
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=strlen, param_index=1
  [9/14] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
  [10/14] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [11/14] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> strlen
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=strlen, param_index=1
  [12/14] チェーン: TA_InvokeCommandEntryPoint -> read_persist_value -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
  [13/14] チェーン: TA_InvokeCommandEntryPoint -> read_persist_value -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [14/14] チェーン: TA_InvokeCommandEntryPoint -> delete_persist_value -> strlen
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=strlen, param_index=1
[taint_analyzer] 解析完了: 0 件の脆弱性を検出
  結果: /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerabilities.json
  ログ: /workspace/benchmark/optee-fiovb/ta/results/taint_analysis_log.txt
Traceback (most recent call last):
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 169, in <module>
    main()
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 138, in main
    generate_summary_report(out_dir, statistics, vulnerabilities)
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 161, in generate_summary_report
    from .report_generator import ReportGenerator
ImportError: attempted relative import with no known parent package
[generate_report] HTMLレポートを生成しました: /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerability_report.html
  検出脆弱性数: 0
  AI対話履歴を含めました: /workspace/benchmark/optee-fiovb/ta/results/taint_analysis_log.txt
  対話チェーン数: 12
make -C host CROSS_COMPILE="arm-linux-gnueabihf-" --no-builtin-variables  \
	TEEC_EXPORT=/workspace/benchmark/optee-sdp/../../optee_client/out/export
make[1]: Entering directory '/workspace/benchmark/optee-sdp/host'
arm-linux-gnueabihf-gcc -o smaf-optee smaf-optee.o  -lteec -L/workspace/benchmark/optee-sdp/../../optee_client/out/export/lib
make[1]: Leaving directory '/workspace/benchmark/optee-sdp/host'
make -C ta CROSS_COMPILE="arm-linux-gnueabihf-" LDFLAGS="" \
	TA_DEV_KIT_DIR=/workspace/benchmark/optee-sdp/../../optee_os/out/arm/export-ta_arm32
make[1]: Entering directory '/workspace/benchmark/optee-sdp/ta'
make[1]: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'sdp_ta.o'.  Stop.
make[1]: Leaving directory '/workspace/benchmark/optee-sdp/ta'
make: *** [Makefile:13: all] Error 2
make: Entering directory '/workspace/benchmark/optee-sdp/ta'
make: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'sdp_ta.o'.  Stop.
make: Leaving directory '/workspace/benchmark/optee-sdp/ta'
make: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'sdp_ta.o'.  Stop.
[INFO] Loaded sink definitions from /workspace/rules/generated_sink_definitions.json
[INFO] PatternMatcher initialized with 3 sink functions
[INFO] Sample sinks: TEE_MemMove(params: [0, 1, 2]), snprintf(params: [0, 1, 2, 3]), TEEC_InvokeCommand(params: [1, 2])
使用中のLLMプロバイダー: openrouter
呼び出し済み外部 API を抽出中...
外部 API 関数: 13 個
外部 API 関数をシンクとして解析中...

[DEBUG] PatternMatcher initialized
[DEBUG] Loaded rules count: 3
[DEBUG] Known functions in index: 3

[DEBUG] Analyzing: memset
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: platform_add_device_to_region
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: platform_check_permissions
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: platform_create_region
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: platform_destroy_region
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: platform_dump_device
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: platform_dump_status
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: platform_find_device_by_name
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: platform_find_region_by_id
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: platform_init
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: platform_remove_device_from_region
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: snprintf
  - Is known: True
  - Is sink: True
  - Dangerous params: {0, 1, 2, 3}
  - Rule IDs: {'unencrypted_data_output', 'input_validation_weaknesses'}

[DEBUG] Analyzing: strcmp
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()
抽出されたシンク候補: 27 個
結果を /workspace/benchmark/optee-sdp/ta/results/ta_sinks.json に保存しました
[DEBUG] Include paths:
  ✓ /workspace/benchmark/optee-sdp/ta
  ✗ /workspace/benchmark/optee-sdp/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/optee-sdp/ta/sdp_ta.c
  Args: -I/workspace/benchmark/optee-sdp/ta -I/workspace/benchmark/optee-sdp/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/optee-sdp/ta/platform/stub.c
  Args: -I/workspace/benchmark/optee-sdp/ta -I/workspace/benchmark/optee-sdp/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[find_sink_calls] 55 call sites → /workspace/benchmark/optee-sdp/ta/results/ta_vulnerable_destinations.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/optee-sdp/ta
  ✗ /workspace/benchmark/optee-sdp/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/optee-sdp/ta/sdp_ta.c
  Args: -I/workspace/benchmark/optee-sdp/ta -I/workspace/benchmark/optee-sdp/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/optee-sdp/ta/platform/stub.c
  Args: -I/workspace/benchmark/optee-sdp/ta -I/workspace/benchmark/optee-sdp/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[generate_call_graph_advanced] 34 edges, 26 functions → /workspace/benchmark/optee-sdp/ta/results/ta_call_graph.json
[DEBUG] No parameter dependency detected, but tracing callers anyway
[DEBUG] No parameter dependency detected, but tracing callers anyway
[DEBUG] Include paths:
  ✓ /workspace/benchmark/optee-sdp/ta
  ✗ /workspace/benchmark/optee-sdp/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/optee-sdp/ta/sdp_ta.c
  Args: -I/workspace/benchmark/optee-sdp/ta -I/workspace/benchmark/optee-sdp/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/optee-sdp/ta/platform/stub.c
  Args: -I/workspace/benchmark/optee-sdp/ta -I/workspace/benchmark/optee-sdp/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[extract_sink_calls] 55 entries → /workspace/benchmark/optee-sdp/ta/results/ta_vulnerable_destinations.json
[DEBUG] 入力チェーン数: 55
[DEBUG] ソース関数マッピング: {'TA_InvokeCommandEntryPoint': [], 'TA_OpenSessionEntryPoint': []}
[DEBUG] ソース関数: ['TA_InvokeCommandEntryPoint', 'TA_OpenSessionEntryPoint']
[DEBUG] ステップ1後: 53 CDFs
[DEBUG] ステップ2後: 53 CDFs（同じVD+ソースの最長チェーンのみ）
[DEBUG] ステップ3後: 53 CDFs（0 個のサブチェーンを削除）
[DEBUG] ステップ4: 16 グループ
[DEBUG] ステップ4後: 16 CDFs（15 グループがマージされた）
[DEBUG] 最終的な危険フロー:
  - platform_create_region at line 86, params=[1, 2, 3]: TA_InvokeCommandEntryPoint -> create_region -> platform_create_region
  - platform_destroy_region at line 108, params=[0]: TA_InvokeCommandEntryPoint -> destroy_region -> platform_destroy_region
  - platform_add_device_to_region at line 155, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> update_region -> platform_add_device_to_region
  - platform_dump_status at line 173, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status
  - platform_dump_device at line 174, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_device
  - memset at line 112, params=[0, 2]: TA_InvokeCommandEntryPoint -> destroy_region -> platform_destroy_region -> memset
  - strcmp at line 130, params=[0, 1]: TA_InvokeCommandEntryPoint -> update_region -> platform_find_device_by_name -> strcmp
  - snprintf at line 210, params=[0, 1, 2, 3]: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
  - snprintf at line 215, params=[0, 1, 2, 3]: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
  - snprintf at line 220, params=[0, 1, 2, 3]: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
  - snprintf at line 224, params=[0, 1, 2, 3]: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
  - snprintf at line 228, params=[0, 1, 2, 3]: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
  - snprintf at line 235, params=[0, 1, 2, 3]: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
  - snprintf at line 241, params=[0, 1, 2, 3]: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
  - snprintf at line 256, params=[0, 1, 2, 3]: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_device -> snprintf
  - snprintf at line 261, params=[0, 1, 2, 3]: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_device -> snprintf

[generate_candidate_flows] 16 件 → /workspace/benchmark/optee-sdp/ta/results/ta_candidate_flows.json
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[DEBUG] Using prompts directory: /workspace/prompts/vulnerabilities_prompt
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
[DEBUG] RAG system already initialized
[INFO] RAG mode disabled
[INFO] RAG disabled
使用中のLLMプロバイダー: openrouter
[taint_analyzer] 16 個の候補フローを解析中...
  [1/16] チェーン: TA_InvokeCommandEntryPoint -> create_region -> platform_create_region
[DEBUG] Loaded prompt: taint_start.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle.txt
[DEBUG] Loaded prompt: taint_middle_multi_params.txt
[DEBUG] Loaded prompt: taint_end.txt
  [2/16] チェーン: TA_InvokeCommandEntryPoint -> destroy_region -> platform_destroy_region
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=platform_destroy_region, param_index=0
  [3/16] チェーン: TA_InvokeCommandEntryPoint -> update_region -> platform_add_device_to_region
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [4/16] チェーン: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [5/16] チェーン: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_device
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [6/16] チェーン: TA_InvokeCommandEntryPoint -> destroy_region -> platform_destroy_region -> memset
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [7/16] チェーン: TA_InvokeCommandEntryPoint -> update_region -> platform_find_device_by_name -> strcmp
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [8/16] チェーン: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [9/16] チェーン: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [10/16] チェーン: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [11/16] チェーン: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [12/16] チェーン: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [13/16] チェーン: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [14/16] チェーン: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [15/16] チェーン: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_device -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [16/16] チェーン: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_device -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[taint_analyzer] 解析完了: 2 件の脆弱性を検出
  結果: /workspace/benchmark/optee-sdp/ta/results/ta_vulnerabilities.json
  ログ: /workspace/benchmark/optee-sdp/ta/results/taint_analysis_log.txt
Traceback (most recent call last):
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 169, in <module>
    main()
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 138, in main
    generate_summary_report(out_dir, statistics, vulnerabilities)
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 161, in generate_summary_report
    from .report_generator import ReportGenerator
ImportError: attempted relative import with no known parent package
[generate_report] HTMLレポートを生成しました: /workspace/benchmark/optee-sdp/ta/results/ta_vulnerability_report.html
  検出脆弱性数: 2
  AI対話履歴を含めました: /workspace/benchmark/optee-sdp/ta/results/taint_analysis_log.txt
  対話チェーン数: 9
make -C host CROSS_COMPILE="arm-linux-gnueabihf-" --no-builtin-variables \
	TEEC_EXPORT=/workspace/benchmark/Lenet5_in_OPTEE/../../optee_client/out/export
make[1]: Entering directory '/workspace/benchmark/Lenet5_in_OPTEE/host'
arm-linux-gnueabihf-gcc -o optee_lenet5 main.o -lteec -L/workspace/benchmark/Lenet5_in_OPTEE/../../optee_client/out/export/lib
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: main.o: relocation R_ARM_THM_MOVW_ABS_NC against `a local symbol' can not be used when making a shared object; recompile with -fPIC
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: main.o(.text+0x18): unresolvable R_ARM_THM_CALL relocation against symbol `fopen@@GLIBC_2.4'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: final link failed
collect2: error: ld returned 1 exit status
make[1]: *** [makefile:21: optee_lenet5] Error 1
make[1]: Leaving directory '/workspace/benchmark/Lenet5_in_OPTEE/host'
make: *** [Makefile:12: all] Error 2
make: Entering directory '/workspace/benchmark/Lenet5_in_OPTEE/ta'
make: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'lenet5_ta.o'.  Stop.
make: Leaving directory '/workspace/benchmark/Lenet5_in_OPTEE/ta'
CMake Warning (dev) in CMakeLists.txt:
  No cmake_minimum_required command is present.  A line of code such as

    cmake_minimum_required(VERSION 3.22)

  should be added at the top of the file.  The version specified may be lower
  if you wish to support older CMake versions for this project.  For more
  information run "cmake --help-policy CMP0000".
This warning is for project developers.  Use -Wno-dev to suppress it.

-- Configuring done
-- Generating done
-- Build files have been written to: /workspace/benchmark/Lenet5_in_OPTEE/build
[INFO] $ /usr/bin/python3 /workspace/src/analyze_vulnerabilities/taint_analyzer.py --flows /workspace/benchmark/optee-fiovb/ta/results/ta_candidate_flows.json --phase12 /workspace/benchmark/optee-fiovb/ta/results/ta_phase12.json --output /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerabilities.json --generate-summary --no-rag  (cwd=/workspace/benchmark/optee-fiovb/ta)
[WARN]   ↳ rc=1
[INFO] $ /usr/bin/python3 /workspace/src/report/generate_report.py --vulnerabilities /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/optee-fiovb/ta/results/ta_phase12.json --project-name optee-fiovb --output /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerability_report.html  (cwd=/workspace/benchmark/optee-fiovb/ta)
[phase7 ] → /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerability_report.html


=== Project: optee-sdp / TA: ta ===
[INFO] RAG mode is disabled for this analysis
[INFO] $ bear -- make  (cwd=/workspace/benchmark/optee-sdp)
[WARN]   ↳ rc=2
[INFO] $ bear -- make -C ta V=1  (cwd=/workspace/benchmark/optee-sdp)
[WARN]   ↳ rc=2
[INFO] $ bear -- make  (cwd=/workspace/benchmark/optee-sdp/ta)
[WARN]   ↳ rc=2
[WARN] build failed/empty → dummy DB
[INFO] ★ dummy DB 2 entries → /workspace/benchmark/optee-sdp/ta/compile_commands_full.json
[INFO] TA DB saved: /workspace/benchmark/optee-sdp/ta/compile_commands.json  entries=2
[DEBUG] Include paths:
  ✓ /workspace/benchmark/optee-sdp/ta
  ✗ /workspace/benchmark/optee-sdp/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/optee-sdp/ta/sdp_ta.c
  Args: -I/workspace/benchmark/optee-sdp/ta -I/workspace/benchmark/optee-sdp/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/optee-sdp/ta/platform/stub.c
  Args: -I/workspace/benchmark/optee-sdp/ta -I/workspace/benchmark/optee-sdp/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[phase1-2] → /workspace/benchmark/optee-sdp/ta/results/ta_phase12.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/identify_sinks.py -i /workspace/benchmark/optee-sdp/ta/results/ta_phase12.json -o /workspace/benchmark/optee-sdp/ta/results/ta_sinks.json --no-rag  (cwd=/workspace/benchmark/optee-sdp/ta)
[phase3 ] → /workspace/benchmark/optee-sdp/ta/results/ta_sinks.json

[phase3.1] → python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/optee-sdp/ta/compile_commands.json --sinks /workspace/benchmark/optee-sdp/ta/results/ta_sinks.json --output /workspace/benchmark/optee-sdp/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/optee-sdp/ta/compile_commands.json --sinks /workspace/benchmark/optee-sdp/ta/results/ta_sinks.json --output /workspace/benchmark/optee-sdp/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/optee-sdp/ta)
[phase3.4] → /workspace/benchmark/optee-sdp/ta/results/ta_vulnerable_destinations.json

[phase3.2] → python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/optee-sdp/ta/compile_commands.json --output /workspace/benchmark/optee-sdp/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/optee-sdp/ta/compile_commands.json --output /workspace/benchmark/optee-sdp/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/optee-sdp/ta)
[phase3.5] → /workspace/benchmark/optee-sdp/ta/results/ta_call_graph.json

[phase3.3] → python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/optee-sdp/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/optee-sdp/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/optee-sdp/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/optee-sdp/ta/results/ta_chains.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/optee-sdp/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/optee-sdp/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/optee-sdp/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/optee-sdp/ta/results/ta_chains.json  (cwd=/workspace/benchmark/optee-sdp/ta)
[phase3.6] → /workspace/benchmark/optee-sdp/ta/results/ta_chains.json

[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/extract_sink_calls.py --compile-db /workspace/benchmark/optee-sdp/ta/compile_commands.json --sinks /workspace/benchmark/optee-sdp/ta/results/ta_sinks.json --output /workspace/benchmark/optee-sdp/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/optee-sdp/ta)
[phase3.7] → /workspace/benchmark/optee-sdp/ta/results/ta_vulnerable_destinations.json

[phase5_command] → python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/optee-sdp/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/optee-sdp/ta/results/ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/optee-sdp/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/optee-sdp/ta/results/ta_candidate_flows.json  (cwd=/workspace/benchmark/optee-sdp/ta)
[phase5 ] → /workspace/benchmark/optee-sdp/ta/results/ta_candidate_flows.json

[INFO] $ /usr/bin/python3 /workspace/src/analyze_vulnerabilities/taint_analyzer.py --flows /workspace/benchmark/optee-sdp/ta/results/ta_candidate_flows.json --phase12 /workspace/benchmark/optee-sdp/ta/results/ta_phase12.json --output /workspace/benchmark/optee-sdp/ta/results/ta_vulnerabilities.json --generate-summary --no-rag  (cwd=/workspace/benchmark/optee-sdp/ta)
[WARN]   ↳ rc=1
[INFO] $ /usr/bin/python3 /workspace/src/report/generate_report.py --vulnerabilities /workspace/benchmark/optee-sdp/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/optee-sdp/ta/results/ta_phase12.json --project-name optee-sdp --output /workspace/benchmark/optee-sdp/ta/results/ta_vulnerability_report.html  (cwd=/workspace/benchmark/optee-sdp/ta)
[phase7 ] → /workspace/benchmark/optee-sdp/ta/results/ta_vulnerability_report.html


=== Project: Lenet5_in_OPTEE / TA: ta ===
[INFO] RAG mode is disabled for this analysis
[INFO] $ bear -- make  (cwd=/workspace/benchmark/Lenet5_in_OPTEE)
[WARN]   ↳ rc=2
[INFO] $ bear -- make -C ta V=1  (cwd=/workspace/benchmark/Lenet5_in_OPTEE)
[WARN]   ↳ rc=2
[INFO] $ cmake -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -Bbuild -H.  (cwd=/workspace/benchmark/Lenet5_in_OPTEE)
[WARN] bear が拾えなかった .c がある → dummy 補完
[INFO] ★ dummy DB 4 entries → /workspace/benchmark/Lenet5_in_OPTEE/build/compile_commands.json
[INFO] TA DB saved: /workspace/benchmark/Lenet5_in_OPTEE/ta/compile_commands.json  entries=4
[DEBUG] Include paths:
  ✓ /workspace/benchmark/Lenet5_in_OPTEE/ta
  ✓ /workspace/benchmark/Lenet5_in_OPTEE/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/lenet5_ta.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/e_exp.c
[INFO] Loaded sink definitions from /workspace/rules/generated_sink_definitions.json
[INFO] PatternMatcher initialized with 3 sink functions
[INFO] Sample sinks: TEE_MemMove(params: [0, 1, 2]), snprintf(params: [0, 1, 2, 3]), TEEC_InvokeCommand(params: [1, 2])
使用中のLLMプロバイダー: openrouter
呼び出し済み外部 API を抽出中...
外部 API 関数: 9 個
外部 API 関数をシンクとして解析中...

[DEBUG] PatternMatcher initialized
[DEBUG] Loaded rules count: 3
[DEBUG] Known functions in index: 3

[DEBUG] Analyzing: Initial
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: Predict
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_GenerateRandom
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TEE_Malloc
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: TrainBatch
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: __HI
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: __LO
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: __ieee754_exp
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()

[DEBUG] Analyzing: __ieee754_sqrt
  - Is known: False
  - Is sink: False
  - Dangerous params: set()
  - Rule IDs: set()
抽出されたシンク候補: 17 個
結果を /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_sinks.json に保存しました
[DEBUG] Include paths:
  ✓ /workspace/benchmark/Lenet5_in_OPTEE/ta
  ✓ /workspace/benchmark/Lenet5_in_OPTEE/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/lenet5_ta.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/e_exp.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/lenet.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/e_sqrt.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[find_sink_calls] 10 call sites → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerable_destinations.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/Lenet5_in_OPTEE/ta
  ✓ /workspace/benchmark/Lenet5_in_OPTEE/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/lenet5_ta.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/e_exp.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/lenet.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/e_sqrt.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[generate_call_graph_advanced] 42 edges, 23 functions → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_call_graph.json
[DEBUG] No parameter dependency detected, but tracing callers anyway
[DEBUG] No parameter dependency detected, but tracing callers anyway
[DEBUG] Include paths:
  ✓ /workspace/benchmark/Lenet5_in_OPTEE/ta
  ✓ /workspace/benchmark/Lenet5_in_OPTEE/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/lenet5_ta.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/e_exp.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/lenet.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/e_sqrt.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[extract_sink_calls] 10 entries → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerable_destinations.json
[DEBUG] 入力チェーン数: 10
[DEBUG] ソース関数マッピング: {'TA_InvokeCommandEntryPoint': [], 'TA_OpenSessionEntryPoint': []}
[DEBUG] ソース関数: ['TA_InvokeCommandEntryPoint', 'TA_OpenSessionEntryPoint']
[DEBUG] ステップ1後: 10 CDFs
[DEBUG] ステップ2後: 10 CDFs（同じVD+ソースの最長チェーンのみ）
[DEBUG] ステップ3後: 10 CDFs（0 個のサブチェーンを削除）
[DEBUG] ステップ4: 4 グループ
[DEBUG] ステップ4後: 4 CDFs（3 グループがマージされた）
[DEBUG] 最終的な危険フロー:
  - TEE_Malloc at line 93, params=[0]: TA_InvokeCommandEntryPoint -> ta_init -> TEE_Malloc
  - TrainBatch at line 137, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> ta_trainBatch -> TrainBatch
  - Predict at line 156, params=[0, 1, 2, 3]: TA_InvokeCommandEntryPoint -> ta_predict -> Predict
  - TEE_GenerateRandom at line 252, params=[0, 2]: TA_InvokeCommandEntryPoint -> ta_init -> Initial -> f64rand -> rand -> TEE_GenerateRandom

[generate_candidate_flows] 4 件 → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_candidate_flows.json
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[DEBUG] Using prompts directory: /workspace/prompts/vulnerabilities_prompt
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
[DEBUG] RAG system already initialized
[INFO] RAG mode disabled
[INFO] RAG disabled
使用中のLLMプロバイダー: openrouter
[taint_analyzer] 4 個の候補フローを解析中...
  [1/4] チェーン: TA_InvokeCommandEntryPoint -> ta_init -> TEE_Malloc
[DEBUG] Loaded prompt: taint_start.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle.txt
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Loaded prompt: taint_end.txt
  [2/4] チェーン: TA_InvokeCommandEntryPoint -> ta_trainBatch -> TrainBatch
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle_multi_params.txt
  [3/4] チェーン: TA_InvokeCommandEntryPoint -> ta_predict -> Predict
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
  [4/4] チェーン: TA_InvokeCommandEntryPoint -> ta_init -> Initial -> f64rand -> rand -> TEE_GenerateRandom
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[taint_analyzer] 解析完了: 0 件の脆弱性を検出
  結果: /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerabilities.json
  ログ: /workspace/benchmark/Lenet5_in_OPTEE/ta/results/taint_analysis_log.txt
Traceback (most recent call last):
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 169, in <module>
    main()
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 138, in main
    generate_summary_report(out_dir, statistics, vulnerabilities)
  File "/workspace/src/analyze_vulnerabilities/taint_analyzer.py", line 161, in generate_summary_report
    from .report_generator import ReportGenerator
ImportError: attempted relative import with no known parent package
[generate_report] HTMLレポートを生成しました: /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerability_report.html
  検出脆弱性数: 0
  AI対話履歴を含めました: /workspace/benchmark/Lenet5_in_OPTEE/ta/results/taint_analysis_log.txt
  対話チェーン数: 4
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/lenet.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/e_sqrt.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[phase1-2] → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_phase12.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/identify_sinks.py -i /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_phase12.json -o /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_sinks.json --no-rag  (cwd=/workspace/benchmark/Lenet5_in_OPTEE/ta)
[phase3 ] → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_sinks.json

[phase3.1] → python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/Lenet5_in_OPTEE/ta/compile_commands.json --sinks /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_sinks.json --output /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/Lenet5_in_OPTEE/ta/compile_commands.json --sinks /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_sinks.json --output /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/Lenet5_in_OPTEE/ta)
[phase3.4] → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerable_destinations.json

[phase3.2] → python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/Lenet5_in_OPTEE/ta/compile_commands.json --output /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/Lenet5_in_OPTEE/ta/compile_commands.json --output /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/Lenet5_in_OPTEE/ta)
[phase3.5] → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_call_graph.json

[phase3.3] → python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/Lenet5_in_OPTEE/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_chains.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/Lenet5_in_OPTEE/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_chains.json  (cwd=/workspace/benchmark/Lenet5_in_OPTEE/ta)
[phase3.6] → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_chains.json

[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/extract_sink_calls.py --compile-db /workspace/benchmark/Lenet5_in_OPTEE/ta/compile_commands.json --sinks /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_sinks.json --output /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/Lenet5_in_OPTEE/ta)
[phase3.7] → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerable_destinations.json

[phase5_command] → python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_candidate_flows.json  (cwd=/workspace/benchmark/Lenet5_in_OPTEE/ta)
[phase5 ] → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_candidate_flows.json

[INFO] $ /usr/bin/python3 /workspace/src/analyze_vulnerabilities/taint_analyzer.py --flows /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_candidate_flows.json --phase12 /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_phase12.json --output /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerabilities.json --generate-summary --no-rag  (cwd=/workspace/benchmark/Lenet5_in_OPTEE/ta)
[WARN]   ↳ rc=1
[INFO] $ /usr/bin/python3 /workspace/src/report/generate_report.py --vulnerabilities /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_phase12.json --project-name Lenet5_in_OPTEE --output /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerability_report.html  (cwd=/workspace/benchmark/Lenet5_in_OPTEE/ta)
[phase7 ] → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerability_report.html

