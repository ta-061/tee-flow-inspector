make -C host CROSS_COMPILE="arm-linux-gnueabihf-" --no-builtin-variables \
	TEEC_EXPORT=/workspace/benchmark/acipher/../../optee_client/out/export
make[1]: Entering directory '/workspace/benchmark/acipher/host'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/workspace/benchmark/acipher/host'
make -C ta CROSS_COMPILE="arm-linux-gnueabihf-" LDFLAGS="" \
	TA_DEV_KIT_DIR=/workspace/benchmark/acipher/../../optee_os/out/arm/export-ta_arm32
make[1]: Entering directory '/workspace/benchmark/acipher/ta'
make[1]: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'acipher_ta.o'.  Stop.
make[1]: Leaving directory '/workspace/benchmark/acipher/ta'
make: *** [Makefile:14: all] Error 2
make: Entering directory '/workspace/benchmark/acipher/ta'
make: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'acipher_ta.o'.  Stop.
make: Leaving directory '/workspace/benchmark/acipher/ta'
-- The C compiler identification is GNU 11.4.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/arm-linux-gnueabihf-gcc - skipped
-- Detecting C compile features
-- Detecting C compile features - done
CMake Warning (dev) in CMakeLists.txt:
  No cmake_minimum_required command is present.  A line of code such as

    cmake_minimum_required(VERSION 3.22)

  should be added at the top of the file.  The version specified may be lower
  if you wish to support older CMake versions for this project.  For more
  information run "cmake --help-policy CMP0000".
This warning is for project developers.  Use -Wno-dev to suppress it.

-- Configuring done
-- Generating done
-- Build files have been written to: /workspace/benchmark/acipher/build
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[INFO] RAG mode enabled. Initializing RAG system...
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
使用中のLLMプロバイダー: openai
呼び出し済み外部 API を抽出中...
外部 API 関数: 8 個
外部 API 関数をシンクとして解析中...
[DEBUG] Searching for API: TEE_AllocateOperation
[DEBUG] Searching for API: TEE_AllocateTransientObject
[DEBUG] Searching for API: TEE_AsymmetricEncrypt
[DEBUG] Searching for API: TEE_FreeOperation
[DEBUG] Searching for API: TEE_FreeTransientObject
[DEBUG] Searching for API: TEE_GenerateKey
[DEBUG] Searching for API: TEE_GetObjectInfo1
[DEBUG] Searching for API: TEE_SetOperationKey
抽出されたシンク候補: 12 個
結果を /workspace/benchmark/acipher/ta/results/ta_sinks.json に保存しました
[DEBUG] Include paths:
  ✓ /workspace/benchmark/acipher/ta
  ✓ /workspace/benchmark/acipher/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/acipher/ta/acipher_ta.c
  Args: -I/workspace/benchmark/acipher/ta -I/workspace/benchmark/acipher/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[find_sink_calls] 8 call sites → /workspace/benchmark/acipher/ta/results/ta_vulnerable_destinations.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/acipher/ta
  ✓ /workspace/benchmark/acipher/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/acipher/ta/acipher_ta.c
  Args: -I/workspace/benchmark/acipher/ta -I/workspace/benchmark/acipher/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[generate_call_graph_advanced] 21 edges, 7 functions → /workspace/benchmark/acipher/ta/results/ta_call_graph.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/acipher/ta
  ✓ /workspace/benchmark/acipher/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/acipher/ta/acipher_ta.c
  Args: -I/workspace/benchmark/acipher/ta -I/workspace/benchmark/acipher/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[extract_sink_calls] 8 entries → /workspace/benchmark/acipher/ta/results/ta_vulnerable_destinations.json
[DEBUG] 入力チェーン数: 8
[DEBUG] ソース関数マッピング: {'TA_InvokeCommandEntryPoint': [], 'TA_OpenSessionEntryPoint': []}
[DEBUG] ソース関数: ['TA_InvokeCommandEntryPoint', 'TA_OpenSessionEntryPoint']
[DEBUG] ステップ1後: 8 CDFs
[DEBUG] ステップ2後: 8 CDFs（同じVD+ソースの最長チェーンのみ）
[DEBUG] ステップ3後: 8 CDFs（0 個のサブチェーンを削除）
[DEBUG] ステップ4: 5 グループ
[DEBUG] ステップ4後: 5 CDFs（2 グループがマージされた）
[DEBUG] 最終的な危険フロー:
  - TEE_AllocateTransientObject at line 33, params=[1]: TA_InvokeCommandEntryPoint -> cmd_gen_key -> TEE_AllocateTransientObject
  - TEE_GenerateKey at line 39, params=[1]: TA_InvokeCommandEntryPoint -> cmd_gen_key -> TEE_GenerateKey
  - TEE_GetObjectInfo1 at line 73, params=[0]: TA_InvokeCommandEntryPoint -> cmd_enc -> TEE_GetObjectInfo1
  - TEE_SetOperationKey at line 91, params=[0, 1]: TA_InvokeCommandEntryPoint -> cmd_enc -> TEE_SetOperationKey
  - TEE_AsymmetricEncrypt at line 97, params=[3, 4, 5]: TA_InvokeCommandEntryPoint -> cmd_enc -> TEE_AsymmetricEncrypt

[generate_candidate_flows] 5 件 → /workspace/benchmark/acipher/ta/results/ta_candidate_flows.json
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[DEBUG] Using prompts directory: /workspace/prompts/vulnerabilities_prompt
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
[DEBUG] RAG system already initialized
使用中のLLMプロバイダー: openai
[taint_analyzer] 5 個の候補フローを解析中...
  [1/5] チェーン: TA_InvokeCommandEntryPoint -> cmd_gen_key -> TEE_AllocateTransientObject
[DEBUG] Loaded prompt: taint_start.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle.txt
[DEBUG] get_middle_prompt called: sink_function=TEE_AllocateTransientObject, param_index=1
[DEBUG] Attempting to get RAG context for TEE_AllocateTransientObject
[DEBUG] Retrieved RAG context for TEE_AllocateTransientObject (param 1): 1089 chars
[DEBUG] Loaded prompt: taint_middle_with_rag.txt
[DEBUG] Using RAG template for TEE_AllocateTransientObject
[DEBUG] Loaded prompt: taint_end.txt
  [2/5] チェーン: TA_InvokeCommandEntryPoint -> cmd_gen_key -> TEE_GenerateKey
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_GenerateKey, param_index=1
[DEBUG] Attempting to get RAG context for TEE_GenerateKey
[DEBUG] Retrieved RAG context for TEE_GenerateKey (param 1): 5834 chars
[DEBUG] Using RAG template for TEE_GenerateKey
  [3/5] チェーン: TA_InvokeCommandEntryPoint -> cmd_enc -> TEE_GetObjectInfo1
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_GetObjectInfo1, param_index=0
[DEBUG] Attempting to get RAG context for TEE_GetObjectInfo1
[DEBUG] Retrieved RAG context for TEE_GetObjectInfo1 (param 0): 2085 chars
[DEBUG] Using RAG template for TEE_GetObjectInfo1
  [4/5] チェーン: TA_InvokeCommandEntryPoint -> cmd_enc -> TEE_SetOperationKey
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_SetOperationKey (param 0): 5515 chars
[DEBUG] Loaded prompt: taint_middle_multi_params_with_rag.txt
[DEBUG] Using multi-param RAG template for TEE_SetOperationKey
  [5/5] チェーン: TA_InvokeCommandEntryPoint -> cmd_enc -> TEE_AsymmetricEncrypt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_AsymmetricEncrypt (param 3): 3957 chars
[DEBUG] Using multi-param RAG template for TEE_AsymmetricEncrypt
[taint_analyzer] 解析完了: 4 件の脆弱性を検出
  結果: /workspace/benchmark/acipher/ta/results/ta_vulnerabilities.json
  ログ: /workspace/benchmark/acipher/ta/results/taint_analysis_log.txt
[generate_report] HTMLレポートを生成しました: /workspace/benchmark/acipher/ta/results/ta_vulnerability_report.html
  検出脆弱性数: 4
  AI対話履歴を含めました: /workspace/benchmark/acipher/ta/results/taint_analysis_log.txt
  対話チェーン数: 5
make -C host CROSS_COMPILE="arm-linux-gnueabihf-" --no-builtin-variables \
	TEEC_EXPORT=/workspace/benchmark/aes/../../optee_client/out/export
make[1]: Entering directory '/workspace/benchmark/aes/host'
arm-linux-gnueabihf-gcc  -o optee_example_aes main.o -lteec -L/workspace/benchmark/aes/../../optee_client/out/export/lib
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: main.o: relocation R_ARM_THM_MOVW_ABS_NC against `a local symbol' can not be used when making a shared object; recompile with -fPIC
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: main.o(.text+0x20): unresolvable R_ARM_THM_CALL relocation against symbol `TEEC_InitializeContext'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: final link failed
collect2: error: ld returned 1 exit status
make[1]: *** [Makefile:21: optee_example_aes] Error 1
make[1]: Leaving directory '/workspace/benchmark/aes/host'
make: *** [Makefile:12: all] Error 2
make: Entering directory '/workspace/benchmark/aes/ta'
make: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'aes_ta.o'.  Stop.
make: Leaving directory '/workspace/benchmark/aes/ta'
-- The C compiler identification is GNU 11.4.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/arm-linux-gnueabihf-gcc - skipped
-- Detecting C compile features
-- Detecting C compile features - done
CMake Warning (dev) in CMakeLists.txt:
  No cmake_minimum_required command is present.  A line of code such as

    cmake_minimum_required(VERSION 3.22)

  should be added at the top of the file.  The version specified may be lower
  if you wish to support older CMake versions for this project.  For more
  information run "cmake --help-policy CMP0000".
This warning is for project developers.  Use -Wno-dev to suppress it.

-- Configuring done
-- Generating done
-- Build files have been written to: /workspace/benchmark/aes/build
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[INFO] RAG mode enabled. Initializing RAG system...
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
使用中のLLMプロバイダー: openai
呼び出し済み外部 API を抽出中...
外部 API 関数: 13 個
外部 API 関数をシンクとして解析中...
[DEBUG] Searching for API: TEE_AllocateOperation
[DEBUG] Searching for API: TEE_AllocateTransientObject
[DEBUG] Searching for API: TEE_CipherInit
[DEBUG] Searching for API: TEE_CipherUpdate
[DEBUG] Searching for API: TEE_Free
[DEBUG] Searching for API: TEE_FreeOperation
[DEBUG] Searching for API: TEE_FreeTransientObject
[DEBUG] Searching for API: TEE_InitRefAttribute
[DEBUG] Searching for API: TEE_Malloc
[DEBUG] Searching for API: TEE_PopulateTransientObject
[DEBUG] Searching for API: TEE_ResetOperation
[DEBUG] Searching for API: TEE_ResetTransientObject
[DEBUG] Searching for API: TEE_SetOperationKey
抽出されたシンク候補: 19 個
結果を /workspace/benchmark/aes/ta/results/ta_sinks.json に保存しました
[DEBUG] Include paths:
  ✓ /workspace/benchmark/aes/ta
  ✓ /workspace/benchmark/aes/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/aes/ta/aes_ta.c
  Args: -I/workspace/benchmark/aes/ta -I/workspace/benchmark/aes/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[find_sink_calls] 25 call sites → /workspace/benchmark/aes/ta/results/ta_vulnerable_destinations.json

=== Project: acipher / TA: ta ===
[INFO] $ bear -- make  (cwd=/workspace/benchmark/acipher)
[WARN]   ↳ rc=2
[INFO] $ bear -- make -C ta V=1  (cwd=/workspace/benchmark/acipher)
[WARN]   ↳ rc=2
[INFO] $ cmake -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -Bbuild -H.  (cwd=/workspace/benchmark/acipher)
[WARN] bear が拾えなかった .c がある → dummy 補完
[INFO] ★ dummy DB 1 entries → /workspace/benchmark/acipher/build/compile_commands.json
[INFO] TA DB saved: /workspace/benchmark/acipher/ta/compile_commands.json  entries=1
[DEBUG] Include paths:
  ✓ /workspace/benchmark/acipher/ta
  ✓ /workspace/benchmark/acipher/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/acipher/ta/acipher_ta.c
  Args: -I/workspace/benchmark/acipher/ta -I/workspace/benchmark/acipher/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[phase1-2] → /workspace/benchmark/acipher/ta/results/ta_phase12.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/identify_sinks.py -i /workspace/benchmark/acipher/ta/results/ta_phase12.json -o /workspace/benchmark/acipher/ta/results/ta_sinks.json  (cwd=/workspace/benchmark/acipher/ta)
[phase3 ] → /workspace/benchmark/acipher/ta/results/ta_sinks.json

[phase3.1] → python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/acipher/ta/compile_commands.json --sinks /workspace/benchmark/acipher/ta/results/ta_sinks.json --output /workspace/benchmark/acipher/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/acipher/ta/compile_commands.json --sinks /workspace/benchmark/acipher/ta/results/ta_sinks.json --output /workspace/benchmark/acipher/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/acipher/ta)
[phase3.4] → /workspace/benchmark/acipher/ta/results/ta_vulnerable_destinations.json

[phase3.2] → python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/acipher/ta/compile_commands.json --output /workspace/benchmark/acipher/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/acipher/ta/compile_commands.json --output /workspace/benchmark/acipher/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/acipher/ta)
[phase3.5] → /workspace/benchmark/acipher/ta/results/ta_call_graph.json

[phase3.3] → python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/acipher/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/acipher/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/acipher/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/acipher/ta/results/ta_chains.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/acipher/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/acipher/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/acipher/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/acipher/ta/results/ta_chains.json  (cwd=/workspace/benchmark/acipher/ta)
[phase3.6] → /workspace/benchmark/acipher/ta/results/ta_chains.json

[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/extract_sink_calls.py --compile-db /workspace/benchmark/acipher/ta/compile_commands.json --sinks /workspace/benchmark/acipher/ta/results/ta_sinks.json --output /workspace/benchmark/acipher/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/acipher/ta)
[phase3.7] → /workspace/benchmark/acipher/ta/results/ta_vulnerable_destinations.json

[phase5_command] → python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/acipher/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/acipher/ta/results/ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/acipher/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/acipher/ta/results/ta_candidate_flows.json  (cwd=/workspace/benchmark/acipher/ta)
[phase5 ] → /workspace/benchmark/acipher/ta/results/ta_candidate_flows.json

[INFO] $ /usr/bin/python3 /workspace/src/analyze_vulnerabilities/taint_analyzer.py --flows /workspace/benchmark/acipher/ta/results/ta_candidate_flows.json --phase12 /workspace/benchmark/acipher/ta/results/ta_phase12.json --output /workspace/benchmark/acipher/ta/results/ta_vulnerabilities.json  (cwd=/workspace/benchmark/acipher/ta)
[phase6 ] → /workspace/benchmark/acipher/ta/results/ta_vulnerabilities.json

[INFO] $ /usr/bin/python3 /workspace/src/report/generate_report.py --vulnerabilities /workspace/benchmark/acipher/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/acipher/ta/results/ta_phase12.json --project-name acipher --output /workspace/benchmark/acipher/ta/results/ta_vulnerability_report.html  (cwd=/workspace/benchmark/acipher/ta)
[phase7 ] → /workspace/benchmark/acipher/ta/results/ta_vulnerability_report.html


=== Project: aes / TA: ta ===
[INFO] $ bear -- make  (cwd=/workspace/benchmark/aes)
[WARN]   ↳ rc=2
[INFO] $ bear -- make -C ta V=1  (cwd=/workspace/benchmark/aes)
[WARN]   ↳ rc=2
[INFO] $ cmake -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -Bbuild -H.  (cwd=/workspace/benchmark/aes)
[WARN] bear が拾えなかった .c がある → dummy 補完
[INFO] ★ dummy DB 1 entries → /workspace/benchmark/aes/build/compile_commands.json
[INFO] TA DB saved: /workspace/benchmark/aes/ta/compile_commands.json  entries=1
[DEBUG] Include paths:
  ✓ /workspace/benchmark/aes/ta
  ✓ /workspace/benchmark/aes/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/aes/ta/aes_ta.c
  Args: -I/workspace/benchmark/aes/ta -I/workspace/benchmark/aes/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[phase1-2] → /workspace/benchmark/aes/ta/results/ta_phase12.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/identify_sinks.py -i /workspace/benchmark/aes/ta/results/ta_phase12.json -o /workspace/benchmark/aes/ta/results/ta_sinks.json  (cwd=/workspace/benchmark/aes/ta)
[phase3 ] → /workspace/benchmark/aes/ta/results/ta_sinks.json

[phase3.1] → python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/aes/ta/compile_commands.json --sinks /workspace/benchmark/aes/ta/results/ta_sinks.json --output /workspace/benchmark/aes/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/aes/ta/compile_commands.json --sinks /workspace/benchmark/aes/ta/results/ta_sinks.json --output /workspace/benchmark/aes/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/aes/ta)
[phase3.4] → /workspace/benchmark/aes/ta/results/ta_vulnerable_destinations.json

[phase3.2] → python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/aes/ta/compile_commands.json --output /workspace/benchmark/aes/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[DEBUG] Include paths:
  ✓ /workspace/benchmark/aes/ta
  ✓ /workspace/benchmark/aes/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/aes/ta/aes_ta.c
  Args: -I/workspace/benchmark/aes/ta -I/workspace/benchmark/aes/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[generate_call_graph_advanced] 47 edges, 12 functions → /workspace/benchmark/aes/ta/results/ta_call_graph.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/aes/ta
  ✓ /workspace/benchmark/aes/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/aes/ta/aes_ta.c
  Args: -I/workspace/benchmark/aes/ta -I/workspace/benchmark/aes/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[extract_sink_calls] 25 entries → /workspace/benchmark/aes/ta/results/ta_vulnerable_destinations.json
[DEBUG] 入力チェーン数: 25
[DEBUG] ソース関数マッピング: {'TA_InvokeCommandEntryPoint': [], 'TA_OpenSessionEntryPoint': []}
[DEBUG] ソース関数: ['TA_InvokeCommandEntryPoint', 'TA_OpenSessionEntryPoint']
[DEBUG] ステップ1後: 24 CDFs
[DEBUG] ステップ2後: 24 CDFs（同じVD+ソースの最長チェーンのみ）
[DEBUG] ステップ3後: 24 CDFs（0 個のサブチェーンを削除）
[DEBUG] ステップ4: 15 グループ
[DEBUG] ステップ4後: 15 CDFs（8 グループがマージされた）
[DEBUG] 最終的な危険フロー:
  - TEE_AllocateOperation at line 155, params=[0, 1]: TA_InvokeCommandEntryPoint -> alloc_resources -> TEE_AllocateOperation
  - TEE_AllocateTransientObject at line 170, params=[0, 1]: TA_InvokeCommandEntryPoint -> alloc_resources -> TEE_AllocateTransientObject
  - TEE_Malloc at line 188, params=[0]: TA_InvokeCommandEntryPoint -> alloc_resources -> TEE_Malloc
  - TEE_InitRefAttribute at line 194, params=[2, 3]: TA_InvokeCommandEntryPoint -> alloc_resources -> TEE_InitRefAttribute
  - TEE_PopulateTransientObject at line 196, params=[1]: TA_InvokeCommandEntryPoint -> alloc_resources -> TEE_PopulateTransientObject
  - TEE_Free at line 197, params=[0]: TA_InvokeCommandEntryPoint -> alloc_resources -> TEE_Free
  - TEE_SetOperationKey at line 203, params=[0, 1]: TA_InvokeCommandEntryPoint -> alloc_resources -> TEE_SetOperationKey
  - TEE_InitRefAttribute at line 274, params=[2, 3]: TA_InvokeCommandEntryPoint -> set_aes_key -> TEE_InitRefAttribute
  - TEE_ResetTransientObject at line 276, params=[0]: TA_InvokeCommandEntryPoint -> set_aes_key -> TEE_ResetTransientObject
  - TEE_PopulateTransientObject at line 277, params=[1]: TA_InvokeCommandEntryPoint -> set_aes_key -> TEE_PopulateTransientObject
  - TEE_ResetOperation at line 283, params=[0]: TA_InvokeCommandEntryPoint -> set_aes_key -> TEE_ResetOperation
  - TEE_SetOperationKey at line 284, params=[0, 1]: TA_InvokeCommandEntryPoint -> set_aes_key -> TEE_SetOperationKey
  - TEE_CipherInit at line 322, params=[1, 2]: TA_InvokeCommandEntryPoint -> reset_aes_iv -> TEE_CipherInit
  - TEE_CipherUpdate at line 360, params=[1, 2, 3]: TA_InvokeCommandEntryPoint -> cipher_buffer -> TEE_CipherUpdate
  - TEE_Malloc at line 387, params=[0]: TA_OpenSessionEntryPoint -> TEE_Malloc

[generate_candidate_flows] 15 件 → /workspace/benchmark/aes/ta/results/ta_candidate_flows.json
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[DEBUG] Using prompts directory: /workspace/prompts/vulnerabilities_prompt
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
[DEBUG] RAG system already initialized
使用中のLLMプロバイダー: openai
[taint_analyzer] 15 個の候補フローを解析中...
  [1/15] チェーン: TA_InvokeCommandEntryPoint -> alloc_resources -> TEE_AllocateOperation
[DEBUG] Loaded prompt: taint_start.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle.txt
[DEBUG] Retrieved RAG context for TEE_AllocateOperation (param 0): 2903 chars
[DEBUG] Loaded prompt: taint_middle_multi_params_with_rag.txt
[DEBUG] Using multi-param RAG template for TEE_AllocateOperation
[DEBUG] Loaded prompt: taint_end.txt
  [2/15] チェーン: TA_InvokeCommandEntryPoint -> alloc_resources -> TEE_AllocateTransientObject
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_AllocateTransientObject (param 0): 1089 chars
[DEBUG] Using multi-param RAG template for TEE_AllocateTransientObject
  [3/15] チェーン: TA_InvokeCommandEntryPoint -> alloc_resources -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Malloc
[DEBUG] Retrieved RAG context for TEE_Malloc (param 0): 354 chars
[DEBUG] Loaded prompt: taint_middle_with_rag.txt
[DEBUG] Using RAG template for TEE_Malloc
  [4/15] チェーン: TA_InvokeCommandEntryPoint -> alloc_resources -> TEE_InitRefAttribute
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_InitRefAttribute (param 2): 1496 chars
[DEBUG] Using multi-param RAG template for TEE_InitRefAttribute
  [5/15] チェーン: TA_InvokeCommandEntryPoint -> alloc_resources -> TEE_PopulateTransientObject
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_PopulateTransientObject, param_index=1
[DEBUG] Attempting to get RAG context for TEE_PopulateTransientObject
[DEBUG] Retrieved RAG context for TEE_PopulateTransientObject (param 1): 4480 chars
[DEBUG] Using RAG template for TEE_PopulateTransientObject
  [6/15] チェーン: TA_InvokeCommandEntryPoint -> alloc_resources -> TEE_Free
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Free, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Free
[DEBUG] Retrieved RAG context for TEE_Free (param 0): 5059 chars
[DEBUG] Using RAG template for TEE_Free
  [7/15] チェーン: TA_InvokeCommandEntryPoint -> alloc_resources -> TEE_SetOperationKey
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_SetOperationKey (param 0): 5515 chars
[DEBUG] Using multi-param RAG template for TEE_SetOperationKey
  [8/15] チェーン: TA_InvokeCommandEntryPoint -> set_aes_key -> TEE_InitRefAttribute
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_InitRefAttribute (param 2): 1496 chars
[DEBUG] Using multi-param RAG template for TEE_InitRefAttribute
  [9/15] チェーン: TA_InvokeCommandEntryPoint -> set_aes_key -> TEE_ResetTransientObject
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_ResetTransientObject, param_index=0
[DEBUG] Attempting to get RAG context for TEE_ResetTransientObject
[DEBUG] Retrieved RAG context for TEE_ResetTransientObject (param 0): 4069 chars
[DEBUG] Using RAG template for TEE_ResetTransientObject
  [10/15] チェーン: TA_InvokeCommandEntryPoint -> set_aes_key -> TEE_PopulateTransientObject
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_PopulateTransientObject, param_index=1
[DEBUG] Attempting to get RAG context for TEE_PopulateTransientObject
[DEBUG] Retrieved RAG context for TEE_PopulateTransientObject (param 1): 4480 chars
[DEBUG] Using RAG template for TEE_PopulateTransientObject
  [11/15] チェーン: TA_InvokeCommandEntryPoint -> set_aes_key -> TEE_ResetOperation
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_ResetOperation, param_index=0
[DEBUG] Attempting to get RAG context for TEE_ResetOperation
[DEBUG] Retrieved RAG context for TEE_ResetOperation (param 0): 5024 chars
[DEBUG] Using RAG template for TEE_ResetOperation
  [12/15] チェーン: TA_InvokeCommandEntryPoint -> set_aes_key -> TEE_SetOperationKey
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_SetOperationKey (param 0): 5515 chars
[DEBUG] Using multi-param RAG template for TEE_SetOperationKey
  [13/15] チェーン: TA_InvokeCommandEntryPoint -> reset_aes_iv -> TEE_CipherInit
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_CipherInit (param 1): 6793 chars
[DEBUG] Using multi-param RAG template for TEE_CipherInit
  [14/15] チェーン: TA_InvokeCommandEntryPoint -> cipher_buffer -> TEE_CipherUpdate
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_CipherUpdate (param 1): 7382 chars
[DEBUG] Using multi-param RAG template for TEE_CipherUpdate
  [15/15] チェーン: TA_OpenSessionEntryPoint -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Malloc
[DEBUG] Retrieved RAG context for TEE_Malloc (param 0): 354 chars
[DEBUG] Using RAG template for TEE_Malloc
[taint_analyzer] 解析完了: 11 件の脆弱性を検出
  結果: /workspace/benchmark/aes/ta/results/ta_vulnerabilities.json
  ログ: /workspace/benchmark/aes/ta/results/taint_analysis_log.txt
[generate_report] HTMLレポートを生成しました: /workspace/benchmark/aes/ta/results/ta_vulnerability_report.html
  検出脆弱性数: 11
  AI対話履歴を含めました: /workspace/benchmark/aes/ta/results/taint_analysis_log.txt
  対話チェーン数: 15
make -C host CROSS_COMPILE="arm-linux-gnueabihf-" --no-builtin-variables \
	TEEC_EXPORT=/workspace/benchmark/hotp/../../optee_client/out/export
make[1]: Entering directory '/workspace/benchmark/hotp/host'
arm-linux-gnueabihf-gcc  -o optee_example_hotp main.o -lteec -L/workspace/benchmark/hotp/../../optee_client/out/export/lib
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: main.o: relocation R_ARM_THM_MOVW_ABS_NC against `a local symbol' can not be used when making a shared object; recompile with -fPIC
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: main.o(.text+0x42): unresolvable R_ARM_THM_CALL relocation against symbol `TEEC_InitializeContext'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: final link failed
collect2: error: ld returned 1 exit status
make[1]: *** [Makefile:21: optee_example_hotp] Error 1
make[1]: Leaving directory '/workspace/benchmark/hotp/host'
make: *** [Makefile:12: all] Error 2
make: Entering directory '/workspace/benchmark/hotp/ta'
make: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'hotp_ta.o'.  Stop.
make: Leaving directory '/workspace/benchmark/hotp/ta'
-- The C compiler identification is GNU 11.4.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/arm-linux-gnueabihf-gcc - skipped
-- Detecting C compile features
-- Detecting C compile features - done
CMake Warning (dev) in CMakeLists.txt:
  No cmake_minimum_required command is present.  A line of code such as

    cmake_minimum_required(VERSION 3.22)

  should be added at the top of the file.  The version specified may be lower
  if you wish to support older CMake versions for this project.  For more
  information run "cmake --help-policy CMP0000".
This warning is for project developers.  Use -Wno-dev to suppress it.

-- Configuring done
-- Generating done
-- Build files have been written to: /workspace/benchmark/hotp/build
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[INFO] RAG mode enabled. Initializing RAG system...
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
使用中のLLMプロバイダー: openai
呼び出し済み外部 API を抽出中...
外部 API 関数: 12 個
外部 API 関数をシンクとして解析中...
[DEBUG] Searching for API: TEE_AllocateOperation
[DEBUG] Searching for API: TEE_AllocateTransientObject
[DEBUG] Searching for API: TEE_FreeOperation
[DEBUG] Searching for API: TEE_FreeTransientObject
[DEBUG] Searching for API: TEE_InitRefAttribute
[DEBUG] Searching for API: TEE_MACComputeFinal
[DEBUG] Searching for API: TEE_MACInit
[DEBUG] Searching for API: TEE_MACUpdate
[DEBUG] Searching for API: TEE_PopulateTransientObject
[DEBUG] Searching for API: TEE_SetOperationKey
[DEBUG] Searching for API: memcpy
[DEBUG] Searching for API: memset
抽出されたシンク候補: 38 個
結果を /workspace/benchmark/hotp/ta/results/ta_sinks.json に保存しました
[DEBUG] Include paths:
  ✓ /workspace/benchmark/hotp/ta
  ✓ /workspace/benchmark/hotp/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/hotp/ta/hotp_ta.c
  Args: -I/workspace/benchmark/hotp/ta -I/workspace/benchmark/hotp/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[find_sink_calls] 20 call sites → /workspace/benchmark/hotp/ta/results/ta_vulnerable_destinations.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/hotp/ta
  ✓ /workspace/benchmark/hotp/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/hotp/ta/hotp_ta.c
  Args: -I/workspace/benchmark/hotp/ta -I/workspace/benchmark/hotp/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[generate_call_graph_advanced] 26 edges, 9 functions → /workspace/benchmark/hotp/ta/results/ta_call_graph.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/hotp/ta
  ✓ /workspace/benchmark/hotp/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/hotp/ta/hotp_ta.c
  Args: -I/workspace/benchmark/hotp/ta -I/workspace/benchmark/hotp/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[extract_sink_calls] 20 entries → /workspace/benchmark/hotp/ta/results/ta_vulnerable_destinations.json
[DEBUG] 入力チェーン数: 20
[DEBUG] ソース関数マッピング: {'TA_InvokeCommandEntryPoint': [], 'TA_OpenSessionEntryPoint': []}
[DEBUG] ソース関数: ['TA_InvokeCommandEntryPoint', 'TA_OpenSessionEntryPoint']
[DEBUG] ステップ1後: 20 CDFs
[DEBUG] ステップ2後: 20 CDFs（同じVD+ソースの最長チェーンのみ）
[DEBUG] ステップ3後: 20 CDFs（0 個のサブチェーンを削除）
[DEBUG] ステップ4: 10 グループ
[DEBUG] ステップ4後: 10 CDFs（9 グループがマージされた）
[DEBUG] 最終的な危険フロー:
  - TEE_AllocateOperation at line 67, params=[0, 1]: TA_InvokeCommandEntryPoint -> get_hotp -> hmac_sha1 -> TEE_AllocateOperation
  - TEE_AllocateTransientObject at line 78, params=[0, 1]: TA_InvokeCommandEntryPoint -> get_hotp -> hmac_sha1 -> TEE_AllocateTransientObject
  - TEE_InitRefAttribute at line 89, params=[2, 3]: TA_InvokeCommandEntryPoint -> get_hotp -> hmac_sha1 -> TEE_InitRefAttribute
  - TEE_PopulateTransientObject at line 92, params=[1]: TA_InvokeCommandEntryPoint -> get_hotp -> hmac_sha1 -> TEE_PopulateTransientObject
  - TEE_SetOperationKey at line 99, params=[0, 1]: TA_InvokeCommandEntryPoint -> get_hotp -> hmac_sha1 -> TEE_SetOperationKey
  - TEE_MACInit at line 106, params=[1, 2]: TA_InvokeCommandEntryPoint -> get_hotp -> hmac_sha1 -> TEE_MACInit
  - TEE_MACUpdate at line 107, params=[0, 1]: TA_InvokeCommandEntryPoint -> get_hotp -> hmac_sha1 -> TEE_MACUpdate
  - TEE_MACComputeFinal at line 108, params=[3, 4]: TA_InvokeCommandEntryPoint -> get_hotp -> hmac_sha1 -> TEE_MACComputeFinal
  - memset at line 152, params=[1, 2]: TA_InvokeCommandEntryPoint -> register_shared_key -> memset
  - memcpy at line 153, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> register_shared_key -> memcpy

[generate_candidate_flows] 10 件 → /workspace/benchmark/hotp/ta/results/ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/aes/ta/compile_commands.json --output /workspace/benchmark/aes/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/aes/ta)
[phase3.5] → /workspace/benchmark/aes/ta/results/ta_call_graph.json

[phase3.3] → python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/aes/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/aes/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/aes/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/aes/ta/results/ta_chains.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/aes/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/aes/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/aes/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/aes/ta/results/ta_chains.json  (cwd=/workspace/benchmark/aes/ta)
[phase3.6] → /workspace/benchmark/aes/ta/results/ta_chains.json

[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/extract_sink_calls.py --compile-db /workspace/benchmark/aes/ta/compile_commands.json --sinks /workspace/benchmark/aes/ta/results/ta_sinks.json --output /workspace/benchmark/aes/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/aes/ta)
[phase3.7] → /workspace/benchmark/aes/ta/results/ta_vulnerable_destinations.json

[phase5_command] → python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/aes/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/aes/ta/results/ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/aes/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/aes/ta/results/ta_candidate_flows.json  (cwd=/workspace/benchmark/aes/ta)
[phase5 ] → /workspace/benchmark/aes/ta/results/ta_candidate_flows.json

[INFO] $ /usr/bin/python3 /workspace/src/analyze_vulnerabilities/taint_analyzer.py --flows /workspace/benchmark/aes/ta/results/ta_candidate_flows.json --phase12 /workspace/benchmark/aes/ta/results/ta_phase12.json --output /workspace/benchmark/aes/ta/results/ta_vulnerabilities.json  (cwd=/workspace/benchmark/aes/ta)
[phase6 ] → /workspace/benchmark/aes/ta/results/ta_vulnerabilities.json

[INFO] $ /usr/bin/python3 /workspace/src/report/generate_report.py --vulnerabilities /workspace/benchmark/aes/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/aes/ta/results/ta_phase12.json --project-name aes --output /workspace/benchmark/aes/ta/results/ta_vulnerability_report.html  (cwd=/workspace/benchmark/aes/ta)
[phase7 ] → /workspace/benchmark/aes/ta/results/ta_vulnerability_report.html


=== Project: hotp / TA: ta ===
[INFO] $ bear -- make  (cwd=/workspace/benchmark/hotp)
[WARN]   ↳ rc=2
[INFO] $ bear -- make -C ta V=1  (cwd=/workspace/benchmark/hotp)
[WARN]   ↳ rc=2
[INFO] $ cmake -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -Bbuild -H.  (cwd=/workspace/benchmark/hotp)
[WARN] bear が拾えなかった .c がある → dummy 補完
[INFO] ★ dummy DB 1 entries → /workspace/benchmark/hotp/build/compile_commands.json
[INFO] TA DB saved: /workspace/benchmark/hotp/ta/compile_commands.json  entries=1
[DEBUG] Include paths:
  ✓ /workspace/benchmark/hotp/ta
  ✓ /workspace/benchmark/hotp/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/hotp/ta/hotp_ta.c
  Args: -I/workspace/benchmark/hotp/ta -I/workspace/benchmark/hotp/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[phase1-2] → /workspace/benchmark/hotp/ta/results/ta_phase12.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/identify_sinks.py -i /workspace/benchmark/hotp/ta/results/ta_phase12.json -o /workspace/benchmark/hotp/ta/results/ta_sinks.json  (cwd=/workspace/benchmark/hotp/ta)
[phase3 ] → /workspace/benchmark/hotp/ta/results/ta_sinks.json

[phase3.1] → python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/hotp/ta/compile_commands.json --sinks /workspace/benchmark/hotp/ta/results/ta_sinks.json --output /workspace/benchmark/hotp/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/hotp/ta/compile_commands.json --sinks /workspace/benchmark/hotp/ta/results/ta_sinks.json --output /workspace/benchmark/hotp/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/hotp/ta)
[phase3.4] → /workspace/benchmark/hotp/ta/results/ta_vulnerable_destinations.json

[phase3.2] → python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/hotp/ta/compile_commands.json --output /workspace/benchmark/hotp/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/hotp/ta/compile_commands.json --output /workspace/benchmark/hotp/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/hotp/ta)
[phase3.5] → /workspace/benchmark/hotp/ta/results/ta_call_graph.json

[phase3.3] → python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/hotp/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/hotp/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/hotp/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/hotp/ta/results/ta_chains.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/hotp/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/hotp/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/hotp/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/hotp/ta/results/ta_chains.json  (cwd=/workspace/benchmark/hotp/ta)
[phase3.6] → /workspace/benchmark/hotp/ta/results/ta_chains.json

[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/extract_sink_calls.py --compile-db /workspace/benchmark/hotp/ta/compile_commands.json --sinks /workspace/benchmark/hotp/ta/results/ta_sinks.json --output /workspace/benchmark/hotp/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/hotp/ta)
[phase3.7] → /workspace/benchmark/hotp/ta/results/ta_vulnerable_destinations.json

[phase5_command] → python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/hotp/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/hotp/ta/results/ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/hotp/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/hotp/ta/results/ta_candidate_flows.json  (cwd=/workspace/benchmark/hotp/ta)
[phase5 ] → /workspace/benchmark/hotp/ta/results/ta_candidate_flows.json

/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[DEBUG] Using prompts directory: /workspace/prompts/vulnerabilities_prompt
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
[DEBUG] RAG system already initialized
使用中のLLMプロバイダー: openai
[taint_analyzer] 10 個の候補フローを解析中...
  [1/10] チェーン: TA_InvokeCommandEntryPoint -> get_hotp -> hmac_sha1 -> TEE_AllocateOperation
[DEBUG] Loaded prompt: taint_start.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_AllocateOperation (param 0): 2903 chars
[DEBUG] Loaded prompt: taint_middle_multi_params_with_rag.txt
[DEBUG] Using multi-param RAG template for TEE_AllocateOperation
[DEBUG] Loaded prompt: taint_end.txt
  [2/10] チェーン: TA_InvokeCommandEntryPoint -> get_hotp -> hmac_sha1 -> TEE_AllocateTransientObject
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_AllocateTransientObject (param 0): 1089 chars
[DEBUG] Using multi-param RAG template for TEE_AllocateTransientObject
  [3/10] チェーン: TA_InvokeCommandEntryPoint -> get_hotp -> hmac_sha1 -> TEE_InitRefAttribute
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_InitRefAttribute (param 2): 1496 chars
[DEBUG] Using multi-param RAG template for TEE_InitRefAttribute
  [4/10] チェーン: TA_InvokeCommandEntryPoint -> get_hotp -> hmac_sha1 -> TEE_PopulateTransientObject
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_PopulateTransientObject, param_index=1
[DEBUG] Attempting to get RAG context for TEE_PopulateTransientObject
[DEBUG] Retrieved RAG context for TEE_PopulateTransientObject (param 1): 4480 chars
[DEBUG] Loaded prompt: taint_middle_with_rag.txt
[DEBUG] Using RAG template for TEE_PopulateTransientObject
  [5/10] チェーン: TA_InvokeCommandEntryPoint -> get_hotp -> hmac_sha1 -> TEE_SetOperationKey
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_SetOperationKey (param 0): 5515 chars
[DEBUG] Using multi-param RAG template for TEE_SetOperationKey
  [6/10] チェーン: TA_InvokeCommandEntryPoint -> get_hotp -> hmac_sha1 -> TEE_MACInit
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MACInit (param 1): 6098 chars
[DEBUG] Using multi-param RAG template for TEE_MACInit
  [7/10] チェーン: TA_InvokeCommandEntryPoint -> get_hotp -> hmac_sha1 -> TEE_MACUpdate
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MACUpdate (param 0): 5122 chars
[DEBUG] Using multi-param RAG template for TEE_MACUpdate
  [8/10] チェーン: TA_InvokeCommandEntryPoint -> get_hotp -> hmac_sha1 -> TEE_MACComputeFinal
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MACComputeFinal (param 3): 5786 chars
[DEBUG] Using multi-param RAG template for TEE_MACComputeFinal
  [9/10] チェーン: TA_InvokeCommandEntryPoint -> register_shared_key -> memset
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for memset (param 1): 2036 chars
[DEBUG] Using multi-param RAG template for memset
  [10/10] チェーン: TA_InvokeCommandEntryPoint -> register_shared_key -> memcpy
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for memcpy (param 0): 2036 chars
[DEBUG] Using multi-param RAG template for memcpy
[taint_analyzer] 解析完了: 7 件の脆弱性を検出
  結果: /workspace/benchmark/hotp/ta/results/ta_vulnerabilities.json
  ログ: /workspace/benchmark/hotp/ta/results/taint_analysis_log.txt
[generate_report] HTMLレポートを生成しました: /workspace/benchmark/hotp/ta/results/ta_vulnerability_report.html
  検出脆弱性数: 7
  AI対話履歴を含めました: /workspace/benchmark/hotp/ta/results/taint_analysis_log.txt
  対話チェーン数: 10
make -C host CROSS_COMPILE="arm-linux-gnueabihf-" --no-builtin-variables \
	TEEC_EXPORT=/workspace/benchmark/random/../../optee_client/out/export
make[1]: Entering directory '/workspace/benchmark/random/host'
arm-linux-gnueabihf-gcc  -o optee_example_random main.o -lteec -L/workspace/benchmark/random/../../optee_client/out/export/lib
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: main.o: relocation R_ARM_THM_MOVW_ABS_NC against `a local symbol' can not be used when making a shared object; recompile with -fPIC
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: main.o(.text+0x3a): unresolvable R_ARM_THM_CALL relocation against symbol `TEEC_InitializeContext'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: final link failed
collect2: error: ld returned 1 exit status
make[1]: *** [Makefile:21: optee_example_random] Error 1
make[1]: Leaving directory '/workspace/benchmark/random/host'
make: *** [Makefile:12: all] Error 2
make: Entering directory '/workspace/benchmark/random/ta'
make: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'random_example_ta.o'.  Stop.
make: Leaving directory '/workspace/benchmark/random/ta'
-- The C compiler identification is GNU 11.4.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/arm-linux-gnueabihf-gcc - skipped
-- Detecting C compile features
-- Detecting C compile features - done
CMake Warning (dev) in CMakeLists.txt:
  No cmake_minimum_required command is present.  A line of code such as

    cmake_minimum_required(VERSION 3.22)

  should be added at the top of the file.  The version specified may be lower
  if you wish to support older CMake versions for this project.  For more
  information run "cmake --help-policy CMP0000".
This warning is for project developers.  Use -Wno-dev to suppress it.

-- Configuring done
-- Generating done
-- Build files have been written to: /workspace/benchmark/random/build
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[INFO] RAG mode enabled. Initializing RAG system...
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
使用中のLLMプロバイダー: openai
呼び出し済み外部 API を抽出中...
外部 API 関数: 4 個
外部 API 関数をシンクとして解析中...
[DEBUG] Searching for API: TEE_Free
[DEBUG] Searching for API: TEE_GenerateRandom
[DEBUG] Searching for API: TEE_Malloc
[DEBUG] Searching for API: TEE_MemMove
抽出されたシンク候補: 10 個
結果を /workspace/benchmark/random/ta/results/ta_sinks.json に保存しました
[DEBUG] Include paths:
  ✓ /workspace/benchmark/random/ta
  ✓ /workspace/benchmark/random/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/random/ta/random_example_ta.c
  Args: -I/workspace/benchmark/random/ta -I/workspace/benchmark/random/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[find_sink_calls] 6 call sites → /workspace/benchmark/random/ta/results/ta_vulnerable_destinations.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/random/ta
  ✓ /workspace/benchmark/random/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/random/ta/random_example_ta.c
  Args: -I/workspace/benchmark/random/ta -I/workspace/benchmark/random/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[generate_call_graph_advanced] 7 edges, 6 functions → /workspace/benchmark/random/ta/results/ta_call_graph.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/random/ta
  ✓ /workspace/benchmark/random/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/random/ta/random_example_ta.c
  Args: -I/workspace/benchmark/random/ta -I/workspace/benchmark/random/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[extract_sink_calls] 6 entries → /workspace/benchmark/random/ta/results/ta_vulnerable_destinations.json
[DEBUG] 入力チェーン数: 6
[DEBUG] ソース関数マッピング: {'TA_InvokeCommandEntryPoint': [], 'TA_OpenSessionEntryPoint': []}
[DEBUG] ソース関数: ['TA_InvokeCommandEntryPoint', 'TA_OpenSessionEntryPoint']
[DEBUG] ステップ1後: 6 CDFs
[DEBUG] ステップ2後: 6 CDFs（同じVD+ソースの最長チェーンのみ）
[DEBUG] ステップ3後: 6 CDFs（0 個のサブチェーンを削除）
[DEBUG] ステップ4: 4 グループ
[DEBUG] ステップ4後: 4 CDFs（2 グループがマージされた）
[DEBUG] 最終的な危険フロー:
  - TEE_Malloc at line 78, params=[0]: TA_InvokeCommandEntryPoint -> random_number_generate -> TEE_Malloc
  - TEE_GenerateRandom at line 90, params=[0, 1]: TA_InvokeCommandEntryPoint -> random_number_generate -> TEE_GenerateRandom
  - TEE_MemMove at line 91, params=[0, 2]: TA_InvokeCommandEntryPoint -> random_number_generate -> TEE_MemMove
  - TEE_Free at line 92, params=[0]: TA_InvokeCommandEntryPoint -> random_number_generate -> TEE_Free

[generate_candidate_flows] 4 件 → /workspace/benchmark/random/ta/results/ta_candidate_flows.json
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[DEBUG] Using prompts directory: /workspace/prompts/vulnerabilities_prompt
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
[DEBUG] RAG system already initialized
使用中のLLMプロバイダー: openai
[taint_analyzer] 4 個の候補フローを解析中...
  [1/4] チェーン: TA_InvokeCommandEntryPoint -> random_number_generate -> TEE_Malloc
[DEBUG] Loaded prompt: taint_start.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle.txt
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Malloc
[DEBUG] Retrieved RAG context for TEE_Malloc (param 0): 354 chars
[DEBUG] Loaded prompt: taint_middle_with_rag.txt
[DEBUG] Using RAG template for TEE_Malloc
[DEBUG] Loaded prompt: taint_end.txt
  [2/4] チェーン: TA_InvokeCommandEntryPoint -> random_number_generate -> TEE_GenerateRandom
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_GenerateRandom (param 0): 3907 chars
[DEBUG] Loaded prompt: taint_middle_multi_params_with_rag.txt
[DEBUG] Using multi-param RAG template for TEE_GenerateRandom
  [3/4] チェーン: TA_InvokeCommandEntryPoint -> random_number_generate -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [4/4] チェーン: TA_InvokeCommandEntryPoint -> random_number_generate -> TEE_Free
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Free, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Free
[DEBUG] Retrieved RAG context for TEE_Free (param 0): 5059 chars
[DEBUG] Using RAG template for TEE_Free
[taint_analyzer] 解析完了: 2 件の脆弱性を検出
  結果: /workspace/benchmark/random/ta/results/ta_vulnerabilities.json
  ログ: /workspace/benchmark/random/ta/results/taint_analysis_log.txt
[generate_report] HTMLレポートを生成しました: /workspace/benchmark/random/ta/results/ta_vulnerability_report.html
  検出脆弱性数: 2
  AI対話履歴を含めました: /workspace/benchmark/random/ta/results/taint_analysis_log.txt
  対話チェーン数: 4
make -C host CROSS_COMPILE="arm-linux-gnueabihf-" --no-builtin-variables \
	TEEC_EXPORT=/workspace/benchmark/secure_storage/../../optee_client/out/export
make[1]: Entering directory '/workspace/benchmark/secure_storage/host'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/workspace/benchmark/secure_storage/host'
make -C ta CROSS_COMPILE="arm-linux-gnueabihf-" LDFLAGS="" \
	TA_DEV_KIT_DIR=/workspace/benchmark/secure_storage/../../optee_os/out/arm/export-ta_arm32
make[1]: Entering directory '/workspace/benchmark/secure_storage/ta'
make[1]: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'secure_storage_ta.o'.  Stop.
make[1]: Leaving directory '/workspace/benchmark/secure_storage/ta'
make: *** [Makefile:14: all] Error 2
make: Entering directory '/workspace/benchmark/secure_storage/ta'
make: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'secure_storage_ta.o'.  Stop.
make: Leaving directory '/workspace/benchmark/secure_storage/ta'
-- The C compiler identification is GNU 11.4.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/arm-linux-gnueabihf-gcc - skipped
-- Detecting C compile features
-- Detecting C compile features - done
CMake Warning (dev) in CMakeLists.txt:
  No cmake_minimum_required command is present.  A line of code such as

    cmake_minimum_required(VERSION 3.22)

  should be added at the top of the file.  The version specified may be lower
  if you wish to support older CMake versions for this project.  For more
  information run "cmake --help-policy CMP0000".
This warning is for project developers.  Use -Wno-dev to suppress it.

-- Configuring done
-- Generating done
-- Build files have been written to: /workspace/benchmark/secure_storage/build
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[INFO] RAG mode enabled. Initializing RAG system...
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
使用中のLLMプロバイダー: openai
呼び出し済み外部 API を抽出中...
外部 API 関数: 10 個
外部 API 関数をシンクとして解析中...
[DEBUG] Searching for API: TEE_CloseAndDeletePersistentObject1
[DEBUG] Searching for API: TEE_CloseObject
[DEBUG] Searching for API: TEE_CreatePersistentObject
[DEBUG] Searching for API: TEE_Free
[DEBUG] Searching for API: TEE_GetObjectInfo1
[DEBUG] Searching for API: TEE_Malloc
[DEBUG] Searching for API: TEE_MemMove
[DEBUG] Searching for API: TEE_OpenPersistentObject
[DEBUG] Searching for API: TEE_ReadObjectData
[DEBUG] Searching for API: TEE_WriteObjectData
抽出されたシンク候補: 25 個
結果を /workspace/benchmark/secure_storage/ta/results/ta_sinks.json に保存しました
[INFO] $ /usr/bin/python3 /workspace/src/analyze_vulnerabilities/taint_analyzer.py --flows /workspace/benchmark/hotp/ta/results/ta_candidate_flows.json --phase12 /workspace/benchmark/hotp/ta/results/ta_phase12.json --output /workspace/benchmark/hotp/ta/results/ta_vulnerabilities.json  (cwd=/workspace/benchmark/hotp/ta)
[phase6 ] → /workspace/benchmark/hotp/ta/results/ta_vulnerabilities.json

[INFO] $ /usr/bin/python3 /workspace/src/report/generate_report.py --vulnerabilities /workspace/benchmark/hotp/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/hotp/ta/results/ta_phase12.json --project-name hotp --output /workspace/benchmark/hotp/ta/results/ta_vulnerability_report.html  (cwd=/workspace/benchmark/hotp/ta)
[phase7 ] → /workspace/benchmark/hotp/ta/results/ta_vulnerability_report.html


=== Project: random / TA: ta ===
[INFO] $ bear -- make  (cwd=/workspace/benchmark/random)
[WARN]   ↳ rc=2
[INFO] $ bear -- make -C ta V=1  (cwd=/workspace/benchmark/random)
[WARN]   ↳ rc=2
[INFO] $ cmake -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -Bbuild -H.  (cwd=/workspace/benchmark/random)
[WARN] bear が拾えなかった .c がある → dummy 補完
[INFO] ★ dummy DB 1 entries → /workspace/benchmark/random/build/compile_commands.json
[INFO] TA DB saved: /workspace/benchmark/random/ta/compile_commands.json  entries=1
[DEBUG] Include paths:
  ✓ /workspace/benchmark/random/ta
  ✓ /workspace/benchmark/random/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/random/ta/random_example_ta.c
  Args: -I/workspace/benchmark/random/ta -I/workspace/benchmark/random/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[phase1-2] → /workspace/benchmark/random/ta/results/ta_phase12.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/identify_sinks.py -i /workspace/benchmark/random/ta/results/ta_phase12.json -o /workspace/benchmark/random/ta/results/ta_sinks.json  (cwd=/workspace/benchmark/random/ta)
[phase3 ] → /workspace/benchmark/random/ta/results/ta_sinks.json

[phase3.1] → python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/random/ta/compile_commands.json --sinks /workspace/benchmark/random/ta/results/ta_sinks.json --output /workspace/benchmark/random/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/random/ta/compile_commands.json --sinks /workspace/benchmark/random/ta/results/ta_sinks.json --output /workspace/benchmark/random/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/random/ta)
[phase3.4] → /workspace/benchmark/random/ta/results/ta_vulnerable_destinations.json

[phase3.2] → python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/random/ta/compile_commands.json --output /workspace/benchmark/random/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/random/ta/compile_commands.json --output /workspace/benchmark/random/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/random/ta)
[phase3.5] → /workspace/benchmark/random/ta/results/ta_call_graph.json

[phase3.3] → python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/random/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/random/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/random/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/random/ta/results/ta_chains.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/random/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/random/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/random/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/random/ta/results/ta_chains.json  (cwd=/workspace/benchmark/random/ta)
[phase3.6] → /workspace/benchmark/random/ta/results/ta_chains.json

[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/extract_sink_calls.py --compile-db /workspace/benchmark/random/ta/compile_commands.json --sinks /workspace/benchmark/random/ta/results/ta_sinks.json --output /workspace/benchmark/random/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/random/ta)
[phase3.7] → /workspace/benchmark/random/ta/results/ta_vulnerable_destinations.json

[phase5_command] → python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/random/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/random/ta/results/ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/random/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/random/ta/results/ta_candidate_flows.json  (cwd=/workspace/benchmark/random/ta)
[phase5 ] → /workspace/benchmark/random/ta/results/ta_candidate_flows.json

[INFO] $ /usr/bin/python3 /workspace/src/analyze_vulnerabilities/taint_analyzer.py --flows /workspace/benchmark/random/ta/results/ta_candidate_flows.json --phase12 /workspace/benchmark/random/ta/results/ta_phase12.json --output /workspace/benchmark/random/ta/results/ta_vulnerabilities.json  (cwd=/workspace/benchmark/random/ta)
[phase6 ] → /workspace/benchmark/random/ta/results/ta_vulnerabilities.json

[INFO] $ /usr/bin/python3 /workspace/src/report/generate_report.py --vulnerabilities /workspace/benchmark/random/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/random/ta/results/ta_phase12.json --project-name random --output /workspace/benchmark/random/ta/results/ta_vulnerability_report.html  (cwd=/workspace/benchmark/random/ta)
[phase7 ] → /workspace/benchmark/random/ta/results/ta_vulnerability_report.html


=== Project: secure_storage / TA: ta ===
[INFO] $ bear -- make  (cwd=/workspace/benchmark/secure_storage)
[WARN]   ↳ rc=2
[INFO] $ bear -- make -C ta V=1  (cwd=/workspace/benchmark/secure_storage)
[WARN]   ↳ rc=2
[INFO] $ cmake -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -Bbuild -H.  (cwd=/workspace/benchmark/secure_storage)
[WARN] bear が拾えなかった .c がある → dummy 補完
[INFO] ★ dummy DB 1 entries → /workspace/benchmark/secure_storage/build/compile_commands.json
[INFO] TA DB saved: /workspace/benchmark/secure_storage/ta/compile_commands.json  entries=1
[DEBUG] Include paths:
  ✓ /workspace/benchmark/secure_storage/ta
  ✓ /workspace/benchmark/secure_storage/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/secure_storage/ta/secure_storage_ta.c
  Args: -I/workspace/benchmark/secure_storage/ta -I/workspace/benchmark/secure_storage/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[phase1-2] → /workspace/benchmark/secure_storage/ta/results/ta_phase12.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/identify_sinks.py -i /workspace/benchmark/secure_storage/ta/results/ta_phase12.json -o /workspace/benchmark/secure_storage/ta/results/ta_sinks.json  (cwd=/workspace/benchmark/secure_storage/ta)
[phase3 ] → /workspace/benchmark/secure_storage/ta/results/ta_sinks.json

[DEBUG] Include paths:
  ✓ /workspace/benchmark/secure_storage/ta
  ✓ /workspace/benchmark/secure_storage/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/secure_storage/ta/secure_storage_ta.c
  Args: -I/workspace/benchmark/secure_storage/ta -I/workspace/benchmark/secure_storage/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[find_sink_calls] 43 call sites → /workspace/benchmark/secure_storage/ta/results/ta_vulnerable_destinations.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/secure_storage/ta
  ✓ /workspace/benchmark/secure_storage/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/secure_storage/ta/secure_storage_ta.c
  Args: -I/workspace/benchmark/secure_storage/ta -I/workspace/benchmark/secure_storage/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[generate_call_graph_advanced] 40 edges, 8 functions → /workspace/benchmark/secure_storage/ta/results/ta_call_graph.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/secure_storage/ta
  ✓ /workspace/benchmark/secure_storage/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/secure_storage/ta/secure_storage_ta.c
  Args: -I/workspace/benchmark/secure_storage/ta -I/workspace/benchmark/secure_storage/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[extract_sink_calls] 43 entries → /workspace/benchmark/secure_storage/ta/results/ta_vulnerable_destinations.json
[DEBUG] 入力チェーン数: 43
[DEBUG] ソース関数マッピング: {'TA_InvokeCommandEntryPoint': [], 'TA_OpenSessionEntryPoint': []}
[DEBUG] ソース関数: ['TA_InvokeCommandEntryPoint', 'TA_OpenSessionEntryPoint']
[DEBUG] ステップ1後: 43 CDFs
[DEBUG] ステップ2後: 43 CDFs（同じVD+ソースの最長チェーンのみ）
[DEBUG] ステップ3後: 43 CDFs（0 個のサブチェーンを削除）
[DEBUG] ステップ4: 26 グループ
[DEBUG] ステップ4後: 26 CDFs（11 グループがマージされた）
[DEBUG] 最終的な危険フロー:
  - TEE_Malloc at line 52, params=[0]: TA_InvokeCommandEntryPoint -> delete_object -> TEE_Malloc
  - TEE_MemMove at line 56, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> delete_object -> TEE_MemMove
  - TEE_OpenPersistentObject at line 61, params=[2, 4]: TA_InvokeCommandEntryPoint -> delete_object -> TEE_OpenPersistentObject
  - TEE_Free at line 68, params=[0]: TA_InvokeCommandEntryPoint -> delete_object -> TEE_Free
  - TEE_Free at line 73, params=[0]: TA_InvokeCommandEntryPoint -> delete_object -> TEE_Free
  - TEE_Malloc at line 100, params=[0]: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_Malloc
  - TEE_MemMove at line 104, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_MemMove
  - TEE_Malloc at line 107, params=[0]: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_Malloc
  - TEE_MemMove at line 110, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_MemMove
  - TEE_CreatePersistentObject at line 120, params=[2, 5, 6]: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_CreatePersistentObject
  - TEE_Free at line 128, params=[0]: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_Free
  - TEE_Free at line 129, params=[0]: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_Free
  - TEE_WriteObjectData at line 133, params=[1, 2]: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_WriteObjectData
  - TEE_Free at line 140, params=[0]: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_Free
  - TEE_Free at line 141, params=[0]: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_Free
  - TEE_Malloc at line 168, params=[0]: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_Malloc
  - TEE_MemMove at line 172, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_MemMove
  - TEE_Malloc at line 175, params=[0]: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_Malloc
  - TEE_OpenPersistentObject at line 183, params=[2, 4]: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_OpenPersistentObject
  - TEE_Free at line 190, params=[0]: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_Free
  - TEE_Free at line 191, params=[0]: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_Free
  - TEE_GetObjectInfo1 at line 195, params=[0, 1]: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_GetObjectInfo1
  - TEE_ReadObjectData at line 211, params=[1, 2]: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_ReadObjectData
  - TEE_MemMove at line 214, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_MemMove
  - TEE_Free at line 225, params=[0]: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_Free
  - TEE_Free at line 226, params=[0]: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_Free

[generate_candidate_flows] 26 件 → /workspace/benchmark/secure_storage/ta/results/ta_candidate_flows.json
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[DEBUG] Using prompts directory: /workspace/prompts/vulnerabilities_prompt
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
[DEBUG] RAG system already initialized
使用中のLLMプロバイダー: openai
[taint_analyzer] 26 個の候補フローを解析中...
  [1/26] チェーン: TA_InvokeCommandEntryPoint -> delete_object -> TEE_Malloc
[DEBUG] Loaded prompt: taint_start.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle.txt
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Malloc
[DEBUG] Retrieved RAG context for TEE_Malloc (param 0): 354 chars
[DEBUG] Loaded prompt: taint_middle_with_rag.txt
[DEBUG] Using RAG template for TEE_Malloc
[DEBUG] Loaded prompt: taint_end.txt
  [2/26] チェーン: TA_InvokeCommandEntryPoint -> delete_object -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Loaded prompt: taint_middle_multi_params_with_rag.txt
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [3/26] チェーン: TA_InvokeCommandEntryPoint -> delete_object -> TEE_OpenPersistentObject
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_OpenPersistentObject (param 2): 2985 chars
[DEBUG] Using multi-param RAG template for TEE_OpenPersistentObject
  [4/26] チェーン: TA_InvokeCommandEntryPoint -> delete_object -> TEE_Free
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Free, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Free
[DEBUG] Retrieved RAG context for TEE_Free (param 0): 5059 chars
[DEBUG] Using RAG template for TEE_Free
  [5/26] チェーン: TA_InvokeCommandEntryPoint -> delete_object -> TEE_Free
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Free, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Free
[DEBUG] Retrieved RAG context for TEE_Free (param 0): 5059 chars
[DEBUG] Using RAG template for TEE_Free
  [6/26] チェーン: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Malloc
[DEBUG] Retrieved RAG context for TEE_Malloc (param 0): 354 chars
[DEBUG] Using RAG template for TEE_Malloc
  [7/26] チェーン: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [8/26] チェーン: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Malloc
[DEBUG] Retrieved RAG context for TEE_Malloc (param 0): 354 chars
[DEBUG] Using RAG template for TEE_Malloc
  [9/26] チェーン: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [10/26] チェーン: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_CreatePersistentObject
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_CreatePersistentObject (param 2): 1987 chars
[DEBUG] Using multi-param RAG template for TEE_CreatePersistentObject
  [11/26] チェーン: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_Free
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Free, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Free
[DEBUG] Retrieved RAG context for TEE_Free (param 0): 5059 chars
[DEBUG] Using RAG template for TEE_Free
  [12/26] チェーン: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_Free
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Free, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Free
[DEBUG] Retrieved RAG context for TEE_Free (param 0): 5059 chars
[DEBUG] Using RAG template for TEE_Free
  [13/26] チェーン: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_WriteObjectData
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_WriteObjectData (param 1): 9922 chars
[DEBUG] Using multi-param RAG template for TEE_WriteObjectData
  [14/26] チェーン: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_Free
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Free, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Free
[DEBUG] Retrieved RAG context for TEE_Free (param 0): 5059 chars
[DEBUG] Using RAG template for TEE_Free
  [15/26] チェーン: TA_InvokeCommandEntryPoint -> create_raw_object -> TEE_Free
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Free, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Free
[DEBUG] Retrieved RAG context for TEE_Free (param 0): 5059 chars
[DEBUG] Using RAG template for TEE_Free
  [16/26] チェーン: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Malloc
[DEBUG] Retrieved RAG context for TEE_Malloc (param 0): 354 chars
[DEBUG] Using RAG template for TEE_Malloc
  [17/26] チェーン: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [18/26] チェーン: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Malloc
[DEBUG] Retrieved RAG context for TEE_Malloc (param 0): 354 chars
[DEBUG] Using RAG template for TEE_Malloc
  [19/26] チェーン: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_OpenPersistentObject
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_OpenPersistentObject (param 2): 2985 chars
[DEBUG] Using multi-param RAG template for TEE_OpenPersistentObject
  [20/26] チェーン: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_Free
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Free, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Free
[DEBUG] Retrieved RAG context for TEE_Free (param 0): 5059 chars
[DEBUG] Using RAG template for TEE_Free
  [21/26] チェーン: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_Free
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Free, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Free
[DEBUG] Retrieved RAG context for TEE_Free (param 0): 5059 chars
[DEBUG] Using RAG template for TEE_Free
  [22/26] チェーン: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_GetObjectInfo1
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_GetObjectInfo1 (param 0): 2085 chars
[DEBUG] Using multi-param RAG template for TEE_GetObjectInfo1
  [23/26] チェーン: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_ReadObjectData
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_ReadObjectData (param 1): 3323 chars
[DEBUG] Using multi-param RAG template for TEE_ReadObjectData
  [24/26] チェーン: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [25/26] チェーン: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_Free
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Free, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Free
[DEBUG] Retrieved RAG context for TEE_Free (param 0): 5059 chars
[DEBUG] Using RAG template for TEE_Free
  [26/26] チェーン: TA_InvokeCommandEntryPoint -> read_raw_object -> TEE_Free
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Free, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Free
[DEBUG] Retrieved RAG context for TEE_Free (param 0): 5059 chars
[DEBUG] Using RAG template for TEE_Free
[taint_analyzer] 解析完了: 18 件の脆弱性を検出
  結果: /workspace/benchmark/secure_storage/ta/results/ta_vulnerabilities.json
  ログ: /workspace/benchmark/secure_storage/ta/results/taint_analysis_log.txt
[generate_report] HTMLレポートを生成しました: /workspace/benchmark/secure_storage/ta/results/ta_vulnerability_report.html
  検出脆弱性数: 18
  AI対話履歴を含めました: /workspace/benchmark/secure_storage/ta/results/taint_analysis_log.txt
  対話チェーン数: 15
make -C host CROSS_COMPILE="arm-linux-gnueabihf-" --no-builtin-variables \
	TEEC_EXPORT=/workspace/benchmark/secvideo_demo/../../optee_client/out/export
make[1]: Entering directory '/workspace/benchmark/secvideo_demo/host'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/workspace/benchmark/secvideo_demo/host'
make -C ta CROSS_COMPILE="arm-linux-gnueabihf-" LDFLAGS="" \
	TA_DEV_KIT_DIR=/workspace/benchmark/secvideo_demo/../../optee_os/out/arm/export-ta_arm32
make[1]: Entering directory '/workspace/benchmark/secvideo_demo/ta'
make[1]: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'secvideo_demo_ta.o'.  Stop.
make[1]: Leaving directory '/workspace/benchmark/secvideo_demo/ta'
make: *** [Makefile:14: all] Error 2
make: Entering directory '/workspace/benchmark/secvideo_demo/ta'
make: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'secvideo_demo_ta.o'.  Stop.
make: Leaving directory '/workspace/benchmark/secvideo_demo/ta'
make: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'secvideo_demo_ta.o'.  Stop.
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[INFO] RAG mode enabled. Initializing RAG system...
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
使用中のLLMプロバイダー: openai
呼び出し済み外部 API を抽出中...
外部 API 関数: 11 個
外部 API 関数をシンクとして解析中...
[DEBUG] Searching for API: TEE_AllocateOperation
[DEBUG] Searching for API: TEE_AllocateTransientObject
[DEBUG] Searching for API: TEE_CheckMemoryAccessRights
[DEBUG] Searching for API: TEE_CipherDoFinal
[DEBUG] Searching for API: TEE_CipherInit
[DEBUG] Searching for API: TEE_Free
[DEBUG] Searching for API: TEE_FreeTransientObject
[DEBUG] Searching for API: TEE_Malloc
[DEBUG] Searching for API: TEE_PopulateTransientObject
[DEBUG] Searching for API: TEE_SetOperationKey
[DEBUG] Searching for API: memset
抽出されたシンク候補: 28 個
結果を /workspace/benchmark/secvideo_demo/ta/results/ta_sinks.json に保存しました
[DEBUG] Include paths:
  ✓ /workspace/benchmark/secvideo_demo/ta
  ✓ /workspace/benchmark/secvideo_demo/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/secvideo_demo/ta/secvideo_demo_ta.c
  Args: -I/workspace/benchmark/secvideo_demo/ta -I/workspace/benchmark/secvideo_demo/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[find_sink_calls] 18 call sites → /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerable_destinations.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/secvideo_demo/ta
  ✓ /workspace/benchmark/secvideo_demo/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/secvideo_demo/ta/secvideo_demo_ta.c
  Args: -I/workspace/benchmark/secvideo_demo/ta -I/workspace/benchmark/secvideo_demo/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[generate_call_graph_advanced] 31 edges, 8 functions → /workspace/benchmark/secvideo_demo/ta/results/ta_call_graph.json
[phase3.1] → python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/secure_storage/ta/compile_commands.json --sinks /workspace/benchmark/secure_storage/ta/results/ta_sinks.json --output /workspace/benchmark/secure_storage/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/secure_storage/ta/compile_commands.json --sinks /workspace/benchmark/secure_storage/ta/results/ta_sinks.json --output /workspace/benchmark/secure_storage/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/secure_storage/ta)
[phase3.4] → /workspace/benchmark/secure_storage/ta/results/ta_vulnerable_destinations.json

[phase3.2] → python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/secure_storage/ta/compile_commands.json --output /workspace/benchmark/secure_storage/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/secure_storage/ta/compile_commands.json --output /workspace/benchmark/secure_storage/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/secure_storage/ta)
[phase3.5] → /workspace/benchmark/secure_storage/ta/results/ta_call_graph.json

[phase3.3] → python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/secure_storage/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/secure_storage/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/secure_storage/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/secure_storage/ta/results/ta_chains.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/secure_storage/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/secure_storage/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/secure_storage/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/secure_storage/ta/results/ta_chains.json  (cwd=/workspace/benchmark/secure_storage/ta)
[phase3.6] → /workspace/benchmark/secure_storage/ta/results/ta_chains.json

[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/extract_sink_calls.py --compile-db /workspace/benchmark/secure_storage/ta/compile_commands.json --sinks /workspace/benchmark/secure_storage/ta/results/ta_sinks.json --output /workspace/benchmark/secure_storage/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/secure_storage/ta)
[phase3.7] → /workspace/benchmark/secure_storage/ta/results/ta_vulnerable_destinations.json

[phase5_command] → python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/secure_storage/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/secure_storage/ta/results/ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/secure_storage/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/secure_storage/ta/results/ta_candidate_flows.json  (cwd=/workspace/benchmark/secure_storage/ta)
[phase5 ] → /workspace/benchmark/secure_storage/ta/results/ta_candidate_flows.json

[INFO] $ /usr/bin/python3 /workspace/src/analyze_vulnerabilities/taint_analyzer.py --flows /workspace/benchmark/secure_storage/ta/results/ta_candidate_flows.json --phase12 /workspace/benchmark/secure_storage/ta/results/ta_phase12.json --output /workspace/benchmark/secure_storage/ta/results/ta_vulnerabilities.json  (cwd=/workspace/benchmark/secure_storage/ta)
[phase6 ] → /workspace/benchmark/secure_storage/ta/results/ta_vulnerabilities.json

[INFO] $ /usr/bin/python3 /workspace/src/report/generate_report.py --vulnerabilities /workspace/benchmark/secure_storage/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/secure_storage/ta/results/ta_phase12.json --project-name secure_storage --output /workspace/benchmark/secure_storage/ta/results/ta_vulnerability_report.html  (cwd=/workspace/benchmark/secure_storage/ta)
[phase7 ] → /workspace/benchmark/secure_storage/ta/results/ta_vulnerability_report.html


=== Project: secvideo_demo / TA: ta ===
[INFO] $ bear -- make  (cwd=/workspace/benchmark/secvideo_demo)
[WARN]   ↳ rc=2
[INFO] $ bear -- make -C ta V=1  (cwd=/workspace/benchmark/secvideo_demo)
[WARN]   ↳ rc=2
[INFO] $ bear -- make  (cwd=/workspace/benchmark/secvideo_demo/ta)
[WARN]   ↳ rc=2
[WARN] build failed/empty → dummy DB
[INFO] ★ dummy DB 1 entries → /workspace/benchmark/secvideo_demo/ta/compile_commands_full.json
[INFO] TA DB saved: /workspace/benchmark/secvideo_demo/ta/compile_commands.json  entries=1
[DEBUG] Include paths:
  ✓ /workspace/benchmark/secvideo_demo/ta
  ✓ /workspace/benchmark/secvideo_demo/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/secvideo_demo/ta/secvideo_demo_ta.c
  Args: -I/workspace/benchmark/secvideo_demo/ta -I/workspace/benchmark/secvideo_demo/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[phase1-2] → /workspace/benchmark/secvideo_demo/ta/results/ta_phase12.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/identify_sinks.py -i /workspace/benchmark/secvideo_demo/ta/results/ta_phase12.json -o /workspace/benchmark/secvideo_demo/ta/results/ta_sinks.json  (cwd=/workspace/benchmark/secvideo_demo/ta)
[phase3 ] → /workspace/benchmark/secvideo_demo/ta/results/ta_sinks.json

[phase3.1] → python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/secvideo_demo/ta/compile_commands.json --sinks /workspace/benchmark/secvideo_demo/ta/results/ta_sinks.json --output /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/secvideo_demo/ta/compile_commands.json --sinks /workspace/benchmark/secvideo_demo/ta/results/ta_sinks.json --output /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/secvideo_demo/ta)
[phase3.4] → /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerable_destinations.json

[phase3.2] → python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/secvideo_demo/ta/compile_commands.json --output /workspace/benchmark/secvideo_demo/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/secvideo_demo/ta/compile_commands.json --output /workspace/benchmark/secvideo_demo/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/secvideo_demo/ta)
[phase3.5] → /workspace/benchmark/secvideo_demo/ta/results/ta_call_graph.json

[phase3.3] → python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/secvideo_demo/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/secvideo_demo/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/secvideo_demo/ta/results/ta_chains.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/secvideo_demo/ta
  ✓ /workspace/benchmark/secvideo_demo/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/secvideo_demo/ta/secvideo_demo_ta.c
  Args: -I/workspace/benchmark/secvideo_demo/ta -I/workspace/benchmark/secvideo_demo/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[extract_sink_calls] 18 entries → /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerable_destinations.json
[DEBUG] 入力チェーン数: 18
[DEBUG] ソース関数マッピング: {'TA_InvokeCommandEntryPoint': [], 'TA_OpenSessionEntryPoint': []}
[DEBUG] ソース関数: ['TA_InvokeCommandEntryPoint', 'TA_OpenSessionEntryPoint']
[DEBUG] ステップ1後: 18 CDFs
[DEBUG] ステップ2後: 18 CDFs（同じVD+ソースの最長チェーンのみ）
[DEBUG] ステップ3後: 18 CDFs（0 個のサブチェーンを削除）
[DEBUG] ステップ4: 10 グループ
[DEBUG] ステップ4後: 10 CDFs（7 グループがマージされた）
[DEBUG] 最終的な危険フロー:
  - TEE_Malloc at line 107, params=[0]: TA_InvokeCommandEntryPoint -> clear_screen -> TEE_Malloc
  - memset at line 110, params=[0, 2]: TA_InvokeCommandEntryPoint -> clear_screen -> memset
  - TEE_Free at line 117, params=[0]: TA_InvokeCommandEntryPoint -> clear_screen -> TEE_Free
  - TEE_AllocateOperation at line 130, params=[0, 1]: TA_InvokeCommandEntryPoint -> image_data -> decrypt -> TEE_AllocateOperation
  - TEE_AllocateTransientObject at line 135, params=[0, 1]: TA_InvokeCommandEntryPoint -> image_data -> decrypt -> TEE_AllocateTransientObject
  - TEE_PopulateTransientObject at line 143, params=[1]: TA_InvokeCommandEntryPoint -> image_data -> decrypt -> TEE_PopulateTransientObject
  - TEE_SetOperationKey at line 147, params=[0, 1]: TA_InvokeCommandEntryPoint -> image_data -> decrypt -> TEE_SetOperationKey
  - TEE_CipherInit at line 154, params=[1, 2]: TA_InvokeCommandEntryPoint -> image_data -> decrypt -> TEE_CipherInit
  - TEE_CipherDoFinal at line 158, params=[2, 3, 4]: TA_InvokeCommandEntryPoint -> image_data -> decrypt -> TEE_CipherDoFinal
  - TEE_CheckMemoryAccessRights at line 197, params=[1, 2]: TA_InvokeCommandEntryPoint -> image_data -> TEE_CheckMemoryAccessRights

[generate_candidate_flows] 10 件 → /workspace/benchmark/secvideo_demo/ta/results/ta_candidate_flows.json
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[DEBUG] Using prompts directory: /workspace/prompts/vulnerabilities_prompt
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
[DEBUG] RAG system already initialized
使用中のLLMプロバイダー: openai
[taint_analyzer] 10 個の候補フローを解析中...
  [1/10] チェーン: TA_InvokeCommandEntryPoint -> clear_screen -> TEE_Malloc
[DEBUG] Loaded prompt: taint_start.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle.txt
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Malloc
[DEBUG] Retrieved RAG context for TEE_Malloc (param 0): 354 chars
[DEBUG] Loaded prompt: taint_middle_with_rag.txt
[DEBUG] Using RAG template for TEE_Malloc
[DEBUG] Loaded prompt: taint_end.txt
  [2/10] チェーン: TA_InvokeCommandEntryPoint -> clear_screen -> memset
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for memset (param 0): 2036 chars
[DEBUG] Loaded prompt: taint_middle_multi_params_with_rag.txt
[DEBUG] Using multi-param RAG template for memset
  [3/10] チェーン: TA_InvokeCommandEntryPoint -> clear_screen -> TEE_Free
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Free, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Free
[DEBUG] Retrieved RAG context for TEE_Free (param 0): 5059 chars
[DEBUG] Using RAG template for TEE_Free
  [4/10] チェーン: TA_InvokeCommandEntryPoint -> image_data -> decrypt -> TEE_AllocateOperation
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_AllocateOperation (param 0): 2903 chars
[DEBUG] Using multi-param RAG template for TEE_AllocateOperation
  [5/10] チェーン: TA_InvokeCommandEntryPoint -> image_data -> decrypt -> TEE_AllocateTransientObject
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_AllocateTransientObject (param 0): 1089 chars
[DEBUG] Using multi-param RAG template for TEE_AllocateTransientObject
  [6/10] チェーン: TA_InvokeCommandEntryPoint -> image_data -> decrypt -> TEE_PopulateTransientObject
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_PopulateTransientObject, param_index=1
[DEBUG] Attempting to get RAG context for TEE_PopulateTransientObject
[DEBUG] Retrieved RAG context for TEE_PopulateTransientObject (param 1): 4480 chars
[DEBUG] Using RAG template for TEE_PopulateTransientObject
  [7/10] チェーン: TA_InvokeCommandEntryPoint -> image_data -> decrypt -> TEE_SetOperationKey
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_SetOperationKey (param 0): 5515 chars
[DEBUG] Using multi-param RAG template for TEE_SetOperationKey
  [8/10] チェーン: TA_InvokeCommandEntryPoint -> image_data -> decrypt -> TEE_CipherInit
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_CipherInit (param 1): 6793 chars
[DEBUG] Using multi-param RAG template for TEE_CipherInit
  [9/10] チェーン: TA_InvokeCommandEntryPoint -> image_data -> decrypt -> TEE_CipherDoFinal
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_CipherDoFinal (param 2): 6788 chars
[DEBUG] Using multi-param RAG template for TEE_CipherDoFinal
  [10/10] チェーン: TA_InvokeCommandEntryPoint -> image_data -> TEE_CheckMemoryAccessRights
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_CheckMemoryAccessRights (param 1): 7670 chars
[DEBUG] Using multi-param RAG template for TEE_CheckMemoryAccessRights
[taint_analyzer] 解析完了: 6 件の脆弱性を検出
  結果: /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerabilities.json
  ログ: /workspace/benchmark/secvideo_demo/ta/results/taint_analysis_log.txt
[generate_report] HTMLレポートを生成しました: /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerability_report.html
  検出脆弱性数: 6
  AI対話履歴を含めました: /workspace/benchmark/secvideo_demo/ta/results/taint_analysis_log.txt
  対話チェーン数: 10
make -C host CROSS_COMPILE="arm-linux-gnueabihf-" --no-builtin-variables  \
	TEEC_EXPORT=/workspace/benchmark/optee-fiovb/../../optee_client/out/export
make[1]: Entering directory '/workspace/benchmark/optee-fiovb/host'
arm-linux-gnueabihf-gcc -o fiovb main.o  -lteec -L/workspace/benchmark/optee-fiovb/../../optee_client/out/export/lib
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: main.o: relocation R_ARM_THM_MOVW_ABS_NC against `a local symbol' can not be used when making a shared object; recompile with -fPIC
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: main.o(.text+0x20): unresolvable R_ARM_THM_CALL relocation against symbol `TEEC_InitializeContext'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: final link failed
collect2: error: ld returned 1 exit status
make[1]: *** [Makefile:21: fiovb] Error 1
make[1]: Leaving directory '/workspace/benchmark/optee-fiovb/host'
make: *** [Makefile:17: all] Error 2
make: Entering directory '/workspace/benchmark/optee-fiovb/ta'
make: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'entry.o'.  Stop.
make: Leaving directory '/workspace/benchmark/optee-fiovb/ta'
-- The C compiler identification is GNU 11.4.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/arm-linux-gnueabihf-gcc - skipped
-- Detecting C compile features
-- Detecting C compile features - done
CMake Error at CMakeLists.txt:31 (install):
  install FILES given no DESTINATION!


CMake Warning (dev) in CMakeLists.txt:
  No cmake_minimum_required command is present.  A line of code such as

    cmake_minimum_required(VERSION 3.22)

  should be added at the top of the file.  The version specified may be lower
  if you wish to support older CMake versions for this project.  For more
  information run "cmake --help-policy CMP0000".
This warning is for project developers.  Use -Wno-dev to suppress it.

-- Configuring incomplete, errors occurred!
See also "/workspace/benchmark/optee-fiovb/build/CMakeFiles/CMakeOutput.log".
gmake: Makefile: No such file or directory
gmake: *** No rule to make target 'Makefile'.  Stop.
make: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'entry.o'.  Stop.
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[INFO] RAG mode enabled. Initializing RAG system...
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
使用中のLLMプロバイダー: openai
呼び出し済み外部 API を抽出中...
外部 API 関数: 12 個
外部 API 関数をシンクとして解析中...
[DEBUG] Searching for API: TEE_CloseAndDeletePersistentObject1
[DEBUG] Searching for API: TEE_CloseObject
[DEBUG] Searching for API: TEE_CreatePersistentObject
[DEBUG] Searching for API: TEE_Free
[DEBUG] Searching for API: TEE_Malloc
[DEBUG] Searching for API: TEE_MemMove
[DEBUG] Searching for API: TEE_OpenPersistentObject
[DEBUG] Searching for API: TEE_ReadObjectData
[DEBUG] Searching for API: strcmp
[DEBUG] Searching for API: strlen
[DEBUG] Searching for API: strncmp
[DEBUG] Searching for API: strtoul
抽出されたシンク候補: 27 個
結果を /workspace/benchmark/optee-fiovb/ta/results/ta_sinks.json に保存しました
[DEBUG] Include paths:
  ✓ /workspace/benchmark/optee-fiovb/ta
  ✓ /workspace/benchmark/optee-fiovb/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/optee-fiovb/ta/entry.c
  Args: -I/workspace/benchmark/optee-fiovb/ta -I/workspace/benchmark/optee-fiovb/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[find_sink_calls] 35 call sites → /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerable_destinations.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/optee-fiovb/ta
  ✓ /workspace/benchmark/optee-fiovb/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/optee-fiovb/ta/entry.c
  Args: -I/workspace/benchmark/optee-fiovb/ta -I/workspace/benchmark/optee-fiovb/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[generate_call_graph_advanced] 58 edges, 16 functions → /workspace/benchmark/optee-fiovb/ta/results/ta_call_graph.json
[DEBUG] No parameter dependency detected, but tracing callers anyway
[DEBUG] Include paths:
  ✓ /workspace/benchmark/optee-fiovb/ta
  ✓ /workspace/benchmark/optee-fiovb/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/optee-fiovb/ta/entry.c
  Args: -I/workspace/benchmark/optee-fiovb/ta -I/workspace/benchmark/optee-fiovb/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[extract_sink_calls] 35 entries → /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerable_destinations.json
[DEBUG] 入力チェーン数: 35
[DEBUG] ソース関数マッピング: {'TA_InvokeCommandEntryPoint': [], 'TA_OpenSessionEntryPoint': []}
[DEBUG] ソース関数: ['TA_InvokeCommandEntryPoint', 'TA_OpenSessionEntryPoint']
[DEBUG] ステップ1後: 73 CDFs
[DEBUG] ステップ2後: 35 CDFs（同じVD+ソースの最長チェーンのみ）
[DEBUG] ステップ3後: 35 CDFs（0 個のサブチェーンを削除）
[DEBUG] ステップ4: 25 グループ
[DEBUG] ステップ4後: 25 CDFs（9 グループがマージされた）
[DEBUG] 最終的な危険フロー:
  - strlen at line 29, params=[0]: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_rollback_protected -> read_value -> get_named_object_name -> strlen
  - TEE_MemMove at line 36, params=[0, 2]: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_rollback_protected -> read_value -> get_named_object_name -> TEE_MemMove
  - TEE_MemMove at line 39, params=[0, 2]: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_rollback_protected -> read_value -> get_named_object_name -> TEE_MemMove
  - strcmp at line 58, params=[0, 1]: TA_InvokeCommandEntryPoint -> write_persist_value -> check_valid_value -> strcmp
  - TEE_CreatePersistentObject at line 89, params=[2, 4, 5]: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> write_value -> TEE_CreatePersistentObject
  - TEE_OpenPersistentObject at line 121, params=[2, 3]: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_rollback_protected -> read_value -> TEE_OpenPersistentObject
  - TEE_ReadObjectData at line 128, params=[1, 2]: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_rollback_protected -> read_value -> TEE_ReadObjectData
  - TEE_OpenPersistentObject at line 152, params=[2, 3]: TA_InvokeCommandEntryPoint -> delete_persist_value -> delete_value -> TEE_OpenPersistentObject
  - strlen at line 173, params=[0]: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_rollback_protected -> strlen
  - strlen at line 192, params=[0]: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_version_incremental -> strlen
  - strtoul at line 201, params=[0]: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_version_incremental -> strtoul
  - strtoul at line 202, params=[0]: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_version_incremental -> strtoul
  - strlen at line 222, params=[0]: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> strlen
  - strncmp at line 260, params=[2]: TA_InvokeCommandEntryPoint -> write_persist_value -> strncmp
  - strlen at line 260, params=[0]: TA_InvokeCommandEntryPoint -> write_persist_value -> strlen
  - TEE_Malloc at line 264, params=[0]: TA_InvokeCommandEntryPoint -> write_persist_value -> TEE_Malloc
  - TEE_MemMove at line 268, params=[0, 2]: TA_InvokeCommandEntryPoint -> write_persist_value -> TEE_MemMove
  - strncmp at line 281, params=[2]: TA_InvokeCommandEntryPoint -> write_persist_value -> strncmp
  - strlen at line 281, params=[0]: TA_InvokeCommandEntryPoint -> write_persist_value -> strlen
  - TEE_Free at line 289, params=[0]: TA_InvokeCommandEntryPoint -> write_persist_value -> TEE_Free
  - TEE_Malloc at line 320, params=[0]: TA_InvokeCommandEntryPoint -> read_persist_value -> TEE_Malloc
  - TEE_MemMove at line 326, params=[0, 2]: TA_InvokeCommandEntryPoint -> read_persist_value -> TEE_MemMove
  - TEE_Free at line 331, params=[0]: TA_InvokeCommandEntryPoint -> read_persist_value -> TEE_Free
  - strncmp at line 356, params=[2]: TA_InvokeCommandEntryPoint -> delete_persist_value -> strncmp
  - strlen at line 356, params=[0]: TA_InvokeCommandEntryPoint -> delete_persist_value -> strlen

[generate_candidate_flows] 25 件 → /workspace/benchmark/optee-fiovb/ta/results/ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/secvideo_demo/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/secvideo_demo/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/secvideo_demo/ta/results/ta_chains.json  (cwd=/workspace/benchmark/secvideo_demo/ta)
[phase3.6] → /workspace/benchmark/secvideo_demo/ta/results/ta_chains.json

[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/extract_sink_calls.py --compile-db /workspace/benchmark/secvideo_demo/ta/compile_commands.json --sinks /workspace/benchmark/secvideo_demo/ta/results/ta_sinks.json --output /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/secvideo_demo/ta)
[phase3.7] → /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerable_destinations.json

[phase5_command] → python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/secvideo_demo/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/secvideo_demo/ta/results/ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/secvideo_demo/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/secvideo_demo/ta/results/ta_candidate_flows.json  (cwd=/workspace/benchmark/secvideo_demo/ta)
[phase5 ] → /workspace/benchmark/secvideo_demo/ta/results/ta_candidate_flows.json

[INFO] $ /usr/bin/python3 /workspace/src/analyze_vulnerabilities/taint_analyzer.py --flows /workspace/benchmark/secvideo_demo/ta/results/ta_candidate_flows.json --phase12 /workspace/benchmark/secvideo_demo/ta/results/ta_phase12.json --output /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerabilities.json  (cwd=/workspace/benchmark/secvideo_demo/ta)
[phase6 ] → /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerabilities.json

[INFO] $ /usr/bin/python3 /workspace/src/report/generate_report.py --vulnerabilities /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/secvideo_demo/ta/results/ta_phase12.json --project-name secvideo_demo --output /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerability_report.html  (cwd=/workspace/benchmark/secvideo_demo/ta)
[phase7 ] → /workspace/benchmark/secvideo_demo/ta/results/ta_vulnerability_report.html


=== Project: optee-fiovb / TA: ta ===
[INFO] $ bear -- make  (cwd=/workspace/benchmark/optee-fiovb)
[WARN]   ↳ rc=2
[INFO] $ bear -- make -C ta V=1  (cwd=/workspace/benchmark/optee-fiovb)
[WARN]   ↳ rc=2
[INFO] $ cmake -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -Bbuild -H.  (cwd=/workspace/benchmark/optee-fiovb)
[WARN]   ↳ rc=1
[INFO] $ cmake --build build  (cwd=/workspace/benchmark/optee-fiovb)
[WARN]   ↳ rc=2
[INFO] $ bear -- make  (cwd=/workspace/benchmark/optee-fiovb/ta)
[WARN]   ↳ rc=2
[WARN] build failed/empty → dummy DB
[INFO] ★ dummy DB 1 entries → /workspace/benchmark/optee-fiovb/ta/compile_commands_full.json
[INFO] TA DB saved: /workspace/benchmark/optee-fiovb/ta/compile_commands.json  entries=1
[DEBUG] Include paths:
  ✓ /workspace/benchmark/optee-fiovb/ta
  ✓ /workspace/benchmark/optee-fiovb/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/optee-fiovb/ta/entry.c
  Args: -I/workspace/benchmark/optee-fiovb/ta -I/workspace/benchmark/optee-fiovb/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[phase1-2] → /workspace/benchmark/optee-fiovb/ta/results/ta_phase12.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/identify_sinks.py -i /workspace/benchmark/optee-fiovb/ta/results/ta_phase12.json -o /workspace/benchmark/optee-fiovb/ta/results/ta_sinks.json  (cwd=/workspace/benchmark/optee-fiovb/ta)
[phase3 ] → /workspace/benchmark/optee-fiovb/ta/results/ta_sinks.json

[phase3.1] → python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/optee-fiovb/ta/compile_commands.json --sinks /workspace/benchmark/optee-fiovb/ta/results/ta_sinks.json --output /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/optee-fiovb/ta/compile_commands.json --sinks /workspace/benchmark/optee-fiovb/ta/results/ta_sinks.json --output /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/optee-fiovb/ta)
[phase3.4] → /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerable_destinations.json

[phase3.2] → python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/optee-fiovb/ta/compile_commands.json --output /workspace/benchmark/optee-fiovb/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/optee-fiovb/ta/compile_commands.json --output /workspace/benchmark/optee-fiovb/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/optee-fiovb/ta)
[phase3.5] → /workspace/benchmark/optee-fiovb/ta/results/ta_call_graph.json

[phase3.3] → python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/optee-fiovb/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/optee-fiovb/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/optee-fiovb/ta/results/ta_chains.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/optee-fiovb/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/optee-fiovb/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/optee-fiovb/ta/results/ta_chains.json  (cwd=/workspace/benchmark/optee-fiovb/ta)
[phase3.6] → /workspace/benchmark/optee-fiovb/ta/results/ta_chains.json

[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/extract_sink_calls.py --compile-db /workspace/benchmark/optee-fiovb/ta/compile_commands.json --sinks /workspace/benchmark/optee-fiovb/ta/results/ta_sinks.json --output /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/optee-fiovb/ta)
[phase3.7] → /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerable_destinations.json

[phase5_command] → python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/optee-fiovb/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/optee-fiovb/ta/results/ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/optee-fiovb/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/optee-fiovb/ta/results/ta_candidate_flows.json  (cwd=/workspace/benchmark/optee-fiovb/ta)
[phase5 ] → /workspace/benchmark/optee-fiovb/ta/results/ta_candidate_flows.json

/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[DEBUG] Using prompts directory: /workspace/prompts/vulnerabilities_prompt
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
[DEBUG] RAG system already initialized
使用中のLLMプロバイダー: openai
[taint_analyzer] 25 個の候補フローを解析中...
  [1/25] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_rollback_protected -> read_value -> get_named_object_name -> strlen
[DEBUG] Loaded prompt: taint_start.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=strlen, param_index=0
[DEBUG] Attempting to get RAG context for strlen
[DEBUG] Retrieved RAG context for strlen (param 0): 5042 chars
[DEBUG] Loaded prompt: taint_middle_with_rag.txt
[DEBUG] Using RAG template for strlen
[DEBUG] Loaded prompt: taint_end.txt
  [2/25] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_rollback_protected -> read_value -> get_named_object_name -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Loaded prompt: taint_middle_multi_params_with_rag.txt
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [3/25] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_rollback_protected -> read_value -> get_named_object_name -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [4/25] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> check_valid_value -> strcmp
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for strcmp (param 0): 2165 chars
[DEBUG] Using multi-param RAG template for strcmp
  [5/25] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> write_value -> TEE_CreatePersistentObject
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_CreatePersistentObject (param 2): 1987 chars
[DEBUG] Using multi-param RAG template for TEE_CreatePersistentObject
  [6/25] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_rollback_protected -> read_value -> TEE_OpenPersistentObject
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_OpenPersistentObject (param 2): 2985 chars
[DEBUG] Using multi-param RAG template for TEE_OpenPersistentObject
  [7/25] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_rollback_protected -> read_value -> TEE_ReadObjectData
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_ReadObjectData (param 1): 3323 chars
[DEBUG] Using multi-param RAG template for TEE_ReadObjectData
  [8/25] チェーン: TA_InvokeCommandEntryPoint -> delete_persist_value -> delete_value -> TEE_OpenPersistentObject
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_OpenPersistentObject (param 2): 2985 chars
[DEBUG] Using multi-param RAG template for TEE_OpenPersistentObject
  [9/25] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_rollback_protected -> strlen
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=strlen, param_index=0
[DEBUG] Attempting to get RAG context for strlen
[DEBUG] Retrieved RAG context for strlen (param 0): 5042 chars
[DEBUG] Using RAG template for strlen
  [10/25] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_version_incremental -> strlen
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=strlen, param_index=0
[DEBUG] Attempting to get RAG context for strlen
[DEBUG] Retrieved RAG context for strlen (param 0): 5042 chars
[DEBUG] Using RAG template for strlen
  [11/25] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_version_incremental -> strtoul
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=strtoul, param_index=0
[DEBUG] Attempting to get RAG context for strtoul
[DEBUG] Retrieved RAG context for strtoul (param 0): 5886 chars
[DEBUG] Using RAG template for strtoul
  [12/25] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> is_version_incremental -> strtoul
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=strtoul, param_index=0
[DEBUG] Attempting to get RAG context for strtoul
[DEBUG] Retrieved RAG context for strtoul (param 0): 5886 chars
[DEBUG] Using RAG template for strtoul
  [13/25] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> increase_boot_firmware -> strlen
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=strlen, param_index=0
[DEBUG] Attempting to get RAG context for strlen
[DEBUG] Retrieved RAG context for strlen (param 0): 5042 chars
[DEBUG] Using RAG template for strlen
  [14/25] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> strncmp
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=strncmp, param_index=2
[DEBUG] Attempting to get RAG context for strncmp
[DEBUG] Retrieved RAG context for strncmp (param 2): 5293 chars
[DEBUG] Using RAG template for strncmp
  [15/25] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> strlen
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=strlen, param_index=0
[DEBUG] Attempting to get RAG context for strlen
[DEBUG] Retrieved RAG context for strlen (param 0): 5042 chars
[DEBUG] Using RAG template for strlen
  [16/25] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Malloc
[DEBUG] Retrieved RAG context for TEE_Malloc (param 0): 354 chars
[DEBUG] Using RAG template for TEE_Malloc
  [17/25] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [18/25] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> strncmp
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=strncmp, param_index=2
[DEBUG] Attempting to get RAG context for strncmp
[DEBUG] Retrieved RAG context for strncmp (param 2): 5293 chars
[DEBUG] Using RAG template for strncmp
  [19/25] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> strlen
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=strlen, param_index=0
[DEBUG] Attempting to get RAG context for strlen
[DEBUG] Retrieved RAG context for strlen (param 0): 5042 chars
[DEBUG] Using RAG template for strlen
  [20/25] チェーン: TA_InvokeCommandEntryPoint -> write_persist_value -> TEE_Free
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Free, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Free
[DEBUG] Retrieved RAG context for TEE_Free (param 0): 5059 chars
[DEBUG] Using RAG template for TEE_Free
  [21/25] チェーン: TA_InvokeCommandEntryPoint -> read_persist_value -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Malloc
[DEBUG] Retrieved RAG context for TEE_Malloc (param 0): 354 chars
[DEBUG] Using RAG template for TEE_Malloc
  [22/25] チェーン: TA_InvokeCommandEntryPoint -> read_persist_value -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [23/25] チェーン: TA_InvokeCommandEntryPoint -> read_persist_value -> TEE_Free
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Free, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Free
[DEBUG] Retrieved RAG context for TEE_Free (param 0): 5059 chars
[DEBUG] Using RAG template for TEE_Free
  [24/25] チェーン: TA_InvokeCommandEntryPoint -> delete_persist_value -> strncmp
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=strncmp, param_index=2
[DEBUG] Attempting to get RAG context for strncmp
[DEBUG] Retrieved RAG context for strncmp (param 2): 5293 chars
[DEBUG] Using RAG template for strncmp
  [25/25] チェーン: TA_InvokeCommandEntryPoint -> delete_persist_value -> strlen
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=strlen, param_index=0
[DEBUG] Attempting to get RAG context for strlen
[DEBUG] Retrieved RAG context for strlen (param 0): 5042 chars
[DEBUG] Using RAG template for strlen
[taint_analyzer] 解析完了: 13 件の脆弱性を検出
  結果: /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerabilities.json
  ログ: /workspace/benchmark/optee-fiovb/ta/results/taint_analysis_log.txt
[generate_report] HTMLレポートを生成しました: /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerability_report.html
  検出脆弱性数: 13
  AI対話履歴を含めました: /workspace/benchmark/optee-fiovb/ta/results/taint_analysis_log.txt
  対話チェーン数: 21
make -C host CROSS_COMPILE="arm-linux-gnueabihf-" --no-builtin-variables  \
	TEEC_EXPORT=/workspace/benchmark/optee-sdp/../../optee_client/out/export
make[1]: Entering directory '/workspace/benchmark/optee-sdp/host'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/workspace/benchmark/optee-sdp/host'
make -C ta CROSS_COMPILE="arm-linux-gnueabihf-" LDFLAGS="" \
	TA_DEV_KIT_DIR=/workspace/benchmark/optee-sdp/../../optee_os/out/arm/export-ta_arm32
make[1]: Entering directory '/workspace/benchmark/optee-sdp/ta'
make[1]: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'sdp_ta.o'.  Stop.
make[1]: Leaving directory '/workspace/benchmark/optee-sdp/ta'
make: *** [Makefile:13: all] Error 2
make: Entering directory '/workspace/benchmark/optee-sdp/ta'
make: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'sdp_ta.o'.  Stop.
make: Leaving directory '/workspace/benchmark/optee-sdp/ta'
make: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'sdp_ta.o'.  Stop.
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[INFO] RAG mode enabled. Initializing RAG system...
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
使用中のLLMプロバイダー: openai
呼び出し済み外部 API を抽出中...
外部 API 関数: 13 個
外部 API 関数をシンクとして解析中...
[DEBUG] Searching for API: memset
[DEBUG] Searching for API: platform_add_device_to_region
[DEBUG] Searching for API: platform_check_permissions
[DEBUG] Searching for API: platform_create_region
[DEBUG] Searching for API: platform_destroy_region
[DEBUG] Searching for API: platform_dump_device
[DEBUG] Searching for API: platform_dump_status
[DEBUG] Searching for API: platform_find_device_by_name
[DEBUG] Searching for API: platform_find_region_by_id
[DEBUG] Searching for API: platform_init
[DEBUG] Searching for API: platform_remove_device_from_region
[DEBUG] Searching for API: snprintf
[DEBUG] Searching for API: strcmp
抽出されたシンク候補: 37 個
結果を /workspace/benchmark/optee-sdp/ta/results/ta_sinks.json に保存しました
[DEBUG] Include paths:
  ✓ /workspace/benchmark/optee-sdp/ta
  ✗ /workspace/benchmark/optee-sdp/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/optee-sdp/ta/sdp_ta.c
  Args: -I/workspace/benchmark/optee-sdp/ta -I/workspace/benchmark/optee-sdp/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/optee-sdp/ta/platform/stub.c
  Args: -I/workspace/benchmark/optee-sdp/ta -I/workspace/benchmark/optee-sdp/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[find_sink_calls] 59 call sites → /workspace/benchmark/optee-sdp/ta/results/ta_vulnerable_destinations.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/optee-sdp/ta
  ✗ /workspace/benchmark/optee-sdp/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/optee-sdp/ta/sdp_ta.c
  Args: -I/workspace/benchmark/optee-sdp/ta -I/workspace/benchmark/optee-sdp/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/optee-sdp/ta/platform/stub.c
  Args: -I/workspace/benchmark/optee-sdp/ta -I/workspace/benchmark/optee-sdp/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[generate_call_graph_advanced] 34 edges, 26 functions → /workspace/benchmark/optee-sdp/ta/results/ta_call_graph.json
[DEBUG] No parameter dependency detected, but tracing callers anyway
[DEBUG] No parameter dependency detected, but tracing callers anyway
[DEBUG] No parameter dependency detected, but tracing callers anyway
[DEBUG] No parameter dependency detected, but tracing callers anyway
[DEBUG] No parameter dependency detected, but tracing callers anyway
[DEBUG] Include paths:
  ✓ /workspace/benchmark/optee-sdp/ta
  ✗ /workspace/benchmark/optee-sdp/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/optee-sdp/ta/sdp_ta.c
  Args: -I/workspace/benchmark/optee-sdp/ta -I/workspace/benchmark/optee-sdp/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/optee-sdp/ta/platform/stub.c
  Args: -I/workspace/benchmark/optee-sdp/ta -I/workspace/benchmark/optee-sdp/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[extract_sink_calls] 59 entries → /workspace/benchmark/optee-sdp/ta/results/ta_vulnerable_destinations.json
[DEBUG] 入力チェーン数: 59
[DEBUG] ソース関数マッピング: {'TA_InvokeCommandEntryPoint': [], 'TA_OpenSessionEntryPoint': []}
[DEBUG] ソース関数: ['TA_InvokeCommandEntryPoint', 'TA_OpenSessionEntryPoint']
[DEBUG] ステップ1後: 54 CDFs
[DEBUG] ステップ2後: 54 CDFs（同じVD+ソースの最長チェーンのみ）
[DEBUG] ステップ3後: 54 CDFs（0 個のサブチェーンを削除）
[DEBUG] ステップ4: 20 グループ
[DEBUG] ステップ4後: 20 CDFs（18 グループがマージされた）
[DEBUG] 最終的な危険フロー:
  - platform_create_region at line 86, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> create_region -> platform_create_region
  - platform_destroy_region at line 108, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> destroy_region -> platform_destroy_region
  - platform_find_device_by_name at line 137, params=[0]: TA_InvokeCommandEntryPoint -> update_region -> platform_find_device_by_name
  - platform_find_region_by_id at line 143, params=[0]: TA_InvokeCommandEntryPoint -> update_region -> platform_find_region_by_id
  - platform_check_permissions at line 150, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> update_region -> platform_check_permissions
  - platform_add_device_to_region at line 155, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> update_region -> platform_add_device_to_region
  - platform_remove_device_from_region at line 157, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> update_region -> platform_remove_device_from_region
  - platform_dump_status at line 173, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status
  - platform_dump_device at line 174, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_device
  - memset at line 112, params=[0, 1]: TA_InvokeCommandEntryPoint -> destroy_region -> platform_destroy_region -> memset
  - strcmp at line 130, params=[0, 1]: TA_InvokeCommandEntryPoint -> update_region -> platform_find_device_by_name -> strcmp
  - snprintf at line 210, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
  - snprintf at line 215, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
  - snprintf at line 220, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
  - snprintf at line 224, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
  - snprintf at line 228, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
  - snprintf at line 235, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
  - snprintf at line 241, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
  - snprintf at line 256, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_device -> snprintf
  - snprintf at line 261, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_device -> snprintf

[generate_candidate_flows] 20 件 → /workspace/benchmark/optee-sdp/ta/results/ta_candidate_flows.json
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[DEBUG] Using prompts directory: /workspace/prompts/vulnerabilities_prompt
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
[DEBUG] RAG system already initialized
使用中のLLMプロバイダー: openai
[taint_analyzer] 20 個の候補フローを解析中...
  [1/20] チェーン: TA_InvokeCommandEntryPoint -> create_region -> platform_create_region
[DEBUG] Loaded prompt: taint_start.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle.txt
[DEBUG] Retrieved RAG context for platform_create_region (param 0): 1281 chars
[DEBUG] Loaded prompt: taint_middle_multi_params_with_rag.txt
[DEBUG] Using multi-param RAG template for platform_create_region
[DEBUG] Loaded prompt: taint_end.txt
  [2/20] チェーン: TA_InvokeCommandEntryPoint -> destroy_region -> platform_destroy_region
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for platform_destroy_region (param 0): 2094 chars
[DEBUG] Using multi-param RAG template for platform_destroy_region
  [3/20] チェーン: TA_InvokeCommandEntryPoint -> update_region -> platform_find_device_by_name
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=platform_find_device_by_name, param_index=0
[DEBUG] Attempting to get RAG context for platform_find_device_by_name
[DEBUG] Retrieved RAG context for platform_find_device_by_name (param 0): 3222 chars
[DEBUG] Loaded prompt: taint_middle_with_rag.txt
[DEBUG] Using RAG template for platform_find_device_by_name
  [4/20] チェーン: TA_InvokeCommandEntryPoint -> update_region -> platform_find_region_by_id
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=platform_find_region_by_id, param_index=0
[DEBUG] Attempting to get RAG context for platform_find_region_by_id
[DEBUG] Retrieved RAG context for platform_find_region_by_id (param 0): 1569 chars
[DEBUG] Using RAG template for platform_find_region_by_id
  [5/20] チェーン: TA_InvokeCommandEntryPoint -> update_region -> platform_check_permissions
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for platform_check_permissions (param 0): 3289 chars
[DEBUG] Using multi-param RAG template for platform_check_permissions
  [6/20] チェーン: TA_InvokeCommandEntryPoint -> update_region -> platform_add_device_to_region
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for platform_add_device_to_region (param 0): 1832 chars
[DEBUG] Using multi-param RAG template for platform_add_device_to_region
  [7/20] チェーン: TA_InvokeCommandEntryPoint -> update_region -> platform_remove_device_from_region
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for platform_remove_device_from_region (param 0): 1832 chars
[DEBUG] Using multi-param RAG template for platform_remove_device_from_region
  [8/20] チェーン: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for platform_dump_status (param 0): 2745 chars
[DEBUG] Using multi-param RAG template for platform_dump_status
  [9/20] チェーン: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_device
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for platform_dump_device (param 0): 4723 chars
[DEBUG] Using multi-param RAG template for platform_dump_device
  [10/20] チェーン: TA_InvokeCommandEntryPoint -> destroy_region -> platform_destroy_region -> memset
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for memset (param 0): 2036 chars
[DEBUG] Using multi-param RAG template for memset
  [11/20] チェーン: TA_InvokeCommandEntryPoint -> update_region -> platform_find_device_by_name -> strcmp
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for strcmp (param 0): 2165 chars
[DEBUG] Using multi-param RAG template for strcmp
  [12/20] チェーン: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for snprintf (param 0): 3172 chars
[DEBUG] Using multi-param RAG template for snprintf
  [13/20] チェーン: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for snprintf (param 0): 3172 chars
[DEBUG] Using multi-param RAG template for snprintf
  [14/20] チェーン: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for snprintf (param 0): 3172 chars
[DEBUG] Using multi-param RAG template for snprintf
  [15/20] チェーン: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for snprintf (param 0): 3172 chars
[DEBUG] Using multi-param RAG template for snprintf
  [16/20] チェーン: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for snprintf (param 0): 3172 chars
[DEBUG] Using multi-param RAG template for snprintf
  [17/20] チェーン: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for snprintf (param 0): 3172 chars
[DEBUG] Using multi-param RAG template for snprintf
  [18/20] チェーン: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_status -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for snprintf (param 0): 3172 chars
[DEBUG] Using multi-param RAG template for snprintf
  [19/20] チェーン: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_device -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for snprintf (param 0): 3172 chars
[DEBUG] Using multi-param RAG template for snprintf
  [20/20] チェーン: TA_InvokeCommandEntryPoint -> dump_status -> platform_dump_device -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for snprintf (param 0): 3172 chars
[DEBUG] Using multi-param RAG template for snprintf
[taint_analyzer] 解析完了: 18 件の脆弱性を検出
  結果: /workspace/benchmark/optee-sdp/ta/results/ta_vulnerabilities.json
  ログ: /workspace/benchmark/optee-sdp/ta/results/taint_analysis_log.txt
[generate_report] HTMLレポートを生成しました: /workspace/benchmark/optee-sdp/ta/results/ta_vulnerability_report.html
  検出脆弱性数: 18
  AI対話履歴を含めました: /workspace/benchmark/optee-sdp/ta/results/taint_analysis_log.txt
  対話チェーン数: 13
make -C host CROSS_COMPILE="arm-linux-gnueabihf-" --no-builtin-variables \
	TEEC_EXPORT=/workspace/benchmark/Lenet5_in_OPTEE/../../optee_client/out/export
make[1]: Entering directory '/workspace/benchmark/Lenet5_in_OPTEE/host'
arm-linux-gnueabihf-gcc -o optee_lenet5 main.o -lteec -L/workspace/benchmark/Lenet5_in_OPTEE/../../optee_client/out/export/lib
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: main.o: relocation R_ARM_THM_MOVW_ABS_NC against `a local symbol' can not be used when making a shared object; recompile with -fPIC
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: main.o(.text+0x18): unresolvable R_ARM_THM_CALL relocation against symbol `fopen@@GLIBC_2.4'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: final link failed
collect2: error: ld returned 1 exit status
make[1]: *** [makefile:21: optee_lenet5] Error 1
make[1]: Leaving directory '/workspace/benchmark/Lenet5_in_OPTEE/host'
make: *** [Makefile:12: all] Error 2
make: Entering directory '/workspace/benchmark/Lenet5_in_OPTEE/ta'
make: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'lenet5_ta.o'.  Stop.
make: Leaving directory '/workspace/benchmark/Lenet5_in_OPTEE/ta'
-- The C compiler identification is GNU 11.4.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/arm-linux-gnueabihf-gcc - skipped
-- Detecting C compile features
-- Detecting C compile features - done
CMake Warning (dev) in CMakeLists.txt:
  No cmake_minimum_required command is present.  A line of code such as

    cmake_minimum_required(VERSION 3.22)

  should be added at the top of the file.  The version specified may be lower
  if you wish to support older CMake versions for this project.  For more
  information run "cmake --help-policy CMP0000".
This warning is for project developers.  Use -Wno-dev to suppress it.

-- Configuring done
-- Generating done
-- Build files have been written to: /workspace/benchmark/Lenet5_in_OPTEE/build
[INFO] $ /usr/bin/python3 /workspace/src/analyze_vulnerabilities/taint_analyzer.py --flows /workspace/benchmark/optee-fiovb/ta/results/ta_candidate_flows.json --phase12 /workspace/benchmark/optee-fiovb/ta/results/ta_phase12.json --output /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerabilities.json  (cwd=/workspace/benchmark/optee-fiovb/ta)
[phase6 ] → /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerabilities.json

[INFO] $ /usr/bin/python3 /workspace/src/report/generate_report.py --vulnerabilities /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/optee-fiovb/ta/results/ta_phase12.json --project-name optee-fiovb --output /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerability_report.html  (cwd=/workspace/benchmark/optee-fiovb/ta)
[phase7 ] → /workspace/benchmark/optee-fiovb/ta/results/ta_vulnerability_report.html


=== Project: optee-sdp / TA: ta ===
[INFO] $ bear -- make  (cwd=/workspace/benchmark/optee-sdp)
[WARN]   ↳ rc=2
[INFO] $ bear -- make -C ta V=1  (cwd=/workspace/benchmark/optee-sdp)
[WARN]   ↳ rc=2
[INFO] $ bear -- make  (cwd=/workspace/benchmark/optee-sdp/ta)
[WARN]   ↳ rc=2
[WARN] build failed/empty → dummy DB
[INFO] ★ dummy DB 2 entries → /workspace/benchmark/optee-sdp/ta/compile_commands_full.json
[INFO] TA DB saved: /workspace/benchmark/optee-sdp/ta/compile_commands.json  entries=2
[DEBUG] Include paths:
  ✓ /workspace/benchmark/optee-sdp/ta
  ✗ /workspace/benchmark/optee-sdp/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/optee-sdp/ta/sdp_ta.c
  Args: -I/workspace/benchmark/optee-sdp/ta -I/workspace/benchmark/optee-sdp/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/optee-sdp/ta/platform/stub.c
  Args: -I/workspace/benchmark/optee-sdp/ta -I/workspace/benchmark/optee-sdp/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[phase1-2] → /workspace/benchmark/optee-sdp/ta/results/ta_phase12.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/identify_sinks.py -i /workspace/benchmark/optee-sdp/ta/results/ta_phase12.json -o /workspace/benchmark/optee-sdp/ta/results/ta_sinks.json  (cwd=/workspace/benchmark/optee-sdp/ta)
[phase3 ] → /workspace/benchmark/optee-sdp/ta/results/ta_sinks.json

[phase3.1] → python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/optee-sdp/ta/compile_commands.json --sinks /workspace/benchmark/optee-sdp/ta/results/ta_sinks.json --output /workspace/benchmark/optee-sdp/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/optee-sdp/ta/compile_commands.json --sinks /workspace/benchmark/optee-sdp/ta/results/ta_sinks.json --output /workspace/benchmark/optee-sdp/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/optee-sdp/ta)
[phase3.4] → /workspace/benchmark/optee-sdp/ta/results/ta_vulnerable_destinations.json

[phase3.2] → python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/optee-sdp/ta/compile_commands.json --output /workspace/benchmark/optee-sdp/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/optee-sdp/ta/compile_commands.json --output /workspace/benchmark/optee-sdp/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/optee-sdp/ta)
[phase3.5] → /workspace/benchmark/optee-sdp/ta/results/ta_call_graph.json

[phase3.3] → python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/optee-sdp/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/optee-sdp/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/optee-sdp/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/optee-sdp/ta/results/ta_chains.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/optee-sdp/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/optee-sdp/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/optee-sdp/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/optee-sdp/ta/results/ta_chains.json  (cwd=/workspace/benchmark/optee-sdp/ta)
[phase3.6] → /workspace/benchmark/optee-sdp/ta/results/ta_chains.json

[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/extract_sink_calls.py --compile-db /workspace/benchmark/optee-sdp/ta/compile_commands.json --sinks /workspace/benchmark/optee-sdp/ta/results/ta_sinks.json --output /workspace/benchmark/optee-sdp/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/optee-sdp/ta)
[phase3.7] → /workspace/benchmark/optee-sdp/ta/results/ta_vulnerable_destinations.json

[phase5_command] → python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/optee-sdp/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/optee-sdp/ta/results/ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/optee-sdp/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/optee-sdp/ta/results/ta_candidate_flows.json  (cwd=/workspace/benchmark/optee-sdp/ta)
[phase5 ] → /workspace/benchmark/optee-sdp/ta/results/ta_candidate_flows.json

[INFO] $ /usr/bin/python3 /workspace/src/analyze_vulnerabilities/taint_analyzer.py --flows /workspace/benchmark/optee-sdp/ta/results/ta_candidate_flows.json --phase12 /workspace/benchmark/optee-sdp/ta/results/ta_phase12.json --output /workspace/benchmark/optee-sdp/ta/results/ta_vulnerabilities.json  (cwd=/workspace/benchmark/optee-sdp/ta)
[phase6 ] → /workspace/benchmark/optee-sdp/ta/results/ta_vulnerabilities.json

[INFO] $ /usr/bin/python3 /workspace/src/report/generate_report.py --vulnerabilities /workspace/benchmark/optee-sdp/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/optee-sdp/ta/results/ta_phase12.json --project-name optee-sdp --output /workspace/benchmark/optee-sdp/ta/results/ta_vulnerability_report.html  (cwd=/workspace/benchmark/optee-sdp/ta)
[phase7 ] → /workspace/benchmark/optee-sdp/ta/results/ta_vulnerability_report.html


=== Project: Lenet5_in_OPTEE / TA: ta ===
[INFO] $ bear -- make  (cwd=/workspace/benchmark/Lenet5_in_OPTEE)
[WARN]   ↳ rc=2
[INFO] $ bear -- make -C ta V=1  (cwd=/workspace/benchmark/Lenet5_in_OPTEE)
[WARN]   ↳ rc=2
[INFO] $ cmake -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -Bbuild -H.  (cwd=/workspace/benchmark/Lenet5_in_OPTEE)
[WARN] bear が拾えなかった .c がある → dummy 補完
[INFO] ★ dummy DB 4 entries → /workspace/benchmark/Lenet5_in_OPTEE/build/compile_commands.json
[INFO] TA DB saved: /workspace/benchmark/Lenet5_in_OPTEE/ta/compile_commands.json  entries=4
[DEBUG] Include paths:
  ✓ /workspace/benchmark/Lenet5_in_OPTEE/ta
  ✓ /workspace/benchmark/Lenet5_in_OPTEE/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/lenet5_ta.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/e_exp.c
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[INFO] RAG mode enabled. Initializing RAG system...
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
使用中のLLMプロバイダー: openai
呼び出し済み外部 API を抽出中...
外部 API 関数: 9 個
外部 API 関数をシンクとして解析中...
[DEBUG] Searching for API: Initial
[DEBUG] Searching for API: Predict
[DEBUG] Searching for API: TEE_GenerateRandom
[DEBUG] Searching for API: TEE_Malloc
[DEBUG] Searching for API: TrainBatch
[DEBUG] Searching for API: __HI
[DEBUG] Searching for API: __LO
[DEBUG] Searching for API: __ieee754_exp
[DEBUG] Searching for API: __ieee754_sqrt
抽出されたシンク候補: 21 個
結果を /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_sinks.json に保存しました
[DEBUG] Include paths:
  ✓ /workspace/benchmark/Lenet5_in_OPTEE/ta
  ✓ /workspace/benchmark/Lenet5_in_OPTEE/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/lenet5_ta.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/e_exp.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/lenet.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/e_sqrt.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[find_sink_calls] 14 call sites → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerable_destinations.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/Lenet5_in_OPTEE/ta
  ✓ /workspace/benchmark/Lenet5_in_OPTEE/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/lenet5_ta.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/e_exp.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/lenet.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/e_sqrt.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[generate_call_graph_advanced] 42 edges, 23 functions → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_call_graph.json
[DEBUG] No parameter dependency detected, but tracing callers anyway
[DEBUG] No parameter dependency detected, but tracing callers anyway
[DEBUG] No parameter dependency detected, but tracing callers anyway
[DEBUG] No parameter dependency detected, but tracing callers anyway
[DEBUG] No parameter dependency detected, but tracing callers anyway
[DEBUG] No parameter dependency detected, but tracing callers anyway
[DEBUG] Include paths:
  ✓ /workspace/benchmark/Lenet5_in_OPTEE/ta
  ✓ /workspace/benchmark/Lenet5_in_OPTEE/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/lenet5_ta.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/e_exp.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/lenet.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/e_sqrt.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[extract_sink_calls] 14 entries → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerable_destinations.json
[DEBUG] 入力チェーン数: 14
[DEBUG] ソース関数マッピング: {'TA_InvokeCommandEntryPoint': [], 'TA_OpenSessionEntryPoint': []}
[DEBUG] ソース関数: ['TA_InvokeCommandEntryPoint', 'TA_OpenSessionEntryPoint']
[DEBUG] ステップ1後: 15 CDFs
[DEBUG] ステップ2後: 14 CDFs（同じVD+ソースの最長チェーンのみ）
[DEBUG] ステップ3後: 14 CDFs（0 個のサブチェーンを削除）
[DEBUG] ステップ4: 9 グループ
[DEBUG] ステップ4後: 9 CDFs（3 グループがマージされた）
[DEBUG] 最終的な危険フロー:
  - TEE_Malloc at line 93, params=[0]: TA_InvokeCommandEntryPoint -> ta_init -> TEE_Malloc
  - TrainBatch at line 137, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> ta_trainBatch -> TrainBatch
  - Predict at line 156, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> ta_predict -> Predict
  - __ieee754_sqrt at line 196, params=[0]: TA_InvokeCommandEntryPoint -> ta_trainBatch -> TrainBatch -> load_input -> __ieee754_sqrt
  - TEE_GenerateRandom at line 252, params=[0, 1]: TA_InvokeCommandEntryPoint -> ta_init -> Initial -> f64rand -> rand -> TEE_GenerateRandom
  - __ieee754_sqrt at line 305, params=[0]: TA_InvokeCommandEntryPoint -> ta_init -> Initial -> __ieee754_sqrt
  - __ieee754_sqrt at line 306, params=[0]: TA_InvokeCommandEntryPoint -> ta_init -> Initial -> __ieee754_sqrt
  - __ieee754_sqrt at line 307, params=[0]: TA_InvokeCommandEntryPoint -> ta_init -> Initial -> __ieee754_sqrt
  - __ieee754_sqrt at line 308, params=[0]: TA_InvokeCommandEntryPoint -> ta_init -> Initial -> __ieee754_sqrt

[generate_candidate_flows] 9 件 → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_candidate_flows.json
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[DEBUG] Using prompts directory: /workspace/prompts/vulnerabilities_prompt
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
[DEBUG] RAG system already initialized
使用中のLLMプロバイダー: openai
[taint_analyzer] 9 個の候補フローを解析中...
  [1/9] チェーン: TA_InvokeCommandEntryPoint -> ta_init -> TEE_Malloc
[DEBUG] Loaded prompt: taint_start.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle.txt
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Malloc
[DEBUG] Retrieved RAG context for TEE_Malloc (param 0): 354 chars
[DEBUG] Loaded prompt: taint_middle_with_rag.txt
[DEBUG] Using RAG template for TEE_Malloc
[DEBUG] Loaded prompt: taint_end.txt
  [2/9] チェーン: TA_InvokeCommandEntryPoint -> ta_trainBatch -> TrainBatch
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TrainBatch (param 0): 3918 chars
[DEBUG] Loaded prompt: taint_middle_multi_params_with_rag.txt
[DEBUG] Using multi-param RAG template for TrainBatch
  [3/9] チェーン: TA_InvokeCommandEntryPoint -> ta_predict -> Predict
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for Predict (param 0): 5293 chars
[DEBUG] Using multi-param RAG template for Predict
  [4/9] チェーン: TA_InvokeCommandEntryPoint -> ta_trainBatch -> TrainBatch -> load_input -> __ieee754_sqrt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=__ieee754_sqrt, param_index=0
[DEBUG] Attempting to get RAG context for __ieee754_sqrt
[DEBUG] Retrieved RAG context for __ieee754_sqrt (param 0): 3855 chars
[DEBUG] Using RAG template for __ieee754_sqrt
  [5/9] チェーン: TA_InvokeCommandEntryPoint -> ta_init -> Initial -> f64rand -> rand -> TEE_GenerateRandom
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_GenerateRandom (param 0): 3907 chars
[DEBUG] Using multi-param RAG template for TEE_GenerateRandom
  [6/9] チェーン: TA_InvokeCommandEntryPoint -> ta_init -> Initial -> __ieee754_sqrt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=__ieee754_sqrt, param_index=0
[DEBUG] Attempting to get RAG context for __ieee754_sqrt
[DEBUG] Retrieved RAG context for __ieee754_sqrt (param 0): 3855 chars
[DEBUG] Using RAG template for __ieee754_sqrt
  [7/9] チェーン: TA_InvokeCommandEntryPoint -> ta_init -> Initial -> __ieee754_sqrt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=__ieee754_sqrt, param_index=0
[DEBUG] Attempting to get RAG context for __ieee754_sqrt
[DEBUG] Retrieved RAG context for __ieee754_sqrt (param 0): 3855 chars
[DEBUG] Using RAG template for __ieee754_sqrt
  [8/9] チェーン: TA_InvokeCommandEntryPoint -> ta_init -> Initial -> __ieee754_sqrt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=__ieee754_sqrt, param_index=0
[DEBUG] Attempting to get RAG context for __ieee754_sqrt
[DEBUG] Retrieved RAG context for __ieee754_sqrt (param 0): 3855 chars
[DEBUG] Using RAG template for __ieee754_sqrt
  [9/9] チェーン: TA_InvokeCommandEntryPoint -> ta_init -> Initial -> __ieee754_sqrt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=__ieee754_sqrt, param_index=0
[DEBUG] Attempting to get RAG context for __ieee754_sqrt
[DEBUG] Retrieved RAG context for __ieee754_sqrt (param 0): 3855 chars
[DEBUG] Using RAG template for __ieee754_sqrt
[taint_analyzer] 解析完了: 4 件の脆弱性を検出
  結果: /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerabilities.json
  ログ: /workspace/benchmark/Lenet5_in_OPTEE/ta/results/taint_analysis_log.txt
[generate_report] HTMLレポートを生成しました: /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerability_report.html
  検出脆弱性数: 4
  AI対話履歴を含めました: /workspace/benchmark/Lenet5_in_OPTEE/ta/results/taint_analysis_log.txt
  対話チェーン数: 6
make -C host CROSS_COMPILE="arm-linux-gnueabihf-" --no-builtin-variables \
	TEEC_EXPORT=/workspace/benchmark/bad-partitioning/../../optee_client/out/export
make[1]: Entering directory '/workspace/benchmark/bad-partitioning/host'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/workspace/benchmark/bad-partitioning/host'
make -C ta CROSS_COMPILE="arm-linux-gnueabihf-" LDFLAGS="" \
	TA_DEV_KIT_DIR=/workspace/benchmark/bad-partitioning/../../optee_os/out/arm/export-ta_arm32
make[1]: Entering directory '/workspace/benchmark/bad-partitioning/ta'
make[1]: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'entry.o'.  Stop.
make[1]: Leaving directory '/workspace/benchmark/bad-partitioning/ta'
make: *** [Makefile:14: all] Error 2
make: Entering directory '/workspace/benchmark/bad-partitioning/ta'
make: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'entry.o'.  Stop.
make: Leaving directory '/workspace/benchmark/bad-partitioning/ta'
make: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'entry.o'.  Stop.
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[INFO] RAG mode enabled. Initializing RAG system...
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
使用中のLLMプロバイダー: openai
呼び出し済み外部 API を抽出中...
外部 API 関数: 7 個
外部 API 関数をシンクとして解析中...
[DEBUG] Searching for API: TEE_Malloc
[DEBUG] Searching for API: TEE_MemCompare
[DEBUG] Searching for API: TEE_MemMove
[DEBUG] Searching for API: TEE_Wait
[DEBUG] Searching for API: snprintf
[DEBUG] Searching for API: strcmp
[DEBUG] Searching for API: strlen
抽出されたシンク候補: 14 個
結果を /workspace/benchmark/bad-partitioning/ta/results/ta_sinks.json に保存しました
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/lenet.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/Lenet5_in_OPTEE/ta/e_sqrt.c
  Args: -I/workspace/benchmark/Lenet5_in_OPTEE/ta -I/workspace/benchmark/Lenet5_in_OPTEE/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[phase1-2] → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_phase12.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/identify_sinks.py -i /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_phase12.json -o /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_sinks.json  (cwd=/workspace/benchmark/Lenet5_in_OPTEE/ta)
[phase3 ] → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_sinks.json

[phase3.1] → python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/Lenet5_in_OPTEE/ta/compile_commands.json --sinks /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_sinks.json --output /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/Lenet5_in_OPTEE/ta/compile_commands.json --sinks /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_sinks.json --output /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/Lenet5_in_OPTEE/ta)
[phase3.4] → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerable_destinations.json

[phase3.2] → python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/Lenet5_in_OPTEE/ta/compile_commands.json --output /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/Lenet5_in_OPTEE/ta/compile_commands.json --output /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/Lenet5_in_OPTEE/ta)
[phase3.5] → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_call_graph.json

[phase3.3] → python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/Lenet5_in_OPTEE/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_chains.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/Lenet5_in_OPTEE/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_chains.json  (cwd=/workspace/benchmark/Lenet5_in_OPTEE/ta)
[phase3.6] → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_chains.json

[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/extract_sink_calls.py --compile-db /workspace/benchmark/Lenet5_in_OPTEE/ta/compile_commands.json --sinks /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_sinks.json --output /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/Lenet5_in_OPTEE/ta)
[phase3.7] → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerable_destinations.json

[phase5_command] → python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_candidate_flows.json  (cwd=/workspace/benchmark/Lenet5_in_OPTEE/ta)
[phase5 ] → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_candidate_flows.json

[INFO] $ /usr/bin/python3 /workspace/src/analyze_vulnerabilities/taint_analyzer.py --flows /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_candidate_flows.json --phase12 /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_phase12.json --output /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerabilities.json  (cwd=/workspace/benchmark/Lenet5_in_OPTEE/ta)
[phase6 ] → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerabilities.json

[INFO] $ /usr/bin/python3 /workspace/src/report/generate_report.py --vulnerabilities /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_phase12.json --project-name Lenet5_in_OPTEE --output /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerability_report.html  (cwd=/workspace/benchmark/Lenet5_in_OPTEE/ta)
[phase7 ] → /workspace/benchmark/Lenet5_in_OPTEE/ta/results/ta_vulnerability_report.html


=== Project: bad-partitioning / TA: ta ===
[INFO] $ bear -- make  (cwd=/workspace/benchmark/bad-partitioning)
[WARN]   ↳ rc=2
[INFO] $ bear -- make -C ta V=1  (cwd=/workspace/benchmark/bad-partitioning)
[WARN]   ↳ rc=2
[INFO] $ bear -- make  (cwd=/workspace/benchmark/bad-partitioning/ta)
[WARN]   ↳ rc=2
[WARN] build failed/empty → dummy DB
[INFO] ★ dummy DB 1 entries → /workspace/benchmark/bad-partitioning/ta/compile_commands_full.json
[INFO] TA DB saved: /workspace/benchmark/bad-partitioning/ta/compile_commands.json  entries=1
[DEBUG] Include paths:
  ✓ /workspace/benchmark/bad-partitioning/ta
  ✓ /workspace/benchmark/bad-partitioning/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/bad-partitioning/ta/entry.c
  Args: -I/workspace/benchmark/bad-partitioning/ta -I/workspace/benchmark/bad-partitioning/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  [3] void function 'produce_i0' should not return a value
  [3] void function 'produce_i0' should not return a value
  [3] void function 'produce_i3' should not return a value
  [3] void function 'produce_s' should not return a value
  [3] void function 'produce_s3' should not return a value
  [3] void function 'produce_s3' should not return a value
[phase1-2] → /workspace/benchmark/bad-partitioning/ta/results/ta_phase12.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/identify_sinks.py -i /workspace/benchmark/bad-partitioning/ta/results/ta_phase12.json -o /workspace/benchmark/bad-partitioning/ta/results/ta_sinks.json  (cwd=/workspace/benchmark/bad-partitioning/ta)
[phase3 ] → /workspace/benchmark/bad-partitioning/ta/results/ta_sinks.json

[phase3.1] → python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/bad-partitioning/ta/compile_commands.json --sinks /workspace/benchmark/bad-partitioning/ta/results/ta_sinks.json --output /workspace/benchmark/bad-partitioning/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[DEBUG] Include paths:
  ✓ /workspace/benchmark/bad-partitioning/ta
  ✓ /workspace/benchmark/bad-partitioning/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/bad-partitioning/ta/entry.c
  Args: -I/workspace/benchmark/bad-partitioning/ta -I/workspace/benchmark/bad-partitioning/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  [3] void function 'produce_i0' should not return a value
  [3] void function 'produce_i0' should not return a value
  [3] void function 'produce_i3' should not return a value
  [3] void function 'produce_s' should not return a value
  [3] void function 'produce_s3' should not return a value
  [3] void function 'produce_s3' should not return a value
[find_sink_calls] 139 call sites → /workspace/benchmark/bad-partitioning/ta/results/ta_vulnerable_destinations.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/bad-partitioning/ta
  ✓ /workspace/benchmark/bad-partitioning/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/bad-partitioning/ta/entry.c
  Args: -I/workspace/benchmark/bad-partitioning/ta -I/workspace/benchmark/bad-partitioning/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  [3] void function 'produce_i0' should not return a value
  [3] void function 'produce_i0' should not return a value
  [3] void function 'produce_i3' should not return a value
  [3] void function 'produce_s' should not return a value
  [3] void function 'produce_s3' should not return a value
  [3] void function 'produce_s3' should not return a value
[generate_call_graph_advanced] 122 edges, 19 functions → /workspace/benchmark/bad-partitioning/ta/results/ta_call_graph.json
  [3] void function 'produce_i0' should not return a value
  [3] void function 'produce_i0' should not return a value
  [3] void function 'produce_i3' should not return a value
  [3] void function 'produce_s' should not return a value
  [3] void function 'produce_s3' should not return a value
  [3] void function 'produce_s3' should not return a value
[DEBUG] Include paths:
  ✓ /workspace/benchmark/bad-partitioning/ta
  ✓ /workspace/benchmark/bad-partitioning/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/bad-partitioning/ta/entry.c
  Args: -I/workspace/benchmark/bad-partitioning/ta -I/workspace/benchmark/bad-partitioning/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  [3] void function 'produce_i0' should not return a value
  [3] void function 'produce_i0' should not return a value
  [3] void function 'produce_i3' should not return a value
  [3] void function 'produce_s' should not return a value
  [3] void function 'produce_s3' should not return a value
  [3] void function 'produce_s3' should not return a value
[extract_sink_calls] 139 entries → /workspace/benchmark/bad-partitioning/ta/results/ta_vulnerable_destinations.json
[DEBUG] 入力チェーン数: 139
[DEBUG] ソース関数マッピング: {'TA_InvokeCommandEntryPoint': [], 'TA_OpenSessionEntryPoint': []}
[DEBUG] ソース関数: ['TA_InvokeCommandEntryPoint', 'TA_OpenSessionEntryPoint']
[DEBUG] ステップ1後: 139 CDFs
[DEBUG] ステップ2後: 139 CDFs（同じVD+ソースの最長チェーンのみ）
[DEBUG] ステップ3後: 139 CDFs（0 個のサブチェーンを削除）
[DEBUG] ステップ4: 73 グループ
[DEBUG] ステップ4後: 73 CDFs（48 グループがマージされた）
[DEBUG] 最終的な危険フロー:
  - TEE_MemMove at line 116, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> TEE_MemMove
  - strlen at line 116, params=[0]: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> strlen
  - snprintf at line 117, params=[1, 2]: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> snprintf
  - snprintf at line 121, params=[1, 2]: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> snprintf
  - snprintf at line 122, params=[1, 2]: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> snprintf
  - snprintf at line 125, params=[1, 2]: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> snprintf
  - snprintf at line 126, params=[1, 2]: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> snprintf
  - TEE_MemMove at line 136, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> output -> produce -> TEE_MemMove
  - strlen at line 136, params=[0]: TA_InvokeCommandEntryPoint -> output -> produce -> strlen
  - snprintf at line 137, params=[1, 2]: TA_InvokeCommandEntryPoint -> output -> produce -> snprintf
  - snprintf at line 143, params=[1, 2]: TA_InvokeCommandEntryPoint -> output -> produce -> snprintf
  - snprintf at line 144, params=[1, 2]: TA_InvokeCommandEntryPoint -> output -> produce -> snprintf
  - snprintf at line 147, params=[1, 2]: TA_InvokeCommandEntryPoint -> output -> produce -> snprintf
  - snprintf at line 148, params=[1, 2]: TA_InvokeCommandEntryPoint -> output -> produce -> snprintf
  - TEE_MemMove at line 154, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> output -> produce_3 -> TEE_MemMove
  - strlen at line 154, params=[0]: TA_InvokeCommandEntryPoint -> output -> produce_3 -> strlen
  - snprintf at line 155, params=[1, 2]: TA_InvokeCommandEntryPoint -> output -> produce_3 -> snprintf
  - TEE_MemMove at line 175, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> output -> TEE_MemMove
  - strlen at line 175, params=[0]: TA_InvokeCommandEntryPoint -> output -> strlen
  - snprintf at line 176, params=[1, 2]: TA_InvokeCommandEntryPoint -> output -> snprintf
  - snprintf at line 184, params=[1, 2]: TA_InvokeCommandEntryPoint -> output -> snprintf
  - snprintf at line 185, params=[1, 2]: TA_InvokeCommandEntryPoint -> output -> snprintf
  - snprintf at line 189, params=[1, 2]: TA_InvokeCommandEntryPoint -> output -> snprintf
  - snprintf at line 190, params=[1, 2]: TA_InvokeCommandEntryPoint -> output -> snprintf
  - snprintf at line 191, params=[1, 2]: TA_InvokeCommandEntryPoint -> output -> snprintf
  - TEE_Malloc at line 198, params=[0]: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> produce_i2 -> TEE_Malloc
  - TEE_Malloc at line 201, params=[0]: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> produce_i2 -> TEE_Malloc
  - TEE_Malloc at line 202, params=[0]: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> produce_i2 -> TEE_Malloc
  - TEE_MemMove at line 208, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> produce_i2 -> TEE_MemMove
  - TEE_MemMove at line 212, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> produce_i2 -> TEE_MemMove
  - TEE_Malloc at line 217, params=[0]: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> TEE_Malloc
  - TEE_Malloc at line 220, params=[0]: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> TEE_Malloc
  - TEE_Malloc at line 221, params=[0]: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> TEE_Malloc
  - TEE_MemMove at line 227, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> TEE_MemMove
  - TEE_MemMove at line 238, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> TEE_MemMove
  - TEE_MemMove at line 239, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> TEE_MemMove
  - TEE_MemMove at line 246, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> TEE_MemMove
  - TEE_Malloc at line 251, params=[0]: TA_InvokeCommandEntryPoint -> input -> produce_i3 -> TEE_Malloc
  - TEE_Malloc at line 254, params=[0]: TA_InvokeCommandEntryPoint -> input -> produce_i3 -> TEE_Malloc
  - TEE_Malloc at line 280, params=[0]: TA_InvokeCommandEntryPoint -> input -> TEE_Malloc
  - TEE_Malloc at line 283, params=[0]: TA_InvokeCommandEntryPoint -> input -> TEE_Malloc
  - TEE_Malloc at line 284, params=[0]: TA_InvokeCommandEntryPoint -> input -> TEE_Malloc
  - TEE_MemMove at line 290, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> input -> TEE_MemMove
  - TEE_MemMove at line 291, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> input -> TEE_MemMove
  - TEE_Malloc at line 303, params=[0]: TA_InvokeCommandEntryPoint -> input -> TEE_Malloc
  - TEE_MemMove at line 306, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> input -> TEE_MemMove
  - TEE_MemMove at line 307, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> input -> TEE_MemMove
  - TEE_MemMove at line 309, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> input -> TEE_MemMove
  - strcmp at line 319, params=[0, 1]: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s -> produce_s2 -> strcmp
  - TEE_MemCompare at line 324, params=[2]: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s -> produce_s2 -> TEE_MemCompare
  - strcmp at line 334, params=[0, 1]: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s -> strcmp
  - TEE_MemCompare at line 340, params=[2]: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s -> TEE_MemCompare
  - TEE_MemMove at line 350, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s -> TEE_MemMove
  - strcmp at line 359, params=[0, 1]: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s3 -> strcmp
  - TEE_MemCompare at line 366, params=[2]: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s3 -> TEE_MemCompare
  - TEE_MemCompare at line 372, params=[2]: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s3 -> TEE_MemCompare
  - TEE_MemCompare at line 378, params=[2]: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s3 -> TEE_MemCompare
  - strcmp at line 384, params=[0, 1]: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s3 -> strcmp
  - strcmp at line 389, params=[0, 1]: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s3 -> strcmp
  - strcmp at line 393, params=[0, 1]: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s3 -> strcmp
  - TEE_MemMove at line 401, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s3 -> TEE_MemMove
  - strcmp at line 403, params=[0, 1]: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s3 -> strcmp
  - strcmp at line 425, params=[0, 1]: TA_InvokeCommandEntryPoint -> shared_memory -> strcmp
  - strcmp at line 432, params=[0, 1]: TA_InvokeCommandEntryPoint -> shared_memory -> strcmp
  - TEE_MemCompare at line 437, params=[2]: TA_InvokeCommandEntryPoint -> shared_memory -> TEE_MemCompare
  - TEE_MemCompare at line 445, params=[2]: TA_InvokeCommandEntryPoint -> shared_memory -> TEE_MemCompare
  - TEE_MemCompare at line 451, params=[2]: TA_InvokeCommandEntryPoint -> shared_memory -> TEE_MemCompare
  - TEE_MemCompare at line 457, params=[2]: TA_InvokeCommandEntryPoint -> shared_memory -> TEE_MemCompare
  - strcmp at line 463, params=[0, 1]: TA_InvokeCommandEntryPoint -> shared_memory -> strcmp
  - strcmp at line 468, params=[0, 1]: TA_InvokeCommandEntryPoint -> shared_memory -> strcmp
  - strcmp at line 472, params=[0, 1]: TA_InvokeCommandEntryPoint -> shared_memory -> strcmp
  - TEE_MemMove at line 485, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> shared_memory -> TEE_MemMove
  - strcmp at line 487, params=[0, 1]: TA_InvokeCommandEntryPoint -> shared_memory -> strcmp

[generate_candidate_flows] 73 件 → /workspace/benchmark/bad-partitioning/ta/results/ta_candidate_flows.json
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[DEBUG] Using prompts directory: /workspace/prompts/vulnerabilities_prompt
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
[DEBUG] RAG system already initialized
使用中のLLMプロバイダー: openai
[taint_analyzer] 73 個の候補フローを解析中...
  [1/73] チェーン: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> TEE_MemMove
[DEBUG] Loaded prompt: taint_start.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Loaded prompt: taint_middle_multi_params_with_rag.txt
[DEBUG] Using multi-param RAG template for TEE_MemMove
[DEBUG] Loaded prompt: taint_end.txt
  [2/73] チェーン: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> strlen
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=strlen, param_index=0
[DEBUG] Attempting to get RAG context for strlen
[DEBUG] Retrieved RAG context for strlen (param 0): 5042 chars
[DEBUG] Loaded prompt: taint_middle_with_rag.txt
[DEBUG] Using RAG template for strlen
  [3/73] チェーン: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for snprintf (param 1): 2176 chars
[DEBUG] Using multi-param RAG template for snprintf
  [4/73] チェーン: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for snprintf (param 1): 2176 chars
[DEBUG] Using multi-param RAG template for snprintf
  [5/73] チェーン: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for snprintf (param 1): 2176 chars
[DEBUG] Using multi-param RAG template for snprintf
  [6/73] チェーン: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for snprintf (param 1): 2176 chars
[DEBUG] Using multi-param RAG template for snprintf
  [7/73] チェーン: TA_InvokeCommandEntryPoint -> output -> produce -> produce_2 -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for snprintf (param 1): 2176 chars
[DEBUG] Using multi-param RAG template for snprintf
  [8/73] チェーン: TA_InvokeCommandEntryPoint -> output -> produce -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [9/73] チェーン: TA_InvokeCommandEntryPoint -> output -> produce -> strlen
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=strlen, param_index=0
[DEBUG] Attempting to get RAG context for strlen
[DEBUG] Retrieved RAG context for strlen (param 0): 5042 chars
[DEBUG] Using RAG template for strlen
  [10/73] チェーン: TA_InvokeCommandEntryPoint -> output -> produce -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for snprintf (param 1): 2176 chars
[DEBUG] Using multi-param RAG template for snprintf
  [11/73] チェーン: TA_InvokeCommandEntryPoint -> output -> produce -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for snprintf (param 1): 2176 chars
[DEBUG] Using multi-param RAG template for snprintf
  [12/73] チェーン: TA_InvokeCommandEntryPoint -> output -> produce -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for snprintf (param 1): 2176 chars
[DEBUG] Using multi-param RAG template for snprintf
  [13/73] チェーン: TA_InvokeCommandEntryPoint -> output -> produce -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for snprintf (param 1): 2176 chars
[DEBUG] Using multi-param RAG template for snprintf
  [14/73] チェーン: TA_InvokeCommandEntryPoint -> output -> produce -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for snprintf (param 1): 2176 chars
[DEBUG] Using multi-param RAG template for snprintf
  [15/73] チェーン: TA_InvokeCommandEntryPoint -> output -> produce_3 -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [16/73] チェーン: TA_InvokeCommandEntryPoint -> output -> produce_3 -> strlen
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=strlen, param_index=0
[DEBUG] Attempting to get RAG context for strlen
[DEBUG] Retrieved RAG context for strlen (param 0): 5042 chars
[DEBUG] Using RAG template for strlen
  [17/73] チェーン: TA_InvokeCommandEntryPoint -> output -> produce_3 -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for snprintf (param 1): 2176 chars
[DEBUG] Using multi-param RAG template for snprintf
  [18/73] チェーン: TA_InvokeCommandEntryPoint -> output -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [19/73] チェーン: TA_InvokeCommandEntryPoint -> output -> strlen
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=strlen, param_index=0
[DEBUG] Attempting to get RAG context for strlen
[DEBUG] Retrieved RAG context for strlen (param 0): 5042 chars
[DEBUG] Using RAG template for strlen
  [20/73] チェーン: TA_InvokeCommandEntryPoint -> output -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for snprintf (param 1): 2176 chars
[DEBUG] Using multi-param RAG template for snprintf
  [21/73] チェーン: TA_InvokeCommandEntryPoint -> output -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for snprintf (param 1): 2176 chars
[DEBUG] Using multi-param RAG template for snprintf
  [22/73] チェーン: TA_InvokeCommandEntryPoint -> output -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for snprintf (param 1): 2176 chars
[DEBUG] Using multi-param RAG template for snprintf
  [23/73] チェーン: TA_InvokeCommandEntryPoint -> output -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for snprintf (param 1): 2176 chars
[DEBUG] Using multi-param RAG template for snprintf
  [24/73] チェーン: TA_InvokeCommandEntryPoint -> output -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for snprintf (param 1): 2176 chars
[DEBUG] Using multi-param RAG template for snprintf
  [25/73] チェーン: TA_InvokeCommandEntryPoint -> output -> snprintf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for snprintf (param 1): 2176 chars
[DEBUG] Using multi-param RAG template for snprintf
  [26/73] チェーン: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> produce_i2 -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Malloc
[DEBUG] Retrieved RAG context for TEE_Malloc (param 0): 354 chars
[DEBUG] Using RAG template for TEE_Malloc
  [27/73] チェーン: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> produce_i2 -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Malloc
[DEBUG] Retrieved RAG context for TEE_Malloc (param 0): 354 chars
[DEBUG] Using RAG template for TEE_Malloc
  [28/73] チェーン: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> produce_i2 -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Malloc
[DEBUG] Retrieved RAG context for TEE_Malloc (param 0): 354 chars
[DEBUG] Using RAG template for TEE_Malloc
  [29/73] チェーン: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> produce_i2 -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [30/73] チェーン: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> produce_i2 -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [31/73] チェーン: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Malloc
[DEBUG] Retrieved RAG context for TEE_Malloc (param 0): 354 chars
[DEBUG] Using RAG template for TEE_Malloc
  [32/73] チェーン: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Malloc
[DEBUG] Retrieved RAG context for TEE_Malloc (param 0): 354 chars
[DEBUG] Using RAG template for TEE_Malloc
  [33/73] チェーン: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Malloc
[DEBUG] Retrieved RAG context for TEE_Malloc (param 0): 354 chars
[DEBUG] Using RAG template for TEE_Malloc
  [34/73] チェーン: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [35/73] チェーン: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [36/73] チェーン: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [37/73] チェーン: TA_InvokeCommandEntryPoint -> input -> produce_i0 -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [38/73] チェーン: TA_InvokeCommandEntryPoint -> input -> produce_i3 -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Malloc
[DEBUG] Retrieved RAG context for TEE_Malloc (param 0): 354 chars
[DEBUG] Using RAG template for TEE_Malloc
  [39/73] チェーン: TA_InvokeCommandEntryPoint -> input -> produce_i3 -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Malloc
[DEBUG] Retrieved RAG context for TEE_Malloc (param 0): 354 chars
[DEBUG] Using RAG template for TEE_Malloc
  [40/73] チェーン: TA_InvokeCommandEntryPoint -> input -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Malloc
[DEBUG] Retrieved RAG context for TEE_Malloc (param 0): 354 chars
[DEBUG] Using RAG template for TEE_Malloc
  [41/73] チェーン: TA_InvokeCommandEntryPoint -> input -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Malloc
[DEBUG] Retrieved RAG context for TEE_Malloc (param 0): 354 chars
[DEBUG] Using RAG template for TEE_Malloc
  [42/73] チェーン: TA_InvokeCommandEntryPoint -> input -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Malloc
[DEBUG] Retrieved RAG context for TEE_Malloc (param 0): 354 chars
[DEBUG] Using RAG template for TEE_Malloc
  [43/73] チェーン: TA_InvokeCommandEntryPoint -> input -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [44/73] チェーン: TA_InvokeCommandEntryPoint -> input -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [45/73] チェーン: TA_InvokeCommandEntryPoint -> input -> TEE_Malloc
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_Malloc, param_index=0
[DEBUG] Attempting to get RAG context for TEE_Malloc
[DEBUG] Retrieved RAG context for TEE_Malloc (param 0): 354 chars
[DEBUG] Using RAG template for TEE_Malloc
  [46/73] チェーン: TA_InvokeCommandEntryPoint -> input -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [47/73] チェーン: TA_InvokeCommandEntryPoint -> input -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [48/73] チェーン: TA_InvokeCommandEntryPoint -> input -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [49/73] チェーン: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s -> produce_s2 -> strcmp
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for strcmp (param 0): 2165 chars
[DEBUG] Using multi-param RAG template for strcmp
  [50/73] チェーン: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s -> produce_s2 -> TEE_MemCompare
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_MemCompare, param_index=2
[DEBUG] Attempting to get RAG context for TEE_MemCompare
[DEBUG] Retrieved RAG context for TEE_MemCompare (param 2): 4728 chars
[DEBUG] Using RAG template for TEE_MemCompare
  [51/73] チェーン: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s -> strcmp
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for strcmp (param 0): 2165 chars
[DEBUG] Using multi-param RAG template for strcmp
  [52/73] チェーン: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s -> TEE_MemCompare
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_MemCompare, param_index=2
[DEBUG] Attempting to get RAG context for TEE_MemCompare
[DEBUG] Retrieved RAG context for TEE_MemCompare (param 2): 4728 chars
[DEBUG] Using RAG template for TEE_MemCompare
  [53/73] チェーン: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [54/73] チェーン: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s3 -> strcmp
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for strcmp (param 0): 2165 chars
[DEBUG] Using multi-param RAG template for strcmp
  [55/73] チェーン: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s3 -> TEE_MemCompare
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_MemCompare, param_index=2
[DEBUG] Attempting to get RAG context for TEE_MemCompare
[DEBUG] Retrieved RAG context for TEE_MemCompare (param 2): 4728 chars
[DEBUG] Using RAG template for TEE_MemCompare
  [56/73] チェーン: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s3 -> TEE_MemCompare
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_MemCompare, param_index=2
[DEBUG] Attempting to get RAG context for TEE_MemCompare
[DEBUG] Retrieved RAG context for TEE_MemCompare (param 2): 4728 chars
[DEBUG] Using RAG template for TEE_MemCompare
  [57/73] チェーン: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s3 -> TEE_MemCompare
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_MemCompare, param_index=2
[DEBUG] Attempting to get RAG context for TEE_MemCompare
[DEBUG] Retrieved RAG context for TEE_MemCompare (param 2): 4728 chars
[DEBUG] Using RAG template for TEE_MemCompare
  [58/73] チェーン: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s3 -> strcmp
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for strcmp (param 0): 2165 chars
[DEBUG] Using multi-param RAG template for strcmp
  [59/73] チェーン: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s3 -> strcmp
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for strcmp (param 0): 2165 chars
[DEBUG] Using multi-param RAG template for strcmp
  [60/73] チェーン: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s3 -> strcmp
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for strcmp (param 0): 2165 chars
[DEBUG] Using multi-param RAG template for strcmp
  [61/73] チェーン: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s3 -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [62/73] チェーン: TA_InvokeCommandEntryPoint -> shared_memory -> produce_s3 -> strcmp
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for strcmp (param 0): 2165 chars
[DEBUG] Using multi-param RAG template for strcmp
  [63/73] チェーン: TA_InvokeCommandEntryPoint -> shared_memory -> strcmp
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for strcmp (param 0): 2165 chars
[DEBUG] Using multi-param RAG template for strcmp
  [64/73] チェーン: TA_InvokeCommandEntryPoint -> shared_memory -> strcmp
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for strcmp (param 0): 2165 chars
[DEBUG] Using multi-param RAG template for strcmp
  [65/73] チェーン: TA_InvokeCommandEntryPoint -> shared_memory -> TEE_MemCompare
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_MemCompare, param_index=2
[DEBUG] Attempting to get RAG context for TEE_MemCompare
[DEBUG] Retrieved RAG context for TEE_MemCompare (param 2): 4728 chars
[DEBUG] Using RAG template for TEE_MemCompare
  [66/73] チェーン: TA_InvokeCommandEntryPoint -> shared_memory -> TEE_MemCompare
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_MemCompare, param_index=2
[DEBUG] Attempting to get RAG context for TEE_MemCompare
[DEBUG] Retrieved RAG context for TEE_MemCompare (param 2): 4728 chars
[DEBUG] Using RAG template for TEE_MemCompare
  [67/73] チェーン: TA_InvokeCommandEntryPoint -> shared_memory -> TEE_MemCompare
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_MemCompare, param_index=2
[DEBUG] Attempting to get RAG context for TEE_MemCompare
[DEBUG] Retrieved RAG context for TEE_MemCompare (param 2): 4728 chars
[DEBUG] Using RAG template for TEE_MemCompare
  [68/73] チェーン: TA_InvokeCommandEntryPoint -> shared_memory -> TEE_MemCompare
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_MemCompare, param_index=2
[DEBUG] Attempting to get RAG context for TEE_MemCompare
[DEBUG] Retrieved RAG context for TEE_MemCompare (param 2): 4728 chars
[DEBUG] Using RAG template for TEE_MemCompare
  [69/73] チェーン: TA_InvokeCommandEntryPoint -> shared_memory -> strcmp
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for strcmp (param 0): 2165 chars
[DEBUG] Using multi-param RAG template for strcmp
  [70/73] チェーン: TA_InvokeCommandEntryPoint -> shared_memory -> strcmp
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for strcmp (param 0): 2165 chars
[DEBUG] Using multi-param RAG template for strcmp
  [71/73] チェーン: TA_InvokeCommandEntryPoint -> shared_memory -> strcmp
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for strcmp (param 0): 2165 chars
[DEBUG] Using multi-param RAG template for strcmp
  [72/73] チェーン: TA_InvokeCommandEntryPoint -> shared_memory -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [73/73] チェーン: TA_InvokeCommandEntryPoint -> shared_memory -> strcmp
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for strcmp (param 0): 2165 chars
[DEBUG] Using multi-param RAG template for strcmp
[taint_analyzer] 解析完了: 50 件の脆弱性を検出
  結果: /workspace/benchmark/bad-partitioning/ta/results/ta_vulnerabilities.json
  ログ: /workspace/benchmark/bad-partitioning/ta/results/taint_analysis_log.txt
[generate_report] HTMLレポートを生成しました: /workspace/benchmark/bad-partitioning/ta/results/ta_vulnerability_report.html
  検出脆弱性数: 50
  AI対話履歴を含めました: /workspace/benchmark/bad-partitioning/ta/results/taint_analysis_log.txt
  対話チェーン数: 30
make -C host CROSS_COMPILE="arm-linux-gnueabihf-" --no-builtin-variables \
	TEEC_EXPORT=/workspace/benchmark/basicAlg_use/../../optee_client/out/export
make[1]: Entering directory '/workspace/benchmark/basicAlg_use/host'
arm-linux-gnueabihf-gcc -I../ta/include -I/workspace/benchmark/basicAlg_use/../../optee_client/out/export/include -I./include -c CryptoVerifyCaTest.c -o CryptoVerifyCaTest.o
arm-linux-gnueabihf-gcc -lteec -L/workspace/benchmark/basicAlg_use/../../optee_client/out/export/lib -o basicAlgUse CryptoVerifyCaDebug.o CryptoVerifyCa.o CryptoVerifyCaTest.o
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCaDebug.o: relocation R_ARM_THM_MOVW_ABS_NC against `a local symbol' can not be used when making a shared object; recompile with -fPIC
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.o: relocation R_ARM_THM_MOVW_ABS_NC against `a local symbol' can not be used when making a shared object; recompile with -fPIC
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.o: in function `l_CryptoVerifyCa_TaskInit':
CryptoVerifyCa.c:(.text+0x24): undefined reference to `TEEC_InitializeContext'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.o: in function `l_CryptoVerifyCa_OpenSession':
CryptoVerifyCa.c:(.text+0x9c): undefined reference to `TEEC_OpenSession'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.o: in function `l_CryptoVerifyCa_SendCommand':
CryptoVerifyCa.c:(.text+0x106): undefined reference to `TEEC_InvokeCommand'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.o: in function `g_CryptoVerifyCa_Random':
CryptoVerifyCa.c:(.text+0x1b4): undefined reference to `TEEC_CloseSession'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.c:(.text+0x1c4): undefined reference to `TEEC_FinalizeContext'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.o: in function `g_CryptoVerifyCa_Sha':
CryptoVerifyCa.c:(.text+0x264): undefined reference to `TEEC_CloseSession'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.c:(.text+0x274): undefined reference to `TEEC_FinalizeContext'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.o: in function `g_CryptoVerifyCa_hmac':
CryptoVerifyCa.c:(.text+0x308): undefined reference to `TEEC_CloseSession'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.c:(.text+0x318): undefined reference to `TEEC_FinalizeContext'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.o: in function `g_CryptoVerifyCa_Aes':
CryptoVerifyCa.c:(.text+0x3c8): undefined reference to `TEEC_CloseSession'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.c:(.text+0x3d8): undefined reference to `TEEC_FinalizeContext'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.o: in function `g_CryptoVerifyCa_Pbkdf':
CryptoVerifyCa.c:(.text+0x466): undefined reference to `TEEC_CloseSession'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.c:(.text+0x476): undefined reference to `TEEC_FinalizeContext'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.o: in function `g_CryptoVerifyCa_Rsa':
CryptoVerifyCa.c:(.text+0x536): undefined reference to `TEEC_CloseSession'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.c:(.text+0x546): undefined reference to `TEEC_FinalizeContext'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.o: in function `g_CryptoVerifyCa_base64':
CryptoVerifyCa.c:(.text+0x5ec): undefined reference to `TEEC_CloseSession'
/usr/lib/gcc-cross/arm-linux-gnueabihf/11/../../../../arm-linux-gnueabihf/bin/ld: CryptoVerifyCa.c:(.text+0x5fc): undefined reference to `TEEC_FinalizeContext'
collect2: error: ld returned 1 exit status
make[1]: *** [Makefile:23: basicAlgUse] Error 1
make[1]: Leaving directory '/workspace/benchmark/basicAlg_use/host'
make: *** [Makefile:12: all] Error 2
make: Entering directory '/workspace/benchmark/basicAlg_use/ta'
make: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'CryptoVerifyTaEntry.o'.  Stop.
make: Leaving directory '/workspace/benchmark/basicAlg_use/ta'
make: *** No rule to make target '/mnt/disk/toolschain/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/lib/gcc/arm-linux-gnueabihf/6.5.0/include/stddef.h', needed by 'CryptoVerifyTaEntry.o'.  Stop.
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[INFO] RAG mode enabled. Initializing RAG system...
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
使用中のLLMプロバイダー: openai
呼び出し済み外部 API を抽出中...
外部 API 関数: 40 個
外部 API 関数をシンクとして解析中...
[DEBUG] Searching for API: TEE_AllocateOperation
[DEBUG] Searching for API: TEE_AllocateTransientObject
[DEBUG] Searching for API: TEE_AsymmetricDecrypt
[DEBUG] Searching for API: TEE_AsymmetricEncrypt
[DEBUG] Searching for API: TEE_AsymmetricSignDigest
[DEBUG] Searching for API: TEE_AsymmetricVerifyDigest
[DEBUG] Searching for API: TEE_CipherDoFinal
[DEBUG] Searching for API: TEE_CipherInit
[DEBUG] Searching for API: TEE_CipherUpdate
[DEBUG] Searching for API: TEE_DeriveKey
[DEBUG] Searching for API: TEE_DigestDoFinal
[DEBUG] Searching for API: TEE_DigestUpdate
[DEBUG] Searching for API: TEE_FreeOperation
[DEBUG] Searching for API: TEE_FreeTransientObject
[DEBUG] Searching for API: TEE_GenerateRandom
[DEBUG] Searching for API: TEE_GetObjectBufferAttribute
[DEBUG] Searching for API: TEE_InitRefAttribute
[DEBUG] Searching for API: TEE_MemFill
[DEBUG] Searching for API: TEE_MemMove
[DEBUG] Searching for API: TEE_PopulateTransientObject
[DEBUG] Searching for API: TEE_SetOperationKey
[DEBUG] Searching for API: UNUSED
[DEBUG] Searching for API: g_CryptoTaAes_AesOper
[DEBUG] Searching for API: g_CryptoTaHandle_Aes
[DEBUG] Searching for API: g_CryptoTaHandle_Pbkdf
[DEBUG] Searching for API: g_CryptoTaHandle_Random
[DEBUG] Searching for API: g_CryptoTaHandle_Rsa
[DEBUG] Searching for API: g_CryptoTaHandle_Sha
[DEBUG] Searching for API: g_CryptoTaHandle_base64
[DEBUG] Searching for API: g_CryptoTaHandle_hmac
[DEBUG] Searching for API: g_CryptoTaHash_hmac
[DEBUG] Searching for API: g_CryptoTaHash_sha
[DEBUG] Searching for API: g_CryptoTaOther_Random
[DEBUG] Searching for API: g_CryptoTaOther_base64
[DEBUG] Searching for API: g_CryptoTaPbkdf_PBKDF2
[DEBUG] Searching for API: g_CryptoTaRsa_rsaDecOper
[DEBUG] Searching for API: g_CryptoTaRsa_rsaEncOper
[DEBUG] Searching for API: g_CryptoTaRsa_rsaSignOper
[DEBUG] Searching for API: g_CryptoTaRsa_rsaVerifyOper
[DEBUG] Searching for API: g_TA_Printf
抽出されたシンク候補: 140 個
結果を /workspace/benchmark/basicAlg_use/ta/results/ta_sinks.json に保存しました
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/bad-partitioning/ta/compile_commands.json --sinks /workspace/benchmark/bad-partitioning/ta/results/ta_sinks.json --output /workspace/benchmark/bad-partitioning/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/bad-partitioning/ta)
[phase3.4] → /workspace/benchmark/bad-partitioning/ta/results/ta_vulnerable_destinations.json

[phase3.2] → python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/bad-partitioning/ta/compile_commands.json --output /workspace/benchmark/bad-partitioning/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/bad-partitioning/ta/compile_commands.json --output /workspace/benchmark/bad-partitioning/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/bad-partitioning/ta)
[phase3.5] → /workspace/benchmark/bad-partitioning/ta/results/ta_call_graph.json

[phase3.3] → python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/bad-partitioning/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/bad-partitioning/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/bad-partitioning/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/bad-partitioning/ta/results/ta_chains.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/bad-partitioning/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/bad-partitioning/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/bad-partitioning/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/bad-partitioning/ta/results/ta_chains.json  (cwd=/workspace/benchmark/bad-partitioning/ta)
[phase3.6] → /workspace/benchmark/bad-partitioning/ta/results/ta_chains.json

[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/extract_sink_calls.py --compile-db /workspace/benchmark/bad-partitioning/ta/compile_commands.json --sinks /workspace/benchmark/bad-partitioning/ta/results/ta_sinks.json --output /workspace/benchmark/bad-partitioning/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/bad-partitioning/ta)
[phase3.7] → /workspace/benchmark/bad-partitioning/ta/results/ta_vulnerable_destinations.json

[phase5_command] → python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/bad-partitioning/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/bad-partitioning/ta/results/ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/bad-partitioning/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/bad-partitioning/ta/results/ta_candidate_flows.json  (cwd=/workspace/benchmark/bad-partitioning/ta)
[phase5 ] → /workspace/benchmark/bad-partitioning/ta/results/ta_candidate_flows.json

[INFO] $ /usr/bin/python3 /workspace/src/analyze_vulnerabilities/taint_analyzer.py --flows /workspace/benchmark/bad-partitioning/ta/results/ta_candidate_flows.json --phase12 /workspace/benchmark/bad-partitioning/ta/results/ta_phase12.json --output /workspace/benchmark/bad-partitioning/ta/results/ta_vulnerabilities.json  (cwd=/workspace/benchmark/bad-partitioning/ta)
[phase6 ] → /workspace/benchmark/bad-partitioning/ta/results/ta_vulnerabilities.json

[INFO] $ /usr/bin/python3 /workspace/src/report/generate_report.py --vulnerabilities /workspace/benchmark/bad-partitioning/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/bad-partitioning/ta/results/ta_phase12.json --project-name bad-partitioning --output /workspace/benchmark/bad-partitioning/ta/results/ta_vulnerability_report.html  (cwd=/workspace/benchmark/bad-partitioning/ta)
[phase7 ] → /workspace/benchmark/bad-partitioning/ta/results/ta_vulnerability_report.html


=== Project: basicAlg_use / TA: ta ===
[INFO] $ bear -- make  (cwd=/workspace/benchmark/basicAlg_use)
[WARN]   ↳ rc=2
[INFO] $ bear -- make -C ta V=1  (cwd=/workspace/benchmark/basicAlg_use)
[WARN]   ↳ rc=2
[INFO] $ bear -- make  (cwd=/workspace/benchmark/basicAlg_use/ta)
[WARN]   ↳ rc=2
[WARN] build failed/empty → dummy DB
[INFO] ★ dummy DB 8 entries → /workspace/benchmark/basicAlg_use/ta/compile_commands_full.json
[INFO] TA DB saved: /workspace/benchmark/basicAlg_use/ta/compile_commands.json  entries=8
[DEBUG] Include paths:
  ✓ /workspace/benchmark/basicAlg_use/ta
  ✓ /workspace/benchmark/basicAlg_use/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaAes.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaEntry.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaRsa.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaHandle.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaOther.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaHash.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaDebug.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaPbkdf2.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[phase1-2] → /workspace/benchmark/basicAlg_use/ta/results/ta_phase12.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/identify_sinks.py -i /workspace/benchmark/basicAlg_use/ta/results/ta_phase12.json -o /workspace/benchmark/basicAlg_use/ta/results/ta_sinks.json  (cwd=/workspace/benchmark/basicAlg_use/ta)
[phase3 ] → /workspace/benchmark/basicAlg_use/ta/results/ta_sinks.json

[DEBUG] Include paths:
  ✓ /workspace/benchmark/basicAlg_use/ta
  ✓ /workspace/benchmark/basicAlg_use/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaAes.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaEntry.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaRsa.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaHandle.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaOther.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaHash.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaDebug.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaPbkdf2.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[find_sink_calls] 206 call sites → /workspace/benchmark/basicAlg_use/ta/results/ta_vulnerable_destinations.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/basicAlg_use/ta
  ✓ /workspace/benchmark/basicAlg_use/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaAes.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaEntry.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaRsa.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaHandle.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaOther.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaHash.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaDebug.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaPbkdf2.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[generate_call_graph_advanced] 219 edges, 34 functions → /workspace/benchmark/basicAlg_use/ta/results/ta_call_graph.json
[DEBUG] Include paths:
  ✓ /workspace/benchmark/basicAlg_use/ta
  ✓ /workspace/benchmark/basicAlg_use/ta/include
  ✓ /workspace/optee_os/out/arm/export-ta_arm32/include
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaAes.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaEntry.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaRsa.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaHandle.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaOther.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaHash.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaDebug.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[DEBUG] Parsing /workspace/benchmark/basicAlg_use/ta/CryptoVerifyTaPbkdf2.c
  Args: -I/workspace/benchmark/basicAlg_use/ta -I/workspace/benchmark/basicAlg_use/ta/include -I/workspace/optee_os/out/arm/export-ta_arm32/include --target=armv7a-none-eabi
  ✓ Parsed successfully (warnings: 0)
[extract_sink_calls] 206 entries → /workspace/benchmark/basicAlg_use/ta/results/ta_vulnerable_destinations.json
[DEBUG] 入力チェーン数: 206
[DEBUG] ソース関数マッピング: {'TA_InvokeCommandEntryPoint': [], 'TA_OpenSessionEntryPoint': []}
[DEBUG] ソース関数: ['TA_InvokeCommandEntryPoint', 'TA_OpenSessionEntryPoint']
[DEBUG] ステップ1後: 243 CDFs
[DEBUG] ステップ2後: 206 CDFs（同じVD+ソースの最長チェーンのみ）
[DEBUG] ステップ3後: 206 CDFs（0 個のサブチェーンを削除）
[DEBUG] ステップ4: 85 グループ
[DEBUG] ステップ4後: 85 CDFs（74 グループがマージされた）
[DEBUG] 最終的な危険フロー:
  - g_TA_Printf at line 113, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper -> g_TA_Printf
  - g_TA_Printf at line 115, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper -> g_TA_Printf
  - g_TA_Printf at line 119, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper -> g_TA_Printf
  - TEE_AllocateOperation at line 122, params=[0]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper -> TEE_AllocateOperation
  - TEE_AllocateTransientObject at line 131, params=[0, 1]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper -> TEE_AllocateTransientObject
  - TEE_InitRefAttribute at line 140, params=[2, 3]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper -> TEE_InitRefAttribute
  - TEE_PopulateTransientObject at line 141, params=[1]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper -> TEE_PopulateTransientObject
  - TEE_SetOperationKey at line 150, params=[0, 1]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper -> TEE_SetOperationKey
  - TEE_CipherInit at line 159, params=[1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper -> TEE_CipherInit
  - TEE_CipherDoFinal at line 199, params=[2, 3, 4]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper -> TEE_CipherDoFinal
  - g_TA_Printf at line 210, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper -> g_TA_Printf
  - g_CryptoTaHandle_Random at line 187, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Random
  - g_CryptoTaHandle_Sha at line 191, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Sha
  - g_CryptoTaHandle_Aes at line 195, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes
  - g_CryptoTaHandle_Pbkdf at line 199, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf
  - g_CryptoTaHandle_Rsa at line 203, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa
  - g_CryptoTaHandle_Rsa at line 207, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa
  - g_CryptoTaHandle_Rsa at line 211, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa
  - g_CryptoTaHandle_Rsa at line 215, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa
  - g_CryptoTaHandle_hmac at line 219, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_hmac
  - g_CryptoTaHandle_base64 at line 223, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_base64
  - TEE_MemFill at line 152, params=[0, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper -> l_CryptoTaRsa_SetRsaPrivateKey -> TEE_MemFill
  - TEE_AllocateTransientObject at line 171, params=[0, 1]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper -> l_CryptoTaRsa_SetRsaPrivateKey -> TEE_AllocateTransientObject
  - TEE_PopulateTransientObject at line 181, params=[1]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper -> l_CryptoTaRsa_SetRsaPrivateKey -> TEE_PopulateTransientObject
  - TEE_MemFill at line 210, params=[0, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaEncOper -> l_CryptoTaRsa_SetRsaPublicKey -> TEE_MemFill
  - TEE_AllocateTransientObject at line 223, params=[0, 1]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaEncOper -> l_CryptoTaRsa_SetRsaPublicKey -> TEE_AllocateTransientObject
  - TEE_PopulateTransientObject at line 232, params=[1]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaEncOper -> l_CryptoTaRsa_SetRsaPublicKey -> TEE_PopulateTransientObject
  - TEE_AllocateOperation at line 267, params=[0]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaEncOper -> TEE_AllocateOperation
  - TEE_SetOperationKey at line 276, params=[0, 1]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaEncOper -> TEE_SetOperationKey
  - TEE_AsymmetricEncrypt at line 285, params=[4, 5, 6]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaEncOper -> TEE_AsymmetricEncrypt
  - g_TA_Printf at line 295, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaEncOper -> g_TA_Printf
  - TEE_AllocateOperation at line 327, params=[0]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper -> TEE_AllocateOperation
  - TEE_SetOperationKey at line 336, params=[0, 1]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper -> TEE_SetOperationKey
  - TEE_AsymmetricDecrypt at line 345, params=[4, 5, 6]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper -> TEE_AsymmetricDecrypt
  - g_TA_Printf at line 355, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper -> g_TA_Printf
  - g_CryptoTaHash_sha at line 382, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> g_CryptoTaHash_sha
  - g_TA_Printf at line 384, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> g_TA_Printf
  - TEE_AllocateOperation at line 396, params=[0]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> TEE_AllocateOperation
  - TEE_SetOperationKey at line 405, params=[0, 1]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> TEE_SetOperationKey
  - TEE_AsymmetricSignDigest at line 415, params=[3, 4, 5]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> TEE_AsymmetricSignDigest
  - g_TA_Printf at line 421, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> g_TA_Printf
  - g_TA_Printf at line 448, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> g_TA_Printf
  - g_CryptoTaHash_sha at line 450, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> g_CryptoTaHash_sha
  - g_TA_Printf at line 452, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> g_TA_Printf
  - TEE_AllocateOperation at line 464, params=[0]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> TEE_AllocateOperation
  - TEE_SetOperationKey at line 473, params=[0, 1]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> TEE_SetOperationKey
  - TEE_AsymmetricVerifyDigest at line 483, params=[3, 4, 5, 6]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> TEE_AsymmetricVerifyDigest
  - TEE_MemMove at line 490, params=[0, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> TEE_MemMove
  - TEE_MemMove at line 498, params=[0, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> TEE_MemMove
  - g_CryptoTaOther_Random at line 328, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Random -> g_CryptoTaOther_Random
  - g_CryptoTaHash_sha at line 352, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Sha -> g_CryptoTaHash_sha
  - g_CryptoTaHash_hmac at line 372, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_hmac -> g_CryptoTaHash_hmac
  - TEE_MemMove at line 396, params=[0, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> TEE_MemMove
  - g_CryptoTaAes_AesOper at line 406, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper
  - g_CryptoTaPbkdf_PBKDF2 at line 427, params=[0, 1, 2, 3, 4]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2
  - g_CryptoTaRsa_rsaEncOper at line 471, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaEncOper
  - g_CryptoTaRsa_rsaDecOper at line 475, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper
  - g_CryptoTaRsa_rsaSignOper at line 479, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper
  - g_CryptoTaRsa_rsaVerifyOper at line 483, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper
  - g_TA_Printf at line 511, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_base64 -> g_TA_Printf
  - g_CryptoTaOther_base64 at line 514, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_base64 -> g_CryptoTaOther_base64
  - g_TA_Printf at line 517, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_base64 -> g_TA_Printf
  - TEE_GenerateRandom at line 120, params=[0, 1]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Random -> g_CryptoTaOther_Random -> TEE_GenerateRandom
  - TEE_AllocateOperation at line 122, params=[0]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC -> g_CryptoTaHash_sha -> TEE_AllocateOperation
  - TEE_DigestUpdate at line 130, params=[1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC -> g_CryptoTaHash_sha -> TEE_DigestUpdate
  - TEE_DigestDoFinal at line 133, params=[1, 2, 3]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC -> g_CryptoTaHash_sha -> TEE_DigestDoFinal
  - g_TA_Printf at line 145, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC -> g_CryptoTaHash_sha -> g_TA_Printf
  - TEE_AllocateOperation at line 189, params=[0]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_hmac -> g_CryptoTaHash_hmac -> TEE_AllocateOperation
  - TEE_AllocateTransientObject at line 198, params=[0, 1]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_hmac -> g_CryptoTaHash_hmac -> TEE_AllocateTransientObject
  - TEE_PopulateTransientObject at line 212, params=[1]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_hmac -> g_CryptoTaHash_hmac -> TEE_PopulateTransientObject
  - TEE_SetOperationKey at line 221, params=[0, 1]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_hmac -> g_CryptoTaHash_hmac -> TEE_SetOperationKey
  - TEE_AllocateTransientObject at line 230, params=[0, 1]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_hmac -> g_CryptoTaHash_hmac -> TEE_AllocateTransientObject
  - TEE_DeriveKey at line 251, params=[1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_hmac -> g_CryptoTaHash_hmac -> TEE_DeriveKey
  - TEE_GetObjectBufferAttribute at line 253, params=[2, 3]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_hmac -> g_CryptoTaHash_hmac -> TEE_GetObjectBufferAttribute
  - g_TA_Printf at line 263, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_hmac -> g_CryptoTaHash_hmac -> g_TA_Printf
  - TEE_MemMove at line 110, params=[0, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC -> TEE_MemMove
  - TEE_MemMove at line 114, params=[0, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC -> TEE_MemMove
  - g_CryptoTaHash_sha at line 138, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC -> g_CryptoTaHash_sha
  - g_CryptoTaHash_sha at line 153, params=[0, 1, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC -> g_CryptoTaHash_sha
  - TEE_MemMove at line 156, params=[0, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC -> TEE_MemMove
  - TEE_MemFill at line 229, params=[0, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> TEE_MemFill
  - TEE_MemMove at line 230, params=[0, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> TEE_MemMove
  - TEE_MemFill at line 240, params=[0, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> TEE_MemFill
  - TEE_MemMove at line 241, params=[0, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> TEE_MemMove
  - TEE_MemMove at line 264, params=[0, 2]: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> TEE_MemMove

[generate_candidate_flows] 85 件 → /workspace/benchmark/basicAlg_use/ta/results/ta_candidate_flows.json
/workspace/src/rag/vector_store.py:79: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embeddings = HuggingFaceEmbeddings(
/workspace/src/rag/vector_store.py:390: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_store = Chroma(
[DEBUG] Using prompts directory: /workspace/prompts/vulnerabilities_prompt
[INFO] Initializing embedding model: sentence-transformers/all-MiniLM-L6-v2
[INFO] Loading vector store from /workspace/src/rag/vector_stores
[INFO] Vector store loaded successfully
[INFO] Total chunks: 1264
[INFO] Index created: 2025-07-24T05:00:30.995158
[INFO] Loaded existing vector index
[DEBUG] RAG system already initialized
使用中のLLMプロバイダー: openai
[taint_analyzer] 85 個の候補フローを解析中...
  [1/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper -> g_TA_Printf
[DEBUG] Loaded prompt: taint_start.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Loaded prompt: taint_middle.txt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for g_TA_Printf (param 0): 2027 chars
[DEBUG] Loaded prompt: taint_middle_multi_params_with_rag.txt
[DEBUG] Using multi-param RAG template for g_TA_Printf
[DEBUG] Loaded prompt: taint_end.txt
  [2/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper -> g_TA_Printf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for g_TA_Printf (param 0): 2027 chars
[DEBUG] Using multi-param RAG template for g_TA_Printf
  [3/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper -> g_TA_Printf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for g_TA_Printf (param 0): 2027 chars
[DEBUG] Using multi-param RAG template for g_TA_Printf
  [4/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper -> TEE_AllocateOperation
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_AllocateOperation, param_index=0
[DEBUG] Attempting to get RAG context for TEE_AllocateOperation
[DEBUG] Retrieved RAG context for TEE_AllocateOperation (param 0): 2903 chars
[DEBUG] Loaded prompt: taint_middle_with_rag.txt
[DEBUG] Using RAG template for TEE_AllocateOperation
  [5/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper -> TEE_AllocateTransientObject
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_AllocateTransientObject (param 0): 1089 chars
[DEBUG] Using multi-param RAG template for TEE_AllocateTransientObject
  [6/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper -> TEE_InitRefAttribute
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_InitRefAttribute (param 2): 1496 chars
[DEBUG] Using multi-param RAG template for TEE_InitRefAttribute
  [7/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper -> TEE_PopulateTransientObject
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_PopulateTransientObject, param_index=1
[DEBUG] Attempting to get RAG context for TEE_PopulateTransientObject
[DEBUG] Retrieved RAG context for TEE_PopulateTransientObject (param 1): 4480 chars
[DEBUG] Using RAG template for TEE_PopulateTransientObject
  [8/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper -> TEE_SetOperationKey
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_SetOperationKey (param 0): 5515 chars
[DEBUG] Using multi-param RAG template for TEE_SetOperationKey
  [9/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper -> TEE_CipherInit
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_CipherInit (param 1): 6793 chars
[DEBUG] Using multi-param RAG template for TEE_CipherInit
  [10/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper -> TEE_CipherDoFinal
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_CipherDoFinal (param 2): 6788 chars
[DEBUG] Using multi-param RAG template for TEE_CipherDoFinal
  [11/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper -> g_TA_Printf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for g_TA_Printf (param 0): 2027 chars
[DEBUG] Using multi-param RAG template for g_TA_Printf
  [12/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Random
[DEBUG] Retrieved RAG context for g_CryptoTaHandle_Random (param 0): 1873 chars
[DEBUG] Using multi-param RAG template for g_CryptoTaHandle_Random
  [13/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Sha
[DEBUG] Retrieved RAG context for g_CryptoTaHandle_Sha (param 0): 2037 chars
[DEBUG] Using multi-param RAG template for g_CryptoTaHandle_Sha
  [14/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes
[DEBUG] Retrieved RAG context for g_CryptoTaHandle_Aes (param 0): 2870 chars
[DEBUG] Using multi-param RAG template for g_CryptoTaHandle_Aes
  [15/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf
[DEBUG] Retrieved RAG context for g_CryptoTaHandle_Pbkdf (param 0): 2017 chars
[DEBUG] Using multi-param RAG template for g_CryptoTaHandle_Pbkdf
  [16/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa
[DEBUG] Retrieved RAG context for g_CryptoTaHandle_Rsa (param 0): 1332 chars
[DEBUG] Using multi-param RAG template for g_CryptoTaHandle_Rsa
  [17/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa
[DEBUG] Retrieved RAG context for g_CryptoTaHandle_Rsa (param 0): 1332 chars
[DEBUG] Using multi-param RAG template for g_CryptoTaHandle_Rsa
  [18/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa
[DEBUG] Retrieved RAG context for g_CryptoTaHandle_Rsa (param 0): 1332 chars
[DEBUG] Using multi-param RAG template for g_CryptoTaHandle_Rsa
  [19/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa
[DEBUG] Retrieved RAG context for g_CryptoTaHandle_Rsa (param 0): 1332 chars
[DEBUG] Using multi-param RAG template for g_CryptoTaHandle_Rsa
  [20/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_hmac
[DEBUG] Retrieved RAG context for g_CryptoTaHandle_hmac (param 0): 2891 chars
[DEBUG] Using multi-param RAG template for g_CryptoTaHandle_hmac
  [21/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_base64
[DEBUG] Retrieved RAG context for g_CryptoTaHandle_base64 (param 0): 2870 chars
[DEBUG] Using multi-param RAG template for g_CryptoTaHandle_base64
  [22/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper -> l_CryptoTaRsa_SetRsaPrivateKey -> TEE_MemFill
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemFill (param 0): 3627 chars
[DEBUG] Using multi-param RAG template for TEE_MemFill
  [23/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper -> l_CryptoTaRsa_SetRsaPrivateKey -> TEE_AllocateTransientObject
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_AllocateTransientObject (param 0): 1089 chars
[DEBUG] Using multi-param RAG template for TEE_AllocateTransientObject
  [24/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper -> l_CryptoTaRsa_SetRsaPrivateKey -> TEE_PopulateTransientObject
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_PopulateTransientObject, param_index=1
[DEBUG] Attempting to get RAG context for TEE_PopulateTransientObject
[DEBUG] Retrieved RAG context for TEE_PopulateTransientObject (param 1): 4480 chars
[DEBUG] Using RAG template for TEE_PopulateTransientObject
  [25/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaEncOper -> l_CryptoTaRsa_SetRsaPublicKey -> TEE_MemFill
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemFill (param 0): 3627 chars
[DEBUG] Using multi-param RAG template for TEE_MemFill
  [26/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaEncOper -> l_CryptoTaRsa_SetRsaPublicKey -> TEE_AllocateTransientObject
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_AllocateTransientObject (param 0): 1089 chars
[DEBUG] Using multi-param RAG template for TEE_AllocateTransientObject
  [27/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaEncOper -> l_CryptoTaRsa_SetRsaPublicKey -> TEE_PopulateTransientObject
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_PopulateTransientObject, param_index=1
[DEBUG] Attempting to get RAG context for TEE_PopulateTransientObject
[DEBUG] Retrieved RAG context for TEE_PopulateTransientObject (param 1): 4480 chars
[DEBUG] Using RAG template for TEE_PopulateTransientObject
  [28/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaEncOper -> TEE_AllocateOperation
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_AllocateOperation, param_index=0
[DEBUG] Attempting to get RAG context for TEE_AllocateOperation
[DEBUG] Retrieved RAG context for TEE_AllocateOperation (param 0): 2903 chars
[DEBUG] Using RAG template for TEE_AllocateOperation
  [29/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaEncOper -> TEE_SetOperationKey
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_SetOperationKey (param 0): 5515 chars
[DEBUG] Using multi-param RAG template for TEE_SetOperationKey
  [30/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaEncOper -> TEE_AsymmetricEncrypt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_AsymmetricEncrypt (param 4): 3957 chars
[DEBUG] Using multi-param RAG template for TEE_AsymmetricEncrypt
  [31/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaEncOper -> g_TA_Printf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for g_TA_Printf (param 0): 2027 chars
[DEBUG] Using multi-param RAG template for g_TA_Printf
  [32/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper -> TEE_AllocateOperation
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_AllocateOperation, param_index=0
[DEBUG] Attempting to get RAG context for TEE_AllocateOperation
[DEBUG] Retrieved RAG context for TEE_AllocateOperation (param 0): 2903 chars
[DEBUG] Using RAG template for TEE_AllocateOperation
  [33/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper -> TEE_SetOperationKey
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_SetOperationKey (param 0): 5515 chars
[DEBUG] Using multi-param RAG template for TEE_SetOperationKey
  [34/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper -> TEE_AsymmetricDecrypt
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_AsymmetricDecrypt (param 4): 6143 chars
[DEBUG] Using multi-param RAG template for TEE_AsymmetricDecrypt
  [35/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper -> g_TA_Printf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for g_TA_Printf (param 0): 2027 chars
[DEBUG] Using multi-param RAG template for g_TA_Printf
  [36/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> g_CryptoTaHash_sha
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for g_CryptoTaHash_sha (param 0): 2167 chars
[DEBUG] Using multi-param RAG template for g_CryptoTaHash_sha
  [37/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> g_TA_Printf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for g_TA_Printf (param 0): 2027 chars
[DEBUG] Using multi-param RAG template for g_TA_Printf
  [38/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> TEE_AllocateOperation
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_AllocateOperation, param_index=0
[DEBUG] Attempting to get RAG context for TEE_AllocateOperation
[DEBUG] Retrieved RAG context for TEE_AllocateOperation (param 0): 2903 chars
[DEBUG] Using RAG template for TEE_AllocateOperation
  [39/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> TEE_SetOperationKey
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_SetOperationKey (param 0): 5515 chars
[DEBUG] Using multi-param RAG template for TEE_SetOperationKey
  [40/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> TEE_AsymmetricSignDigest
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_AsymmetricSignDigest (param 3): 7045 chars
[DEBUG] Using multi-param RAG template for TEE_AsymmetricSignDigest
  [41/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper -> g_TA_Printf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for g_TA_Printf (param 0): 2027 chars
[DEBUG] Using multi-param RAG template for g_TA_Printf
  [42/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> g_TA_Printf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for g_TA_Printf (param 0): 2027 chars
[DEBUG] Using multi-param RAG template for g_TA_Printf
  [43/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> g_CryptoTaHash_sha
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for g_CryptoTaHash_sha (param 0): 2167 chars
[DEBUG] Using multi-param RAG template for g_CryptoTaHash_sha
  [44/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> g_TA_Printf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for g_TA_Printf (param 0): 2027 chars
[DEBUG] Using multi-param RAG template for g_TA_Printf
  [45/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> TEE_AllocateOperation
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_AllocateOperation, param_index=0
[DEBUG] Attempting to get RAG context for TEE_AllocateOperation
[DEBUG] Retrieved RAG context for TEE_AllocateOperation (param 0): 2903 chars
[DEBUG] Using RAG template for TEE_AllocateOperation
  [46/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> TEE_SetOperationKey
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_SetOperationKey (param 0): 5515 chars
[DEBUG] Using multi-param RAG template for TEE_SetOperationKey
  [47/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> TEE_AsymmetricVerifyDigest
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_AsymmetricVerifyDigest (param 3): 7647 chars
[DEBUG] Using multi-param RAG template for TEE_AsymmetricVerifyDigest
  [48/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [49/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [50/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Random -> g_CryptoTaOther_Random
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for g_CryptoTaOther_Random (param 0): 1967 chars
[DEBUG] Using multi-param RAG template for g_CryptoTaOther_Random
  [51/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Sha -> g_CryptoTaHash_sha
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for g_CryptoTaHash_sha (param 0): 2167 chars
[DEBUG] Using multi-param RAG template for g_CryptoTaHash_sha
  [52/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_hmac -> g_CryptoTaHash_hmac
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for g_CryptoTaHash_hmac (param 0): 2196 chars
[DEBUG] Using multi-param RAG template for g_CryptoTaHash_hmac
  [53/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [54/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Aes -> g_CryptoTaAes_AesOper
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for g_CryptoTaAes_AesOper (param 0): 2857 chars
[DEBUG] Using multi-param RAG template for g_CryptoTaAes_AesOper
  [55/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for g_CryptoTaPbkdf_PBKDF2 (param 0): 1938 chars
[DEBUG] Using multi-param RAG template for g_CryptoTaPbkdf_PBKDF2
  [56/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaEncOper
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for g_CryptoTaRsa_rsaEncOper (param 0): 1937 chars
[DEBUG] Using multi-param RAG template for g_CryptoTaRsa_rsaEncOper
  [57/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaDecOper
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for g_CryptoTaRsa_rsaDecOper (param 0): 1983 chars
[DEBUG] Using multi-param RAG template for g_CryptoTaRsa_rsaDecOper
  [58/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaSignOper
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for g_CryptoTaRsa_rsaSignOper (param 0): 1983 chars
[DEBUG] Using multi-param RAG template for g_CryptoTaRsa_rsaSignOper
  [59/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Rsa -> g_CryptoTaRsa_rsaVerifyOper
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for g_CryptoTaRsa_rsaVerifyOper (param 0): 2141 chars
[DEBUG] Using multi-param RAG template for g_CryptoTaRsa_rsaVerifyOper
  [60/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_base64 -> g_TA_Printf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for g_TA_Printf (param 0): 2027 chars
[DEBUG] Using multi-param RAG template for g_TA_Printf
  [61/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_base64 -> g_CryptoTaOther_base64
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for g_CryptoTaOther_base64 (param 0): 2860 chars
[DEBUG] Using multi-param RAG template for g_CryptoTaOther_base64
  [62/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_base64 -> g_TA_Printf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for g_TA_Printf (param 0): 2027 chars
[DEBUG] Using multi-param RAG template for g_TA_Printf
  [63/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Random -> g_CryptoTaOther_Random -> TEE_GenerateRandom
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_GenerateRandom (param 0): 3907 chars
[DEBUG] Using multi-param RAG template for TEE_GenerateRandom
  [64/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC -> g_CryptoTaHash_sha -> TEE_AllocateOperation
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_AllocateOperation, param_index=0
[DEBUG] Attempting to get RAG context for TEE_AllocateOperation
[DEBUG] Retrieved RAG context for TEE_AllocateOperation (param 0): 2903 chars
[DEBUG] Using RAG template for TEE_AllocateOperation
  [65/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC -> g_CryptoTaHash_sha -> TEE_DigestUpdate
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_DigestUpdate (param 1): 3885 chars
[DEBUG] Using multi-param RAG template for TEE_DigestUpdate
  [66/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC -> g_CryptoTaHash_sha -> TEE_DigestDoFinal
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_DigestDoFinal (param 1): 6001 chars
[DEBUG] Using multi-param RAG template for TEE_DigestDoFinal
  [67/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC -> g_CryptoTaHash_sha -> g_TA_Printf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for g_TA_Printf (param 0): 2027 chars
[DEBUG] Using multi-param RAG template for g_TA_Printf
  [68/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_hmac -> g_CryptoTaHash_hmac -> TEE_AllocateOperation
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_AllocateOperation, param_index=0
[DEBUG] Attempting to get RAG context for TEE_AllocateOperation
[DEBUG] Retrieved RAG context for TEE_AllocateOperation (param 0): 2903 chars
[DEBUG] Using RAG template for TEE_AllocateOperation
  [69/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_hmac -> g_CryptoTaHash_hmac -> TEE_AllocateTransientObject
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_AllocateTransientObject (param 0): 1089 chars
[DEBUG] Using multi-param RAG template for TEE_AllocateTransientObject
  [70/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_hmac -> g_CryptoTaHash_hmac -> TEE_PopulateTransientObject
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=TEE_PopulateTransientObject, param_index=1
[DEBUG] Attempting to get RAG context for TEE_PopulateTransientObject
[DEBUG] Retrieved RAG context for TEE_PopulateTransientObject (param 1): 4480 chars
[DEBUG] Using RAG template for TEE_PopulateTransientObject
  [71/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_hmac -> g_CryptoTaHash_hmac -> TEE_SetOperationKey
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_SetOperationKey (param 0): 5515 chars
[DEBUG] Using multi-param RAG template for TEE_SetOperationKey
  [72/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_hmac -> g_CryptoTaHash_hmac -> TEE_AllocateTransientObject
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_AllocateTransientObject (param 0): 1089 chars
[DEBUG] Using multi-param RAG template for TEE_AllocateTransientObject
  [73/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_hmac -> g_CryptoTaHash_hmac -> TEE_DeriveKey
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_DeriveKey (param 1): 4414 chars
[DEBUG] Using multi-param RAG template for TEE_DeriveKey
  [74/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_hmac -> g_CryptoTaHash_hmac -> TEE_GetObjectBufferAttribute
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_GetObjectBufferAttribute (param 2): 7419 chars
[DEBUG] Using multi-param RAG template for TEE_GetObjectBufferAttribute
  [75/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_hmac -> g_CryptoTaHash_hmac -> g_TA_Printf
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for g_TA_Printf (param 0): 2027 chars
[DEBUG] Using multi-param RAG template for g_TA_Printf
  [76/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [77/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [78/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC -> g_CryptoTaHash_sha
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for g_CryptoTaHash_sha (param 0): 2167 chars
[DEBUG] Using multi-param RAG template for g_CryptoTaHash_sha
  [79/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC -> g_CryptoTaHash_sha
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for g_CryptoTaHash_sha (param 0): 2167 chars
[DEBUG] Using multi-param RAG template for g_CryptoTaHash_sha
  [80/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> l_CryptoTaPbkdf_HMAC -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [81/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> TEE_MemFill
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemFill (param 0): 3627 chars
[DEBUG] Using multi-param RAG template for TEE_MemFill
  [82/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [83/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> TEE_MemFill
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemFill (param 0): 3627 chars
[DEBUG] Using multi-param RAG template for TEE_MemFill
  [84/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
  [85/85] チェーン: TA_InvokeCommandEntryPoint -> g_CryptoTaHandle_Pbkdf -> g_CryptoTaPbkdf_PBKDF2 -> TEE_MemMove
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] get_middle_prompt called: sink_function=None, param_index=None
[DEBUG] Retrieved RAG context for TEE_MemMove (param 0): 4271 chars
[DEBUG] Using multi-param RAG template for TEE_MemMove
[taint_analyzer] 解析完了: 79 件の脆弱性を検出
  結果: /workspace/benchmark/basicAlg_use/ta/results/ta_vulnerabilities.json
  ログ: /workspace/benchmark/basicAlg_use/ta/results/taint_analysis_log.txt
[generate_report] HTMLレポートを生成しました: /workspace/benchmark/basicAlg_use/ta/results/ta_vulnerability_report.html
  検出脆弱性数: 79
  AI対話履歴を含めました: /workspace/benchmark/basicAlg_use/ta/results/taint_analysis_log.txt
  対話チェーン数: 68
[phase3.1] → python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/basicAlg_use/ta/compile_commands.json --sinks /workspace/benchmark/basicAlg_use/ta/results/ta_sinks.json --output /workspace/benchmark/basicAlg_use/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/find_sink_calls.py --compile-db /workspace/benchmark/basicAlg_use/ta/compile_commands.json --sinks /workspace/benchmark/basicAlg_use/ta/results/ta_sinks.json --output /workspace/benchmark/basicAlg_use/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/basicAlg_use/ta)
[phase3.4] → /workspace/benchmark/basicAlg_use/ta/results/ta_vulnerable_destinations.json

[phase3.2] → python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/basicAlg_use/ta/compile_commands.json --output /workspace/benchmark/basicAlg_use/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/generate_call_graph.py --compile-db /workspace/benchmark/basicAlg_use/ta/compile_commands.json --output /workspace/benchmark/basicAlg_use/ta/results/ta_call_graph.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/basicAlg_use/ta)
[phase3.5] → /workspace/benchmark/basicAlg_use/ta/results/ta_call_graph.json

[phase3.3] → python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/basicAlg_use/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/basicAlg_use/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/basicAlg_use/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/basicAlg_use/ta/results/ta_chains.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/function_call_chains.py --call-graph /workspace/benchmark/basicAlg_use/ta/results/ta_call_graph.json --vd-list /workspace/benchmark/basicAlg_use/ta/results/ta_vulnerable_destinations.json --compile-db /workspace/benchmark/basicAlg_use/ta/compile_commands.json --devkit /workspace/optee_os/out/arm/export-ta_arm32 --output /workspace/benchmark/basicAlg_use/ta/results/ta_chains.json  (cwd=/workspace/benchmark/basicAlg_use/ta)
[phase3.6] → /workspace/benchmark/basicAlg_use/ta/results/ta_chains.json

[INFO] $ /usr/bin/python3 /workspace/src/identify_sinks/extract_sink_calls.py --compile-db /workspace/benchmark/basicAlg_use/ta/compile_commands.json --sinks /workspace/benchmark/basicAlg_use/ta/results/ta_sinks.json --output /workspace/benchmark/basicAlg_use/ta/results/ta_vulnerable_destinations.json --devkit /workspace/optee_os/out/arm/export-ta_arm32  (cwd=/workspace/benchmark/basicAlg_use/ta)
[phase3.7] → /workspace/benchmark/basicAlg_use/ta/results/ta_vulnerable_destinations.json

[phase5_command] → python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/basicAlg_use/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/basicAlg_use/ta/results/ta_candidate_flows.json
[INFO] $ /usr/bin/python3 /workspace/src/identify_flows/generate_candidate_flows.py --chains /workspace/benchmark/basicAlg_use/ta/results/ta_chains.json --sources TA_InvokeCommandEntryPoint,TA_OpenSessionEntryPoint --output /workspace/benchmark/basicAlg_use/ta/results/ta_candidate_flows.json  (cwd=/workspace/benchmark/basicAlg_use/ta)
[phase5 ] → /workspace/benchmark/basicAlg_use/ta/results/ta_candidate_flows.json

[INFO] $ /usr/bin/python3 /workspace/src/analyze_vulnerabilities/taint_analyzer.py --flows /workspace/benchmark/basicAlg_use/ta/results/ta_candidate_flows.json --phase12 /workspace/benchmark/basicAlg_use/ta/results/ta_phase12.json --output /workspace/benchmark/basicAlg_use/ta/results/ta_vulnerabilities.json  (cwd=/workspace/benchmark/basicAlg_use/ta)
[phase6 ] → /workspace/benchmark/basicAlg_use/ta/results/ta_vulnerabilities.json

[INFO] $ /usr/bin/python3 /workspace/src/report/generate_report.py --vulnerabilities /workspace/benchmark/basicAlg_use/ta/results/ta_vulnerabilities.json --phase12 /workspace/benchmark/basicAlg_use/ta/results/ta_phase12.json --project-name basicAlg_use --output /workspace/benchmark/basicAlg_use/ta/results/ta_vulnerability_report.html  (cwd=/workspace/benchmark/basicAlg_use/ta)
[phase7 ] → /workspace/benchmark/basicAlg_use/ta/results/ta_vulnerability_report.html

